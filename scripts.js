var JSON;if(!JSON){JSON={};}(function(){function f(n){return n<10?"0"+n:n;}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key);}if(typeof rep==="function"){value=rep.call(holder,key,value);}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null";}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null";}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v;}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v);}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v);}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v;}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" ";}}else{if(typeof space==="string"){indent=space;}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify");}return str("",{"":value});};}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}return reviver.call(holder,key,value);}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);});}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j;}throw new SyntaxError("JSON.parse");};}}());/*
 * ASP.NET SignalR JavaScript Library v1.0.0
 * http://signalr.net/
 *
 * Copyright Microsoft Open Technologies, Inc. All rights reserved.
 * Licensed under the Apache 2.0
 * https://github.com/SignalR/SignalR/blob/master/LICENSE.md
 *
 */
(function($,window){if(typeof($)!=="function"){throw new Error("SignalR: jQuery not found. Please ensure jQuery is referenced before the SignalR.js file.");}if(!window.JSON){throw new Error("SignalR: No JSON parser found. Please ensure json2.js is referenced before the SignalR.js file if you need to support clients without native JSON parsing support, e.g. IE<8.");}var signalR,_connection,_pageLoaded=(window.document.readyState==="complete"),_pageWindow=$(window),events={onStart:"onStart",onStarting:"onStarting",onReceived:"onReceived",onError:"onError",onConnectionSlow:"onConnectionSlow",onReconnecting:"onReconnecting",onReconnect:"onReconnect",onStateChanged:"onStateChanged",onDisconnect:"onDisconnect"},log=function(msg,logging){if(logging===false){return;}var m;if(typeof(window.console)==="undefined"){return;}m="["+new Date().toTimeString()+"] SignalR: "+msg;if(window.console.debug){window.console.debug(m);}else{if(window.console.log){window.console.log(m);}}},changeState=function(connection,expectedState,newState){if(expectedState===connection.state){connection.state=newState;$(connection).triggerHandler(events.onStateChanged,[{oldState:expectedState,newState:newState}]);return true;}return false;},isDisconnecting=function(connection){return connection.state===signalR.connectionState.disconnected;},configureStopReconnectingTimeout=function(connection){var stopReconnectingTimeout,onReconnectTimeout;if(!connection._.configuredStopReconnectingTimeout){onReconnectTimeout=function(connection){connection.log("Couldn't reconnect within the configured timeout ("+connection.disconnectTimeout+"ms), disconnecting.");connection.stop(false,false);};connection.reconnecting(function(){var connection=this;stopReconnectingTimeout=window.setTimeout(function(){onReconnectTimeout(connection);},connection.disconnectTimeout);});connection.stateChanged(function(data){if(data.oldState===signalR.connectionState.reconnecting){window.clearTimeout(stopReconnectingTimeout);}});connection._.configuredStopReconnectingTimeout=true;}};signalR=function(url,qs,logging){return new signalR.fn.init(url,qs,logging);};signalR.events=events;signalR.changeState=changeState;signalR.isDisconnecting=isDisconnecting;signalR.connectionState={connecting:0,connected:1,reconnecting:2,disconnected:4};signalR.hub={start:function(){throw new Error("SignalR: Error loading hubs. Ensure your hubs reference is correct, e.g. <script src='/signalr/hubs'></script>.");}};_pageWindow.load(function(){_pageLoaded=true;});function validateTransport(requestedTransport,connection){if($.isArray(requestedTransport)){for(var i=requestedTransport.length-1;i>=0;i--){var transport=requestedTransport[i];if($.type(requestedTransport)!=="object"&&($.type(transport)!=="string"||!signalR.transports[transport])){connection.log("Invalid transport: "+transport+", removing it from the transports list.");requestedTransport.splice(i,1);}}if(requestedTransport.length===0){connection.log("No transports remain within the specified transport array.");requestedTransport=null;}}else{if($.type(requestedTransport)!=="object"&&!signalR.transports[requestedTransport]&&requestedTransport!=="auto"){connection.log("Invalid transport: "+requestedTransport.toString());requestedTransport=null;}}return requestedTransport;}function getDefaultPort(protocol){if(protocol==="http:"){return 80;}else{if(protocol==="https:"){return 443;}}}function addDefaultPort(protocol,url){if(url.match(/:\d+$/)){return url;}else{return url+":"+getDefaultPort(protocol);}}signalR.fn=signalR.prototype={init:function(url,qs,logging){this.url=url;this.qs=qs;this._={};if(typeof(logging)==="boolean"){this.logging=logging;}},isCrossDomain:function(url,against){var link;url=$.trim(url);if(url.indexOf("http")!==0){return false;}against=against||window.location;link=window.document.createElement("a");link.href=url;return link.protocol+addDefaultPort(link.protocol,link.host)!==against.protocol+addDefaultPort(against.protocol,against.host);},ajaxDataType:"json",logging:false,state:signalR.connectionState.disconnected,keepAliveData:{},reconnectDelay:2000,disconnectTimeout:40000,keepAliveWarnAt:2/3,start:function(options,callback){var connection=this,config={waitForPageLoad:true,transport:"auto",jsonp:false},initialize,deferred=connection._deferral||$.Deferred(),parser=window.document.createElement("a");if($.type(options)==="function"){callback=options;}else{if($.type(options)==="object"){$.extend(config,options);if($.type(config.callback)==="function"){callback=config.callback;}}}config.transport=validateTransport(config.transport,connection);if(!config.transport){throw new Error("SignalR: Invalid transport(s) specified, aborting start.");}if(!_pageLoaded&&config.waitForPageLoad===true){_pageWindow.load(function(){connection._deferral=deferred;connection.start(options,callback);});return deferred.promise();}configureStopReconnectingTimeout(connection);if(changeState(connection,signalR.connectionState.disconnected,signalR.connectionState.connecting)===false){deferred.resolve(connection);return deferred.promise();}parser.href=connection.url;if(!parser.protocol||parser.protocol===":"){connection.protocol=window.document.location.protocol;connection.host=window.document.location.host;connection.baseUrl=connection.protocol+"//"+connection.host;}else{connection.protocol=parser.protocol;connection.host=parser.host;connection.baseUrl=parser.protocol+"//"+parser.host;}connection.wsProtocol=connection.protocol==="https:"?"wss://":"ws://";if(config.transport==="auto"&&config.jsonp===true){config.transport="longPolling";}if(this.isCrossDomain(connection.url)){connection.log("Auto detected cross domain url.");if(config.transport==="auto"){config.transport=["webSockets","longPolling"];}if(!config.jsonp){config.jsonp=!$.support.cors;if(config.jsonp){connection.log("Using jsonp because this browser doesn't support CORS");}}}connection.ajaxDataType=config.jsonp?"jsonp":"json";$(connection).bind(events.onStart,function(e,data){if($.type(callback)==="function"){callback.call(connection);}deferred.resolve(connection);});initialize=function(transports,index){index=index||0;if(index>=transports.length){if(!connection.transport){$(connection).triggerHandler(events.onError,"SignalR: No transport could be initialized successfully. Try specifying a different transport or none at all for auto initialization.");deferred.reject("SignalR: No transport could be initialized successfully. Try specifying a different transport or none at all for auto initialization.");connection.stop();}return;}var transportName=transports[index],transport=$.type(transportName)==="object"?transportName:signalR.transports[transportName];if(transportName.indexOf("_")===0){initialize(transports,index+1);return;}transport.start(connection,function(){if(transport.supportsKeepAlive&&connection.keepAliveData.activated){signalR.transports._logic.monitorKeepAlive(connection);}connection.transport=transport;changeState(connection,signalR.connectionState.connecting,signalR.connectionState.connected);$(connection).triggerHandler(events.onStart);_pageWindow.unload(function(){connection.stop(false);});},function(){initialize(transports,index+1);});};var url=connection.url+"/negotiate";connection.log("Negotiating with '"+url+"'.");$.ajax({url:url,global:false,cache:false,type:"GET",data:{},dataType:connection.ajaxDataType,error:function(error){$(connection).triggerHandler(events.onError,[error.responseText]);deferred.reject("SignalR: Error during negotiation request: "+error.responseText);connection.stop();},success:function(res){var keepAliveData=connection.keepAliveData;connection.appRelativeUrl=res.Url;connection.id=res.ConnectionId;connection.token=res.ConnectionToken;connection.webSocketServerUrl=res.WebSocketServerUrl;connection.disconnectTimeout=res.DisconnectTimeout*1000;if(res.KeepAliveTimeout){keepAliveData.activated=true;keepAliveData.timeout=res.KeepAliveTimeout*1000;keepAliveData.timeoutWarning=keepAliveData.timeout*connection.keepAliveWarnAt;keepAliveData.checkInterval=(keepAliveData.timeout-keepAliveData.timeoutWarning)/3;}else{keepAliveData.activated=false;}if(!res.ProtocolVersion||res.ProtocolVersion!=="1.2"){$(connection).triggerHandler(events.onError,"SignalR: Incompatible protocol version.");deferred.reject("SignalR: Incompatible protocol version.");return;}$(connection).triggerHandler(events.onStarting);var transports=[],supportedTransports=[];$.each(signalR.transports,function(key){if(key==="webSockets"&&!res.TryWebSockets){return true;}supportedTransports.push(key);});if($.isArray(config.transport)){$.each(config.transport,function(){var transport=this;if($.type(transport)==="object"||($.type(transport)==="string"&&$.inArray(""+transport,supportedTransports)>=0)){transports.push($.type(transport)==="string"?""+transport:transport);}});}else{if($.type(config.transport)==="object"||$.inArray(config.transport,supportedTransports)>=0){transports.push(config.transport);}else{transports=supportedTransports;}}initialize(transports);}});return deferred.promise();},starting:function(callback){var connection=this;$(connection).bind(events.onStarting,function(e,data){callback.call(connection);});return connection;},send:function(data){var connection=this;if(connection.state===signalR.connectionState.disconnected){throw new Error("SignalR: Connection must be started before data can be sent. Call .start() before .send()");}if(connection.state===signalR.connectionState.connecting){throw new Error("SignalR: Connection has not been fully initialized. Use .start().done() or .start().fail() to run logic after the connection has started.");}connection.transport.send(connection,data);return connection;},received:function(callback){var connection=this;$(connection).bind(events.onReceived,function(e,data){callback.call(connection,data);});return connection;},stateChanged:function(callback){var connection=this;$(connection).bind(events.onStateChanged,function(e,data){callback.call(connection,data);});return connection;},error:function(callback){var connection=this;$(connection).bind(events.onError,function(e,data){callback.call(connection,data);});return connection;},disconnected:function(callback){var connection=this;$(connection).bind(events.onDisconnect,function(e,data){callback.call(connection);});return connection;},connectionSlow:function(callback){var connection=this;$(connection).bind(events.onConnectionSlow,function(e,data){callback.call(connection);});return connection;},reconnecting:function(callback){var connection=this;$(connection).bind(events.onReconnecting,function(e,data){callback.call(connection);});return connection;},reconnected:function(callback){var connection=this;$(connection).bind(events.onReconnect,function(e,data){callback.call(connection);});return connection;},stop:function(async,notifyServer){var connection=this;if(connection.state===signalR.connectionState.disconnected){return;}try{if(connection.transport){if(notifyServer!==false){connection.transport.abort(connection,async);}if(connection.transport.supportsKeepAlive&&connection.keepAliveData.activated){signalR.transports._logic.stopMonitoringKeepAlive(connection);}connection.transport.stop(connection);connection.transport=null;}$(connection).triggerHandler(events.onDisconnect);delete connection.messageId;delete connection.groupsToken;delete connection.id;delete connection._deferral;}finally{changeState(connection,connection.state,signalR.connectionState.disconnected);}return connection;},log:function(msg){log(msg,this.logging);}};signalR.fn.init.prototype=signalR.fn;signalR.noConflict=function(){if($.connection===signalR){$.connection=_connection;}return signalR;};if($.connection){_connection=$.connection;}$.connection=$.signalR=signalR;}(window.jQuery,window));(function($,window){var signalR=$.signalR,events=$.signalR.events,changeState=$.signalR.changeState;signalR.transports={};function checkIfAlive(connection){var keepAliveData=connection.keepAliveData,diff,timeElapsed;if(connection.state===signalR.connectionState.connected){diff=new Date();diff.setTime(diff-keepAliveData.lastKeepAlive);timeElapsed=diff.getTime();if(timeElapsed>=keepAliveData.timeout){connection.log("Keep alive timed out.  Notifying transport that connection has been lost.");connection.transport.lostConnection(connection);}else{if(timeElapsed>=keepAliveData.timeoutWarning){if(!keepAliveData.userNotified){connection.log("Keep alive has been missed, connection may be dead/slow.");$(connection).triggerHandler(events.onConnectionSlow);keepAliveData.userNotified=true;}}else{keepAliveData.userNotified=false;}}}if(keepAliveData.monitoring){window.setTimeout(function(){checkIfAlive(connection);},keepAliveData.checkInterval);}}signalR.transports._logic={pingServer:function(connection,transport){var baseUrl=transport==="webSockets"?"":connection.baseUrl,url=baseUrl+connection.appRelativeUrl+"/ping",deferral=$.Deferred();$.ajax({url:url,global:false,cache:false,type:"GET",data:{},dataType:connection.ajaxDataType,success:function(data){if(data.Response==="pong"){deferral.resolve();}else{deferral.reject("SignalR: Invalid ping response when pinging server: "+(data.responseText||data.statusText));}},error:function(data){deferral.reject("SignalR: Error pinging server: "+(data.responseText||data.statusText));}});return deferral.promise();},addQs:function(url,connection){if(!connection.qs){return url;}if(typeof(connection.qs)==="object"){return url+"&"+$.param(connection.qs);}if(typeof(connection.qs)==="string"){return url+"&"+connection.qs;}return url+"&"+window.encodeURIComponent(connection.qs.toString());},getUrl:function(connection,transport,reconnecting,appendReconnectUrl){var baseUrl=transport==="webSockets"?"":connection.baseUrl,url=baseUrl+connection.appRelativeUrl,qs="transport="+transport+"&connectionToken="+window.encodeURIComponent(connection.token);if(connection.data){qs+="&connectionData="+window.encodeURIComponent(connection.data);}if(connection.groupsToken){qs+="&groupsToken="+window.encodeURIComponent(connection.groupsToken);}if(!reconnecting){url=url+"/connect";}else{if(appendReconnectUrl){url=url+"/reconnect";}if(connection.messageId){qs+="&messageId="+window.encodeURIComponent(connection.messageId);}}url+="?"+qs;url=this.addQs(url,connection);url+="&tid="+Math.floor(Math.random()*11);return url;},maximizePersistentResponse:function(minPersistentResponse){return{MessageId:minPersistentResponse.C,Messages:minPersistentResponse.M,Disconnect:typeof(minPersistentResponse.D)!=="undefined"?true:false,TimedOut:typeof(minPersistentResponse.T)!=="undefined"?true:false,LongPollDelay:minPersistentResponse.L,GroupsToken:minPersistentResponse.G};},updateGroups:function(connection,groupsToken){if(groupsToken){connection.groupsToken=groupsToken;}},ajaxSend:function(connection,data){var url=connection.url+"/send"+"?transport="+connection.transport.name+"&connectionToken="+window.encodeURIComponent(connection.token);url=this.addQs(url,connection);return $.ajax({url:url,global:false,type:connection.ajaxDataType==="jsonp"?"GET":"POST",dataType:connection.ajaxDataType,data:{data:data},success:function(result){if(result){$(connection).triggerHandler(events.onReceived,[result]);}},error:function(errData,textStatus){if(textStatus==="abort"||(textStatus==="parsererror"&&connection.ajaxDataType==="jsonp")){return;}$(connection).triggerHandler(events.onError,[errData]);}});},ajaxAbort:function(connection,async){if(typeof(connection.transport)==="undefined"){return;}async=typeof async==="undefined"?true:async;var url=connection.url+"/abort"+"?transport="+connection.transport.name+"&connectionToken="+window.encodeURIComponent(connection.token);url=this.addQs(url,connection);$.ajax({url:url,async:async,timeout:1000,global:false,type:"POST",dataType:connection.ajaxDataType,data:{}});connection.log("Fired ajax abort async = "+async);},processMessages:function(connection,minData){var data;if(connection.transport){var $connection=$(connection);if(connection.transport.supportsKeepAlive&&connection.keepAliveData.activated){this.updateKeepAlive(connection);}if(!minData){return;}data=this.maximizePersistentResponse(minData);if(data.Disconnect){connection.log("Disconnect command received from server");connection.stop(false,false);return;}this.updateGroups(connection,data.GroupsToken);if(data.Messages){$.each(data.Messages,function(){try{$connection.triggerHandler(events.onReceived,[this]);}catch(e){connection.log("Error raising received "+e);$(connection).triggerHandler(events.onError,[e]);}});}if(data.MessageId){connection.messageId=data.MessageId;}}},monitorKeepAlive:function(connection){var keepAliveData=connection.keepAliveData,that=this;if(!keepAliveData.monitoring){keepAliveData.monitoring=true;that.updateKeepAlive(connection);connection.keepAliveData.reconnectKeepAliveUpdate=function(){that.updateKeepAlive(connection);};$(connection).bind(events.onReconnect,connection.keepAliveData.reconnectKeepAliveUpdate);connection.log("Now monitoring keep alive with a warning timeout of "+keepAliveData.timeoutWarning+" and a connection lost timeout of "+keepAliveData.timeout);checkIfAlive(connection);}else{connection.log("Tried to monitor keep alive but it's already being monitored");}},stopMonitoringKeepAlive:function(connection){var keepAliveData=connection.keepAliveData;if(keepAliveData.monitoring){keepAliveData.monitoring=false;$(connection).unbind(events.onReconnect,connection.keepAliveData.reconnectKeepAliveUpdate);keepAliveData={};connection.log("Stopping the monitoring of the keep alive");}},updateKeepAlive:function(connection){connection.keepAliveData.lastKeepAlive=new Date();},ensureReconnectingState:function(connection){if(changeState(connection,signalR.connectionState.connected,signalR.connectionState.reconnecting)===true){$(connection).triggerHandler(events.onReconnecting);}return connection.state===signalR.connectionState.reconnecting;},foreverFrame:{count:0,connections:{}}};}(window.jQuery,window));(function($,window){var signalR=$.signalR,events=$.signalR.events,changeState=$.signalR.changeState,transportLogic=signalR.transports._logic;signalR.transports.webSockets={name:"webSockets",supportsKeepAlive:true,attemptingReconnect:false,currentSocketID:0,send:function(connection,data){connection.socket.send(data);},start:function(connection,onSuccess,onFailed){var url,opened=false,that=this,reconnecting=!onSuccess,$connection=$(connection);if(!window.WebSocket){onFailed();return;}if(!connection.socket){if(connection.webSocketServerUrl){url=connection.webSocketServerUrl;}else{url=connection.wsProtocol+connection.host;}url+=transportLogic.getUrl(connection,this.name,reconnecting);connection.log("Connecting to websocket endpoint '"+url+"'");connection.socket=new window.WebSocket(url);connection.socket.ID=++that.currentSocketID;connection.socket.onopen=function(){opened=true;connection.log("Websocket opened");if(that.attemptingReconnect){that.attemptingReconnect=false;}if(onSuccess){onSuccess();}else{if(changeState(connection,signalR.connectionState.reconnecting,signalR.connectionState.connected)===true){$connection.triggerHandler(events.onReconnect);}}};connection.socket.onclose=function(event){if(this.ID===that.currentSocketID){if(!opened){if(onFailed){onFailed();}else{if(reconnecting){that.reconnect(connection);}}return;}else{if(typeof event.wasClean!=="undefined"&&event.wasClean===false){$(connection).triggerHandler(events.onError,[event.reason]);connection.log("Unclean disconnect from websocket."+event.reason);}else{connection.log("Websocket closed");}}that.reconnect(connection);}};connection.socket.onmessage=function(event){var data=window.JSON.parse(event.data),$connection=$(connection);if(data){if($.isEmptyObject(data)||data.M){transportLogic.processMessages(connection,data);}else{$connection.triggerHandler(events.onReceived,[data]);}}};}},reconnect:function(connection){var that=this;if(connection.state!==signalR.connectionState.disconnected){if(!that.attemptingReconnect){that.attemptingReconnect=true;}window.setTimeout(function(){if(that.attemptingReconnect){that.stop(connection);}if(transportLogic.ensureReconnectingState(connection)){connection.log("Websocket reconnecting");that.start(connection);}},connection.reconnectDelay);}},lostConnection:function(connection){this.reconnect(connection);},stop:function(connection){if(connection.socket!==null){connection.log("Closing the Websocket");connection.socket.close();connection.socket=null;}},abort:function(connection){}};}(window.jQuery,window));(function($,window){var signalR=$.signalR,events=$.signalR.events,changeState=$.signalR.changeState,transportLogic=signalR.transports._logic;signalR.transports.serverSentEvents={name:"serverSentEvents",supportsKeepAlive:true,reconnectTimeout:false,currentEventSourceID:0,timeOut:3000,start:function(connection,onSuccess,onFailed){var that=this,opened=false,$connection=$(connection),reconnecting=!onSuccess,url,connectTimeOut;if(connection.eventSource){connection.log("The connection already has an event source. Stopping it.");connection.stop();}if(!window.EventSource){if(onFailed){connection.log("This browser doesn't support SSE.");onFailed();}return;}url=transportLogic.getUrl(connection,this.name,reconnecting);try{connection.log("Attempting to connect to SSE endpoint '"+url+"'");connection.eventSource=new window.EventSource(url);connection.eventSource.ID=++that.currentEventSourceID;}catch(e){connection.log("EventSource failed trying to connect with error "+e.Message);if(onFailed){onFailed();}else{$connection.triggerHandler(events.onError,[e]);if(reconnecting){that.reconnect(connection);}}return;}connectTimeOut=window.setTimeout(function(){if(opened===false){connection.log("EventSource timed out trying to connect");connection.log("EventSource readyState: "+connection.eventSource.readyState);if(!reconnecting){that.stop(connection);}if(reconnecting){if(connection.eventSource.readyState!==window.EventSource.CONNECTING&&connection.eventSource.readyState!==window.EventSource.OPEN){that.reconnect(connection);}}else{if(onFailed){onFailed();}}}},that.timeOut);connection.eventSource.addEventListener("open",function(e){connection.log("EventSource connected");if(connectTimeOut){window.clearTimeout(connectTimeOut);}if(that.reconnectTimeout){window.clearTimeout(that.reconnectTimeout);}if(opened===false){opened=true;if(onSuccess){onSuccess();}else{if(changeState(connection,signalR.connectionState.reconnecting,signalR.connectionState.connected)===true){$connection.triggerHandler(events.onReconnect);}}}},false);connection.eventSource.addEventListener("message",function(e){if(e.data==="initialized"){return;}transportLogic.processMessages(connection,window.JSON.parse(e.data));},false);connection.eventSource.addEventListener("error",function(e){if(this.ID===that.currentEventSourceID){if(!opened){if(onFailed){onFailed();}return;}connection.log("EventSource readyState: "+connection.eventSource.readyState);if(e.eventPhase===window.EventSource.CLOSED){connection.log("EventSource reconnecting due to the server connection ending");that.reconnect(connection);}else{connection.log("EventSource error");$connection.triggerHandler(events.onError);}}},false);},reconnect:function(connection){var that=this;that.reconnectTimeout=window.setTimeout(function(){that.stop(connection);if(transportLogic.ensureReconnectingState(connection)){connection.log("EventSource reconnecting");that.start(connection);}},connection.reconnectDelay);},lostConnection:function(connection){this.reconnect(connection);},send:function(connection,data){transportLogic.ajaxSend(connection,data);},stop:function(connection){if(connection&&connection.eventSource){connection.log("EventSource calling close()");connection.eventSource.close();connection.eventSource=null;delete connection.eventSource;}},abort:function(connection,async){transportLogic.ajaxAbort(connection,async);}};}(window.jQuery,window));(function($,window){var signalR=$.signalR,events=$.signalR.events,changeState=$.signalR.changeState,transportLogic=signalR.transports._logic;signalR.transports.foreverFrame={name:"foreverFrame",supportsKeepAlive:true,timeOut:3000,start:function(connection,onSuccess,onFailed){var that=this,frameId=(transportLogic.foreverFrame.count+=1),url,frame=$("<iframe data-signalr-connection-id='"+connection.id+"' style='position:absolute;top:0;left:0;width:0;height:0;visibility:hidden;' src=''></iframe>");if(window.EventSource){if(onFailed){connection.log("This browser supports SSE, skipping Forever Frame.");onFailed();}return;}url=transportLogic.getUrl(connection,this.name);url+="&frameId="+frameId;$("body").append(frame);frame.prop("src",url);transportLogic.foreverFrame.connections[frameId]=connection;connection.log("Binding to iframe's readystatechange event.");frame.bind("readystatechange",function(){if($.inArray(this.readyState,["loaded","complete"])>=0){connection.log("Forever frame iframe readyState changed to "+this.readyState+", reconnecting");that.reconnect(connection);}});connection.frame=frame[0];connection.frameId=frameId;if(onSuccess){connection.onSuccess=onSuccess;}window.setTimeout(function(){if(connection.onSuccess){connection.log("Failed to connect using forever frame source, it timed out after "+that.timeOut+"ms.");that.stop(connection);if(onFailed){onFailed();}}},that.timeOut);},reconnect:function(connection){var that=this;window.setTimeout(function(){if(connection.frame&&transportLogic.ensureReconnectingState(connection)){var frame=connection.frame,src=transportLogic.getUrl(connection,that.name,true)+"&frameId="+connection.frameId;connection.log("Updating iframe src to '"+src+"'.");frame.src=src;}},connection.reconnectDelay);},lostConnection:function(connection){this.reconnect(connection);},send:function(connection,data){transportLogic.ajaxSend(connection,data);},receive:function(connection,data){var cw;transportLogic.processMessages(connection,data);connection.frameMessageCount=(connection.frameMessageCount||0)+1;if(connection.frameMessageCount>50){connection.frameMessageCount=0;cw=connection.frame.contentWindow||connection.frame.contentDocument;if(cw&&cw.document){$("body",cw.document).empty();}}},stop:function(connection){var cw=null;if(connection.frame){if(connection.frame.stop){connection.frame.stop();}else{try{cw=connection.frame.contentWindow||connection.frame.contentDocument;if(cw.document&&cw.document.execCommand){cw.document.execCommand("Stop");}}catch(e){connection.log("SignalR: Error occured when stopping foreverFrame transport. Message = "+e.message);}}$(connection.frame).remove();delete transportLogic.foreverFrame.connections[connection.frameId];connection.frame=null;connection.frameId=null;delete connection.frame;delete connection.frameId;connection.log("Stopping forever frame");}},abort:function(connection,async){transportLogic.ajaxAbort(connection,async);},getConnection:function(id){return transportLogic.foreverFrame.connections[id];},started:function(connection){if(connection.onSuccess){connection.onSuccess();connection.onSuccess=null;delete connection.onSuccess;}else{if(changeState(connection,signalR.connectionState.reconnecting,signalR.connectionState.connected)===true){$(connection).triggerHandler(events.onReconnect);}}}};}(window.jQuery,window));(function($,window){var signalR=$.signalR,events=$.signalR.events,changeState=$.signalR.changeState,isDisconnecting=$.signalR.isDisconnecting,transportLogic=signalR.transports._logic;signalR.transports.longPolling={name:"longPolling",supportsKeepAlive:false,reconnectDelay:3000,init:function(connection,onComplete){var that=this,pingLoop,pingFail=function(reason){if(isDisconnecting(connection)===false){connection.log("SignalR: Server ping failed because '"+reason+"', re-trying ping.");window.setTimeout(pingLoop,that.reconnectDelay);}};connection.log("SignalR: Initializing long polling connection with server.");pingLoop=function(){transportLogic.pingServer(connection,that.name).done(onComplete).fail(pingFail);};pingLoop();},start:function(connection,onSuccess,onFailed){var that=this,initialConnectedFired=false,fireConnect=function(){if(initialConnectedFired){return;}initialConnectedFired=true;onSuccess();connection.log("Longpolling connected");};if(connection.pollXhr){connection.log("Polling xhr requests already exists, aborting.");connection.stop();}that.init(connection,function(){connection.messageId=null;window.setTimeout(function(){(function poll(instance,raiseReconnect){var messageId=instance.messageId,connect=(messageId===null),reconnecting=!connect,url=transportLogic.getUrl(instance,that.name,reconnecting,raiseReconnect);if(isDisconnecting(instance)===true){return;}connection.log("Attempting to connect to '"+url+"' using longPolling.");instance.pollXhr=$.ajax({url:url,global:false,cache:false,type:"GET",dataType:connection.ajaxDataType,success:function(minData){var delay=0,data;fireConnect();if(minData){data=transportLogic.maximizePersistentResponse(minData);}transportLogic.processMessages(instance,minData);if(data&&$.type(data.LongPollDelay)==="number"){delay=data.LongPollDelay;}if(data&&data.Disconnect){return;}if(isDisconnecting(instance)===true){return;}if(delay>0){window.setTimeout(function(){poll(instance,false);},delay);}else{poll(instance,false);}},error:function(data,textStatus){if(textStatus==="abort"){connection.log("Aborted xhr requst.");return;}if(connection.state!==signalR.connectionState.reconnecting){connection.log("An error occurred using longPolling. Status = "+textStatus+". "+data.responseText);$(instance).triggerHandler(events.onError,[data.responseText]);}transportLogic.ensureReconnectingState(instance);that.init(instance,function(){poll(instance,true);});}});if(reconnecting&&raiseReconnect===true){if(changeState(connection,signalR.connectionState.reconnecting,signalR.connectionState.connected)===true){connection.log("Raising the reconnect event");$(instance).triggerHandler(events.onReconnect);}}}(connection));window.setTimeout(function(){fireConnect();},250);},250);});},lostConnection:function(connection){throw new Error("Lost Connection not handled for LongPolling");},send:function(connection,data){transportLogic.ajaxSend(connection,data);},stop:function(connection){if(connection.pollXhr){connection.pollXhr.abort();connection.pollXhr=null;delete connection.pollXhr;}},abort:function(connection,async){transportLogic.ajaxAbort(connection,async);}};}(window.jQuery,window));(function($,window){var callbackId=0,callbacks={},eventNamespace=".hubProxy";function makeEventName(event){return event+eventNamespace;}if(!Array.prototype.hasOwnProperty("map")){Array.prototype.map=function(fun,thisp){var arr=this,i,length=arr.length,result=[];for(i=0;i<length;i+=1){if(arr.hasOwnProperty(i)){result[i]=fun.call(thisp,arr[i],i,arr);}}return result;};}function getArgValue(a){return $.isFunction(a)?null:($.type(a)==="undefined"?null:a);}function hasMembers(obj){for(var key in obj){if(obj.hasOwnProperty(key)){return true;}}return false;}function hubProxy(hubConnection,hubName){return new hubProxy.fn.init(hubConnection,hubName);}hubProxy.fn=hubProxy.prototype={init:function(connection,hubName){this.state={};this.connection=connection;this.hubName=hubName;this._={callbackMap:{}};},hasSubscriptions:function(){return hasMembers(this._.callbackMap);},on:function(eventName,callback){var self=this,callbackMap=self._.callbackMap;eventName=eventName.toLowerCase();if(!callbackMap[eventName]){callbackMap[eventName]={};}callbackMap[eventName][callback]=function(e,data){callback.apply(self,data);};$(self).bind(makeEventName(eventName),callbackMap[eventName][callback]);return self;},off:function(eventName,callback){var self=this,callbackMap=self._.callbackMap,callbackSpace;eventName=eventName.toLowerCase();callbackSpace=callbackMap[eventName];if(callbackSpace){if(callbackSpace[callback]){$(self).unbind(makeEventName(eventName),callbackSpace[callback]);delete callbackSpace[callback];if(!hasMembers(callbackSpace)){delete callbackMap[eventName];}}else{if(!callback){$(self).unbind(makeEventName(eventName));delete callbackMap[eventName];}}}return self;},invoke:function(methodName){var self=this,args=$.makeArray(arguments).slice(1),argValues=args.map(getArgValue),data={H:self.hubName,M:methodName,A:argValues,I:callbackId},d=$.Deferred(),callback=function(minResult){var result=self._maximizeHubResponse(minResult);$.extend(self.state,result.State);if(result.Error){if(result.StackTrace){self.connection.log(result.Error+"\n"+result.StackTrace);}d.rejectWith(self,[result.Error]);}else{d.resolveWith(self,[result.Result]);}};callbacks[callbackId.toString()]={scope:self,method:callback};callbackId+=1;if(!$.isEmptyObject(self.state)){data.S=self.state;}self.connection.send(window.JSON.stringify(data));return d.promise();},_maximizeHubResponse:function(minHubResponse){return{State:minHubResponse.S,Result:minHubResponse.R,Id:minHubResponse.I,Error:minHubResponse.E,StackTrace:minHubResponse.T};}};hubProxy.fn.init.prototype=hubProxy.fn;function hubConnection(url,options){var settings={qs:null,logging:false,useDefaultPath:true};$.extend(settings,options);if(!url||settings.useDefaultPath){url=(url||"")+"/signalr";}return new hubConnection.fn.init(url,settings);}hubConnection.fn=hubConnection.prototype=$.connection();hubConnection.fn.init=function(url,options){var settings={qs:null,logging:false,useDefaultPath:true},connection=this;$.extend(settings,options);$.signalR.fn.init.call(connection,url,settings.qs,settings.logging);connection.proxies={};connection.received(function(minData){var data,proxy,dataCallbackId,callback,hubName,eventName;if(!minData){return;}if(typeof(minData.I)!=="undefined"){dataCallbackId=minData.I.toString();callback=callbacks[dataCallbackId];if(callback){callbacks[dataCallbackId]=null;delete callbacks[dataCallbackId];callback.method.call(callback.scope,minData);}}else{data=this._maximizeClientHubInvocation(minData);connection.log("Triggering client hub event '"+data.Method+"' on hub '"+data.Hub+"'.");hubName=data.Hub.toLowerCase();eventName=data.Method.toLowerCase();proxy=this.proxies[hubName];$.extend(proxy.state,data.State);$(proxy).triggerHandler(makeEventName(eventName),[data.Args]);}});};hubConnection.fn._maximizeClientHubInvocation=function(minClientHubInvocation){return{Hub:minClientHubInvocation.H,Method:minClientHubInvocation.M,Args:minClientHubInvocation.A,State:minClientHubInvocation.S};};hubConnection.fn._registerSubscribedHubs=function(){if(!this._subscribedToHubs){this._subscribedToHubs=true;this.starting(function(){var subscribedHubs=[];$.each(this.proxies,function(key){if(this.hasSubscriptions()){subscribedHubs.push({name:key});}});this.data=window.JSON.stringify(subscribedHubs);});}};hubConnection.fn.createHubProxy=function(hubName){hubName=hubName.toLowerCase();var proxy=this.proxies[hubName];if(!proxy){proxy=hubProxy(this,hubName);this.proxies[hubName]=proxy;}this._registerSubscribedHubs();return proxy;};hubConnection.fn.init.prototype=hubConnection.fn;$.hubConnection=hubConnection;}(window.jQuery,window));(function($){$.signalR.version="1.0.0.rc1";}(window.jQuery));(function(window,document,navigator,undefined){function m(w){throw w;}var n=void 0,p=!0,s=null,t=!1;function A(w){return function(){return w;};}function E(w){function B(b,c,d){d&&c!==a.k.r(b)&&a.k.S(b,c);c!==a.k.r(b)&&a.a.va(b,"change");}var a="undefined"!==typeof w?w:{};a.b=function(b,c){for(var d=b.split("."),f=a,g=0;g<d.length-1;g++){f=f[d[g]];}f[d[d.length-1]]=c;};a.B=function(a,c,d){a[c]=d;};a.version="2.1.0";a.b("version",a.version);a.a=new function(){function b(b,c){if("input"!==a.a.o(b)||!b.type||"click"!=c.toLowerCase()){return t;}var e=b.type;return"checkbox"==e||"radio"==e;}var c=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,d={},f={};d[/Firefox\/2/i.test(navigator.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"];d.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");for(var g in d){var e=d[g];if(e.length){for(var h=0,j=e.length;h<j;h++){f[e[h]]=g;}}}var k={propertychange:p},i=function(){for(var a=3,b=document.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->",c[0];){}return 4<a?a:n;}();return{Ca:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],v:function(a,b){for(var c=0,e=a.length;c<e;c++){b(a[c]);}},j:function(a,b){if("function"==typeof Array.prototype.indexOf){return Array.prototype.indexOf.call(a,b);}for(var c=0,e=a.length;c<e;c++){if(a[c]===b){return c;}}return -1;},ab:function(a,b,c){for(var e=0,f=a.length;e<f;e++){if(b.call(c,a[e])){return a[e];}}return s;},ba:function(b,c){var e=a.a.j(b,c);0<=e&&b.splice(e,1);},za:function(b){for(var b=b||[],c=[],e=0,f=b.length;e<f;e++){0>a.a.j(c,b[e])&&c.push(b[e]);}return c;},T:function(a,b){for(var a=a||[],c=[],e=0,f=a.length;e<f;e++){c.push(b(a[e]));}return c;},aa:function(a,b){for(var a=a||[],c=[],e=0,f=a.length;e<f;e++){b(a[e])&&c.push(a[e]);}return c;},N:function(a,b){if(b instanceof Array){a.push.apply(a,b);}else{for(var c=0,e=b.length;c<e;c++){a.push(b[c]);}}return a;},extend:function(a,b){if(b){for(var c in b){b.hasOwnProperty(c)&&(a[c]=b[c]);}}return a;},ga:function(b){for(;b.firstChild;){a.removeNode(b.firstChild);}},Ab:function(b){for(var b=a.a.L(b),c=document.createElement("div"),e=0,f=b.length;e<f;e++){a.F(b[e]),c.appendChild(b[e]);}return c;},X:function(b,c){a.a.ga(b);if(c){for(var e=0,f=c.length;e<f;e++){b.appendChild(c[e]);}}},Na:function(b,c){var e=b.nodeType?[b]:b;if(0<e.length){for(var f=e[0],d=f.parentNode,g=0,h=c.length;g<h;g++){d.insertBefore(c[g],f);}g=0;for(h=e.length;g<h;g++){a.removeNode(e[g]);}}},Pa:function(a,b){0<=navigator.userAgent.indexOf("MSIE 6")?a.setAttribute("selected",b):a.selected=b;},w:function(a){return(a||"").replace(c,"");},Ib:function(b,c){for(var e=[],f=(b||"").split(c),g=0,d=f.length;g<d;g++){var h=a.a.w(f[g]);""!==h&&e.push(h);}return e;},Hb:function(a,b){a=a||"";return b.length>a.length?t:a.substring(0,b.length)===b;},eb:function(a,b){for(var c="return ("+a+")",e=0;e<b;e++){c="with(sc["+e+"]) { "+c+" } ";}return new Function("sc",c);},kb:function(a,b){if(b.compareDocumentPosition){return 16==(b.compareDocumentPosition(a)&16);}for(;a!=s;){if(a==b){return p;}a=a.parentNode;}return t;},fa:function(b){return a.a.kb(b,b.ownerDocument);},o:function(a){return a&&a.tagName&&a.tagName.toLowerCase();},n:function(a,c,e){var f=i&&k[c];if(!f&&"undefined"!=typeof jQuery){if(b(a,c)){var g=e,e=function(a,b){var c=this.checked;b&&(this.checked=b.fb!==p);g.call(this,a);this.checked=c;};}jQuery(a).bind(c,e);}else{!f&&"function"==typeof a.addEventListener?a.addEventListener(c,e,t):"undefined"!=typeof a.attachEvent?a.attachEvent("on"+c,function(b){e.call(a,b);}):m(Error("Browser doesn't support addEventListener or attachEvent"));}},va:function(a,c){(!a||!a.nodeType)&&m(Error("element must be a DOM node when calling triggerEvent"));if("undefined"!=typeof jQuery){var e=[];b(a,c)&&e.push({fb:a.checked});jQuery(a).trigger(c,e);}else{"function"==typeof document.createEvent?"function"==typeof a.dispatchEvent?(e=document.createEvent(f[c]||"HTMLEvents"),e.initEvent(c,p,p,window,0,0,0,0,0,t,t,t,t,0,a),a.dispatchEvent(e)):m(Error("The supplied element doesn't support dispatchEvent")):"undefined"!=typeof a.fireEvent?(b(a,c)&&(a.checked=a.checked!==p),a.fireEvent("on"+c)):m(Error("Browser doesn't support triggering events"));}},d:function(b){return a.la(b)?b():b;},Ua:function(b,c,e){var f=(b.className||"").split(/\s+/),g=0<=a.a.j(f,c);if(e&&!g){b.className+=(f[0]?" ":"")+c;}else{if(g&&!e){e="";for(g=0;g<f.length;g++){f[g]!=c&&(e+=f[g]+" ");}b.className=a.a.w(e);}}},Qa:function(b,c){var e=a.a.d(c);if(e===s||e===n){e="";}"innerText" in b?b.innerText=e:b.textContent=e;9<=i&&(b.style.display=b.style.display);},lb:function(a){if(9<=i){var b=a.style.width;a.style.width=0;a.style.width=b;}},Eb:function(b,e){for(var b=a.a.d(b),e=a.a.d(e),c=[],f=b;f<=e;f++){c.push(f);}return c;},L:function(a){for(var b=[],e=0,c=a.length;e<c;e++){b.push(a[e]);}return b;},tb:6===i,ub:7===i,ja:i,Da:function(b,e){for(var c=a.a.L(b.getElementsByTagName("input")).concat(a.a.L(b.getElementsByTagName("textarea"))),f="string"==typeof e?function(a){return a.name===e;}:function(a){return e.test(a.name);},g=[],d=c.length-1;0<=d;d--){f(c[d])&&g.push(c[d]);}return g;},Bb:function(b){return"string"==typeof b&&(b=a.a.w(b))?window.JSON&&window.JSON.parse?window.JSON.parse(b):(new Function("return "+b))():s;},sa:function(b,e,c){("undefined"==typeof JSON||"undefined"==typeof JSON.stringify)&&m(Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js"));return JSON.stringify(a.a.d(b),e,c);},Cb:function(b,e,c){var c=c||{},f=c.params||{},g=c.includeFields||this.Ca,d=b;if("object"==typeof b&&"form"===a.a.o(b)){for(var d=b.action,h=g.length-1;0<=h;h--){for(var k=a.a.Da(b,g[h]),j=k.length-1;0<=j;j--){f[k[j].name]=k[j].value;}}}var e=a.a.d(e),i=document.createElement("form");i.style.display="none";i.action=d;i.method="post";for(var z in e){b=document.createElement("input"),b.name=z,b.value=a.a.sa(a.a.d(e[z])),i.appendChild(b);}for(z in f){b=document.createElement("input"),b.name=z,b.value=f[z],i.appendChild(b);}document.body.appendChild(i);c.submitter?c.submitter(i):i.submit();setTimeout(function(){i.parentNode.removeChild(i);},0);}};};a.b("utils",a.a);a.b("utils.arrayForEach",a.a.v);a.b("utils.arrayFirst",a.a.ab);a.b("utils.arrayFilter",a.a.aa);a.b("utils.arrayGetDistinctValues",a.a.za);a.b("utils.arrayIndexOf",a.a.j);a.b("utils.arrayMap",a.a.T);a.b("utils.arrayPushAll",a.a.N);a.b("utils.arrayRemoveItem",a.a.ba);a.b("utils.extend",a.a.extend);a.b("utils.fieldsIncludedWithJsonPost",a.a.Ca);a.b("utils.getFormFields",a.a.Da);a.b("utils.postJson",a.a.Cb);a.b("utils.parseJson",a.a.Bb);a.b("utils.registerEventHandler",a.a.n);a.b("utils.stringifyJson",a.a.sa);a.b("utils.range",a.a.Eb);a.b("utils.toggleDomNodeCssClass",a.a.Ua);a.b("utils.triggerEvent",a.a.va);a.b("utils.unwrapObservable",a.a.d);Function.prototype.bind||(Function.prototype.bind=function(a){var c=this,d=Array.prototype.slice.call(arguments),a=d.shift();return function(){return c.apply(a,d.concat(Array.prototype.slice.call(arguments)));};});a.a.f=new function(){var b=0,c="__ko__"+(new Date).getTime(),d={};return{get:function(b,c){var e=a.a.f.getAll(b,t);return e===n?n:e[c];},set:function(b,c,e){e===n&&a.a.f.getAll(b,t)===n||(a.a.f.getAll(b,p)[c]=e);},getAll:function(a,g){var e=a[c];if(!(e&&"null"!==e)){if(!g){return;}e=a[c]="ko"+b++;d[e]={};}return d[e];},clear:function(a){var b=a[c];b&&(delete d[b],a[c]=s);}};};a.b("utils.domData",a.a.f);a.b("utils.domData.clear",a.a.f.clear);a.a.G=new function(){function b(b,c){var f=a.a.f.get(b,d);f===n&&c&&(f=[],a.a.f.set(b,d,f));return f;}function c(e){var f=b(e,t);if(f){for(var f=f.slice(0),d=0;d<f.length;d++){f[d](e);}}a.a.f.clear(e);"function"==typeof jQuery&&"function"==typeof jQuery.cleanData&&jQuery.cleanData([e]);if(g[e.nodeType]){for(f=e.firstChild;e=f;){f=e.nextSibling,8===e.nodeType&&c(e);}}}var d="__ko_domNodeDisposal__"+(new Date).getTime(),f={1:p,8:p,9:p},g={1:p,9:p};return{wa:function(a,c){"function"!=typeof c&&m(Error("Callback must be a function"));b(a,p).push(c);},Ma:function(c,f){var g=b(c,t);g&&(a.a.ba(g,f),0==g.length&&a.a.f.set(c,d,n));},F:function(b){if(f[b.nodeType]&&(c(b),g[b.nodeType])){var d=[];a.a.N(d,b.getElementsByTagName("*"));for(var b=0,j=d.length;b<j;b++){c(d[b]);}}},removeNode:function(b){a.F(b);b.parentNode&&b.parentNode.removeChild(b);}};};a.F=a.a.G.F;a.removeNode=a.a.G.removeNode;a.b("cleanNode",a.F);a.b("removeNode",a.removeNode);a.b("utils.domNodeDisposal",a.a.G);a.b("utils.domNodeDisposal.addDisposeCallback",a.a.G.wa);a.b("utils.domNodeDisposal.removeDisposeCallback",a.a.G.Ma);(function(){a.a.pa=function(b){var c;if("undefined"!=typeof jQuery){if((c=jQuery.clean([b]))&&c[0]){for(b=c[0];b.parentNode&&11!==b.parentNode.nodeType;){b=b.parentNode;}b.parentNode&&b.parentNode.removeChild(b);}}else{var d=a.a.w(b).toLowerCase();c=document.createElement("div");d=d.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!d.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!d.indexOf("<td")||!d.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""];b="ignored<div>"+d[1]+b+d[2]+"</div>";for("function"==typeof window.innerShiv?c.appendChild(window.innerShiv(b)):c.innerHTML=b;d[0]--;){c=c.lastChild;}c=a.a.L(c.lastChild.childNodes);}return c;};a.a.Y=function(b,c){a.a.ga(b);if(c!==s&&c!==n){if("string"!=typeof c&&(c=c.toString()),"undefined"!=typeof jQuery){jQuery(b).html(c);}else{for(var d=a.a.pa(c),f=0;f<d.length;f++){b.appendChild(d[f]);}}}};})();a.b("utils.parseHtmlFragment",a.a.pa);a.b("utils.setHtml",a.a.Y);a.s=function(){function b(){return(4294967296*(1+Math.random())|0).toString(16).substring(1);}function c(b,g){if(b){if(8==b.nodeType){var e=a.s.Ja(b.nodeValue);e!=s&&g.push({jb:b,yb:e});}else{if(1==b.nodeType){for(var e=0,d=b.childNodes,j=d.length;e<j;e++){c(d[e],g);}}}}}var d={};return{na:function(a){"function"!=typeof a&&m(Error("You can only pass a function to ko.memoization.memoize()"));var c=b()+b();d[c]=a;return"<!--[ko_memo:"+c+"]-->";},Va:function(a,b){var c=d[a];c===n&&m(Error("Couldn't find any memo with ID "+a+". Perhaps it's already been unmemoized."));try{return c.apply(s,b||[]),p;}finally{delete d[a];}},Wa:function(b,d){var e=[];c(b,e);for(var h=0,j=e.length;h<j;h++){var k=e[h].jb,i=[k];d&&a.a.N(i,d);a.s.Va(e[h].yb,i);k.nodeValue="";k.parentNode&&k.parentNode.removeChild(k);}},Ja:function(a){return(a=a.match(/^\[ko_memo\:(.*?)\]$/))?a[1]:s;}};}();a.b("memoization",a.s);a.b("memoization.memoize",a.s.na);a.b("memoization.unmemoize",a.s.Va);a.b("memoization.parseMemoText",a.s.Ja);a.b("memoization.unmemoizeDomNodeAndDescendants",a.s.Wa);a.Ba={throttle:function(b,c){b.throttleEvaluation=c;var d=s;return a.h({read:b,write:function(a){clearTimeout(d);d=setTimeout(function(){b(a);},c);}});},notify:function(b,c){b.equalityComparer="always"==c?A(t):a.m.fn.equalityComparer;return b;}};a.b("extenders",a.Ba);a.Sa=function(b,c,d){this.target=b;this.ca=c;this.ib=d;a.B(this,"dispose",this.A);};a.Sa.prototype.A=function(){this.sb=p;this.ib();};a.R=function(){this.u={};a.a.extend(this,a.R.fn);a.B(this,"subscribe",this.ta);a.B(this,"extend",this.extend);a.B(this,"getSubscriptionsCount",this.ob);};a.R.fn={ta:function(b,c,d){var d=d||"change",b=c?b.bind(c):b,f=new a.Sa(this,b,function(){a.a.ba(this.u[d],f);}.bind(this));this.u[d]||(this.u[d]=[]);this.u[d].push(f);return f;},notifySubscribers:function(b,c){c=c||"change";this.u[c]&&a.a.v(this.u[c].slice(0),function(a){a&&a.sb!==p&&a.ca(b);});},ob:function(){var a=0,c;for(c in this.u){this.u.hasOwnProperty(c)&&(a+=this.u[c].length);}return a;},extend:function(b){var c=this;if(b){for(var d in b){var f=a.Ba[d];"function"==typeof f&&(c=f(c,b[d]));}}return c;}};a.Ga=function(a){return"function"==typeof a.ta&&"function"==typeof a.notifySubscribers;};a.b("subscribable",a.R);a.b("isSubscribable",a.Ga);a.U=function(){var b=[];return{bb:function(a){b.push({ca:a,Aa:[]});},end:function(){b.pop();},La:function(c){a.Ga(c)||m(Error("Only subscribable things can act as dependencies"));if(0<b.length){var d=b[b.length-1];0<=a.a.j(d.Aa,c)||(d.Aa.push(c),d.ca(c));}}};}();var G={undefined:p,"boolean":p,number:p,string:p};a.m=function(b){function c(){if(0<arguments.length){if(!c.equalityComparer||!c.equalityComparer(d,arguments[0])){c.I(),d=arguments[0],c.H();}return this;}a.U.La(c);return d;}var d=b;a.R.call(c);c.H=function(){c.notifySubscribers(d);};c.I=function(){c.notifySubscribers(d,"beforeChange");};a.a.extend(c,a.m.fn);a.B(c,"valueHasMutated",c.H);a.B(c,"valueWillMutate",c.I);return c;};a.m.fn={equalityComparer:function(a,c){return a===s||typeof a in G?a===c:t;}};var x=a.m.Db="__ko_proto__";a.m.fn[x]=a.m;a.ia=function(b,c){return b===s||b===n||b[x]===n?t:b[x]===c?p:a.ia(b[x],c);};a.la=function(b){return a.ia(b,a.m);};a.Ha=function(b){return"function"==typeof b&&b[x]===a.m||"function"==typeof b&&b[x]===a.h&&b.pb?p:t;};a.b("observable",a.m);a.b("isObservable",a.la);a.b("isWriteableObservable",a.Ha);a.Q=function(b){0==arguments.length&&(b=[]);b!==s&&(b!==n&&!("length" in b))&&m(Error("The argument passed when initializing an observable array must be an array, or null, or undefined."));var c=a.m(b);a.a.extend(c,a.Q.fn);return c;};a.Q.fn={remove:function(a){for(var c=this(),d=[],f="function"==typeof a?a:function(c){return c===a;},g=0;g<c.length;g++){var e=c[g];f(e)&&(0===d.length&&this.I(),d.push(e),c.splice(g,1),g--);}d.length&&this.H();return d;},removeAll:function(b){if(b===n){var c=this(),d=c.slice(0);this.I();c.splice(0,c.length);this.H();return d;}return !b?[]:this.remove(function(c){return 0<=a.a.j(b,c);});},destroy:function(a){var c=this(),d="function"==typeof a?a:function(c){return c===a;};this.I();for(var f=c.length-1;0<=f;f--){d(c[f])&&(c[f]._destroy=p);}this.H();},destroyAll:function(b){return b===n?this.destroy(A(p)):!b?[]:this.destroy(function(c){return 0<=a.a.j(b,c);});},indexOf:function(b){var c=this();return a.a.j(c,b);},replace:function(a,c){var d=this.indexOf(a);0<=d&&(this.I(),this()[d]=c,this.H());}};a.a.v("pop push reverse shift sort splice unshift".split(" "),function(b){a.Q.fn[b]=function(){var a=this();this.I();a=a[b].apply(a,arguments);this.H();return a;};});a.a.v(["slice"],function(b){a.Q.fn[b]=function(){var a=this();return a[b].apply(a,arguments);};});a.b("observableArray",a.Q);a.h=function(b,c,d){function f(){a.a.v(v,function(a){a.A();});v=[];}function g(){var a=h.throttleEvaluation;a&&0<=a?(clearTimeout(x),x=setTimeout(e,a)):e();}function e(){if(!l){if(i&&w()){u();}else{l=p;try{var b=a.a.T(v,function(a){return a.target;});a.U.bb(function(c){var e;0<=(e=a.a.j(b,c))?b[e]=n:v.push(c.ta(g));});for(var e=q.call(c),f=b.length-1;0<=f;f--){b[f]&&v.splice(f,1)[0].A();}i=p;h.notifySubscribers(k,"beforeChange");k=e;}finally{a.U.end();}h.notifySubscribers(k);l=t;}}}function h(){if(0<arguments.length){j.apply(h,arguments);}else{return i||e(),a.U.La(h),k;}}function j(){"function"===typeof o?o.apply(c,arguments):m(Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters."));}var k,i=t,l=t,q=b;q&&"object"==typeof q?(d=q,q=d.read):(d=d||{},q||(q=d.read));"function"!=typeof q&&m(Error("Pass a function that returns the value of the ko.computed"));var o=d.write;c||(c=d.owner);var v=[],u=f,r="object"==typeof d.disposeWhenNodeIsRemoved?d.disposeWhenNodeIsRemoved:s,w=d.disposeWhen||A(t);if(r){u=function(){a.a.G.Ma(r,arguments.callee);f();};a.a.G.wa(r,u);var y=w,w=function(){return !a.a.fa(r)||y();};}var x=s;h.nb=function(){return v.length;};h.pb="function"===typeof d.write;h.A=function(){u();};a.R.call(h);a.a.extend(h,a.h.fn);d.deferEvaluation!==p&&e();a.B(h,"dispose",h.A);a.B(h,"getDependenciesCount",h.nb);return h;};a.rb=function(b){return a.ia(b,a.h);};w=a.m.Db;a.h[w]=a.m;a.h.fn={};a.h.fn[w]=a.h;a.b("dependentObservable",a.h);a.b("computed",a.h);a.b("isComputed",a.rb);(function(){function b(a,g,e){e=e||new d;a=g(a);if(!("object"==typeof a&&a!==s&&a!==n&&!(a instanceof Date))){return a;}var h=a instanceof Array?[]:{};e.save(a,h);c(a,function(c){var d=g(a[c]);switch(typeof d){case"boolean":case"number":case"string":case"function":h[c]=d;break;case"object":case"undefined":var i=e.get(d);h[c]=i!==n?i:b(d,g,e);}});return h;}function c(a,b){if(a instanceof Array){for(var c=0;c<a.length;c++){b(c);}"function"==typeof a.toJSON&&b("toJSON");}else{for(c in a){b(c);}}}function d(){var b=[],c=[];this.save=function(e,d){var j=a.a.j(b,e);0<=j?c[j]=d:(b.push(e),c.push(d));};this.get=function(e){e=a.a.j(b,e);return 0<=e?c[e]:n;};}a.Ta=function(c){0==arguments.length&&m(Error("When calling ko.toJS, pass the object you want to convert."));return b(c,function(b){for(var c=0;a.la(b)&&10>c;c++){b=b();}return b;});};a.toJSON=function(b,c,e){b=a.Ta(b);return a.a.sa(b,c,e);};})();a.b("toJS",a.Ta);a.b("toJSON",a.toJSON);(function(){a.k={r:function(b){switch(a.a.o(b)){case"option":return b.__ko__hasDomDataOptionValue__===p?a.a.f.get(b,a.c.options.oa):b.getAttribute("value");case"select":return 0<=b.selectedIndex?a.k.r(b.options[b.selectedIndex]):n;default:return b.value;}},S:function(b,c){switch(a.a.o(b)){case"option":switch(typeof c){case"string":a.a.f.set(b,a.c.options.oa,n);"__ko__hasDomDataOptionValue__" in b&&delete b.__ko__hasDomDataOptionValue__;b.value=c;break;default:a.a.f.set(b,a.c.options.oa,c),b.__ko__hasDomDataOptionValue__=p,b.value="number"===typeof c?c:"";}break;case"select":for(var d=b.options.length-1;0<=d;d--){if(a.k.r(b.options[d])==c){b.selectedIndex=d;break;}}break;default:if(c===s||c===n){c="";}b.value=c;}}};})();a.b("selectExtensions",a.k);a.b("selectExtensions.readValue",a.k.r);a.b("selectExtensions.writeValue",a.k.S);a.g=function(){function b(a,b){for(var d=s;a!=d;){d=a,a=a.replace(c,function(a,c){return b[c];});}return a;}var c=/\@ko_token_(\d+)\@/g,d=/^[\_$a-z][\_$a-z0-9]*(\[.*?\])*(\.[\_$a-z][\_$a-z0-9]*(\[.*?\])*)*$/i,f=["true","false"];return{D:[],W:function(c){var e=a.a.w(c);if(3>e.length){return[];}"{"===e.charAt(0)&&(e=e.substring(1,e.length-1));for(var c=[],d=s,f,k=0;k<e.length;k++){var i=e.charAt(k);if(d===s){switch(i){case'"':case"'":case"/":d=k,f=i;}}else{if(i==f&&"\\"!==e.charAt(k-1)){i=e.substring(d,k+1);c.push(i);var l="@ko_token_"+(c.length-1)+"@",e=e.substring(0,d)+l+e.substring(k+1),k=k-(i.length-l.length),d=s;}}}f=d=s;for(var q=0,o=s,k=0;k<e.length;k++){i=e.charAt(k);if(d===s){switch(i){case"{":d=k;o=i;f="}";break;case"(":d=k;o=i;f=")";break;case"[":d=k,o=i,f="]";}}i===o?q++:i===f&&(q--,0===q&&(i=e.substring(d,k+1),c.push(i),l="@ko_token_"+(c.length-1)+"@",e=e.substring(0,d)+l+e.substring(k+1),k-=i.length-l.length,d=s));}f=[];e=e.split(",");d=0;for(k=e.length;d<k;d++){q=e[d],o=q.indexOf(":"),0<o&&o<q.length-1?(i=q.substring(o+1),f.push({key:b(q.substring(0,o),c),value:b(i,c)})):f.push({unknown:b(q,c)});}return f;},ka:function(b){for(var c="string"===typeof b?a.g.W(b):b,h=[],b=[],j,k=0;j=c[k];k++){if(0<h.length&&h.push(","),j.key){var i;a:{i=j.key;var l=a.a.w(i);switch(l.length&&l.charAt(0)){case"'":case'"':break a;default:i="'"+l+"'";}}j=j.value;h.push(i);h.push(":");h.push(j);l=a.a.w(j);if(0<=a.a.j(f,a.a.w(l).toLowerCase())?0:l.match(d)!==s){0<b.length&&b.push(", "),b.push(i+" : function(__ko_value) { "+j+" = __ko_value; }");}}else{j.unknown&&h.push(j.unknown);}}c=h.join("");0<b.length&&(c=c+", '_ko_property_writers' : { "+b.join("")+" } ");return c;},wb:function(b,c){for(var d=0;d<b.length;d++){if(a.a.w(b[d].key)==c){return p;}}return t;},$:function(b,c,d,f,k){if(!b||!a.Ha(b)){if((b=c()._ko_property_writers)&&b[d]){b[d](f);}}else{(!k||b()!==f)&&b(f);}}};}();a.b("jsonExpressionRewriting",a.g);a.b("jsonExpressionRewriting.bindingRewriteValidators",a.g.D);a.b("jsonExpressionRewriting.parseObjectLiteral",a.g.W);a.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",a.g.ka);(function(){function b(a){return 8==a.nodeType&&(g?a.text:a.nodeValue).match(e);}function c(a){return 8==a.nodeType&&(g?a.text:a.nodeValue).match(h);}function d(a,e){for(var d=a,f=1,g=[];d=d.nextSibling;){if(c(d)&&(f--,0===f)){return g;}g.push(d);b(d)&&f++;}e||m(Error("Cannot find closing comment tag to match: "+a.nodeValue));return s;}function f(a,b){var c=d(a,b);return c?0<c.length?c[c.length-1].nextSibling:a.nextSibling:s;}var g="<!--test-->"===document.createComment("test").text,e=g?/^<\!--\s*ko\s+(.*\:.*)\s*--\>$/:/^\s*ko\s+(.*\:.*)\s*$/,h=g?/^<\!--\s*\/ko\s*--\>$/:/^\s*\/ko\s*$/,j={ul:p,ol:p};a.e={C:{},childNodes:function(a){return b(a)?d(a):a.childNodes;},ha:function(c){if(b(c)){for(var c=a.e.childNodes(c),e=0,d=c.length;e<d;e++){a.removeNode(c[e]);}}else{a.a.ga(c);}},X:function(c,e){if(b(c)){a.e.ha(c);for(var d=c.nextSibling,f=0,g=e.length;f<g;f++){d.parentNode.insertBefore(e[f],d);}}else{a.a.X(c,e);}},Ka:function(a,c){b(a)?a.parentNode.insertBefore(c,a.nextSibling):a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c);},Fa:function(a,c,e){b(a)?a.parentNode.insertBefore(c,e.nextSibling):e.nextSibling?a.insertBefore(c,e.nextSibling):a.appendChild(c);},firstChild:function(a){return !b(a)?a.firstChild:!a.nextSibling||c(a.nextSibling)?s:a.nextSibling;},nextSibling:function(a){b(a)&&(a=f(a));return a.nextSibling&&c(a.nextSibling)?s:a.nextSibling;},Xa:function(a){return(a=b(a))?a[1]:s;},Ia:function(e){if(j[a.a.o(e)]){var d=e.firstChild;if(d){do{if(1===d.nodeType){var g;g=d.firstChild;var h=s;if(g){do{if(h){h.push(g);}else{if(b(g)){var o=f(g,p);o?g=o:h=[g];}else{c(g)&&(h=[g]);}}}while(g=g.nextSibling);}if(g=h){h=d.nextSibling;for(o=0;o<g.length;o++){h?e.insertBefore(g[o],h):e.appendChild(g[o]);}}}}while(d=d.nextSibling);}}}};})();a.b("virtualElements",a.e);a.b("virtualElements.allowedBindings",a.e.C);a.b("virtualElements.emptyNode",a.e.ha);a.b("virtualElements.insertAfter",a.e.Fa);a.b("virtualElements.prepend",a.e.Ka);a.b("virtualElements.setDomNodeChildren",a.e.X);(function(){a.J=function(){this.cb={};};a.a.extend(a.J.prototype,{nodeHasBindings:function(b){switch(b.nodeType){case 1:return b.getAttribute("data-bind")!=s;case 8:return a.e.Xa(b)!=s;default:return t;}},getBindings:function(a,c){var d=this.getBindingsString(a,c);return d?this.parseBindingsString(d,c):s;},getBindingsString:function(b){switch(b.nodeType){case 1:return b.getAttribute("data-bind");case 8:return a.e.Xa(b);default:return s;}},parseBindingsString:function(b,c){try{var d=c.$data,d="object"==typeof d&&d!=s?[d,c]:[c],f=d.length,g=this.cb,e=f+"_"+b,h;if(!(h=g[e])){var j=" { "+a.g.ka(b)+" } ";h=g[e]=a.a.eb(j,f);}return h(d);}catch(k){m(Error("Unable to parse bindings.\nMessage: "+k+";\nBindings value: "+b));}}});a.J.instance=new a.J;})();a.b("bindingProvider",a.J);(function(){function b(b,d,e){for(var h=a.e.firstChild(d);d=h;){h=a.e.nextSibling(d),c(b,d,e);}}function c(c,g,e){var h=p,j=1===g.nodeType;j&&a.e.Ia(g);if(j&&e||a.J.instance.nodeHasBindings(g)){h=d(g,s,c,e).Gb;}h&&b(c,g,!j);}function d(b,c,e,d){function j(a){return function(){return l[a];};}function k(){return l;}var i=0,l,q;a.h(function(){var o=e&&e instanceof a.z?e:new a.z(a.a.d(e)),v=o.$data;d&&a.Ra(b,o);if(l=("function"==typeof c?c():c)||a.J.instance.getBindings(b,o)){if(0===i){i=1;for(var u in l){var r=a.c[u];r&&8===b.nodeType&&!a.e.C[u]&&m(Error("The binding '"+u+"' cannot be used with virtual elements"));if(r&&"function"==typeof r.init&&(r=(0,r.init)(b,j(u),k,v,o))&&r.controlsDescendantBindings){q!==n&&m(Error("Multiple bindings ("+q+" and "+u+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.")),q=u;}}i=2;}if(2===i){for(u in l){(r=a.c[u])&&"function"==typeof r.update&&(0,r.update)(b,j(u),k,v,o);}}}},s,{disposeWhenNodeIsRemoved:b});return{Gb:q===n};}a.c={};a.z=function(b,c){c?(a.a.extend(this,c),this.$parentContext=c,this.$parent=c.$data,this.$parents=(c.$parents||[]).slice(0),this.$parents.unshift(this.$parent)):(this.$parents=[],this.$root=b);this.$data=b;};a.z.prototype.createChildContext=function(b){return new a.z(b,this);};a.z.prototype.extend=function(b){var c=a.a.extend(new a.z,this);return a.a.extend(c,b);};a.Ra=function(b,c){if(2==arguments.length){a.a.f.set(b,"__ko_bindingContext__",c);}else{return a.a.f.get(b,"__ko_bindingContext__");}};a.ya=function(b,c,e){1===b.nodeType&&a.e.Ia(b);return d(b,c,e,p);};a.Ya=function(a,c){(1===c.nodeType||8===c.nodeType)&&b(a,c,p);};a.xa=function(a,b){b&&(1!==b.nodeType&&8!==b.nodeType)&&m(Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node"));b=b||window.document.body;c(a,b,p);};a.ea=function(b){switch(b.nodeType){case 1:case 8:var c=a.Ra(b);if(c){return c;}if(b.parentNode){return a.ea(b.parentNode);}}};a.hb=function(b){return(b=a.ea(b))?b.$data:n;};a.b("bindingHandlers",a.c);a.b("applyBindings",a.xa);a.b("applyBindingsToDescendants",a.Ya);a.b("applyBindingsToNode",a.ya);a.b("contextFor",a.ea);a.b("dataFor",a.hb);})();a.a.v(["click"],function(b){a.c[b]={init:function(c,d,f,g){return a.c.event.init.call(this,c,function(){var a={};a[b]=d();return a;},f,g);}};});a.c.event={init:function(b,c,d,f){var g=c()||{},e;for(e in g){(function(){var g=e;"string"==typeof g&&a.a.n(b,g,function(b){var e,i=c()[g];if(i){var l=d();try{var q=a.a.L(arguments);q.unshift(f);e=i.apply(f,q);}finally{e!==p&&(b.preventDefault?b.preventDefault():b.returnValue=t);}l[g+"Bubble"]===t&&(b.cancelBubble=p,b.stopPropagation&&b.stopPropagation());}});})();}}};a.c.submit={init:function(b,c,d,f){"function"!=typeof c()&&m(Error("The value for a submit binding must be a function"));a.a.n(b,"submit",function(a){var e,d=c();try{e=d.call(f,b);}finally{e!==p&&(a.preventDefault?a.preventDefault():a.returnValue=t);}});}};a.c.visible={update:function(b,c){var d=a.a.d(c()),f="none"!=b.style.display;d&&!f?b.style.display="":!d&&f&&(b.style.display="none");}};a.c.enable={update:function(b,c){var d=a.a.d(c());d&&b.disabled?b.removeAttribute("disabled"):!d&&!b.disabled&&(b.disabled=p);}};a.c.disable={update:function(b,c){a.c.enable.update(b,function(){return !a.a.d(c());});}};a.c.value={init:function(b,c,d){function f(){var e=c(),f=a.k.r(b);a.g.$(e,d,"value",f,p);}var g=["change"],e=d().valueUpdate;e&&("string"==typeof e&&(e=[e]),a.a.N(g,e),g=a.a.za(g));if(a.a.ja&&("input"==b.tagName.toLowerCase()&&"text"==b.type&&"off"!=b.autocomplete&&(!b.form||"off"!=b.form.autocomplete))&&-1==a.a.j(g,"propertychange")){var h=t;a.a.n(b,"propertychange",function(){h=p;});a.a.n(b,"blur",function(){if(h){h=t;f();}});}a.a.v(g,function(c){var e=f;if(a.a.Hb(c,"after")){e=function(){setTimeout(f,0);};c=c.substring(5);}a.a.n(b,c,e);});},update:function(b,c){var d="select"===a.a.o(b),f=a.a.d(c()),g=a.k.r(b),e=f!=g;0===f&&(0!==g&&"0"!==g)&&(e=p);e&&(g=function(){a.k.S(b,f);},g(),d&&setTimeout(g,0));d&&0<b.length&&B(b,f,t);}};a.c.options={update:function(b,c,d){"select"!==a.a.o(b)&&m(Error("options binding applies only to SELECT elements"));for(var f=0==b.length,g=a.a.T(a.a.aa(b.childNodes,function(b){return b.tagName&&"option"===a.a.o(b)&&b.selected;}),function(b){return a.k.r(b)||b.innerText||b.textContent;}),e=b.scrollTop,h=a.a.d(c());0<b.length;){a.F(b.options[0]),b.remove(0);}if(h){d=d();"number"!=typeof h.length&&(h=[h]);if(d.optionsCaption){var j=document.createElement("option");a.a.Y(j,d.optionsCaption);a.k.S(j,n);b.appendChild(j);}for(var c=0,k=h.length;c<k;c++){var j=document.createElement("option"),i="string"==typeof d.optionsValue?h[c][d.optionsValue]:h[c],i=a.a.d(i);a.k.S(j,i);var l=d.optionsText,i="function"==typeof l?l(h[c]):"string"==typeof l?h[c][l]:i;if(i===s||i===n){i="";}a.a.Qa(j,i);b.appendChild(j);}h=b.getElementsByTagName("option");c=j=0;for(k=h.length;c<k;c++){0<=a.a.j(g,a.k.r(h[c]))&&(a.a.Pa(h[c],p),j++);}b.scrollTop=e;f&&"value" in d&&B(b,a.a.d(d.value),p);a.a.lb(b);}}};a.c.options.oa="__ko.optionValueDomData__";a.c.selectedOptions={Ea:function(b){for(var c=[],b=b.childNodes,d=0,f=b.length;d<f;d++){var g=b[d],e=a.a.o(g);"option"==e&&g.selected?c.push(a.k.r(g)):"optgroup"==e&&(g=a.c.selectedOptions.Ea(g),Array.prototype.splice.apply(c,[c.length,0].concat(g)));}return c;},init:function(b,c,d){a.a.n(b,"change",function(){var b=c(),g=a.c.selectedOptions.Ea(this);a.g.$(b,d,"value",g);});},update:function(b,c){"select"!=a.a.o(b)&&m(Error("values binding applies only to SELECT elements"));var d=a.a.d(c());if(d&&"number"==typeof d.length){for(var f=b.childNodes,g=0,e=f.length;g<e;g++){var h=f[g];"option"===a.a.o(h)&&a.a.Pa(h,0<=a.a.j(d,a.k.r(h)));}}}};a.c.text={update:function(b,c){a.a.Qa(b,c());}};a.c.html={init:function(){return{controlsDescendantBindings:p};},update:function(b,c){var d=a.a.d(c());a.a.Y(b,d);}};a.c.css={update:function(b,c){var d=a.a.d(c()||{}),f;for(f in d){if("string"==typeof f){var g=a.a.d(d[f]);a.a.Ua(b,f,g);}}}};a.c.style={update:function(b,c){var d=a.a.d(c()||{}),f;for(f in d){if("string"==typeof f){var g=a.a.d(d[f]);b.style[f]=g||"";}}}};a.c.uniqueName={init:function(b,c){c()&&(b.name="ko_unique_"+ ++a.c.uniqueName.gb,(a.a.tb||a.a.ub)&&b.mergeAttributes(document.createElement("<input name='"+b.name+"'/>"),t));}};a.c.uniqueName.gb=0;a.c.checked={init:function(b,c,d){a.a.n(b,"click",function(){var f;if("checkbox"==b.type){f=b.checked;}else{if("radio"==b.type&&b.checked){f=b.value;}else{return;}}var g=c();"checkbox"==b.type&&a.a.d(g) instanceof Array?(f=a.a.j(a.a.d(g),b.value),b.checked&&0>f?g.push(b.value):!b.checked&&0<=f&&g.splice(f,1)):a.g.$(g,d,"checked",f,p);});"radio"==b.type&&!b.name&&a.c.uniqueName.init(b,A(p));},update:function(b,c){var d=a.a.d(c());"checkbox"==b.type?b.checked=d instanceof Array?0<=a.a.j(d,b.value):d:"radio"==b.type&&(b.checked=b.value==d);}};var F={"class":"className","for":"htmlFor"};a.c.attr={update:function(b,c){var d=a.a.d(c())||{},f;for(f in d){if("string"==typeof f){var g=a.a.d(d[f]),e=g===t||g===s||g===n;e&&b.removeAttribute(f);8>=a.a.ja&&f in F?(f=F[f],e?b.removeAttribute(f):b[f]=g):e||b.setAttribute(f,g.toString());}}}};a.c.hasfocus={init:function(b,c,d){function f(b){var e=c();a.g.$(e,d,"hasfocus",b,p);}a.a.n(b,"focus",function(){f(p);});a.a.n(b,"focusin",function(){f(p);});a.a.n(b,"blur",function(){f(t);});a.a.n(b,"focusout",function(){f(t);});},update:function(b,c){var d=a.a.d(c());d?b.focus():b.blur();a.a.va(b,d?"focusin":"focusout");}};a.c["with"]={p:function(b){return function(){var c=b();return{"if":c,data:c,templateEngine:a.q.K};};},init:function(b,c){return a.c.template.init(b,a.c["with"].p(c));},update:function(b,c,d,f,g){return a.c.template.update(b,a.c["with"].p(c),d,f,g);}};a.g.D["with"]=t;a.e.C["with"]=p;a.c["if"]={p:function(b){return function(){return{"if":b(),templateEngine:a.q.K};};},init:function(b,c){return a.c.template.init(b,a.c["if"].p(c));},update:function(b,c,d,f,g){return a.c.template.update(b,a.c["if"].p(c),d,f,g);}};a.g.D["if"]=t;a.e.C["if"]=p;a.c.ifnot={p:function(b){return function(){return{ifnot:b(),templateEngine:a.q.K};};},init:function(b,c){return a.c.template.init(b,a.c.ifnot.p(c));},update:function(b,c,d,f,g){return a.c.template.update(b,a.c.ifnot.p(c),d,f,g);}};a.g.D.ifnot=t;a.e.C.ifnot=p;a.c.foreach={p:function(b){return function(){var c=a.a.d(b());return !c||"number"==typeof c.length?{foreach:c,templateEngine:a.q.K}:{foreach:c.data,includeDestroyed:c.includeDestroyed,afterAdd:c.afterAdd,beforeRemove:c.beforeRemove,afterRender:c.afterRender,templateEngine:a.q.K};};},init:function(b,c){return a.c.template.init(b,a.c.foreach.p(c));},update:function(b,c,d,f,g){return a.c.template.update(b,a.c.foreach.p(c),d,f,g);}};a.g.D.foreach=t;a.e.C.foreach=p;a.t=function(){};a.t.prototype.renderTemplateSource=function(){m(Error("Override renderTemplateSource"));};a.t.prototype.createJavaScriptEvaluatorBlock=function(){m(Error("Override createJavaScriptEvaluatorBlock"));};a.t.prototype.makeTemplateSource=function(b,c){if("string"==typeof b){var c=c||document,d=c.getElementById(b);d||m(Error("Cannot find template with ID "+b));return new a.l.i(d);}if(1==b.nodeType||8==b.nodeType){return new a.l.M(b);}m(Error("Unknown template type: "+b));};a.t.prototype.renderTemplate=function(a,c,d,f){return this.renderTemplateSource(this.makeTemplateSource(a,f),c,d);};a.t.prototype.isTemplateRewritten=function(a,c){return this.allowTemplateRewriting===t||!(c&&c!=document)&&this.V&&this.V[a]?p:this.makeTemplateSource(a,c).data("isRewritten");};a.t.prototype.rewriteTemplate=function(a,c,d){var f=this.makeTemplateSource(a,d),c=c(f.text());f.text(c);f.data("isRewritten",p);!(d&&d!=document)&&"string"==typeof a&&(this.V=this.V||{},this.V[a]=p);};a.b("templateEngine",a.t);a.Z=function(){function b(b,c,e){for(var b=a.g.W(b),d=a.g.D,j=0;j<b.length;j++){var k=b[j].key;if(d.hasOwnProperty(k)){var i=d[k];"function"===typeof i?(k=i(b[j].value))&&m(Error(k)):i||m(Error("This template engine does not support the '"+k+"' binding within its templates"));}}b="ko.templateRewriting.applyMemoizedBindingsToNextSibling(function() {             return (function() { return { "+a.g.ka(b)+" } })()         })";return e.createJavaScriptEvaluatorBlock(b)+c;}var c=/(<[a-z]+\d*(\s+(?!data-bind=)[a-z0-9\-]+(=(\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind=(["'])([\s\S]*?)\5/gi,d=/<\!--\s*ko\b\s*([\s\S]*?)\s*--\>/g;return{mb:function(b,c,e){c.isTemplateRewritten(b,e)||c.rewriteTemplate(b,function(b){return a.Z.zb(b,c);},e);},zb:function(a,g){return a.replace(c,function(a,c,d,f,i,l,q){return b(q,c,g);}).replace(d,function(a,c){return b(c,"<!-- ko -->",g);});},Za:function(b){return a.s.na(function(c,e){c.nextSibling&&a.ya(c.nextSibling,b,e);});}};}();a.b("templateRewriting",a.Z);a.b("templateRewriting.applyMemoizedBindingsToNextSibling",a.Z.Za);(function(){a.l={};a.l.i=function(a){this.i=a;};a.l.i.prototype.text=function(){var b=a.a.o(this.i),b="script"===b?"text":"textarea"===b?"value":"innerHTML";if(0==arguments.length){return this.i[b];}var c=arguments[0];"innerHTML"===b?a.a.Y(this.i,c):this.i[b]=c;};a.l.i.prototype.data=function(b){if(1===arguments.length){return a.a.f.get(this.i,"templateSourceData_"+b);}a.a.f.set(this.i,"templateSourceData_"+b,arguments[1]);};a.l.M=function(a){this.i=a;};a.l.M.prototype=new a.l.i;a.l.M.prototype.text=function(){if(0==arguments.length){var b=a.a.f.get(this.i,"__ko_anon_template__")||{};b.ua===n&&b.da&&(b.ua=b.da.innerHTML);return b.ua;}a.a.f.set(this.i,"__ko_anon_template__",{ua:arguments[0]});};a.l.i.prototype.nodes=function(){if(0==arguments.length){return(a.a.f.get(this.i,"__ko_anon_template__")||{}).da;}a.a.f.set(this.i,"__ko_anon_template__",{da:arguments[0]});};a.b("templateSources",a.l);a.b("templateSources.domElement",a.l.i);a.b("templateSources.anonymousTemplate",a.l.M);})();(function(){function b(b,c,d){for(var f,c=a.e.nextSibling(c);b&&(f=b)!==c;){b=a.e.nextSibling(f),(1===f.nodeType||8===f.nodeType)&&d(f);}}function c(c,d){if(c.length){var f=c[0],g=c[c.length-1];b(f,g,function(b){a.xa(d,b);});b(f,g,function(b){a.s.Wa(b,[d]);});}}function d(a){return a.nodeType?a:0<a.length?a[0]:s;}function f(b,f,j,k,i){var i=i||{},l=b&&d(b),l=l&&l.ownerDocument,q=i.templateEngine||g;a.Z.mb(j,q,l);j=q.renderTemplate(j,k,i,l);("number"!=typeof j.length||0<j.length&&"number"!=typeof j[0].nodeType)&&m(Error("Template engine must return an array of DOM nodes"));l=t;switch(f){case"replaceChildren":a.e.X(b,j);l=p;break;case"replaceNode":a.a.Na(b,j);l=p;break;case"ignoreTargetNode":break;default:m(Error("Unknown renderMode: "+f));}l&&(c(j,k),i.afterRender&&i.afterRender(j,k.$data));return j;}var g;a.ra=function(b){b!=n&&!(b instanceof a.t)&&m(Error("templateEngine must inherit from ko.templateEngine"));g=b;};a.qa=function(b,c,j,k,i){j=j||{};(j.templateEngine||g)==n&&m(Error("Set a template engine before calling renderTemplate"));i=i||"replaceChildren";if(k){var l=d(k);return a.h(function(){var g=c&&c instanceof a.z?c:new a.z(a.a.d(c)),o="function"==typeof b?b(g.$data):b,g=f(k,i,o,g,j);"replaceNode"==i&&(k=g,l=d(k));},s,{disposeWhen:function(){return !l||!a.a.fa(l);},disposeWhenNodeIsRemoved:l&&"replaceNode"==i?l.parentNode:l});}return a.s.na(function(d){a.qa(b,c,j,d,"replaceNode");});};a.Fb=function(b,d,g,k,i){function l(a,b){c(b,o);g.afterRender&&g.afterRender(b,a);}function q(c,d){var h="function"==typeof b?b(c):b;o=i.createChildContext(a.a.d(c));o.$index=d;return f(s,"ignoreTargetNode",h,o,g);}var o;return a.h(function(){var b=a.a.d(d)||[];"undefined"==typeof b.length&&(b=[b]);b=a.a.aa(b,function(b){return g.includeDestroyed||b===n||b===s||!a.a.d(b._destroy);});a.a.Oa(k,b,q,g,l);},s,{disposeWhenNodeIsRemoved:k});};a.c.template={init:function(b,c){var d=a.a.d(c());if("string"!=typeof d&&!d.name&&(1==b.nodeType||8==b.nodeType)){d=1==b.nodeType?b.childNodes:a.e.childNodes(b),d=a.a.Ab(d),(new a.l.M(b)).nodes(d);}return{controlsDescendantBindings:p};},update:function(b,c,d,f,g){c=a.a.d(c());f=p;"string"==typeof c?d=c:(d=c.name,"if" in c&&(f=f&&a.a.d(c["if"])),"ifnot" in c&&(f=f&&!a.a.d(c.ifnot)));var l=s;"object"===typeof c&&"foreach" in c?l=a.Fb(d||b,f&&c.foreach||[],c,b,g):f?(g="object"==typeof c&&"data" in c?g.createChildContext(a.a.d(c.data)):g,l=a.qa(d||b,g,c,b)):a.e.ha(b);g=l;(c=a.a.f.get(b,"__ko__templateSubscriptionDomDataKey__"))&&"function"==typeof c.A&&c.A();a.a.f.set(b,"__ko__templateSubscriptionDomDataKey__",g);}};a.g.D.template=function(b){b=a.g.W(b);return 1==b.length&&b[0].unknown||a.g.wb(b,"name")?s:"This template engine does not support anonymous templates nested within its templates";};a.e.C.template=p;})();a.b("setTemplateEngine",a.ra);a.b("renderTemplate",a.qa);(function(){a.a.O=function(b,c,d){if(d===n){return a.a.O(b,c,1)||a.a.O(b,c,10)||a.a.O(b,c,Number.MAX_VALUE);}for(var b=b||[],c=c||[],f=b,g=c,e=[],h=0;h<=g.length;h++){e[h]=[];}for(var h=0,j=Math.min(f.length,d);h<=j;h++){e[0][h]=h;}h=1;for(j=Math.min(g.length,d);h<=j;h++){e[h][0]=h;}for(var j=f.length,k,i=g.length,h=1;h<=j;h++){k=Math.max(1,h-d);for(var l=Math.min(i,h+d);k<=l;k++){e[k][h]=f[h-1]===g[k-1]?e[k-1][h-1]:Math.min(e[k-1][h]===n?Number.MAX_VALUE:e[k-1][h]+1,e[k][h-1]===n?Number.MAX_VALUE:e[k][h-1]+1);}}d=b.length;f=c.length;g=[];h=e[f][d];if(h===n){e=s;}else{for(;0<d||0<f;){j=e[f][d];i=0<f?e[f-1][d]:h+1;l=0<d?e[f][d-1]:h+1;k=0<f&&0<d?e[f-1][d-1]:h+1;if(i===n||i<j-1){i=h+1;}if(l===n||l<j-1){l=h+1;}k<j-1&&(k=h+1);i<=l&&i<k?(g.push({status:"added",value:c[f-1]}),f--):(l<i&&l<k?g.push({status:"deleted",value:b[d-1]}):(g.push({status:"retained",value:b[d-1]}),f--),d--);}e=g.reverse();}return e;};})();a.b("utils.compareArrays",a.a.O);(function(){function b(a){if(2<a.length){for(var b=a[0],c=a[a.length-1],e=[b];b!==c;){b=b.nextSibling;if(!b){return;}e.push(b);}Array.prototype.splice.apply(a,[0,a.length].concat(e));}}function c(c,f,g,e,h){var j=[],c=a.h(function(){var c=f(g,h)||[];0<j.length&&(b(j),a.a.Na(j,c),e&&e(g,c));j.splice(0,j.length);a.a.N(j,c);},s,{disposeWhenNodeIsRemoved:c,disposeWhen:function(){return 0==j.length||!a.a.fa(j[0]);}});return{xb:j,h:c};}a.a.Oa=function(d,f,g,e,h){for(var f=f||[],e=e||{},j=a.a.f.get(d,"setDomNodeChildrenFromArrayMapping_lastMappingResult")===n,k=a.a.f.get(d,"setDomNodeChildrenFromArrayMapping_lastMappingResult")||[],i=a.a.T(k,function(a){return a.$a;}),l=a.a.O(i,f),f=[],q=0,o=[],v=0,i=[],u=s,r=0,w=l.length;r<w;r++){switch(l[r].status){case"retained":var y=k[q];y.qb(v);v=f.push(y);0<y.P.length&&(u=y.P[y.P.length-1]);q++;break;case"deleted":k[q].h.A();b(k[q].P);a.a.v(k[q].P,function(a){o.push({element:a,index:r,value:l[r].value});u=a;});q++;break;case"added":for(var y=l[r].value,x=a.m(v),v=c(d,g,y,h,x),C=v.xb,v=f.push({$a:l[r].value,P:C,h:v.h,qb:x}),z=0,B=C.length;z<B;z++){var D=C[z];i.push({element:D,index:r,value:l[r].value});u==s?a.e.Ka(d,D):a.e.Fa(d,D,u);u=D;}h&&h(y,C,x);}}a.a.v(o,function(b){a.F(b.element);});g=t;if(!j){if(e.afterAdd){for(r=0;r<i.length;r++){e.afterAdd(i[r].element,i[r].index,i[r].value);}}if(e.beforeRemove){for(r=0;r<o.length;r++){e.beforeRemove(o[r].element,o[r].index,o[r].value);}g=p;}}if(!g&&o.length){for(r=0;r<o.length;r++){e=o[r].element,e.parentNode&&e.parentNode.removeChild(e);}}a.a.f.set(d,"setDomNodeChildrenFromArrayMapping_lastMappingResult",f);};})();a.b("utils.setDomNodeChildrenFromArrayMapping",a.a.Oa);a.q=function(){this.allowTemplateRewriting=t;};a.q.prototype=new a.t;a.q.prototype.renderTemplateSource=function(b){var c=!(9>a.a.ja)&&b.nodes?b.nodes():s;if(c){return a.a.L(c.cloneNode(p).childNodes);}b=b.text();return a.a.pa(b);};a.q.K=new a.q;a.ra(a.q.K);a.b("nativeTemplateEngine",a.q);(function(){a.ma=function(){var a=this.vb=function(){if("undefined"==typeof jQuery||!jQuery.tmpl){return 0;}try{if(0<=jQuery.tmpl.tag.tmpl.open.toString().indexOf("__")){return 2;}}catch(a){}return 1;}();this.renderTemplateSource=function(b,f,g){g=g||{};2>a&&m(Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later."));var e=b.data("precompiled");e||(e=b.text()||"",e=jQuery.template(s,"{{ko_with $item.koBindingContext}}"+e+"{{/ko_with}}"),b.data("precompiled",e));b=[f.$data];f=jQuery.extend({koBindingContext:f},g.templateOptions);f=jQuery.tmpl(e,b,f);f.appendTo(document.createElement("div"));jQuery.fragments={};return f;};this.createJavaScriptEvaluatorBlock=function(a){return"{{ko_code ((function() { return "+a+" })()) }}";};this.addTemplate=function(a,b){document.write("<script type='text/html' id='"+a+"'>"+b+"</script>");};0<a&&(jQuery.tmpl.tag.ko_code={open:"__.push($1 || '');"},jQuery.tmpl.tag.ko_with={open:"with($1) {",close:"} "});};a.ma.prototype=new a.t;var b=new a.ma;0<b.vb&&a.ra(b);a.b("jqueryTmplTemplateEngine",a.ma);})();}"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?E(module.exports||exports):"function"===typeof define&&define.amd?define(["exports"],E):E(window.ko={});p;})(window,document,navigator);(function(d){"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?d(require("knockout"),exports):"function"===typeof define&&define.amd?define(["knockout","exports"],d):d(ko,ko.mapping={});})(function(d,e){function w(b,c){for(var a in c){if(c.hasOwnProperty(a)&&c[a]){if(a&&b[a]&&"array"!==e.getType(b[a])){w(b[a],c[a]);}else{if("array"===e.getType(b[a])&&"array"===e.getType(c[a])){for(var d=b,g=a,i=b[a],r=c[a],t={},h=i.length-1;0<=h;--h){t[i[h]]=i[h];}for(h=r.length-1;0<=h;--h){t[r[h]]=r[h];}i=[];r=void 0;for(r in t){i.push(t[r]);}d[g]=i;}else{b[a]=c[a];}}}}}function D(b,c){var a={};w(a,b);w(a,c);return a;}function A(b,c){for(var a=D({},b),d=K.length-1;0<=d;d--){var e=K[d];a[e]&&(a[""] instanceof Object||(a[""]={}),a[""][e]=a[e],delete a[e]);}c&&(a.ignore=p(c.ignore,a.ignore),a.include=p(c.include,a.include),a.copy=p(c.copy,a.copy));a.ignore=p(a.ignore,j.ignore);a.include=p(a.include,j.include);a.copy=p(a.copy,j.copy);a.mappedProperties=a.mappedProperties||{};return a;}function p(b,c){"array"!==e.getType(b)&&(b="undefined"===e.getType(b)?[]:[b]);"array"!==e.getType(c)&&(c="undefined"===e.getType(c)?[]:[c]);return d.utils.arrayGetDistinctValues(b.concat(c));}function E(b,c,a,f,g,i,r){var t="array"===e.getType(d.utils.unwrapObservable(c)),i=i||"";if(e.isMapped(b)){var h=d.utils.unwrapObservable(b)[q],a=D(h,a);}var m=function(){return a[f]&&a[f].create instanceof Function;},j=function(b){var e=F,h=d.dependentObservable;d.dependentObservable=function(a,b,c){c=c||{};a&&"object"==typeof a&&(c=a);var f=c.deferEvaluation,L=!1;c.deferEvaluation=!0;a=new G(a,b,c);if(!f){var g=a,f=d.dependentObservable;d.dependentObservable=G;a=d.isWriteableObservable(g);d.dependentObservable=f;a=G({read:function(){L||(d.utils.arrayRemoveItem(e,g),L=!0);return g.apply(g,arguments);},write:a&&function(a){return g(a);},deferEvaluation:!0});e.push(a);}return a;};d.dependentObservable.fn=G.fn;d.computed=d.dependentObservable;b=d.utils.unwrapObservable(g) instanceof Array?a[f].create({data:b||c,parent:r,skip:M}):a[f].create({data:b||c,parent:r});d.dependentObservable=h;d.computed=d.dependentObservable;return b;},x=function(){return a[f]&&a[f].update instanceof Function;},y=function(b,e){var g={data:e||c,parent:r,target:d.utils.unwrapObservable(b)};d.isWriteableObservable(b)&&(g.observable=b);return a[f].update(g);};if(h=H.get(c)){return h;}f=f||"";if(t){var t=[],s=!1,k=function(a){return a;};a[f]&&a[f].key&&(k=a[f].key,s=!0);d.isObservable(b)||(b=d.observableArray([]),b.mappedRemove=function(a){var c=typeof a=="function"?a:function(b){return b===k(a);};return b.remove(function(a){return c(k(a));});},b.mappedRemoveAll=function(a){var c=B(a,k);return b.remove(function(a){return d.utils.arrayIndexOf(c,k(a))!=-1;});},b.mappedDestroy=function(a){var c=typeof a=="function"?a:function(b){return b===k(a);};return b.destroy(function(a){return c(k(a));});},b.mappedDestroyAll=function(a){var c=B(a,k);return b.destroy(function(a){return d.utils.arrayIndexOf(c,k(a))!=-1;});},b.mappedIndexOf=function(a){var c=B(b(),k),a=k(a);return d.utils.arrayIndexOf(c,a);},b.mappedCreate=function(a){if(b.mappedIndexOf(a)!==-1){throw Error("There already is an object with the key that you specified.");}var c=m()?j(a):a;if(x()){a=y(c,a);d.isWriteableObservable(c)?c(a):c=a;}b.push(c);return c;});var h=B(d.utils.unwrapObservable(b),k).sort(),n=B(c,k);s&&n.sort();var s=d.utils.compareArrays(h,n),h={},p,z=d.utils.unwrapObservable(c),v={},w=!0,n=0;for(p=z.length;n<p;n++){var o=k(z[n]);if(void 0===o||o instanceof Object){w=!1;break;}v[o]=z[n];}var z=[],A=0,n=0;for(p=s.length;n<p;n++){var o=s[n],l,u=i+"["+n+"]";switch(o.status){case"added":var C=w?v[o.value]:I(d.utils.unwrapObservable(c),o.value,k);l=E(void 0,C,a,f,b,u,g);m()||(l=d.utils.unwrapObservable(l));u=N(d.utils.unwrapObservable(c),C,h);l===M?A++:z[u-A]=l;h[u]=!0;break;case"retained":C=w?v[o.value]:I(d.utils.unwrapObservable(c),o.value,k);l=I(b,o.value,k);E(l,C,a,f,b,u,g);u=N(d.utils.unwrapObservable(c),C,h);z[u]=l;h[u]=!0;break;case"deleted":l=I(b,o.value,k);}t.push({event:o.status,item:l});}b(z);a[f]&&a[f].arrayChanged&&d.utils.arrayForEach(t,function(b){a[f].arrayChanged(b.event,b.item);});}else{if(O(c)){b=d.utils.unwrapObservable(b);if(!b){if(m()){return s=j(),x()&&(s=y(s)),s;}if(x()){return y(s);}b={};}x()&&(b=y(b));H.save(c,b);if(x()){return b;}P(c,function(f){var e=i.length?i+"."+f:f;if(-1==d.utils.arrayIndexOf(a.ignore,e)){if(-1!=d.utils.arrayIndexOf(a.copy,e)){b[f]=c[f];}else{var g=H.get(c[f]),h=E(b[f],c[f],a,f,b,e,b),g=g||h;if(d.isWriteableObservable(b[f])){b[f](d.utils.unwrapObservable(g));}else{b[f]=g;}a.mappedProperties[e]=!0;}}});}else{switch(e.getType(c)){case"function":x()?d.isWriteableObservable(c)?(c(y(c)),b=c):b=y(c):b=c;break;default:if(d.isWriteableObservable(b)){return l=x()?y(b):d.utils.unwrapObservable(c),b(l),l;}b=m()?j():d.observable(d.utils.unwrapObservable(c));}}}return b;}function N(b,c,a){for(var d=0,e=b.length;d<e;d++){if(!0!==a[d]&&b[d]===c){return d;}}return null;}function Q(b,c){var a;c&&(a=c(b));"undefined"===e.getType(a)&&(a=b);return d.utils.unwrapObservable(a);}function I(b,c,a){for(var b=d.utils.unwrapObservable(b),f=0,e=b.length;f<e;f++){var i=b[f];if(Q(i,a)===c){return i;}}throw Error("When calling ko.update*, the key '"+c+"' was not found!");}function B(b,c){return d.utils.arrayMap(d.utils.unwrapObservable(b),function(a){return c?Q(a,c):a;});}function P(b,c){if("array"===e.getType(b)){for(var a=0;a<b.length;a++){c(a);}}else{for(a in b){c(a);}}}function O(b){var c=e.getType(b);return("object"===c||"array"===c)&&null!==b;}function S(){var b=[],c=[];this.save=function(a,f){var e=d.utils.arrayIndexOf(b,a);0<=e?c[e]=f:(b.push(a),c.push(f));};this.get=function(a){a=d.utils.arrayIndexOf(b,a);return 0<=a?c[a]:void 0;};}function R(){var b={},c=function(a){var c;try{c=a;}catch(d){c="$$$";}a=b[c];void 0===a&&(a=new S,b[c]=a);return a;};this.save=function(a,b){c(a).save(a,b);};this.get=function(a){return c(a).get(a);};}var q="__ko_mapping__",G=d.dependentObservable,J=0,F,H,K=["create","update","key","arrayChanged"],M={},v={include:["_destroy"],ignore:[],copy:[]},j=v;e.isMapped=function(b){return(b=d.utils.unwrapObservable(b))&&b[q];};e.fromJS=function(b){if(0==arguments.length){throw Error("When calling ko.fromJS, pass the object you want to convert.");}window.setTimeout(function(){J=0;},0);J++||(F=[],H=new R);var c,a;2==arguments.length&&(arguments[1][q]?a=arguments[1]:c=arguments[1]);3==arguments.length&&(c=arguments[1],a=arguments[2]);a&&(c=D(c,a[q]));c=A(c);var d=E(a,b,c);a&&(d=a);--J||window.setTimeout(function(){for(;F.length;){var a=F.pop();a&&a();}},0);d[q]=D(d[q],c);return d;};e.fromJSON=function(b){var c=d.utils.parseJson(b);arguments[0]=c;return e.fromJS.apply(this,arguments);};e.updateFromJS=function(){throw Error("ko.mapping.updateFromJS, use ko.mapping.fromJS instead. Please note that the order of parameters is different!");};e.updateFromJSON=function(){throw Error("ko.mapping.updateFromJSON, use ko.mapping.fromJSON instead. Please note that the order of parameters is different!");};e.toJS=function(b,c){j||e.resetDefaultOptions();if(0==arguments.length){throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");}if("array"!==e.getType(j.ignore)){throw Error("ko.mapping.defaultOptions().ignore should be an array.");}if("array"!==e.getType(j.include)){throw Error("ko.mapping.defaultOptions().include should be an array.");}if("array"!==e.getType(j.copy)){throw Error("ko.mapping.defaultOptions().copy should be an array.");}c=A(c,b[q]);return e.visitModel(b,function(a){return d.utils.unwrapObservable(a);},c);};e.toJSON=function(b,c){var a=e.toJS(b,c);return d.utils.stringifyJson(a);};e.defaultOptions=function(){if(0<arguments.length){j=arguments[0];}else{return j;}};e.resetDefaultOptions=function(){j={include:v.include.slice(0),ignore:v.ignore.slice(0),copy:v.copy.slice(0)};};e.getType=function(b){if(b&&"object"===typeof b){if(b.constructor==(new Date).constructor){return"date";}if("[object Array]"===Object.prototype.toString.call(b)){return"array";}}return typeof b;};e.visitModel=function(b,c,a){a=a||{};a.visitedObjects=a.visitedObjects||new R;var f,g=d.utils.unwrapObservable(b);if(O(g)){a=A(a,g[q]),c(b,a.parentName),f="array"===e.getType(g)?[]:{};}else{return c(b,a.parentName);}a.visitedObjects.save(b,f);var i=a.parentName;P(g,function(b){if(!(a.ignore&&-1!=d.utils.arrayIndexOf(a.ignore,b))){var j=g[b],h=a,m=i||"";"array"===e.getType(g)?i&&(m+="["+b+"]"):(i&&(m+="."),m+=b);h.parentName=m;if(!(-1===d.utils.arrayIndexOf(a.copy,b)&&-1===d.utils.arrayIndexOf(a.include,b)&&g[q]&&g[q].mappedProperties&&!g[q].mappedProperties[b]&&"array"!==e.getType(g))){switch(e.getType(d.utils.unwrapObservable(j))){case"object":case"array":case"undefined":h=a.visitedObjects.get(j);f[b]="undefined"!==e.getType(h)?h:e.visitModel(j,c,a);break;default:f[b]=c(j,a.parentName);}}}});return f;};});(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _){return obj;}if(!(this instanceof _)){return new _(obj);}this._wrapped=obj;};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=_;}exports._=_;}else{root["_"]=_;}_.VERSION="1.4.0";var each=_.each=_.forEach=function(obj,iterator,context){if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context);}else{if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){if(iterator.call(context,obj[i],i,obj)===breaker){return;}}}else{for(var key in obj){if(_.has(obj,key)){if(iterator.call(context,obj[key],key,obj)===breaker){return;}}}}}};_.map=_.collect=function(obj,iterator,context){var results=[];if(nativeMap&&obj.map===nativeMap){return obj.map(iterator,context);}each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list);});return results;};_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(nativeReduce&&obj.reduce===nativeReduce){if(context){iterator=_.bind(iterator,context);}return initial?obj.reduce(iterator,memo):obj.reduce(iterator);}each(obj,function(value,index,list){if(!initial){memo=value;initial=true;}else{memo=iterator.call(context,memo,value,index,list);}});if(!initial){throw new TypeError("Reduce of empty array with no initial value");}return memo;};_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context){iterator=_.bind(iterator,context);}return arguments.length>2?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);}var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length;}each(obj,function(value,index,list){index=keys?keys[--length]:--length;if(!initial){memo=obj[index];initial=true;}else{memo=iterator.call(context,memo,obj[index],index,list);}});if(!initial){throw new TypeError("Reduce of empty array with no initial value");}return memo;};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true;}});return result;};_.filter=_.select=function(obj,iterator,context){var results=[];if(nativeFilter&&obj.filter===nativeFilter){return obj.filter(iterator,context);}each(obj,function(value,index,list){if(iterator.call(context,value,index,list)){results[results.length]=value;}});return results;};_.reject=function(obj,iterator,context){var results=[];each(obj,function(value,index,list){if(!iterator.call(context,value,index,list)){results[results.length]=value;}});return results;};_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=true;if(nativeEvery&&obj.every===nativeEvery){return obj.every(iterator,context);}each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list))){return breaker;}});return !!result;};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=false;if(nativeSome&&obj.some===nativeSome){return obj.some(iterator,context);}each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list))){return breaker;}});return !!result;};_.contains=_.include=function(obj,target){var found=false;if(nativeIndexOf&&obj.indexOf===nativeIndexOf){return obj.indexOf(target)!=-1;}found=any(obj,function(value){return value===target;});return found;};_.invoke=function(obj,method){var args=slice.call(arguments,2);return _.map(obj,function(value){return(_.isFunction(method)?method:value[method]).apply(value,args);});};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key];});};_.where=function(obj,attrs){if(_.isEmpty(attrs)){return[];}return _.filter(obj,function(value){for(var key in attrs){if(attrs[key]!==value[key]){return false;}}return true;});};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.max.apply(Math,obj);}if(!iterator&&_.isEmpty(obj)){return -Infinity;}var result={computed:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed});});return result.value;};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.min.apply(Math,obj);}if(!iterator&&_.isEmpty(obj)){return Infinity;}var result={computed:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed});});return result.value;};_.shuffle=function(obj){var rand;var index=0;var shuffled=[];each(obj,function(value){rand=_.random(index++);shuffled[index-1]=shuffled[rand];shuffled[rand]=value;});return shuffled;};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value];};};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)};}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0){return 1;}if(a<b||b===void 0){return -1;}}return left.index<right.index?-1:1;}),"value");};var group=function(obj,value,context,behavior){var result={};var iterator=lookupIterator(value);each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value);});return result;};_.groupBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){(_.has(result,key)?result[key]:(result[key]=[])).push(value);});};_.countBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){if(!_.has(result,key)){result[key]=0;}result[key]++;});};_.sortedIndex=function(array,obj,iterator,context){iterator=iterator==null?_.identity:lookupIterator(iterator);var value=iterator.call(context,obj);var low=0,high=array.length;while(low<high){var mid=(low+high)>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid;}return low;};_.toArray=function(obj){if(!obj){return[];}if(obj.length===+obj.length){return slice.call(obj);}return _.values(obj);};_.size=function(obj){return(obj.length===+obj.length)?obj.length:_.keys(obj).length;};_.first=_.head=_.take=function(array,n,guard){return(n!=null)&&!guard?slice.call(array,0,n):array[0];};_.initial=function(array,n,guard){return slice.call(array,0,array.length-((n==null)||guard?1:n));};_.last=function(array,n,guard){if((n!=null)&&!guard){return slice.call(array,Math.max(array.length-n,0));}else{return array[array.length-1];}};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,(n==null)||guard?1:n);};_.compact=function(array){return _.filter(array,function(value){return !!value;});};var flatten=function(input,shallow,output){each(input,function(value){if(_.isArray(value)){shallow?push.apply(output,value):flatten(value,shallow,output);}else{output.push(value);}});return output;};_.flatten=function(array,shallow){return flatten(array,shallow,[]);};_.without=function(array){return _.difference(array,slice.call(arguments,1));};_.uniq=_.unique=function(array,isSorted,iterator,context){var initial=iterator?_.map(array,iterator,context):array;var results=[];var seen=[];each(initial,function(value,index){if(isSorted?(!index||seen[seen.length-1]!==value):!_.contains(seen,value)){seen.push(value);results.push(array[index]);}});return results;};_.union=function(){return _.uniq(concat.apply(ArrayProto,arguments));};_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0;});});};_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return !_.contains(rest,value);});};_.zip=function(){var args=slice.call(arguments);var length=_.max(_.pluck(args,"length"));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(args,""+i);}return results;};_.object=function(list,values){var result={};for(var i=0,l=list.length;i<l;i++){if(values){result[list[i]]=values[i];}else{result[list[i][0]]=list[i][1];}}return result;};_.indexOf=function(array,item,isSorted){var i=0,l=array.length;if(isSorted){if(typeof isSorted=="number"){i=(isSorted<0?Math.max(0,l+isSorted):isSorted);}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1;}}if(nativeIndexOf&&array.indexOf===nativeIndexOf){return array.indexOf(item,isSorted);}for(;i<l;i++){if(array[i]===item){return i;}}return -1;};_.lastIndexOf=function(array,item,fromIndex){if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return array.lastIndexOf(item,fromIndex);}var i=(fromIndex!=null?fromIndex:array.length);while(i--){if(array[i]===item){return i;}}return -1;};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0;}step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(len);while(idx<len){range[idx++]=start;start+=step;}return range;};var ctor=function(){};_.bind=function bind(func,context){var bound,args;if(func.bind===nativeBind&&nativeBind){return nativeBind.apply(func,slice.call(arguments,1));}if(!_.isFunction(func)){throw new TypeError;}args=slice.call(arguments,2);return bound=function(){if(!(this instanceof bound)){return func.apply(context,args.concat(slice.call(arguments)));}ctor.prototype=func.prototype;var self=new ctor;var result=func.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result){return result;}return self;};};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length==0){funcs=_.functions(obj);}each(funcs,function(f){obj[f]=_.bind(obj[f],obj);});return obj;};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:(memo[key]=func.apply(this,arguments));};};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args);},wait);};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)));};_.throttle=function(func,wait){var context,args,timeout,throttling,more,result;var whenDone=_.debounce(function(){more=throttling=false;},wait);return function(){context=this;args=arguments;var later=function(){timeout=null;if(more){result=func.apply(context,args);}whenDone();};if(!timeout){timeout=setTimeout(later,wait);}if(throttling){more=true;}else{throttling=true;result=func.apply(context,args);}whenDone();return result;};};_.debounce=function(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate){result=func.apply(context,args);}};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow){result=func.apply(context,args);}return result;};};_.once=function(func){var ran=false,memo;return function(){if(ran){return memo;}ran=true;memo=func.apply(this,arguments);func=null;return memo;};};_.wrap=function(func,wrapper){return function(){var args=[func];push.apply(args,arguments);return wrapper.apply(this,args);};};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)];}return args[0];};};_.after=function(times,func){if(times<=0){return func();}return function(){if(--times<1){return func.apply(this,arguments);}};};_.keys=nativeKeys||function(obj){if(obj!==Object(obj)){throw new TypeError("Invalid object");}var keys=[];for(var key in obj){if(_.has(obj,key)){keys[keys.length]=key;}}return keys;};_.values=function(obj){var values=[];for(var key in obj){if(_.has(obj,key)){values.push(obj[key]);}}return values;};_.pairs=function(obj){var pairs=[];for(var key in obj){if(_.has(obj,key)){pairs.push([key,obj[key]]);}}return pairs;};_.invert=function(obj){var result={};for(var key in obj){if(_.has(obj,key)){result[obj[key]]=key;}}return result;};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key])){names.push(key);}}return names.sort();};_.extend=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){obj[prop]=source[prop];}});return obj;};_.pick=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));each(keys,function(key){if(key in obj){copy[key]=obj[key];}});return copy;};_.omit=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj){if(!_.contains(keys,key)){copy[key]=obj[key];}}return copy;};_.defaults=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){if(obj[prop]==null){obj[prop]=source[prop];}}});return obj;};_.clone=function(obj){if(!_.isObject(obj)){return obj;}return _.isArray(obj)?obj.slice():_.extend({},obj);};_.tap=function(obj,interceptor){interceptor(obj);return obj;};var eq=function(a,b,aStack,bStack){if(a===b){return a!==0||1/a==1/b;}if(a==null||b==null){return a===b;}if(a instanceof _){a=a._wrapped;}if(b instanceof _){b=b._wrapped;}var className=toString.call(a);if(className!=toString.call(b)){return false;}switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:(a==0?1/a==1/b:a==+b);case"[object Date]":case"[object Boolean]":return +a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase;}if(typeof a!="object"||typeof b!="object"){return false;}var length=aStack.length;while(length--){if(aStack[length]==a){return bStack[length]==b;}}aStack.push(a);bStack.push(b);var size=0,result=true;if(className=="[object Array]"){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack))){break;}}}}else{var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&(aCtor instanceof aCtor)&&_.isFunction(bCtor)&&(bCtor instanceof bCtor))){return false;}for(var key in a){if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack))){break;}}}if(result){for(key in b){if(_.has(b,key)&&!(size--)){break;}}result=!size;}}aStack.pop();bStack.pop();return result;};_.isEqual=function(a,b){return eq(a,b,[],[]);};_.isEmpty=function(obj){if(obj==null){return true;}if(_.isArray(obj)||_.isString(obj)){return obj.length===0;}for(var key in obj){if(_.has(obj,key)){return false;}}return true;};_.isElement=function(obj){return !!(obj&&obj.nodeType===1);};_.isArray=nativeIsArray||function(obj){return toString.call(obj)=="[object Array]";};_.isObject=function(obj){return obj===Object(obj);};each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]";};});if(!_.isArguments(arguments)){_.isArguments=function(obj){return !!(obj&&_.has(obj,"callee"));};}if(typeof(/./)!=="function"){_.isFunction=function(obj){return typeof obj==="function";};}_.isFinite=function(obj){return _.isNumber(obj)&&isFinite(obj);};_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj;};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)=="[object Boolean]";};_.isNull=function(obj){return obj===null;};_.isUndefined=function(obj){return obj===void 0;};_.has=function(obj,key){return hasOwnProperty.call(obj,key);};_.noConflict=function(){root._=previousUnderscore;return this;};_.identity=function(value){return value;};_.times=function(n,iterator,context){for(var i=0;i<n;i++){iterator.call(context,i);}};_.random=function(min,max){if(max==null){max=min;min=0;}return min+(0|Math.random()*(max-min+1));};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){if(string==null){return"";}return(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match];});};});_.result=function(object,property){if(object==null){return null;}var value=object[property];return _.isFunction(value)?value.call(object):value;};_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args));};});};var idCounter=0;_.uniqueId=function(prefix){var id=idCounter++;return prefix?prefix+id:id;};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,function(match){return"\\"+escapes[match];});source+=escape?"'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?"'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate?"';\n"+evaluate+"\n__p+='":"";index=offset+match.length;});source+="';\n";if(!settings.variable){source="with(obj||{}){\n"+source+"}\n";}source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source);}catch(e){e.source=source;throw e;}if(data){return render(data,_);}var template=function(data){return render.call(this,data,_);};template.source="function("+(settings.variable||"obj")+"){\n"+source+"}";return template;};_.chain=function(obj){return _(obj).chain();};var result=function(obj){return this._chain?_(obj).chain():obj;};_.mixin(_);each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name=="shift"||name=="splice")&&obj.length===0){delete obj[0];}return result.call(this,obj);};});each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments));};});_.extend(_.prototype,{chain:function(){this._chain=true;return this;},value:function(){return this._wrapped;}});}).call(this);/*
Chosen, a Select Box Enhancer for jQuery and Prototype
by Patrick Filler for Harvest, http://getharvest.com

Version 1.6.1
Full source at https://github.com/harvesthq/chosen
Copyright (c) 2011-2016 Harvest http://getharvest.com

MIT License, https://github.com/harvesthq/chosen/blob/master/LICENSE.md
This file is generated by `grunt build`, do not edit it by hand.
*/
(function(){var $,AbstractChosen,Chosen,SelectParser,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key)){child[key]=parent[key];}}function ctor(){this.constructor=child;}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child;};SelectParser=(function(){function SelectParser(){this.options_index=0;this.parsed=[];}SelectParser.prototype.add_node=function(child){if(child.nodeName.toUpperCase()==="OPTGROUP"){return this.add_group(child);}else{return this.add_option(child);}};SelectParser.prototype.add_group=function(group){var group_position,option,_i,_len,_ref,_results;group_position=this.parsed.length;this.parsed.push({array_index:group_position,group:true,label:this.escapeExpression(group.label),title:group.title?group.title:void 0,children:0,disabled:group.disabled,classes:group.className});_ref=group.childNodes;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];_results.push(this.add_option(option,group_position,group.disabled));}return _results;};SelectParser.prototype.add_option=function(option,group_position,group_disabled){if(option.nodeName.toUpperCase()==="OPTION"){if(option.text!==""){if(group_position!=null){this.parsed[group_position].children+=1;}this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:option.value,text:option.text,html:option.innerHTML,title:option.title?option.title:void 0,selected:option.selected,disabled:group_disabled===true?group_disabled:option.disabled,group_array_index:group_position,group_label:group_position!=null?this.parsed[group_position].label:null,classes:option.className,style:option.style.cssText});}else{this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:true});}return this.options_index+=1;}};SelectParser.prototype.escapeExpression=function(text){var map,unsafe_chars;if((text==null)||text===false){return"";}if(!/[\&\<\>\"\'\`]/.test(text)){return text;}map={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};unsafe_chars=/&(?!\w+;)|[\<\>\"\'\`]/g;return text.replace(unsafe_chars,function(chr){return map[chr]||"&amp;";});};return SelectParser;})();SelectParser.select_to_array=function(select){var child,parser,_i,_len,_ref;parser=new SelectParser();_ref=select.childNodes;for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];parser.add_node(child);}return parser.parsed;};AbstractChosen=(function(){function AbstractChosen(form_field,options){this.form_field=form_field;this.options=options!=null?options:{};if(!AbstractChosen.browser_is_supported()){return;}this.is_multiple=this.form_field.multiple;this.set_default_text();this.set_default_values();this.setup();this.set_up_html();this.register_observers();this.on_ready();}AbstractChosen.prototype.set_default_values=function(){var _this=this;this.click_test_action=function(evt){return _this.test_active_click(evt);};this.activate_action=function(evt){return _this.activate_field(evt);};this.active_field=false;this.mouse_on_container=false;this.results_showing=false;this.result_highlighted=null;this.allow_single_deselect=(this.options.allow_single_deselect!=null)&&(this.form_field.options[0]!=null)&&this.form_field.options[0].text===""?this.options.allow_single_deselect:false;this.disable_search_threshold=this.options.disable_search_threshold||0;this.disable_search=this.options.disable_search||false;this.enable_split_word_search=this.options.enable_split_word_search!=null?this.options.enable_split_word_search:true;this.group_search=this.options.group_search!=null?this.options.group_search:true;this.search_contains=this.options.search_contains||false;this.single_backstroke_delete=this.options.single_backstroke_delete!=null?this.options.single_backstroke_delete:true;this.max_selected_options=this.options.max_selected_options||Infinity;this.inherit_select_classes=this.options.inherit_select_classes||false;this.display_selected_options=this.options.display_selected_options!=null?this.options.display_selected_options:true;this.display_disabled_options=this.options.display_disabled_options!=null?this.options.display_disabled_options:true;this.include_group_label_in_selected=this.options.include_group_label_in_selected||false;this.max_shown_results=this.options.max_shown_results||Number.POSITIVE_INFINITY;return this.case_sensitive_search=this.options.case_sensitive_search||false;};AbstractChosen.prototype.set_default_text=function(){if(this.form_field.getAttribute("data-placeholder")){this.default_text=this.form_field.getAttribute("data-placeholder");}else{if(this.is_multiple){this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||AbstractChosen.default_multiple_text;}else{this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||AbstractChosen.default_single_text;}}return this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||AbstractChosen.default_no_result_text;};AbstractChosen.prototype.choice_label=function(item){if(this.include_group_label_in_selected&&(item.group_label!=null)){return"<b class='group-name'>"+item.group_label+"</b>"+item.html;}else{return item.html;}};AbstractChosen.prototype.mouse_enter=function(){return this.mouse_on_container=true;};AbstractChosen.prototype.mouse_leave=function(){return this.mouse_on_container=false;};AbstractChosen.prototype.input_focus=function(evt){var _this=this;if(this.is_multiple){if(!this.active_field){return setTimeout((function(){return _this.container_mousedown();}),50);}}else{if(!this.active_field){return this.activate_field();}}};AbstractChosen.prototype.input_blur=function(evt){var _this=this;if(!this.mouse_on_container){this.active_field=false;return setTimeout((function(){return _this.blur_test();}),100);}};AbstractChosen.prototype.results_option_build=function(options){var content,data,data_content,shown_results,_i,_len,_ref;content="";shown_results=0;_ref=this.results_data;for(_i=0,_len=_ref.length;_i<_len;_i++){data=_ref[_i];data_content="";if(data.group){data_content=this.result_add_group(data);}else{data_content=this.result_add_option(data);}if(data_content!==""){shown_results++;content+=data_content;}if(options!=null?options.first:void 0){if(data.selected&&this.is_multiple){this.choice_build(data);}else{if(data.selected&&!this.is_multiple){this.single_set_selected_text(this.choice_label(data));}}}if(shown_results>=this.max_shown_results){break;}}return content;};AbstractChosen.prototype.result_add_option=function(option){var classes,option_el;if(!option.search_match){return"";}if(!this.include_option_in_results(option)){return"";}classes=[];if(!option.disabled&&!(option.selected&&this.is_multiple)){classes.push("active-result");}if(option.disabled&&!(option.selected&&this.is_multiple)){classes.push("disabled-result");}if(option.selected){classes.push("result-selected");}if(option.group_array_index!=null){classes.push("group-option");}if(option.classes!==""){classes.push(option.classes);}option_el=document.createElement("li");option_el.className=classes.join(" ");option_el.style.cssText=option.style;option_el.setAttribute("data-option-array-index",option.array_index);option_el.innerHTML=option.search_text;if(option.title){option_el.title=option.title;}return this.outerHTML(option_el);};AbstractChosen.prototype.result_add_group=function(group){var classes,group_el;if(!(group.search_match||group.group_match)){return"";}if(!(group.active_options>0)){return"";}classes=[];classes.push("group-result");if(group.classes){classes.push(group.classes);}group_el=document.createElement("li");group_el.className=classes.join(" ");group_el.innerHTML=group.search_text;if(group.title){group_el.title=group.title;}return this.outerHTML(group_el);};AbstractChosen.prototype.results_update_field=function(){this.set_default_text();if(!this.is_multiple){this.results_reset_cleanup();}this.result_clear_highlight();this.results_build();if(this.results_showing){return this.winnow_results();}};AbstractChosen.prototype.reset_single_select_options=function(){var result,_i,_len,_ref,_results;_ref=this.results_data;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){result=_ref[_i];if(result.selected){_results.push(result.selected=false);}else{_results.push(void 0);}}return _results;};AbstractChosen.prototype.results_toggle=function(){if(this.results_showing){return this.results_hide();}else{return this.results_show();}};AbstractChosen.prototype.results_search=function(evt){if(this.results_showing){return this.winnow_results();}else{return this.results_show();}};AbstractChosen.prototype.winnow_results=function(){var escapedSearchText,option,regex,results,results_group,searchText,startpos,text,zregex,_i,_len,_ref;this.no_results_clear();results=0;searchText=this.get_search_text();escapedSearchText=searchText.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");zregex=new RegExp(escapedSearchText,"i");regex=this.get_search_regex(escapedSearchText);_ref=this.results_data;for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];option.search_match=false;results_group=null;if(this.include_option_in_results(option)){if(option.group){option.group_match=false;option.active_options=0;}if((option.group_array_index!=null)&&this.results_data[option.group_array_index]){results_group=this.results_data[option.group_array_index];if(results_group.active_options===0&&results_group.search_match){results+=1;}results_group.active_options+=1;}option.search_text=option.group?option.label:option.html;if(!(option.group&&!this.group_search)){option.search_match=this.search_string_match(option.search_text,regex);if(option.search_match&&!option.group){results+=1;}if(option.search_match){if(searchText.length){startpos=option.search_text.search(zregex);text=option.search_text.substr(0,startpos+searchText.length)+"</em>"+option.search_text.substr(startpos+searchText.length);option.search_text=text.substr(0,startpos)+"<em>"+text.substr(startpos);}if(results_group!=null){results_group.group_match=true;}}else{if((option.group_array_index!=null)&&this.results_data[option.group_array_index].search_match){option.search_match=true;}}}}}this.result_clear_highlight();if(results<1&&searchText.length){this.update_results_content("");return this.no_results(searchText);}else{this.update_results_content(this.results_option_build());return this.winnow_results_set_highlight();}};AbstractChosen.prototype.get_search_regex=function(escaped_search_string){var regex_anchor,regex_flag;regex_anchor=this.search_contains?"":"^";regex_flag=this.case_sensitive_search?"":"i";return new RegExp(regex_anchor+escaped_search_string,regex_flag);};AbstractChosen.prototype.search_string_match=function(search_string,regex){var part,parts,_i,_len;if(regex.test(search_string)){return true;}else{if(this.enable_split_word_search&&(search_string.indexOf(" ")>=0||search_string.indexOf("[")===0)){parts=search_string.replace(/\[|\]/g,"").split(" ");if(parts.length){for(_i=0,_len=parts.length;_i<_len;_i++){part=parts[_i];if(regex.test(part)){return true;}}}}}};AbstractChosen.prototype.choices_count=function(){var option,_i,_len,_ref;if(this.selected_option_count!=null){return this.selected_option_count;}this.selected_option_count=0;_ref=this.form_field.options;for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];if(option.selected){this.selected_option_count+=1;}}return this.selected_option_count;};AbstractChosen.prototype.choices_click=function(evt){evt.preventDefault();if(!(this.results_showing||this.is_disabled)){return this.results_show();}};AbstractChosen.prototype.keyup_checker=function(evt){var stroke,_ref;stroke=(_ref=evt.which)!=null?_ref:evt.keyCode;this.search_field_scale();switch(stroke){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0){return this.keydown_backstroke();}else{if(!this.pending_backstroke){this.result_clear_highlight();return this.results_search();}}break;case 13:evt.preventDefault();if(this.results_showing){return this.result_select(evt);}break;case 27:if(this.results_showing){this.results_hide();}return true;case 9:case 38:case 40:case 16:case 91:case 17:case 18:break;default:return this.results_search();}};AbstractChosen.prototype.clipboard_event_checker=function(evt){var _this=this;return setTimeout((function(){return _this.results_search();}),50);};AbstractChosen.prototype.container_width=function(){if(this.options.width!=null){return this.options.width;}else{return""+this.form_field.offsetWidth+"px";}};AbstractChosen.prototype.include_option_in_results=function(option){if(this.is_multiple&&(!this.display_selected_options&&option.selected)){return false;}if(!this.display_disabled_options&&option.disabled){return false;}if(option.empty){return false;}return true;};AbstractChosen.prototype.search_results_touchstart=function(evt){this.touch_started=true;return this.search_results_mouseover(evt);};AbstractChosen.prototype.search_results_touchmove=function(evt){this.touch_started=false;return this.search_results_mouseout(evt);};AbstractChosen.prototype.search_results_touchend=function(evt){if(this.touch_started){return this.search_results_mouseup(evt);}};AbstractChosen.prototype.outerHTML=function(element){var tmp;if(element.outerHTML){return element.outerHTML;}tmp=document.createElement("div");tmp.appendChild(element);return tmp.innerHTML;};AbstractChosen.browser_is_supported=function(){if("Microsoft Internet Explorer"===window.navigator.appName){return document.documentMode>=8;}if(/iP(od|hone)/i.test(window.navigator.userAgent)||/IEMobile/i.test(window.navigator.userAgent)||/Windows Phone/i.test(window.navigator.userAgent)||/BlackBerry/i.test(window.navigator.userAgent)||/BB10/i.test(window.navigator.userAgent)||/Android.*Mobile/i.test(window.navigator.userAgent)){return false;}return true;};AbstractChosen.default_multiple_text="Select Some Options";AbstractChosen.default_single_text="Select an Option";AbstractChosen.default_no_result_text="No results match";return AbstractChosen;})();$=jQuery;$.fn.extend({chosen:function(options){if(!AbstractChosen.browser_is_supported()){return this;}return this.each(function(input_field){var $this,chosen;$this=$(this);chosen=$this.data("chosen");if(options==="destroy"){if(chosen instanceof Chosen){chosen.destroy();}return;}if(!(chosen instanceof Chosen)){$this.data("chosen",new Chosen(this,options));}});}});Chosen=(function(_super){__extends(Chosen,_super);function Chosen(){_ref=Chosen.__super__.constructor.apply(this,arguments);return _ref;}Chosen.prototype.setup=function(){this.form_field_jq=$(this.form_field);this.current_selectedIndex=this.form_field.selectedIndex;return this.is_rtl=this.form_field_jq.hasClass("chosen-rtl");};Chosen.prototype.set_up_html=function(){var container_classes,container_props;container_classes=["chosen-container"];container_classes.push("chosen-container-"+(this.is_multiple?"multi":"single"));if(this.inherit_select_classes&&this.form_field.className){container_classes.push(this.form_field.className);}if(this.is_rtl){container_classes.push("chosen-rtl");}container_props={"class":container_classes.join(" "),"style":"width: "+(this.container_width())+";","title":this.form_field.title};if(this.form_field.id.length){container_props.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen";}this.container=$("<div />",container_props);if(this.is_multiple){this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>');}else{this.container.html('<a class="chosen-single chosen-default"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>');}this.form_field_jq.hide().after(this.container);this.dropdown=this.container.find("div.chosen-drop").first();this.search_field=this.container.find("input").first();this.search_results=this.container.find("ul.chosen-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();if(this.is_multiple){this.search_choices=this.container.find("ul.chosen-choices").first();this.search_container=this.container.find("li.search-field").first();}else{this.search_container=this.container.find("div.chosen-search").first();this.selected_item=this.container.find(".chosen-single").first();}this.results_build();this.set_tab_index();return this.set_label_behavior();};Chosen.prototype.on_ready=function(){return this.form_field_jq.trigger("chosen:ready",{chosen:this});};Chosen.prototype.register_observers=function(){var _this=this;this.container.bind("touchstart.chosen",function(evt){_this.container_mousedown(evt);return evt.preventDefault();});this.container.bind("touchend.chosen",function(evt){_this.container_mouseup(evt);return evt.preventDefault();});this.container.bind("mousedown.chosen",function(evt){_this.container_mousedown(evt);});this.container.bind("mouseup.chosen",function(evt){_this.container_mouseup(evt);});this.container.bind("mouseenter.chosen",function(evt){_this.mouse_enter(evt);});this.container.bind("mouseleave.chosen",function(evt){_this.mouse_leave(evt);});this.search_results.bind("mouseup.chosen",function(evt){_this.search_results_mouseup(evt);});this.search_results.bind("mouseover.chosen",function(evt){_this.search_results_mouseover(evt);});this.search_results.bind("mouseout.chosen",function(evt){_this.search_results_mouseout(evt);});this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(evt){_this.search_results_mousewheel(evt);});this.search_results.bind("touchstart.chosen",function(evt){_this.search_results_touchstart(evt);});this.search_results.bind("touchmove.chosen",function(evt){_this.search_results_touchmove(evt);});this.search_results.bind("touchend.chosen",function(evt){_this.search_results_touchend(evt);});this.form_field_jq.bind("chosen:updated.chosen",function(evt){_this.results_update_field(evt);});this.form_field_jq.bind("chosen:activate.chosen",function(evt){_this.activate_field(evt);});this.form_field_jq.bind("chosen:open.chosen",function(evt){_this.container_mousedown(evt);});this.form_field_jq.bind("chosen:close.chosen",function(evt){_this.input_blur(evt);});this.search_field.bind("blur.chosen",function(evt){_this.input_blur(evt);});this.search_field.bind("keyup.chosen",function(evt){_this.keyup_checker(evt);});this.search_field.bind("keydown.chosen",function(evt){_this.keydown_checker(evt);});this.search_field.bind("focus.chosen",function(evt){_this.input_focus(evt);});this.search_field.bind("cut.chosen",function(evt){_this.clipboard_event_checker(evt);});this.search_field.bind("paste.chosen",function(evt){_this.clipboard_event_checker(evt);});if(this.is_multiple){return this.search_choices.bind("click.chosen",function(evt){_this.choices_click(evt);});}else{return this.container.bind("click.chosen",function(evt){evt.preventDefault();});}};Chosen.prototype.destroy=function(){$(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action);if(this.search_field[0].tabIndex){this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex;}this.container.remove();this.form_field_jq.removeData("chosen");return this.form_field_jq.show();};Chosen.prototype.search_field_disabled=function(){this.is_disabled=this.form_field_jq[0].disabled;if(this.is_disabled){this.container.addClass("chosen-disabled");this.search_field[0].disabled=true;if(!this.is_multiple){this.selected_item.unbind("focus.chosen",this.activate_action);}return this.close_field();}else{this.container.removeClass("chosen-disabled");this.search_field[0].disabled=false;if(!this.is_multiple){return this.selected_item.bind("focus.chosen",this.activate_action);}}};Chosen.prototype.container_mousedown=function(evt){if(!this.is_disabled){if(evt&&evt.type==="mousedown"&&!this.results_showing){evt.preventDefault();}if(!((evt!=null)&&($(evt.target)).hasClass("search-choice-close"))){if(!this.active_field){if(this.is_multiple){this.search_field.val("");}$(this.container[0].ownerDocument).bind("click.chosen",this.click_test_action);this.results_show();}else{if(!this.is_multiple&&evt&&(($(evt.target)[0]===this.selected_item[0])||$(evt.target).parents("a.chosen-single").length)){evt.preventDefault();this.results_toggle();}}return this.activate_field();}}};Chosen.prototype.container_mouseup=function(evt){if(evt.target.nodeName==="ABBR"&&!this.is_disabled){return this.results_reset(evt);}};Chosen.prototype.search_results_mousewheel=function(evt){var delta;if(evt.originalEvent){delta=evt.originalEvent.deltaY||-evt.originalEvent.wheelDelta||evt.originalEvent.detail;}if(delta!=null){evt.preventDefault();if(evt.type==="DOMMouseScroll"){delta=delta*40;}return this.search_results.scrollTop(delta+this.search_results.scrollTop());}};Chosen.prototype.blur_test=function(evt){if(!this.active_field&&this.container.hasClass("chosen-container-active")){return this.close_field();}};Chosen.prototype.close_field=function(){$(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action);this.active_field=false;this.results_hide();this.container.removeClass("chosen-container-active");this.clear_backstroke();this.show_search_field_default();return this.search_field_scale();};Chosen.prototype.activate_field=function(){this.container.addClass("chosen-container-active");this.active_field=true;this.search_field.val(this.search_field.val());return this.search_field.focus();};Chosen.prototype.test_active_click=function(evt){var active_container;active_container=$(evt.target).closest(".chosen-container");if(active_container.length&&this.container[0]===active_container[0]){return this.active_field=true;}else{return this.close_field();}};Chosen.prototype.results_build=function(){this.parsing=true;this.selected_option_count=null;this.results_data=SelectParser.select_to_array(this.form_field);if(this.is_multiple){this.search_choices.find("li.search-choice").remove();}else{if(!this.is_multiple){this.single_set_selected_text();if(this.disable_search||this.form_field.options.length<=this.disable_search_threshold){this.search_field[0].readOnly=true;this.container.addClass("chosen-container-single-nosearch");}else{this.search_field[0].readOnly=false;this.container.removeClass("chosen-container-single-nosearch");}}}this.update_results_content(this.results_option_build({first:true}));this.search_field_disabled();this.show_search_field_default();this.search_field_scale();return this.parsing=false;};Chosen.prototype.result_do_highlight=function(el){var high_bottom,high_top,maxHeight,visible_bottom,visible_top;if(el.length){this.result_clear_highlight();this.result_highlight=el;this.result_highlight.addClass("highlighted");maxHeight=parseInt(this.search_results.css("maxHeight"),10);visible_top=this.search_results.scrollTop();visible_bottom=maxHeight+visible_top;high_top=this.result_highlight.position().top+this.search_results.scrollTop();high_bottom=high_top+this.result_highlight.outerHeight();if(high_bottom>=visible_bottom){return this.search_results.scrollTop((high_bottom-maxHeight)>0?high_bottom-maxHeight:0);}else{if(high_top<visible_top){return this.search_results.scrollTop(high_top);}}}};Chosen.prototype.result_clear_highlight=function(){if(this.result_highlight){this.result_highlight.removeClass("highlighted");}return this.result_highlight=null;};Chosen.prototype.results_show=function(){if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return false;}this.container.addClass("chosen-with-drop");this.results_showing=true;this.search_field.focus();this.search_field.val(this.search_field.val());this.winnow_results();return this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this});};Chosen.prototype.update_results_content=function(content){return this.search_results.html(content);};Chosen.prototype.results_hide=function(){if(this.results_showing){this.result_clear_highlight();this.container.removeClass("chosen-with-drop");this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this});}return this.results_showing=false;};Chosen.prototype.set_tab_index=function(el){var ti;if(this.form_field.tabIndex){ti=this.form_field.tabIndex;this.form_field.tabIndex=-1;return this.search_field[0].tabIndex=ti;}};Chosen.prototype.set_label_behavior=function(){var _this=this;this.form_field_label=this.form_field_jq.parents("label");if(!this.form_field_label.length&&this.form_field.id.length){this.form_field_label=$("label[for='"+this.form_field.id+"']");}if(this.form_field_label.length>0){return this.form_field_label.bind("click.chosen",function(evt){if(_this.is_multiple){return _this.container_mousedown(evt);}else{return _this.activate_field();}});}};Chosen.prototype.show_search_field_default=function(){if(this.is_multiple&&this.choices_count()<1&&!this.active_field){this.search_field.val(this.default_text);return this.search_field.addClass("default");}else{this.search_field.val("");return this.search_field.removeClass("default");}};Chosen.prototype.search_results_mouseup=function(evt){var target;target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();if(target.length){this.result_highlight=target;this.result_select(evt);return this.search_field.focus();}};Chosen.prototype.search_results_mouseover=function(evt){var target;target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();if(target){return this.result_do_highlight(target);}};Chosen.prototype.search_results_mouseout=function(evt){if($(evt.target).hasClass("active-result"||$(evt.target).parents(".active-result").first())){return this.result_clear_highlight();}};Chosen.prototype.choice_build=function(item){var choice,close_link,_this=this;choice=$("<li />",{"class":"search-choice"}).html("<span>"+(this.choice_label(item))+"</span>");if(item.disabled){choice.addClass("search-choice-disabled");}else{close_link=$("<a />",{"class":"search-choice-close","data-option-array-index":item.array_index});close_link.bind("click.chosen",function(evt){return _this.choice_destroy_link_click(evt);});choice.append(close_link);}return this.search_container.before(choice);};Chosen.prototype.choice_destroy_link_click=function(evt){evt.preventDefault();evt.stopPropagation();if(!this.is_disabled){return this.choice_destroy($(evt.target));}};Chosen.prototype.choice_destroy=function(link){if(this.result_deselect(link[0].getAttribute("data-option-array-index"))){this.show_search_field_default();if(this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1){this.results_hide();}link.parents("li").first().remove();return this.search_field_scale();}};Chosen.prototype.results_reset=function(){this.reset_single_select_options();this.form_field.options[0].selected=true;this.single_set_selected_text();this.show_search_field_default();this.results_reset_cleanup();this.form_field_jq.trigger("change");if(this.active_field){return this.results_hide();}};Chosen.prototype.results_reset_cleanup=function(){this.current_selectedIndex=this.form_field.selectedIndex;return this.selected_item.find("abbr").remove();};Chosen.prototype.result_select=function(evt){var high,item;if(this.result_highlight){high=this.result_highlight;this.result_clear_highlight();if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return false;}if(this.is_multiple){high.removeClass("active-result");}else{this.reset_single_select_options();}high.addClass("result-selected");item=this.results_data[high[0].getAttribute("data-option-array-index")];item.selected=true;this.form_field.options[item.options_index].selected=true;this.selected_option_count=null;if(this.is_multiple){this.choice_build(item);}else{this.single_set_selected_text(this.choice_label(item));}if(!((evt.metaKey||evt.ctrlKey)&&this.is_multiple)){this.results_hide();}this.show_search_field_default();if(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex){this.form_field_jq.trigger("change",{"selected":this.form_field.options[item.options_index].value});}this.current_selectedIndex=this.form_field.selectedIndex;evt.preventDefault();return this.search_field_scale();}};Chosen.prototype.single_set_selected_text=function(text){if(text==null){text=this.default_text;}if(text===this.default_text){this.selected_item.addClass("chosen-default");}else{this.single_deselect_control_build();this.selected_item.removeClass("chosen-default");}return this.selected_item.find("span").html(text);};Chosen.prototype.result_deselect=function(pos){var result_data;result_data=this.results_data[pos];if(!this.form_field.options[result_data.options_index].disabled){result_data.selected=false;this.form_field.options[result_data.options_index].selected=false;this.selected_option_count=null;this.result_clear_highlight();if(this.results_showing){this.winnow_results();}this.form_field_jq.trigger("change",{deselected:this.form_field.options[result_data.options_index].value});this.search_field_scale();return true;}else{return false;}};Chosen.prototype.single_deselect_control_build=function(){if(!this.allow_single_deselect){return;}if(!this.selected_item.find("abbr").length){this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>');}return this.selected_item.addClass("chosen-single-with-deselect");};Chosen.prototype.get_search_text=function(){return $("<div/>").text($.trim(this.search_field.val())).html();};Chosen.prototype.winnow_results_set_highlight=function(){var do_high,selected_results;selected_results=!this.is_multiple?this.search_results.find(".result-selected.active-result"):[];do_high=selected_results.length?selected_results.first():this.search_results.find(".active-result").first();if(do_high!=null){return this.result_do_highlight(do_high);}};Chosen.prototype.no_results=function(terms){var no_results_html;no_results_html=$('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');no_results_html.find("span").first().html(terms);this.search_results.append(no_results_html);return this.form_field_jq.trigger("chosen:no_results",{chosen:this});};Chosen.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove();};Chosen.prototype.keydown_arrow=function(){var next_sib;if(this.results_showing&&this.result_highlight){next_sib=this.result_highlight.nextAll("li.active-result").first();if(next_sib){return this.result_do_highlight(next_sib);}}else{return this.results_show();}};Chosen.prototype.keyup_arrow=function(){var prev_sibs;if(!this.results_showing&&!this.is_multiple){return this.results_show();}else{if(this.result_highlight){prev_sibs=this.result_highlight.prevAll("li.active-result");if(prev_sibs.length){return this.result_do_highlight(prev_sibs.first());}else{if(this.choices_count()>0){this.results_hide();}return this.result_clear_highlight();}}}};Chosen.prototype.keydown_backstroke=function(){var next_available_destroy;if(this.pending_backstroke){this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke();}else{next_available_destroy=this.search_container.siblings("li.search-choice").last();if(next_available_destroy.length&&!next_available_destroy.hasClass("search-choice-disabled")){this.pending_backstroke=next_available_destroy;if(this.single_backstroke_delete){return this.keydown_backstroke();}else{return this.pending_backstroke.addClass("search-choice-focus");}}}};Chosen.prototype.clear_backstroke=function(){if(this.pending_backstroke){this.pending_backstroke.removeClass("search-choice-focus");}return this.pending_backstroke=null;};Chosen.prototype.keydown_checker=function(evt){var stroke,_ref1;stroke=(_ref1=evt.which)!=null?_ref1:evt.keyCode;this.search_field_scale();if(stroke!==8&&this.pending_backstroke){this.clear_backstroke();}switch(stroke){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:if(this.results_showing&&!this.is_multiple){this.result_select(evt);}this.mouse_on_container=false;break;case 13:if(this.results_showing){evt.preventDefault();}break;case 32:if(this.disable_search){evt.preventDefault();}break;case 38:evt.preventDefault();this.keyup_arrow();break;case 40:evt.preventDefault();this.keydown_arrow();break;}};Chosen.prototype.search_field_scale=function(){var div,f_width,h,style,style_block,styles,w,_i,_len;if(this.is_multiple){h=0;w=0;style_block="position:absolute; left: -1000px; top: -1000px; display:none;";styles=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];for(_i=0,_len=styles.length;_i<_len;_i++){style=styles[_i];style_block+=style+":"+this.search_field.css(style)+";";}div=$("<div />",{"style":style_block});div.text(this.search_field.val());$("body").append(div);w=div.width()+25;div.remove();f_width=this.container.outerWidth();if(w>f_width-10){w=f_width-10;}return this.search_field.css({"width":w+"px"});}};return Chosen;})(AbstractChosen);}).call(this);/*
 * Select2 4.0.13
 * https://select2.github.io
 *
 * Released under the MIT license
 * https://github.com/select2/select2/blob/master/LICENSE.md
 */
(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{if(typeof module==="object"&&module.exports){module.exports=function(root,jQuery){if(jQuery===undefined){if(typeof window!=="undefined"){jQuery=require("jquery");}else{jQuery=require("jquery")(root);}}factory(jQuery);return jQuery;};}else{factory(jQuery);}}}(function(jQuery){var S2=(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd){var S2=jQuery.fn.select2.amd;}var S2;(function(){if(!S2||!S2.requirejs){if(!S2){S2={};}else{require=S2;}var requirejs,require,define;(function(undef){var main,req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice,jsSuffixRegExp=/\.js$/;function hasProp(obj,prop){return hasOwn.call(obj,prop);}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,lastIndex,foundI,foundStarMap,starI,i,j,part,normalizedBaseParts,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=(map&&map["*"])||{};if(name){name=name.split("/");lastIndex=name.length-1;if(config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])){name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"");}if(name[0].charAt(0)==="."&&baseParts){normalizedBaseParts=baseParts.slice(0,baseParts.length-1);name=normalizedBaseParts.concat(name);}for(i=0;i<name.length;i++){part=name[i];if(part==="."){name.splice(i,1);i-=1;}else{if(part===".."){if(i===0||(i===1&&name[2]==="..")||name[i-1]===".."){continue;}else{if(i>0){name.splice(i-1,2);i-=2;}}}}}name=name.join("/");}if((baseParts||starMap)&&map){nameParts=name.split("/");for(i=nameParts.length;i>0;i-=1){nameSegment=nameParts.slice(0,i).join("/");if(baseParts){for(j=baseParts.length;j>0;j-=1){mapValue=map[baseParts.slice(0,j).join("/")];if(mapValue){mapValue=mapValue[nameSegment];if(mapValue){foundMap=mapValue;foundI=i;break;}}}}if(foundMap){break;}if(!foundStarMap&&starMap&&starMap[nameSegment]){foundStarMap=starMap[nameSegment];starI=i;}}if(!foundMap&&foundStarMap){foundMap=foundStarMap;foundI=starI;}if(foundMap){nameParts.splice(0,foundI,foundMap);name=nameParts.join("/");}}return name;}function makeRequire(relName,forceSync){return function(){var args=aps.call(arguments,0);if(typeof args[0]!=="string"&&args.length===1){args.push(null);}return req.apply(undef,args.concat([relName,forceSync]));};}function makeNormalize(relName){return function(name){return normalize(name,relName);};}function makeLoad(depName){return function(value){defined[depName]=value;};}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name];defining[name]=true;main.apply(undef,args);}if(!hasProp(defined,name)&&!hasProp(defining,name)){throw new Error("No "+name);}return defined[name];}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;if(index>-1){prefix=name.substring(0,index);name=name.substring(index+1,name.length);}return[prefix,name];}function makeRelParts(relName){return relName?splitPrefix(relName):[];}makeMap=function(name,relParts){var plugin,parts=splitPrefix(name),prefix=parts[0],relResourceName=relParts[1];name=parts[1];if(prefix){prefix=normalize(prefix,relResourceName);plugin=callDep(prefix);}if(prefix){if(plugin&&plugin.normalize){name=plugin.normalize(name,makeNormalize(relResourceName));}else{name=normalize(name,relResourceName);}}else{name=normalize(name,relResourceName);parts=splitPrefix(name);prefix=parts[0];name=parts[1];if(prefix){plugin=callDep(prefix);}}return{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin};};function makeConfig(name){return function(){return(config&&config.config&&config.config[name])||{};};}handlers={require:function(name){return makeRequire(name);},exports:function(name){var e=defined[name];if(typeof e!=="undefined"){return e;}else{return(defined[name]={});}},module:function(name){return{id:name,uri:"",exports:defined[name],config:makeConfig(name)};}};main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,relParts,args=[],callbackType=typeof callback,usingExports;relName=relName||name;relParts=makeRelParts(relName);if(callbackType==="undefined"||callbackType==="function"){deps=!deps.length&&callback.length?["require","exports","module"]:deps;for(i=0;i<deps.length;i+=1){map=makeMap(deps[i],relParts);depName=map.f;if(depName==="require"){args[i]=handlers.require(name);}else{if(depName==="exports"){args[i]=handlers.exports(name);usingExports=true;}else{if(depName==="module"){cjsModule=args[i]=handlers.module(name);}else{if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName)){args[i]=callDep(depName);}else{if(map.p){map.p.load(map.n,makeRequire(relName,true),makeLoad(depName),{});args[i]=defined[depName];}else{throw new Error(name+" missing "+depName);}}}}}}ret=callback?callback.apply(defined[name],args):undefined;if(name){if(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name]){defined[name]=cjsModule.exports;}else{if(ret!==undef||!usingExports){defined[name]=ret;}}}}else{if(name){defined[name]=callback;}}};requirejs=require=req=function(deps,callback,relName,forceSync,alt){if(typeof deps==="string"){if(handlers[deps]){return handlers[deps](callback);}return callDep(makeMap(deps,makeRelParts(callback)).f);}else{if(!deps.splice){config=deps;if(config.deps){req(config.deps,config.callback);}if(!callback){return;}if(callback.splice){deps=callback;callback=relName;relName=null;}else{deps=undef;}}}callback=callback||function(){};if(typeof relName==="function"){relName=forceSync;forceSync=alt;}if(forceSync){main(undef,deps,callback,relName);}else{setTimeout(function(){main(undef,deps,callback,relName);},4);}return req;};req.config=function(cfg){return req(cfg);};requirejs._defined=defined;define=function(name,deps,callback){if(typeof name!=="string"){throw new Error("See almond README: incorrect module build, no module name");}if(!deps.splice){callback=deps;deps=[];}if(!hasProp(defined,name)&&!hasProp(waiting,name)){waiting[name]=[name,deps,callback];}};define.amd={jQuery:true};}());S2.requirejs=requirejs;S2.require=require;S2.define=define;}}());S2.define("almond",function(){});S2.define("jquery",[],function(){var _$=jQuery||$;if(_$==null&&console&&console.error){console.error("Select2: An instance of jQuery or a jQuery-compatible library was not "+"found. Make sure that you are including jQuery before Select2 on your "+"web page.");}return _$;});S2.define("select2/utils",["jquery"],function($){var Utils={};Utils.Extend=function(ChildClass,SuperClass){var __hasProp={}.hasOwnProperty;function BaseConstructor(){this.constructor=ChildClass;}for(var key in SuperClass){if(__hasProp.call(SuperClass,key)){ChildClass[key]=SuperClass[key];}}BaseConstructor.prototype=SuperClass.prototype;ChildClass.prototype=new BaseConstructor();ChildClass.__super__=SuperClass.prototype;return ChildClass;};function getMethods(theClass){var proto=theClass.prototype;var methods=[];for(var methodName in proto){var m=proto[methodName];if(typeof m!=="function"){continue;}if(methodName==="constructor"){continue;}methods.push(methodName);}return methods;}Utils.Decorate=function(SuperClass,DecoratorClass){var decoratedMethods=getMethods(DecoratorClass);var superMethods=getMethods(SuperClass);function DecoratedClass(){var unshift=Array.prototype.unshift;var argCount=DecoratorClass.prototype.constructor.length;var calledConstructor=SuperClass.prototype.constructor;if(argCount>0){unshift.call(arguments,SuperClass.prototype.constructor);calledConstructor=DecoratorClass.prototype.constructor;}calledConstructor.apply(this,arguments);}DecoratorClass.displayName=SuperClass.displayName;function ctr(){this.constructor=DecoratedClass;}DecoratedClass.prototype=new ctr();for(var m=0;m<superMethods.length;m++){var superMethod=superMethods[m];DecoratedClass.prototype[superMethod]=SuperClass.prototype[superMethod];}var calledMethod=function(methodName){var originalMethod=function(){};if(methodName in DecoratedClass.prototype){originalMethod=DecoratedClass.prototype[methodName];}var decoratedMethod=DecoratorClass.prototype[methodName];return function(){var unshift=Array.prototype.unshift;unshift.call(arguments,originalMethod);return decoratedMethod.apply(this,arguments);};};for(var d=0;d<decoratedMethods.length;d++){var decoratedMethod=decoratedMethods[d];DecoratedClass.prototype[decoratedMethod]=calledMethod(decoratedMethod);}return DecoratedClass;};var Observable=function(){this.listeners={};};Observable.prototype.on=function(event,callback){this.listeners=this.listeners||{};if(event in this.listeners){this.listeners[event].push(callback);}else{this.listeners[event]=[callback];}};Observable.prototype.trigger=function(event){var slice=Array.prototype.slice;var params=slice.call(arguments,1);this.listeners=this.listeners||{};if(params==null){params=[];}if(params.length===0){params.push({});}params[0]._type=event;if(event in this.listeners){this.invoke(this.listeners[event],slice.call(arguments,1));}if("*" in this.listeners){this.invoke(this.listeners["*"],arguments);}};Observable.prototype.invoke=function(listeners,params){for(var i=0,len=listeners.length;i<len;i++){listeners[i].apply(this,params);}};Utils.Observable=Observable;Utils.generateChars=function(length){var chars="";for(var i=0;i<length;i++){var randomChar=Math.floor(Math.random()*36);chars+=randomChar.toString(36);}return chars;};Utils.bind=function(func,context){return function(){func.apply(context,arguments);};};Utils._convertData=function(data){for(var originalKey in data){var keys=originalKey.split("-");var dataLevel=data;if(keys.length===1){continue;}for(var k=0;k<keys.length;k++){var key=keys[k];key=key.substring(0,1).toLowerCase()+key.substring(1);if(!(key in dataLevel)){dataLevel[key]={};}if(k==keys.length-1){dataLevel[key]=data[originalKey];}dataLevel=dataLevel[key];}delete data[originalKey];}return data;};Utils.hasScroll=function(index,el){var $el=$(el);var overflowX=el.style.overflowX;var overflowY=el.style.overflowY;if(overflowX===overflowY&&(overflowY==="hidden"||overflowY==="visible")){return false;}if(overflowX==="scroll"||overflowY==="scroll"){return true;}return($el.innerHeight()<el.scrollHeight||$el.innerWidth()<el.scrollWidth);};Utils.escapeMarkup=function(markup){var replaceMap={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};if(typeof markup!=="string"){return markup;}return String(markup).replace(/[&<>"'\/\\]/g,function(match){return replaceMap[match];});};Utils.appendMany=function($element,$nodes){if($.fn.jquery.substr(0,3)==="1.7"){var $jqNodes=$();$.map($nodes,function(node){$jqNodes=$jqNodes.add(node);});$nodes=$jqNodes;}$element.append($nodes);};Utils.__cache={};var id=0;Utils.GetUniqueElementId=function(element){var select2Id=element.getAttribute("data-select2-id");if(select2Id==null){if(element.id){select2Id=element.id;element.setAttribute("data-select2-id",select2Id);}else{element.setAttribute("data-select2-id",++id);select2Id=id.toString();}}return select2Id;};Utils.StoreData=function(element,name,value){var id=Utils.GetUniqueElementId(element);if(!Utils.__cache[id]){Utils.__cache[id]={};}Utils.__cache[id][name]=value;};Utils.GetData=function(element,name){var id=Utils.GetUniqueElementId(element);if(name){if(Utils.__cache[id]){if(Utils.__cache[id][name]!=null){return Utils.__cache[id][name];}return $(element).data(name);}return $(element).data(name);}else{return Utils.__cache[id];}};Utils.RemoveData=function(element){var id=Utils.GetUniqueElementId(element);if(Utils.__cache[id]!=null){delete Utils.__cache[id];}element.removeAttribute("data-select2-id");};return Utils;});S2.define("select2/results",["jquery","./utils"],function($,Utils){function Results($element,options,dataAdapter){this.$element=$element;this.data=dataAdapter;this.options=options;Results.__super__.constructor.call(this);}Utils.Extend(Results,Utils.Observable);Results.prototype.render=function(){var $results=$('<ul class="select2-results__options" role="listbox"></ul>');if(this.options.get("multiple")){$results.attr("aria-multiselectable","true");}this.$results=$results;return $results;};Results.prototype.clear=function(){this.$results.empty();};Results.prototype.displayMessage=function(params){var escapeMarkup=this.options.get("escapeMarkup");this.clear();this.hideLoading();var $message=$('<li role="alert" aria-live="assertive"'+' class="select2-results__option"></li>');var message=this.options.get("translations").get(params.message);$message.append(escapeMarkup(message(params.args)));$message[0].className+=" select2-results__message";this.$results.append($message);};Results.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove();};Results.prototype.append=function(data){this.hideLoading();var $options=[];if(data.results==null||data.results.length===0){if(this.$results.children().length===0){this.trigger("results:message",{message:"noResults"});}return;}data.results=this.sort(data.results);for(var d=0;d<data.results.length;d++){var item=data.results[d];var $option=this.option(item);$options.push($option);}this.$results.append($options);};Results.prototype.position=function($results,$dropdown){var $resultsContainer=$dropdown.find(".select2-results");$resultsContainer.append($results);};Results.prototype.sort=function(data){var sorter=this.options.get("sorter");return sorter(data);};Results.prototype.highlightFirstItem=function(){var $options=this.$results.find(".select2-results__option[aria-selected]");var $selected=$options.filter("[aria-selected=true]");if($selected.length>0){$selected.first().trigger("mouseenter");}else{$options.first().trigger("mouseenter");}this.ensureHighlightVisible();};Results.prototype.setClasses=function(){var self=this;this.data.current(function(selected){var selectedIds=$.map(selected,function(s){return s.id.toString();});var $options=self.$results.find(".select2-results__option[aria-selected]");$options.each(function(){var $option=$(this);var item=Utils.GetData(this,"data");var id=""+item.id;if((item.element!=null&&item.element.selected)||(item.element==null&&$.inArray(id,selectedIds)>-1)){$option.attr("aria-selected","true");}else{$option.attr("aria-selected","false");}});});};Results.prototype.showLoading=function(params){this.hideLoading();var loadingMore=this.options.get("translations").get("searching");var loading={disabled:true,loading:true,text:loadingMore(params)};var $loading=this.option(loading);$loading.className+=" loading-results";this.$results.prepend($loading);};Results.prototype.hideLoading=function(){this.$results.find(".loading-results").remove();};Results.prototype.option=function(data){var option=document.createElement("li");option.className="select2-results__option";var attrs={"role":"option","aria-selected":"false"};var matches=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;if((data.element!=null&&matches.call(data.element,":disabled"))||(data.element==null&&data.disabled)){delete attrs["aria-selected"];attrs["aria-disabled"]="true";}if(data.id==null){delete attrs["aria-selected"];}if(data._resultId!=null){option.id=data._resultId;}if(data.title){option.title=data.title;}if(data.children){attrs.role="group";attrs["aria-label"]=data.text;delete attrs["aria-selected"];}for(var attr in attrs){var val=attrs[attr];option.setAttribute(attr,val);}if(data.children){var $option=$(option);var label=document.createElement("strong");label.className="select2-results__group";var $label=$(label);this.template(data,label);var $children=[];for(var c=0;c<data.children.length;c++){var child=data.children[c];var $child=this.option(child);$children.push($child);}var $childrenContainer=$("<ul></ul>",{"class":"select2-results__options select2-results__options--nested"});$childrenContainer.append($children);$option.append(label);$option.append($childrenContainer);}else{this.template(data,option);}Utils.StoreData(option,"data",data);return option;};Results.prototype.bind=function(container,$container){var self=this;var id=container.id+"-results";this.$results.attr("id",id);container.on("results:all",function(params){self.clear();self.append(params.data);if(container.isOpen()){self.setClasses();self.highlightFirstItem();}});container.on("results:append",function(params){self.append(params.data);if(container.isOpen()){self.setClasses();}});container.on("query",function(params){self.hideMessages();self.showLoading(params);});container.on("select",function(){if(!container.isOpen()){return;}self.setClasses();if(self.options.get("scrollAfterSelect")){self.highlightFirstItem();}});container.on("unselect",function(){if(!container.isOpen()){return;}self.setClasses();if(self.options.get("scrollAfterSelect")){self.highlightFirstItem();}});container.on("open",function(){self.$results.attr("aria-expanded","true");self.$results.attr("aria-hidden","false");self.setClasses();self.ensureHighlightVisible();});container.on("close",function(){self.$results.attr("aria-expanded","false");self.$results.attr("aria-hidden","true");self.$results.removeAttr("aria-activedescendant");});container.on("results:toggle",function(){var $highlighted=self.getHighlightedResults();if($highlighted.length===0){return;}$highlighted.trigger("mouseup");});container.on("results:select",function(){var $highlighted=self.getHighlightedResults();if($highlighted.length===0){return;}var data=Utils.GetData($highlighted[0],"data");if($highlighted.attr("aria-selected")=="true"){self.trigger("close",{});}else{self.trigger("select",{data:data});}});container.on("results:previous",function(){var $highlighted=self.getHighlightedResults();var $options=self.$results.find("[aria-selected]");var currentIndex=$options.index($highlighted);if(currentIndex<=0){return;}var nextIndex=currentIndex-1;if($highlighted.length===0){nextIndex=0;}var $next=$options.eq(nextIndex);$next.trigger("mouseenter");var currentOffset=self.$results.offset().top;var nextTop=$next.offset().top;var nextOffset=self.$results.scrollTop()+(nextTop-currentOffset);if(nextIndex===0){self.$results.scrollTop(0);}else{if(nextTop-currentOffset<0){self.$results.scrollTop(nextOffset);}}});container.on("results:next",function(){var $highlighted=self.getHighlightedResults();var $options=self.$results.find("[aria-selected]");var currentIndex=$options.index($highlighted);var nextIndex=currentIndex+1;if(nextIndex>=$options.length){return;}var $next=$options.eq(nextIndex);$next.trigger("mouseenter");var currentOffset=self.$results.offset().top+self.$results.outerHeight(false);var nextBottom=$next.offset().top+$next.outerHeight(false);var nextOffset=self.$results.scrollTop()+nextBottom-currentOffset;if(nextIndex===0){self.$results.scrollTop(0);}else{if(nextBottom>currentOffset){self.$results.scrollTop(nextOffset);}}});container.on("results:focus",function(params){params.element.addClass("select2-results__option--highlighted");});container.on("results:message",function(params){self.displayMessage(params);});if($.fn.mousewheel){this.$results.on("mousewheel",function(e){var top=self.$results.scrollTop();var bottom=self.$results.get(0).scrollHeight-top+e.deltaY;var isAtTop=e.deltaY>0&&top-e.deltaY<=0;var isAtBottom=e.deltaY<0&&bottom<=self.$results.height();if(isAtTop){self.$results.scrollTop(0);e.preventDefault();e.stopPropagation();}else{if(isAtBottom){self.$results.scrollTop(self.$results.get(0).scrollHeight-self.$results.height());e.preventDefault();e.stopPropagation();}}});}this.$results.on("mouseup",".select2-results__option[aria-selected]",function(evt){var $this=$(this);var data=Utils.GetData(this,"data");if($this.attr("aria-selected")==="true"){if(self.options.get("multiple")){self.trigger("unselect",{originalEvent:evt,data:data});}else{self.trigger("close",{});}return;}self.trigger("select",{originalEvent:evt,data:data});});this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(evt){var data=Utils.GetData(this,"data");self.getHighlightedResults().removeClass("select2-results__option--highlighted");self.trigger("results:focus",{data:data,element:$(this)});});};Results.prototype.getHighlightedResults=function(){var $highlighted=this.$results.find(".select2-results__option--highlighted");return $highlighted;};Results.prototype.destroy=function(){this.$results.remove();};Results.prototype.ensureHighlightVisible=function(){var $highlighted=this.getHighlightedResults();if($highlighted.length===0){return;}var $options=this.$results.find("[aria-selected]");var currentIndex=$options.index($highlighted);var currentOffset=this.$results.offset().top;var nextTop=$highlighted.offset().top;var nextOffset=this.$results.scrollTop()+(nextTop-currentOffset);var offsetDelta=nextTop-currentOffset;nextOffset-=$highlighted.outerHeight(false)*2;if(currentIndex<=2){this.$results.scrollTop(0);}else{if(offsetDelta>this.$results.outerHeight()||offsetDelta<0){this.$results.scrollTop(nextOffset);}}};Results.prototype.template=function(result,container){var template=this.options.get("templateResult");var escapeMarkup=this.options.get("escapeMarkup");var content=template(result,container);if(content==null){container.style.display="none";}else{if(typeof content==="string"){container.innerHTML=escapeMarkup(content);}else{$(container).append(content);}}};return Results;});S2.define("select2/keys",[],function(){var KEYS={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return KEYS;});S2.define("select2/selection/base",["jquery","../utils","../keys"],function($,Utils,KEYS){function BaseSelection($element,options){this.$element=$element;this.options=options;BaseSelection.__super__.constructor.call(this);}Utils.Extend(BaseSelection,Utils.Observable);BaseSelection.prototype.render=function(){var $selection=$('<span class="select2-selection" role="combobox" '+' aria-haspopup="true" aria-expanded="false">'+"</span>");this._tabindex=0;if(Utils.GetData(this.$element[0],"old-tabindex")!=null){this._tabindex=Utils.GetData(this.$element[0],"old-tabindex");}else{if(this.$element.attr("tabindex")!=null){this._tabindex=this.$element.attr("tabindex");}}$selection.attr("title",this.$element.attr("title"));$selection.attr("tabindex",this._tabindex);$selection.attr("aria-disabled","false");this.$selection=$selection;return $selection;};BaseSelection.prototype.bind=function(container,$container){var self=this;var resultsId=container.id+"-results";this.container=container;this.$selection.on("focus",function(evt){self.trigger("focus",evt);});this.$selection.on("blur",function(evt){self._handleBlur(evt);});this.$selection.on("keydown",function(evt){self.trigger("keypress",evt);if(evt.which===KEYS.SPACE){evt.preventDefault();}});container.on("results:focus",function(params){self.$selection.attr("aria-activedescendant",params.data._resultId);});container.on("selection:update",function(params){self.update(params.data);});container.on("open",function(){self.$selection.attr("aria-expanded","true");self.$selection.attr("aria-owns",resultsId);self._attachCloseHandler(container);});container.on("close",function(){self.$selection.attr("aria-expanded","false");self.$selection.removeAttr("aria-activedescendant");self.$selection.removeAttr("aria-owns");self.$selection.trigger("focus");self._detachCloseHandler(container);});container.on("enable",function(){self.$selection.attr("tabindex",self._tabindex);self.$selection.attr("aria-disabled","false");});container.on("disable",function(){self.$selection.attr("tabindex","-1");self.$selection.attr("aria-disabled","true");});};BaseSelection.prototype._handleBlur=function(evt){var self=this;window.setTimeout(function(){if((document.activeElement==self.$selection[0])||($.contains(self.$selection[0],document.activeElement))){return;}self.trigger("blur",evt);},1);};BaseSelection.prototype._attachCloseHandler=function(container){$(document.body).on("mousedown.select2."+container.id,function(e){var $target=$(e.target);var $select=$target.closest(".select2");var $all=$(".select2.select2-container--open");$all.each(function(){if(this==$select[0]){return;}var $element=Utils.GetData(this,"element");$element.select2("close");});});};BaseSelection.prototype._detachCloseHandler=function(container){$(document.body).off("mousedown.select2."+container.id);};BaseSelection.prototype.position=function($selection,$container){var $selectionContainer=$container.find(".selection");$selectionContainer.append($selection);};BaseSelection.prototype.destroy=function(){this._detachCloseHandler(this.container);};BaseSelection.prototype.update=function(data){throw new Error("The `update` method must be defined in child classes.");};BaseSelection.prototype.isEnabled=function(){return !this.isDisabled();};BaseSelection.prototype.isDisabled=function(){return this.options.get("disabled");};return BaseSelection;});S2.define("select2/selection/single",["jquery","./base","../utils","../keys"],function($,BaseSelection,Utils,KEYS){function SingleSelection(){SingleSelection.__super__.constructor.apply(this,arguments);}Utils.Extend(SingleSelection,BaseSelection);SingleSelection.prototype.render=function(){var $selection=SingleSelection.__super__.render.call(this);$selection.addClass("select2-selection--single");$selection.html('<span class="select2-selection__rendered"></span>'+'<span class="select2-selection__arrow" role="presentation">'+'<b role="presentation"></b>'+"</span>");return $selection;};SingleSelection.prototype.bind=function(container,$container){var self=this;SingleSelection.__super__.bind.apply(this,arguments);var id=container.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",id).attr("role","textbox").attr("aria-readonly","true");this.$selection.attr("aria-labelledby",id);this.$selection.on("mousedown",function(evt){if(evt.which!==1){return;}self.trigger("toggle",{originalEvent:evt});});this.$selection.on("focus",function(evt){});this.$selection.on("blur",function(evt){});container.on("focus",function(evt){if(!container.isOpen()){self.$selection.trigger("focus");}});};SingleSelection.prototype.clear=function(){var $rendered=this.$selection.find(".select2-selection__rendered");$rendered.empty();$rendered.removeAttr("title");};SingleSelection.prototype.display=function(data,container){var template=this.options.get("templateSelection");var escapeMarkup=this.options.get("escapeMarkup");return escapeMarkup(template(data,container));};SingleSelection.prototype.selectionContainer=function(){return $("<span></span>");};SingleSelection.prototype.update=function(data){if(data.length===0){this.clear();return;}var selection=data[0];var $rendered=this.$selection.find(".select2-selection__rendered");var formatted=this.display(selection,$rendered);$rendered.empty().append(formatted);var title=selection.title||selection.text;if(title){$rendered.attr("title",title);}else{$rendered.removeAttr("title");}};return SingleSelection;});S2.define("select2/selection/multiple",["jquery","./base","../utils"],function($,BaseSelection,Utils){function MultipleSelection($element,options){MultipleSelection.__super__.constructor.apply(this,arguments);}Utils.Extend(MultipleSelection,BaseSelection);MultipleSelection.prototype.render=function(){var $selection=MultipleSelection.__super__.render.call(this);$selection.addClass("select2-selection--multiple");$selection.html('<ul class="select2-selection__rendered"></ul>');return $selection;};MultipleSelection.prototype.bind=function(container,$container){var self=this;MultipleSelection.__super__.bind.apply(this,arguments);this.$selection.on("click",function(evt){self.trigger("toggle",{originalEvent:evt});});this.$selection.on("click",".select2-selection__choice__remove",function(evt){if(self.isDisabled()){return;}var $remove=$(this);var $selection=$remove.parent();var data=Utils.GetData($selection[0],"data");self.trigger("unselect",{originalEvent:evt,data:data});});};MultipleSelection.prototype.clear=function(){var $rendered=this.$selection.find(".select2-selection__rendered");$rendered.empty();$rendered.removeAttr("title");};MultipleSelection.prototype.display=function(data,container){var template=this.options.get("templateSelection");var escapeMarkup=this.options.get("escapeMarkup");return escapeMarkup(template(data,container));};MultipleSelection.prototype.selectionContainer=function(){var $container=$('<li class="select2-selection__choice">'+'<span class="select2-selection__choice__remove" role="presentation">'+"&times;"+"</span>"+"</li>");return $container;};MultipleSelection.prototype.update=function(data){this.clear();if(data.length===0){return;}var $selections=[];for(var d=0;d<data.length;d++){var selection=data[d];var $selection=this.selectionContainer();var formatted=this.display(selection,$selection);$selection.append(formatted);var title=selection.title||selection.text;if(title){$selection.attr("title",title);}Utils.StoreData($selection[0],"data",selection);$selections.push($selection);}var $rendered=this.$selection.find(".select2-selection__rendered");Utils.appendMany($rendered,$selections);};return MultipleSelection;});S2.define("select2/selection/placeholder",["../utils"],function(Utils){function Placeholder(decorated,$element,options){this.placeholder=this.normalizePlaceholder(options.get("placeholder"));decorated.call(this,$element,options);}Placeholder.prototype.normalizePlaceholder=function(_,placeholder){if(typeof placeholder==="string"){placeholder={id:"",text:placeholder};}return placeholder;};Placeholder.prototype.createPlaceholder=function(decorated,placeholder){var $placeholder=this.selectionContainer();$placeholder.html(this.display(placeholder));$placeholder.addClass("select2-selection__placeholder").removeClass("select2-selection__choice");return $placeholder;};Placeholder.prototype.update=function(decorated,data){var singlePlaceholder=(data.length==1&&data[0].id!=this.placeholder.id);var multipleSelections=data.length>1;if(multipleSelections||singlePlaceholder){return decorated.call(this,data);}this.clear();var $placeholder=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append($placeholder);};return Placeholder;});S2.define("select2/selection/allowClear",["jquery","../keys","../utils"],function($,KEYS,Utils){function AllowClear(){}AllowClear.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);if(this.placeholder==null){if(this.options.get("debug")&&window.console&&console.error){console.error("Select2: The `allowClear` option should be used in combination "+"with the `placeholder` option.");}}this.$selection.on("mousedown",".select2-selection__clear",function(evt){self._handleClear(evt);});container.on("keypress",function(evt){self._handleKeyboardClear(evt,container);});};AllowClear.prototype._handleClear=function(_,evt){if(this.isDisabled()){return;}var $clear=this.$selection.find(".select2-selection__clear");if($clear.length===0){return;}evt.stopPropagation();var data=Utils.GetData($clear[0],"data");var previousVal=this.$element.val();this.$element.val(this.placeholder.id);var unselectData={data:data};this.trigger("clear",unselectData);if(unselectData.prevented){this.$element.val(previousVal);return;}for(var d=0;d<data.length;d++){unselectData={data:data[d]};this.trigger("unselect",unselectData);if(unselectData.prevented){this.$element.val(previousVal);return;}}this.$element.trigger("input").trigger("change");this.trigger("toggle",{});};AllowClear.prototype._handleKeyboardClear=function(_,evt,container){if(container.isOpen()){return;}if(evt.which==KEYS.DELETE||evt.which==KEYS.BACKSPACE){this._handleClear(evt);}};AllowClear.prototype.update=function(decorated,data){decorated.call(this,data);if(this.$selection.find(".select2-selection__placeholder").length>0||data.length===0){return;}var removeAll=this.options.get("translations").get("removeAllItems");var $remove=$('<span class="select2-selection__clear" title="'+removeAll()+'">'+"&times;"+"</span>");Utils.StoreData($remove[0],"data",data);this.$selection.find(".select2-selection__rendered").prepend($remove);};return AllowClear;});S2.define("select2/selection/search",["jquery","../utils","../keys"],function($,Utils,KEYS){function Search(decorated,$element,options){decorated.call(this,$element,options);}Search.prototype.render=function(decorated){var $search=$('<li class="select2-search select2-search--inline">'+'<input class="select2-search__field" type="search" tabindex="-1"'+' autocomplete="off" autocorrect="off" autocapitalize="none"'+' spellcheck="false" role="searchbox" aria-autocomplete="list" />'+"</li>");this.$searchContainer=$search;this.$search=$search.find("input");var $rendered=decorated.call(this);this._transferTabIndex();return $rendered;};Search.prototype.bind=function(decorated,container,$container){var self=this;var resultsId=container.id+"-results";decorated.call(this,container,$container);container.on("open",function(){self.$search.attr("aria-controls",resultsId);self.$search.trigger("focus");});container.on("close",function(){self.$search.val("");self.$search.removeAttr("aria-controls");self.$search.removeAttr("aria-activedescendant");self.$search.trigger("focus");});container.on("enable",function(){self.$search.prop("disabled",false);self._transferTabIndex();});container.on("disable",function(){self.$search.prop("disabled",true);});container.on("focus",function(evt){self.$search.trigger("focus");});container.on("results:focus",function(params){if(params.data._resultId){self.$search.attr("aria-activedescendant",params.data._resultId);}else{self.$search.removeAttr("aria-activedescendant");}});this.$selection.on("focusin",".select2-search--inline",function(evt){self.trigger("focus",evt);});this.$selection.on("focusout",".select2-search--inline",function(evt){self._handleBlur(evt);});this.$selection.on("keydown",".select2-search--inline",function(evt){evt.stopPropagation();self.trigger("keypress",evt);self._keyUpPrevented=evt.isDefaultPrevented();var key=evt.which;if(key===KEYS.BACKSPACE&&self.$search.val()===""){var $previousChoice=self.$searchContainer.prev(".select2-selection__choice");if($previousChoice.length>0){var item=Utils.GetData($previousChoice[0],"data");self.searchRemoveChoice(item);evt.preventDefault();}}});this.$selection.on("click",".select2-search--inline",function(evt){if(self.$search.val()){evt.stopPropagation();}});var msie=document.documentMode;var disableInputEvents=msie&&msie<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(evt){if(disableInputEvents){self.$selection.off("input.search input.searchcheck");return;}self.$selection.off("keyup.search");});this.$selection.on("keyup.search input.search",".select2-search--inline",function(evt){if(disableInputEvents&&evt.type==="input"){self.$selection.off("input.search input.searchcheck");return;}var key=evt.which;if(key==KEYS.SHIFT||key==KEYS.CTRL||key==KEYS.ALT){return;}if(key==KEYS.TAB){return;}self.handleSearch(evt);});};Search.prototype._transferTabIndex=function(decorated){this.$search.attr("tabindex",this.$selection.attr("tabindex"));this.$selection.attr("tabindex","-1");};Search.prototype.createPlaceholder=function(decorated,placeholder){this.$search.attr("placeholder",placeholder.text);};Search.prototype.update=function(decorated,data){var searchHadFocus=this.$search[0]==document.activeElement;this.$search.attr("placeholder","");decorated.call(this,data);this.$selection.find(".select2-selection__rendered").append(this.$searchContainer);this.resizeSearch();if(searchHadFocus){this.$search.trigger("focus");}};Search.prototype.handleSearch=function(){this.resizeSearch();if(!this._keyUpPrevented){var input=this.$search.val();this.trigger("query",{term:input});}this._keyUpPrevented=false;};Search.prototype.searchRemoveChoice=function(decorated,item){this.trigger("unselect",{data:item});this.$search.val(item.text);this.handleSearch();};Search.prototype.resizeSearch=function(){this.$search.css("width","25px");var width="";if(this.$search.attr("placeholder")!==""){width=this.$selection.find(".select2-selection__rendered").width();}else{var minimumWidth=this.$search.val().length+1;width=(minimumWidth*0.75)+"em";}this.$search.css("width",width);};return Search;});S2.define("select2/selection/eventRelay",["jquery"],function($){function EventRelay(){}EventRelay.prototype.bind=function(decorated,container,$container){var self=this;var relayEvents=["open","opening","close","closing","select","selecting","unselect","unselecting","clear","clearing"];var preventableEvents=["opening","closing","selecting","unselecting","clearing"];decorated.call(this,container,$container);container.on("*",function(name,params){if($.inArray(name,relayEvents)===-1){return;}params=params||{};var evt=$.Event("select2:"+name,{params:params});self.$element.trigger(evt);if($.inArray(name,preventableEvents)===-1){return;}params.prevented=evt.isDefaultPrevented();});};return EventRelay;});S2.define("select2/translation",["jquery","require"],function($,require){function Translation(dict){this.dict=dict||{};}Translation.prototype.all=function(){return this.dict;};Translation.prototype.get=function(key){return this.dict[key];};Translation.prototype.extend=function(translation){this.dict=$.extend({},translation.all(),this.dict);};Translation._cache={};Translation.loadPath=function(path){if(!(path in Translation._cache)){var translations=require(path);Translation._cache[path]=translations;}return new Translation(Translation._cache[path]);};return Translation;});S2.define("select2/diacritics",[],function(){var diacritics={"\u24B6":"A","\uFF21":"A","\u00C0":"A","\u00C1":"A","\u00C2":"A","\u1EA6":"A","\u1EA4":"A","\u1EAA":"A","\u1EA8":"A","\u00C3":"A","\u0100":"A","\u0102":"A","\u1EB0":"A","\u1EAE":"A","\u1EB4":"A","\u1EB2":"A","\u0226":"A","\u01E0":"A","\u00C4":"A","\u01DE":"A","\u1EA2":"A","\u00C5":"A","\u01FA":"A","\u01CD":"A","\u0200":"A","\u0202":"A","\u1EA0":"A","\u1EAC":"A","\u1EB6":"A","\u1E00":"A","\u0104":"A","\u023A":"A","\u2C6F":"A","\uA732":"AA","\u00C6":"AE","\u01FC":"AE","\u01E2":"AE","\uA734":"AO","\uA736":"AU","\uA738":"AV","\uA73A":"AV","\uA73C":"AY","\u24B7":"B","\uFF22":"B","\u1E02":"B","\u1E04":"B","\u1E06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24B8":"C","\uFF23":"C","\u0106":"C","\u0108":"C","\u010A":"C","\u010C":"C","\u00C7":"C","\u1E08":"C","\u0187":"C","\u023B":"C","\uA73E":"C","\u24B9":"D","\uFF24":"D","\u1E0A":"D","\u010E":"D","\u1E0C":"D","\u1E10":"D","\u1E12":"D","\u1E0E":"D","\u0110":"D","\u018B":"D","\u018A":"D","\u0189":"D","\uA779":"D","\u01F1":"DZ","\u01C4":"DZ","\u01F2":"Dz","\u01C5":"Dz","\u24BA":"E","\uFF25":"E","\u00C8":"E","\u00C9":"E","\u00CA":"E","\u1EC0":"E","\u1EBE":"E","\u1EC4":"E","\u1EC2":"E","\u1EBC":"E","\u0112":"E","\u1E14":"E","\u1E16":"E","\u0114":"E","\u0116":"E","\u00CB":"E","\u1EBA":"E","\u011A":"E","\u0204":"E","\u0206":"E","\u1EB8":"E","\u1EC6":"E","\u0228":"E","\u1E1C":"E","\u0118":"E","\u1E18":"E","\u1E1A":"E","\u0190":"E","\u018E":"E","\u24BB":"F","\uFF26":"F","\u1E1E":"F","\u0191":"F","\uA77B":"F","\u24BC":"G","\uFF27":"G","\u01F4":"G","\u011C":"G","\u1E20":"G","\u011E":"G","\u0120":"G","\u01E6":"G","\u0122":"G","\u01E4":"G","\u0193":"G","\uA7A0":"G","\uA77D":"G","\uA77E":"G","\u24BD":"H","\uFF28":"H","\u0124":"H","\u1E22":"H","\u1E26":"H","\u021E":"H","\u1E24":"H","\u1E28":"H","\u1E2A":"H","\u0126":"H","\u2C67":"H","\u2C75":"H","\uA78D":"H","\u24BE":"I","\uFF29":"I","\u00CC":"I","\u00CD":"I","\u00CE":"I","\u0128":"I","\u012A":"I","\u012C":"I","\u0130":"I","\u00CF":"I","\u1E2E":"I","\u1EC8":"I","\u01CF":"I","\u0208":"I","\u020A":"I","\u1ECA":"I","\u012E":"I","\u1E2C":"I","\u0197":"I","\u24BF":"J","\uFF2A":"J","\u0134":"J","\u0248":"J","\u24C0":"K","\uFF2B":"K","\u1E30":"K","\u01E8":"K","\u1E32":"K","\u0136":"K","\u1E34":"K","\u0198":"K","\u2C69":"K","\uA740":"K","\uA742":"K","\uA744":"K","\uA7A2":"K","\u24C1":"L","\uFF2C":"L","\u013F":"L","\u0139":"L","\u013D":"L","\u1E36":"L","\u1E38":"L","\u013B":"L","\u1E3C":"L","\u1E3A":"L","\u0141":"L","\u023D":"L","\u2C62":"L","\u2C60":"L","\uA748":"L","\uA746":"L","\uA780":"L","\u01C7":"LJ","\u01C8":"Lj","\u24C2":"M","\uFF2D":"M","\u1E3E":"M","\u1E40":"M","\u1E42":"M","\u2C6E":"M","\u019C":"M","\u24C3":"N","\uFF2E":"N","\u01F8":"N","\u0143":"N","\u00D1":"N","\u1E44":"N","\u0147":"N","\u1E46":"N","\u0145":"N","\u1E4A":"N","\u1E48":"N","\u0220":"N","\u019D":"N","\uA790":"N","\uA7A4":"N","\u01CA":"NJ","\u01CB":"Nj","\u24C4":"O","\uFF2F":"O","\u00D2":"O","\u00D3":"O","\u00D4":"O","\u1ED2":"O","\u1ED0":"O","\u1ED6":"O","\u1ED4":"O","\u00D5":"O","\u1E4C":"O","\u022C":"O","\u1E4E":"O","\u014C":"O","\u1E50":"O","\u1E52":"O","\u014E":"O","\u022E":"O","\u0230":"O","\u00D6":"O","\u022A":"O","\u1ECE":"O","\u0150":"O","\u01D1":"O","\u020C":"O","\u020E":"O","\u01A0":"O","\u1EDC":"O","\u1EDA":"O","\u1EE0":"O","\u1EDE":"O","\u1EE2":"O","\u1ECC":"O","\u1ED8":"O","\u01EA":"O","\u01EC":"O","\u00D8":"O","\u01FE":"O","\u0186":"O","\u019F":"O","\uA74A":"O","\uA74C":"O","\u0152":"OE","\u01A2":"OI","\uA74E":"OO","\u0222":"OU","\u24C5":"P","\uFF30":"P","\u1E54":"P","\u1E56":"P","\u01A4":"P","\u2C63":"P","\uA750":"P","\uA752":"P","\uA754":"P","\u24C6":"Q","\uFF31":"Q","\uA756":"Q","\uA758":"Q","\u024A":"Q","\u24C7":"R","\uFF32":"R","\u0154":"R","\u1E58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1E5A":"R","\u1E5C":"R","\u0156":"R","\u1E5E":"R","\u024C":"R","\u2C64":"R","\uA75A":"R","\uA7A6":"R","\uA782":"R","\u24C8":"S","\uFF33":"S","\u1E9E":"S","\u015A":"S","\u1E64":"S","\u015C":"S","\u1E60":"S","\u0160":"S","\u1E66":"S","\u1E62":"S","\u1E68":"S","\u0218":"S","\u015E":"S","\u2C7E":"S","\uA7A8":"S","\uA784":"S","\u24C9":"T","\uFF34":"T","\u1E6A":"T","\u0164":"T","\u1E6C":"T","\u021A":"T","\u0162":"T","\u1E70":"T","\u1E6E":"T","\u0166":"T","\u01AC":"T","\u01AE":"T","\u023E":"T","\uA786":"T","\uA728":"TZ","\u24CA":"U","\uFF35":"U","\u00D9":"U","\u00DA":"U","\u00DB":"U","\u0168":"U","\u1E78":"U","\u016A":"U","\u1E7A":"U","\u016C":"U","\u00DC":"U","\u01DB":"U","\u01D7":"U","\u01D5":"U","\u01D9":"U","\u1EE6":"U","\u016E":"U","\u0170":"U","\u01D3":"U","\u0214":"U","\u0216":"U","\u01AF":"U","\u1EEA":"U","\u1EE8":"U","\u1EEE":"U","\u1EEC":"U","\u1EF0":"U","\u1EE4":"U","\u1E72":"U","\u0172":"U","\u1E76":"U","\u1E74":"U","\u0244":"U","\u24CB":"V","\uFF36":"V","\u1E7C":"V","\u1E7E":"V","\u01B2":"V","\uA75E":"V","\u0245":"V","\uA760":"VY","\u24CC":"W","\uFF37":"W","\u1E80":"W","\u1E82":"W","\u0174":"W","\u1E86":"W","\u1E84":"W","\u1E88":"W","\u2C72":"W","\u24CD":"X","\uFF38":"X","\u1E8A":"X","\u1E8C":"X","\u24CE":"Y","\uFF39":"Y","\u1EF2":"Y","\u00DD":"Y","\u0176":"Y","\u1EF8":"Y","\u0232":"Y","\u1E8E":"Y","\u0178":"Y","\u1EF6":"Y","\u1EF4":"Y","\u01B3":"Y","\u024E":"Y","\u1EFE":"Y","\u24CF":"Z","\uFF3A":"Z","\u0179":"Z","\u1E90":"Z","\u017B":"Z","\u017D":"Z","\u1E92":"Z","\u1E94":"Z","\u01B5":"Z","\u0224":"Z","\u2C7F":"Z","\u2C6B":"Z","\uA762":"Z","\u24D0":"a","\uFF41":"a","\u1E9A":"a","\u00E0":"a","\u00E1":"a","\u00E2":"a","\u1EA7":"a","\u1EA5":"a","\u1EAB":"a","\u1EA9":"a","\u00E3":"a","\u0101":"a","\u0103":"a","\u1EB1":"a","\u1EAF":"a","\u1EB5":"a","\u1EB3":"a","\u0227":"a","\u01E1":"a","\u00E4":"a","\u01DF":"a","\u1EA3":"a","\u00E5":"a","\u01FB":"a","\u01CE":"a","\u0201":"a","\u0203":"a","\u1EA1":"a","\u1EAD":"a","\u1EB7":"a","\u1E01":"a","\u0105":"a","\u2C65":"a","\u0250":"a","\uA733":"aa","\u00E6":"ae","\u01FD":"ae","\u01E3":"ae","\uA735":"ao","\uA737":"au","\uA739":"av","\uA73B":"av","\uA73D":"ay","\u24D1":"b","\uFF42":"b","\u1E03":"b","\u1E05":"b","\u1E07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24D2":"c","\uFF43":"c","\u0107":"c","\u0109":"c","\u010B":"c","\u010D":"c","\u00E7":"c","\u1E09":"c","\u0188":"c","\u023C":"c","\uA73F":"c","\u2184":"c","\u24D3":"d","\uFF44":"d","\u1E0B":"d","\u010F":"d","\u1E0D":"d","\u1E11":"d","\u1E13":"d","\u1E0F":"d","\u0111":"d","\u018C":"d","\u0256":"d","\u0257":"d","\uA77A":"d","\u01F3":"dz","\u01C6":"dz","\u24D4":"e","\uFF45":"e","\u00E8":"e","\u00E9":"e","\u00EA":"e","\u1EC1":"e","\u1EBF":"e","\u1EC5":"e","\u1EC3":"e","\u1EBD":"e","\u0113":"e","\u1E15":"e","\u1E17":"e","\u0115":"e","\u0117":"e","\u00EB":"e","\u1EBB":"e","\u011B":"e","\u0205":"e","\u0207":"e","\u1EB9":"e","\u1EC7":"e","\u0229":"e","\u1E1D":"e","\u0119":"e","\u1E19":"e","\u1E1B":"e","\u0247":"e","\u025B":"e","\u01DD":"e","\u24D5":"f","\uFF46":"f","\u1E1F":"f","\u0192":"f","\uA77C":"f","\u24D6":"g","\uFF47":"g","\u01F5":"g","\u011D":"g","\u1E21":"g","\u011F":"g","\u0121":"g","\u01E7":"g","\u0123":"g","\u01E5":"g","\u0260":"g","\uA7A1":"g","\u1D79":"g","\uA77F":"g","\u24D7":"h","\uFF48":"h","\u0125":"h","\u1E23":"h","\u1E27":"h","\u021F":"h","\u1E25":"h","\u1E29":"h","\u1E2B":"h","\u1E96":"h","\u0127":"h","\u2C68":"h","\u2C76":"h","\u0265":"h","\u0195":"hv","\u24D8":"i","\uFF49":"i","\u00EC":"i","\u00ED":"i","\u00EE":"i","\u0129":"i","\u012B":"i","\u012D":"i","\u00EF":"i","\u1E2F":"i","\u1EC9":"i","\u01D0":"i","\u0209":"i","\u020B":"i","\u1ECB":"i","\u012F":"i","\u1E2D":"i","\u0268":"i","\u0131":"i","\u24D9":"j","\uFF4A":"j","\u0135":"j","\u01F0":"j","\u0249":"j","\u24DA":"k","\uFF4B":"k","\u1E31":"k","\u01E9":"k","\u1E33":"k","\u0137":"k","\u1E35":"k","\u0199":"k","\u2C6A":"k","\uA741":"k","\uA743":"k","\uA745":"k","\uA7A3":"k","\u24DB":"l","\uFF4C":"l","\u0140":"l","\u013A":"l","\u013E":"l","\u1E37":"l","\u1E39":"l","\u013C":"l","\u1E3D":"l","\u1E3B":"l","\u017F":"l","\u0142":"l","\u019A":"l","\u026B":"l","\u2C61":"l","\uA749":"l","\uA781":"l","\uA747":"l","\u01C9":"lj","\u24DC":"m","\uFF4D":"m","\u1E3F":"m","\u1E41":"m","\u1E43":"m","\u0271":"m","\u026F":"m","\u24DD":"n","\uFF4E":"n","\u01F9":"n","\u0144":"n","\u00F1":"n","\u1E45":"n","\u0148":"n","\u1E47":"n","\u0146":"n","\u1E4B":"n","\u1E49":"n","\u019E":"n","\u0272":"n","\u0149":"n","\uA791":"n","\uA7A5":"n","\u01CC":"nj","\u24DE":"o","\uFF4F":"o","\u00F2":"o","\u00F3":"o","\u00F4":"o","\u1ED3":"o","\u1ED1":"o","\u1ED7":"o","\u1ED5":"o","\u00F5":"o","\u1E4D":"o","\u022D":"o","\u1E4F":"o","\u014D":"o","\u1E51":"o","\u1E53":"o","\u014F":"o","\u022F":"o","\u0231":"o","\u00F6":"o","\u022B":"o","\u1ECF":"o","\u0151":"o","\u01D2":"o","\u020D":"o","\u020F":"o","\u01A1":"o","\u1EDD":"o","\u1EDB":"o","\u1EE1":"o","\u1EDF":"o","\u1EE3":"o","\u1ECD":"o","\u1ED9":"o","\u01EB":"o","\u01ED":"o","\u00F8":"o","\u01FF":"o","\u0254":"o","\uA74B":"o","\uA74D":"o","\u0275":"o","\u0153":"oe","\u01A3":"oi","\u0223":"ou","\uA74F":"oo","\u24DF":"p","\uFF50":"p","\u1E55":"p","\u1E57":"p","\u01A5":"p","\u1D7D":"p","\uA751":"p","\uA753":"p","\uA755":"p","\u24E0":"q","\uFF51":"q","\u024B":"q","\uA757":"q","\uA759":"q","\u24E1":"r","\uFF52":"r","\u0155":"r","\u1E59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1E5B":"r","\u1E5D":"r","\u0157":"r","\u1E5F":"r","\u024D":"r","\u027D":"r","\uA75B":"r","\uA7A7":"r","\uA783":"r","\u24E2":"s","\uFF53":"s","\u00DF":"s","\u015B":"s","\u1E65":"s","\u015D":"s","\u1E61":"s","\u0161":"s","\u1E67":"s","\u1E63":"s","\u1E69":"s","\u0219":"s","\u015F":"s","\u023F":"s","\uA7A9":"s","\uA785":"s","\u1E9B":"s","\u24E3":"t","\uFF54":"t","\u1E6B":"t","\u1E97":"t","\u0165":"t","\u1E6D":"t","\u021B":"t","\u0163":"t","\u1E71":"t","\u1E6F":"t","\u0167":"t","\u01AD":"t","\u0288":"t","\u2C66":"t","\uA787":"t","\uA729":"tz","\u24E4":"u","\uFF55":"u","\u00F9":"u","\u00FA":"u","\u00FB":"u","\u0169":"u","\u1E79":"u","\u016B":"u","\u1E7B":"u","\u016D":"u","\u00FC":"u","\u01DC":"u","\u01D8":"u","\u01D6":"u","\u01DA":"u","\u1EE7":"u","\u016F":"u","\u0171":"u","\u01D4":"u","\u0215":"u","\u0217":"u","\u01B0":"u","\u1EEB":"u","\u1EE9":"u","\u1EEF":"u","\u1EED":"u","\u1EF1":"u","\u1EE5":"u","\u1E73":"u","\u0173":"u","\u1E77":"u","\u1E75":"u","\u0289":"u","\u24E5":"v","\uFF56":"v","\u1E7D":"v","\u1E7F":"v","\u028B":"v","\uA75F":"v","\u028C":"v","\uA761":"vy","\u24E6":"w","\uFF57":"w","\u1E81":"w","\u1E83":"w","\u0175":"w","\u1E87":"w","\u1E85":"w","\u1E98":"w","\u1E89":"w","\u2C73":"w","\u24E7":"x","\uFF58":"x","\u1E8B":"x","\u1E8D":"x","\u24E8":"y","\uFF59":"y","\u1EF3":"y","\u00FD":"y","\u0177":"y","\u1EF9":"y","\u0233":"y","\u1E8F":"y","\u00FF":"y","\u1EF7":"y","\u1E99":"y","\u1EF5":"y","\u01B4":"y","\u024F":"y","\u1EFF":"y","\u24E9":"z","\uFF5A":"z","\u017A":"z","\u1E91":"z","\u017C":"z","\u017E":"z","\u1E93":"z","\u1E95":"z","\u01B6":"z","\u0225":"z","\u0240":"z","\u2C6C":"z","\uA763":"z","\u0386":"\u0391","\u0388":"\u0395","\u0389":"\u0397","\u038A":"\u0399","\u03AA":"\u0399","\u038C":"\u039F","\u038E":"\u03A5","\u03AB":"\u03A5","\u038F":"\u03A9","\u03AC":"\u03B1","\u03AD":"\u03B5","\u03AE":"\u03B7","\u03AF":"\u03B9","\u03CA":"\u03B9","\u0390":"\u03B9","\u03CC":"\u03BF","\u03CD":"\u03C5","\u03CB":"\u03C5","\u03B0":"\u03C5","\u03CE":"\u03C9","\u03C2":"\u03C3","\u2019":"'"};return diacritics;});S2.define("select2/data/base",["../utils"],function(Utils){function BaseAdapter($element,options){BaseAdapter.__super__.constructor.call(this);}Utils.Extend(BaseAdapter,Utils.Observable);BaseAdapter.prototype.current=function(callback){throw new Error("The `current` method must be defined in child classes.");};BaseAdapter.prototype.query=function(params,callback){throw new Error("The `query` method must be defined in child classes.");};BaseAdapter.prototype.bind=function(container,$container){};BaseAdapter.prototype.destroy=function(){};BaseAdapter.prototype.generateResultId=function(container,data){var id=container.id+"-result-";id+=Utils.generateChars(4);if(data.id!=null){id+="-"+data.id.toString();}else{id+="-"+Utils.generateChars(4);}return id;};return BaseAdapter;});S2.define("select2/data/select",["./base","../utils","jquery"],function(BaseAdapter,Utils,$){function SelectAdapter($element,options){this.$element=$element;this.options=options;SelectAdapter.__super__.constructor.call(this);}Utils.Extend(SelectAdapter,BaseAdapter);SelectAdapter.prototype.current=function(callback){var data=[];var self=this;this.$element.find(":selected").each(function(){var $option=$(this);var option=self.item($option);data.push(option);});callback(data);};SelectAdapter.prototype.select=function(data){var self=this;data.selected=true;if($(data.element).is("option")){data.element.selected=true;this.$element.trigger("input").trigger("change");return;}if(this.$element.prop("multiple")){this.current(function(currentData){var val=[];data=[data];data.push.apply(data,currentData);for(var d=0;d<data.length;d++){var id=data[d].id;if($.inArray(id,val)===-1){val.push(id);}}self.$element.val(val);self.$element.trigger("input").trigger("change");});}else{var val=data.id;this.$element.val(val);this.$element.trigger("input").trigger("change");}};SelectAdapter.prototype.unselect=function(data){var self=this;if(!this.$element.prop("multiple")){return;}data.selected=false;if($(data.element).is("option")){data.element.selected=false;this.$element.trigger("input").trigger("change");return;}this.current(function(currentData){var val=[];for(var d=0;d<currentData.length;d++){var id=currentData[d].id;if(id!==data.id&&$.inArray(id,val)===-1){val.push(id);}}self.$element.val(val);self.$element.trigger("input").trigger("change");});};SelectAdapter.prototype.bind=function(container,$container){var self=this;this.container=container;container.on("select",function(params){self.select(params.data);});container.on("unselect",function(params){self.unselect(params.data);});};SelectAdapter.prototype.destroy=function(){this.$element.find("*").each(function(){Utils.RemoveData(this);});};SelectAdapter.prototype.query=function(params,callback){var data=[];var self=this;var $options=this.$element.children();$options.each(function(){var $option=$(this);if(!$option.is("option")&&!$option.is("optgroup")){return;}var option=self.item($option);var matches=self.matches(params,option);if(matches!==null){data.push(matches);}});callback({results:data});};SelectAdapter.prototype.addOptions=function($options){Utils.appendMany(this.$element,$options);};SelectAdapter.prototype.option=function(data){var option;if(data.children){option=document.createElement("optgroup");option.label=data.text;}else{option=document.createElement("option");if(option.textContent!==undefined){option.textContent=data.text;}else{option.innerText=data.text;}}if(data.id!==undefined){option.value=data.id;}if(data.disabled){option.disabled=true;}if(data.selected){option.selected=true;}if(data.title){option.title=data.title;}var $option=$(option);var normalizedData=this._normalizeItem(data);normalizedData.element=option;Utils.StoreData(option,"data",normalizedData);return $option;};SelectAdapter.prototype.item=function($option){var data={};data=Utils.GetData($option[0],"data");if(data!=null){return data;}if($option.is("option")){data={id:$option.val(),text:$option.text(),disabled:$option.prop("disabled"),selected:$option.prop("selected"),title:$option.prop("title")};}else{if($option.is("optgroup")){data={text:$option.prop("label"),children:[],title:$option.prop("title")};var $children=$option.children("option");var children=[];for(var c=0;c<$children.length;c++){var $child=$($children[c]);var child=this.item($child);children.push(child);}data.children=children;}}data=this._normalizeItem(data);data.element=$option[0];Utils.StoreData($option[0],"data",data);return data;};SelectAdapter.prototype._normalizeItem=function(item){if(item!==Object(item)){item={id:item,text:item};}item=$.extend({},{text:""},item);var defaults={selected:false,disabled:false};if(item.id!=null){item.id=item.id.toString();}if(item.text!=null){item.text=item.text.toString();}if(item._resultId==null&&item.id&&this.container!=null){item._resultId=this.generateResultId(this.container,item);}return $.extend({},defaults,item);};SelectAdapter.prototype.matches=function(params,data){var matcher=this.options.get("matcher");return matcher(params,data);};return SelectAdapter;});S2.define("select2/data/array",["./select","../utils","jquery"],function(SelectAdapter,Utils,$){function ArrayAdapter($element,options){this._dataToConvert=options.get("data")||[];ArrayAdapter.__super__.constructor.call(this,$element,options);}Utils.Extend(ArrayAdapter,SelectAdapter);ArrayAdapter.prototype.bind=function(container,$container){ArrayAdapter.__super__.bind.call(this,container,$container);this.addOptions(this.convertToOptions(this._dataToConvert));};ArrayAdapter.prototype.select=function(data){var $option=this.$element.find("option").filter(function(i,elm){return elm.value==data.id.toString();});if($option.length===0){$option=this.option(data);this.addOptions($option);}ArrayAdapter.__super__.select.call(this,data);};ArrayAdapter.prototype.convertToOptions=function(data){var self=this;var $existing=this.$element.find("option");var existingIds=$existing.map(function(){return self.item($(this)).id;}).get();var $options=[];function onlyItem(item){return function(){return $(this).val()==item.id;};}for(var d=0;d<data.length;d++){var item=this._normalizeItem(data[d]);if($.inArray(item.id,existingIds)>=0){var $existingOption=$existing.filter(onlyItem(item));var existingData=this.item($existingOption);var newData=$.extend(true,{},item,existingData);var $newOption=this.option(newData);$existingOption.replaceWith($newOption);continue;}var $option=this.option(item);if(item.children){var $children=this.convertToOptions(item.children);Utils.appendMany($option,$children);}$options.push($option);}return $options;};return ArrayAdapter;});S2.define("select2/data/ajax",["./array","../utils","jquery"],function(ArrayAdapter,Utils,$){function AjaxAdapter($element,options){this.ajaxOptions=this._applyDefaults(options.get("ajax"));if(this.ajaxOptions.processResults!=null){this.processResults=this.ajaxOptions.processResults;}AjaxAdapter.__super__.constructor.call(this,$element,options);}Utils.Extend(AjaxAdapter,ArrayAdapter);AjaxAdapter.prototype._applyDefaults=function(options){var defaults={data:function(params){return $.extend({},params,{q:params.term});},transport:function(params,success,failure){var $request=$.ajax(params);$request.then(success);$request.fail(failure);return $request;}};return $.extend({},defaults,options,true);};AjaxAdapter.prototype.processResults=function(results){return results;};AjaxAdapter.prototype.query=function(params,callback){var matches=[];var self=this;if(this._request!=null){if($.isFunction(this._request.abort)){this._request.abort();}this._request=null;}var options=$.extend({type:"GET"},this.ajaxOptions);if(typeof options.url==="function"){options.url=options.url.call(this.$element,params);}if(typeof options.data==="function"){options.data=options.data.call(this.$element,params);}function request(){var $request=options.transport(options,function(data){var results=self.processResults(data,params);if(self.options.get("debug")&&window.console&&console.error){if(!results||!results.results||!$.isArray(results.results)){console.error("Select2: The AJAX results did not return an array in the "+"`results` key of the response.");}}callback(results);},function(){if("status" in $request&&($request.status===0||$request.status==="0")){return;}self.trigger("results:message",{message:"errorLoading"});});self._request=$request;}if(this.ajaxOptions.delay&&params.term!=null){if(this._queryTimeout){window.clearTimeout(this._queryTimeout);}this._queryTimeout=window.setTimeout(request,this.ajaxOptions.delay);}else{request();}};return AjaxAdapter;});S2.define("select2/data/tags",["jquery"],function($){function Tags(decorated,$element,options){var tags=options.get("tags");var createTag=options.get("createTag");if(createTag!==undefined){this.createTag=createTag;}var insertTag=options.get("insertTag");if(insertTag!==undefined){this.insertTag=insertTag;}decorated.call(this,$element,options);if($.isArray(tags)){for(var t=0;t<tags.length;t++){var tag=tags[t];var item=this._normalizeItem(tag);var $option=this.option(item);this.$element.append($option);}}}Tags.prototype.query=function(decorated,params,callback){var self=this;this._removeOldTags();if(params.term==null||params.page!=null){decorated.call(this,params,callback);return;}function wrapper(obj,child){var data=obj.results;for(var i=0;i<data.length;i++){var option=data[i];var checkChildren=(option.children!=null&&!wrapper({results:option.children},true));var optionText=(option.text||"").toUpperCase();var paramsTerm=(params.term||"").toUpperCase();var checkText=optionText===paramsTerm;if(checkText||checkChildren){if(child){return false;}obj.data=data;callback(obj);return;}}if(child){return true;}var tag=self.createTag(params);if(tag!=null){var $option=self.option(tag);$option.attr("data-select2-tag",true);self.addOptions([$option]);self.insertTag(data,tag);}obj.results=data;callback(obj);}decorated.call(this,params,wrapper);};Tags.prototype.createTag=function(decorated,params){var term=$.trim(params.term);if(term===""){return null;}return{id:term,text:term};};Tags.prototype.insertTag=function(_,data,tag){data.unshift(tag);};Tags.prototype._removeOldTags=function(_){var $options=this.$element.find("option[data-select2-tag]");$options.each(function(){if(this.selected){return;}$(this).remove();});};return Tags;});S2.define("select2/data/tokenizer",["jquery"],function($){function Tokenizer(decorated,$element,options){var tokenizer=options.get("tokenizer");if(tokenizer!==undefined){this.tokenizer=tokenizer;}decorated.call(this,$element,options);}Tokenizer.prototype.bind=function(decorated,container,$container){decorated.call(this,container,$container);this.$search=container.dropdown.$search||container.selection.$search||$container.find(".select2-search__field");};Tokenizer.prototype.query=function(decorated,params,callback){var self=this;function createAndSelect(data){var item=self._normalizeItem(data);var $existingOptions=self.$element.find("option").filter(function(){return $(this).val()===item.id;});if(!$existingOptions.length){var $option=self.option(item);$option.attr("data-select2-tag",true);self._removeOldTags();self.addOptions([$option]);}select(item);}function select(data){self.trigger("select",{data:data});}params.term=params.term||"";var tokenData=this.tokenizer(params,this.options,createAndSelect);if(tokenData.term!==params.term){if(this.$search.length){this.$search.val(tokenData.term);this.$search.trigger("focus");}params.term=tokenData.term;}decorated.call(this,params,callback);};Tokenizer.prototype.tokenizer=function(_,params,options,callback){var separators=options.get("tokenSeparators")||[];var term=params.term;var i=0;var createTag=this.createTag||function(params){return{id:params.term,text:params.term};};while(i<term.length){var termChar=term[i];if($.inArray(termChar,separators)===-1){i++;continue;}var part=term.substr(0,i);var partParams=$.extend({},params,{term:part});var data=createTag(partParams);if(data==null){i++;continue;}callback(data);term=term.substr(i+1)||"";i=0;}return{term:term};};return Tokenizer;});S2.define("select2/data/minimumInputLength",[],function(){function MinimumInputLength(decorated,$e,options){this.minimumInputLength=options.get("minimumInputLength");decorated.call(this,$e,options);}MinimumInputLength.prototype.query=function(decorated,params,callback){params.term=params.term||"";if(params.term.length<this.minimumInputLength){this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:params.term,params:params}});return;}decorated.call(this,params,callback);};return MinimumInputLength;});S2.define("select2/data/maximumInputLength",[],function(){function MaximumInputLength(decorated,$e,options){this.maximumInputLength=options.get("maximumInputLength");decorated.call(this,$e,options);}MaximumInputLength.prototype.query=function(decorated,params,callback){params.term=params.term||"";if(this.maximumInputLength>0&&params.term.length>this.maximumInputLength){this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:params.term,params:params}});return;}decorated.call(this,params,callback);};return MaximumInputLength;});S2.define("select2/data/maximumSelectionLength",[],function(){function MaximumSelectionLength(decorated,$e,options){this.maximumSelectionLength=options.get("maximumSelectionLength");decorated.call(this,$e,options);}MaximumSelectionLength.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("select",function(){self._checkIfMaximumSelected();});};MaximumSelectionLength.prototype.query=function(decorated,params,callback){var self=this;this._checkIfMaximumSelected(function(){decorated.call(self,params,callback);});};MaximumSelectionLength.prototype._checkIfMaximumSelected=function(_,successCallback){var self=this;this.current(function(currentData){var count=currentData!=null?currentData.length:0;if(self.maximumSelectionLength>0&&count>=self.maximumSelectionLength){self.trigger("results:message",{message:"maximumSelected",args:{maximum:self.maximumSelectionLength}});return;}if(successCallback){successCallback();}});};return MaximumSelectionLength;});S2.define("select2/dropdown",["jquery","./utils"],function($,Utils){function Dropdown($element,options){this.$element=$element;this.options=options;Dropdown.__super__.constructor.call(this);}Utils.Extend(Dropdown,Utils.Observable);Dropdown.prototype.render=function(){var $dropdown=$('<span class="select2-dropdown">'+'<span class="select2-results"></span>'+"</span>");$dropdown.attr("dir",this.options.get("dir"));this.$dropdown=$dropdown;return $dropdown;};Dropdown.prototype.bind=function(){};Dropdown.prototype.position=function($dropdown,$container){};Dropdown.prototype.destroy=function(){this.$dropdown.remove();};return Dropdown;});S2.define("select2/dropdown/search",["jquery","../utils"],function($,Utils){function Search(){}Search.prototype.render=function(decorated){var $rendered=decorated.call(this);var $search=$('<span class="select2-search select2-search--dropdown">'+'<input class="select2-search__field" type="search" tabindex="-1"'+' autocomplete="off" autocorrect="off" autocapitalize="none"'+' spellcheck="false" role="searchbox" aria-autocomplete="list" />'+"</span>");this.$searchContainer=$search;this.$search=$search.find("input");$rendered.prepend($search);return $rendered;};Search.prototype.bind=function(decorated,container,$container){var self=this;var resultsId=container.id+"-results";decorated.call(this,container,$container);this.$search.on("keydown",function(evt){self.trigger("keypress",evt);self._keyUpPrevented=evt.isDefaultPrevented();});this.$search.on("input",function(evt){$(this).off("keyup");});this.$search.on("keyup input",function(evt){self.handleSearch(evt);});container.on("open",function(){self.$search.attr("tabindex",0);self.$search.attr("aria-controls",resultsId);self.$search.trigger("focus");window.setTimeout(function(){self.$search.trigger("focus");},0);});container.on("close",function(){self.$search.attr("tabindex",-1);self.$search.removeAttr("aria-controls");self.$search.removeAttr("aria-activedescendant");self.$search.val("");self.$search.trigger("blur");});container.on("focus",function(){if(!container.isOpen()){self.$search.trigger("focus");}});container.on("results:all",function(params){if(params.query.term==null||params.query.term===""){var showSearch=self.showSearch(params);if(showSearch){self.$searchContainer.removeClass("select2-search--hide");}else{self.$searchContainer.addClass("select2-search--hide");}}});container.on("results:focus",function(params){if(params.data._resultId){self.$search.attr("aria-activedescendant",params.data._resultId);}else{self.$search.removeAttr("aria-activedescendant");}});};Search.prototype.handleSearch=function(evt){if(!this._keyUpPrevented){var input=this.$search.val();this.trigger("query",{term:input});}this._keyUpPrevented=false;};Search.prototype.showSearch=function(_,params){return true;};return Search;});S2.define("select2/dropdown/hidePlaceholder",[],function(){function HidePlaceholder(decorated,$element,options,dataAdapter){this.placeholder=this.normalizePlaceholder(options.get("placeholder"));decorated.call(this,$element,options,dataAdapter);}HidePlaceholder.prototype.append=function(decorated,data){data.results=this.removePlaceholder(data.results);decorated.call(this,data);};HidePlaceholder.prototype.normalizePlaceholder=function(_,placeholder){if(typeof placeholder==="string"){placeholder={id:"",text:placeholder};}return placeholder;};HidePlaceholder.prototype.removePlaceholder=function(_,data){var modifiedData=data.slice(0);for(var d=data.length-1;d>=0;d--){var item=data[d];if(this.placeholder.id===item.id){modifiedData.splice(d,1);}}return modifiedData;};return HidePlaceholder;});S2.define("select2/dropdown/infiniteScroll",["jquery"],function($){function InfiniteScroll(decorated,$element,options,dataAdapter){this.lastParams={};decorated.call(this,$element,options,dataAdapter);this.$loadingMore=this.createLoadingMore();this.loading=false;}InfiniteScroll.prototype.append=function(decorated,data){this.$loadingMore.remove();this.loading=false;decorated.call(this,data);if(this.showLoadingMore(data)){this.$results.append(this.$loadingMore);this.loadMoreIfNeeded();}};InfiniteScroll.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("query",function(params){self.lastParams=params;self.loading=true;});container.on("query:append",function(params){self.lastParams=params;self.loading=true;});this.$results.on("scroll",this.loadMoreIfNeeded.bind(this));};InfiniteScroll.prototype.loadMoreIfNeeded=function(){var isLoadMoreVisible=$.contains(document.documentElement,this.$loadingMore[0]);if(this.loading||!isLoadMoreVisible){return;}var currentOffset=this.$results.offset().top+this.$results.outerHeight(false);var loadingMoreOffset=this.$loadingMore.offset().top+this.$loadingMore.outerHeight(false);if(currentOffset+50>=loadingMoreOffset){this.loadMore();}};InfiniteScroll.prototype.loadMore=function(){this.loading=true;var params=$.extend({},{page:1},this.lastParams);params.page++;this.trigger("query:append",params);};InfiniteScroll.prototype.showLoadingMore=function(_,data){return data.pagination&&data.pagination.more;};InfiniteScroll.prototype.createLoadingMore=function(){var $option=$("<li "+'class="select2-results__option select2-results__option--load-more"'+'role="option" aria-disabled="true"></li>');var message=this.options.get("translations").get("loadingMore");$option.html(message(this.lastParams));return $option;};return InfiniteScroll;});S2.define("select2/dropdown/attachBody",["jquery","../utils"],function($,Utils){function AttachBody(decorated,$element,options){this.$dropdownParent=$(options.get("dropdownParent")||document.body);decorated.call(this,$element,options);}AttachBody.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("open",function(){self._showDropdown();self._attachPositioningHandler(container);self._bindContainerResultHandlers(container);});container.on("close",function(){self._hideDropdown();self._detachPositioningHandler(container);});this.$dropdownContainer.on("mousedown",function(evt){evt.stopPropagation();});};AttachBody.prototype.destroy=function(decorated){decorated.call(this);this.$dropdownContainer.remove();};AttachBody.prototype.position=function(decorated,$dropdown,$container){$dropdown.attr("class",$container.attr("class"));$dropdown.removeClass("select2");$dropdown.addClass("select2-container--open");$dropdown.css({position:"absolute",top:-999999});this.$container=$container;};AttachBody.prototype.render=function(decorated){var $container=$("<span></span>");var $dropdown=decorated.call(this);$container.append($dropdown);this.$dropdownContainer=$container;return $container;};AttachBody.prototype._hideDropdown=function(decorated){this.$dropdownContainer.detach();};AttachBody.prototype._bindContainerResultHandlers=function(decorated,container){if(this._containerResultsHandlersBound){return;}var self=this;container.on("results:all",function(){self._positionDropdown();self._resizeDropdown();});container.on("results:append",function(){self._positionDropdown();self._resizeDropdown();});container.on("results:message",function(){self._positionDropdown();self._resizeDropdown();});container.on("select",function(){self._positionDropdown();self._resizeDropdown();});container.on("unselect",function(){self._positionDropdown();self._resizeDropdown();});this._containerResultsHandlersBound=true;};AttachBody.prototype._attachPositioningHandler=function(decorated,container){var self=this;var scrollEvent="scroll.select2."+container.id;var resizeEvent="resize.select2."+container.id;var orientationEvent="orientationchange.select2."+container.id;var $watchers=this.$container.parents().filter(Utils.hasScroll);$watchers.each(function(){Utils.StoreData(this,"select2-scroll-position",{x:$(this).scrollLeft(),y:$(this).scrollTop()});});$watchers.on(scrollEvent,function(ev){var position=Utils.GetData(this,"select2-scroll-position");$(this).scrollTop(position.y);});$(window).on(scrollEvent+" "+resizeEvent+" "+orientationEvent,function(e){self._positionDropdown();self._resizeDropdown();});};AttachBody.prototype._detachPositioningHandler=function(decorated,container){var scrollEvent="scroll.select2."+container.id;var resizeEvent="resize.select2."+container.id;var orientationEvent="orientationchange.select2."+container.id;var $watchers=this.$container.parents().filter(Utils.hasScroll);$watchers.off(scrollEvent);$(window).off(scrollEvent+" "+resizeEvent+" "+orientationEvent);};AttachBody.prototype._positionDropdown=function(){var $window=$(window);var isCurrentlyAbove=this.$dropdown.hasClass("select2-dropdown--above");var isCurrentlyBelow=this.$dropdown.hasClass("select2-dropdown--below");var newDirection=null;var offset=this.$container.offset();offset.bottom=offset.top+this.$container.outerHeight(false);var container={height:this.$container.outerHeight(false)};container.top=offset.top;container.bottom=offset.top+container.height;var dropdown={height:this.$dropdown.outerHeight(false)};var viewport={top:$window.scrollTop(),bottom:$window.scrollTop()+$window.height()};var enoughRoomAbove=viewport.top<(offset.top-dropdown.height);var enoughRoomBelow=viewport.bottom>(offset.bottom+dropdown.height);var css={left:offset.left,top:container.bottom};var $offsetParent=this.$dropdownParent;if($offsetParent.css("position")==="static"){$offsetParent=$offsetParent.offsetParent();}var parentOffset={top:0,left:0};if($.contains(document.body,$offsetParent[0])||$offsetParent[0].isConnected){parentOffset=$offsetParent.offset();}css.top-=parentOffset.top;css.left-=parentOffset.left;if(!isCurrentlyAbove&&!isCurrentlyBelow){newDirection="below";}if(!enoughRoomBelow&&enoughRoomAbove&&!isCurrentlyAbove){newDirection="above";}else{if(!enoughRoomAbove&&enoughRoomBelow&&isCurrentlyAbove){newDirection="below";}}if(newDirection=="above"||(isCurrentlyAbove&&newDirection!=="below")){css.top=container.top-parentOffset.top-dropdown.height;}if(newDirection!=null){this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+newDirection);this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+newDirection);}this.$dropdownContainer.css(css);};AttachBody.prototype._resizeDropdown=function(){var css={width:this.$container.outerWidth(false)+"px"};if(this.options.get("dropdownAutoWidth")){css.minWidth=css.width;css.position="relative";css.width="auto";}this.$dropdown.css(css);};AttachBody.prototype._showDropdown=function(decorated){this.$dropdownContainer.appendTo(this.$dropdownParent);this._positionDropdown();this._resizeDropdown();};return AttachBody;});S2.define("select2/dropdown/minimumResultsForSearch",[],function(){function countResults(data){var count=0;for(var d=0;d<data.length;d++){var item=data[d];if(item.children){count+=countResults(item.children);}else{count++;}}return count;}function MinimumResultsForSearch(decorated,$element,options,dataAdapter){this.minimumResultsForSearch=options.get("minimumResultsForSearch");if(this.minimumResultsForSearch<0){this.minimumResultsForSearch=Infinity;}decorated.call(this,$element,options,dataAdapter);}MinimumResultsForSearch.prototype.showSearch=function(decorated,params){if(countResults(params.data.results)<this.minimumResultsForSearch){return false;}return decorated.call(this,params);};return MinimumResultsForSearch;});S2.define("select2/dropdown/selectOnClose",["../utils"],function(Utils){function SelectOnClose(){}SelectOnClose.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("close",function(params){self._handleSelectOnClose(params);});};SelectOnClose.prototype._handleSelectOnClose=function(_,params){if(params&&params.originalSelect2Event!=null){var event=params.originalSelect2Event;if(event._type==="select"||event._type==="unselect"){return;}}var $highlightedResults=this.getHighlightedResults();if($highlightedResults.length<1){return;}var data=Utils.GetData($highlightedResults[0],"data");if((data.element!=null&&data.element.selected)||(data.element==null&&data.selected)){return;}this.trigger("select",{data:data});};return SelectOnClose;});S2.define("select2/dropdown/closeOnSelect",[],function(){function CloseOnSelect(){}CloseOnSelect.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("select",function(evt){self._selectTriggered(evt);});container.on("unselect",function(evt){self._selectTriggered(evt);});};CloseOnSelect.prototype._selectTriggered=function(_,evt){var originalEvent=evt.originalEvent;if(originalEvent&&(originalEvent.ctrlKey||originalEvent.metaKey)){return;}this.trigger("close",{originalEvent:originalEvent,originalSelect2Event:evt});};return CloseOnSelect;});S2.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded.";},inputTooLong:function(args){var overChars=args.input.length-args.maximum;var message="Please delete "+overChars+" character";if(overChars!=1){message+="s";}return message;},inputTooShort:function(args){var remainingChars=args.minimum-args.input.length;var message="Please enter "+remainingChars+" or more characters";return message;},loadingMore:function(){return"Loading more results";},maximumSelected:function(args){var message="You can only select "+args.maximum+" item";if(args.maximum!=1){message+="s";}return message;},noResults:function(){return"No results found";},searching:function(){return"Searching";},removeAllItems:function(){return"Remove all items";}};});S2.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function($,require,ResultsList,SingleSelection,MultipleSelection,Placeholder,AllowClear,SelectionSearch,EventRelay,Utils,Translation,DIACRITICS,SelectData,ArrayData,AjaxData,Tags,Tokenizer,MinimumInputLength,MaximumInputLength,MaximumSelectionLength,Dropdown,DropdownSearch,HidePlaceholder,InfiniteScroll,AttachBody,MinimumResultsForSearch,SelectOnClose,CloseOnSelect,EnglishTranslation){function Defaults(){this.reset();}Defaults.prototype.apply=function(options){options=$.extend(true,{},this.defaults,options);if(options.dataAdapter==null){if(options.ajax!=null){options.dataAdapter=AjaxData;}else{if(options.data!=null){options.dataAdapter=ArrayData;}else{options.dataAdapter=SelectData;}}if(options.minimumInputLength>0){options.dataAdapter=Utils.Decorate(options.dataAdapter,MinimumInputLength);}if(options.maximumInputLength>0){options.dataAdapter=Utils.Decorate(options.dataAdapter,MaximumInputLength);}if(options.maximumSelectionLength>0){options.dataAdapter=Utils.Decorate(options.dataAdapter,MaximumSelectionLength);}if(options.tags){options.dataAdapter=Utils.Decorate(options.dataAdapter,Tags);}if(options.tokenSeparators!=null||options.tokenizer!=null){options.dataAdapter=Utils.Decorate(options.dataAdapter,Tokenizer);}if(options.query!=null){var Query=require(options.amdBase+"compat/query");options.dataAdapter=Utils.Decorate(options.dataAdapter,Query);}if(options.initSelection!=null){var InitSelection=require(options.amdBase+"compat/initSelection");options.dataAdapter=Utils.Decorate(options.dataAdapter,InitSelection);}}if(options.resultsAdapter==null){options.resultsAdapter=ResultsList;if(options.ajax!=null){options.resultsAdapter=Utils.Decorate(options.resultsAdapter,InfiniteScroll);}if(options.placeholder!=null){options.resultsAdapter=Utils.Decorate(options.resultsAdapter,HidePlaceholder);}if(options.selectOnClose){options.resultsAdapter=Utils.Decorate(options.resultsAdapter,SelectOnClose);}}if(options.dropdownAdapter==null){if(options.multiple){options.dropdownAdapter=Dropdown;}else{var SearchableDropdown=Utils.Decorate(Dropdown,DropdownSearch);options.dropdownAdapter=SearchableDropdown;}if(options.minimumResultsForSearch!==0){options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,MinimumResultsForSearch);}if(options.closeOnSelect){options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,CloseOnSelect);}if(options.dropdownCssClass!=null||options.dropdownCss!=null||options.adaptDropdownCssClass!=null){var DropdownCSS=require(options.amdBase+"compat/dropdownCss");options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,DropdownCSS);}options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,AttachBody);}if(options.selectionAdapter==null){if(options.multiple){options.selectionAdapter=MultipleSelection;}else{options.selectionAdapter=SingleSelection;}if(options.placeholder!=null){options.selectionAdapter=Utils.Decorate(options.selectionAdapter,Placeholder);}if(options.allowClear){options.selectionAdapter=Utils.Decorate(options.selectionAdapter,AllowClear);}if(options.multiple){options.selectionAdapter=Utils.Decorate(options.selectionAdapter,SelectionSearch);}if(options.containerCssClass!=null||options.containerCss!=null||options.adaptContainerCssClass!=null){var ContainerCSS=require(options.amdBase+"compat/containerCss");options.selectionAdapter=Utils.Decorate(options.selectionAdapter,ContainerCSS);}options.selectionAdapter=Utils.Decorate(options.selectionAdapter,EventRelay);}options.language=this._resolveLanguage(options.language);options.language.push("en");var uniqueLanguages=[];for(var l=0;l<options.language.length;l++){var language=options.language[l];if(uniqueLanguages.indexOf(language)===-1){uniqueLanguages.push(language);}}options.language=uniqueLanguages;options.translations=this._processTranslations(options.language,options.debug);return options;};Defaults.prototype.reset=function(){function stripDiacritics(text){function match(a){return DIACRITICS[a]||a;}return text.replace(/[^\u0000-\u007E]/g,match);}function matcher(params,data){if($.trim(params.term)===""){return data;}if(data.children&&data.children.length>0){var match=$.extend(true,{},data);for(var c=data.children.length-1;c>=0;c--){var child=data.children[c];var matches=matcher(params,child);if(matches==null){match.children.splice(c,1);}}if(match.children.length>0){return match;}return matcher(params,match);}var original=stripDiacritics(data.text).toUpperCase();var term=stripDiacritics(params.term).toUpperCase();if(original.indexOf(term)>-1){return data;}return null;}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:true,debug:false,dropdownAutoWidth:false,escapeMarkup:Utils.escapeMarkup,language:{},matcher:matcher,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:false,scrollAfterSelect:false,sorter:function(data){return data;},templateResult:function(result){return result.text;},templateSelection:function(selection){return selection.text;},theme:"default",width:"resolve"};};Defaults.prototype.applyFromElement=function(options,$element){var optionLanguage=options.language;var defaultLanguage=this.defaults.language;var elementLanguage=$element.prop("lang");var parentLanguage=$element.closest("[lang]").prop("lang");var languages=Array.prototype.concat.call(this._resolveLanguage(elementLanguage),this._resolveLanguage(optionLanguage),this._resolveLanguage(defaultLanguage),this._resolveLanguage(parentLanguage));options.language=languages;return options;};Defaults.prototype._resolveLanguage=function(language){if(!language){return[];}if($.isEmptyObject(language)){return[];}if($.isPlainObject(language)){return[language];}var languages;if(!$.isArray(language)){languages=[language];}else{languages=language;}var resolvedLanguages=[];for(var l=0;l<languages.length;l++){resolvedLanguages.push(languages[l]);if(typeof languages[l]==="string"&&languages[l].indexOf("-")>0){var languageParts=languages[l].split("-");var baseLanguage=languageParts[0];resolvedLanguages.push(baseLanguage);}}return resolvedLanguages;};Defaults.prototype._processTranslations=function(languages,debug){var translations=new Translation();for(var l=0;l<languages.length;l++){var languageData=new Translation();var language=languages[l];if(typeof language==="string"){try{languageData=Translation.loadPath(language);}catch(e){try{language=this.defaults.amdLanguageBase+language;languageData=Translation.loadPath(language);}catch(ex){if(debug&&window.console&&console.warn){console.warn('Select2: The language file for "'+language+'" could '+"not be automatically loaded. A fallback will be used instead.");}}}}else{if($.isPlainObject(language)){languageData=new Translation(language);}else{languageData=language;}}translations.extend(languageData);}return translations;};Defaults.prototype.set=function(key,value){var camelKey=$.camelCase(key);var data={};data[camelKey]=value;var convertedData=Utils._convertData(data);$.extend(true,this.defaults,convertedData);};var defaults=new Defaults();return defaults;});S2.define("select2/options",["require","jquery","./defaults","./utils"],function(require,$,Defaults,Utils){function Options(options,$element){this.options=options;if($element!=null){this.fromElement($element);}if($element!=null){this.options=Defaults.applyFromElement(this.options,$element);}this.options=Defaults.apply(this.options);if($element&&$element.is("input")){var InputCompat=require(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=Utils.Decorate(this.options.dataAdapter,InputCompat);}}Options.prototype.fromElement=function($e){var excludedData=["select2"];if(this.options.multiple==null){this.options.multiple=$e.prop("multiple");}if(this.options.disabled==null){this.options.disabled=$e.prop("disabled");}if(this.options.dir==null){if($e.prop("dir")){this.options.dir=$e.prop("dir");}else{if($e.closest("[dir]").prop("dir")){this.options.dir=$e.closest("[dir]").prop("dir");}else{this.options.dir="ltr";}}}$e.prop("disabled",this.options.disabled);$e.prop("multiple",this.options.multiple);if(Utils.GetData($e[0],"select2Tags")){if(this.options.debug&&window.console&&console.warn){console.warn("Select2: The `data-select2-tags` attribute has been changed to "+'use the `data-data` and `data-tags="true"` attributes and will be '+"removed in future versions of Select2.");}Utils.StoreData($e[0],"data",Utils.GetData($e[0],"select2Tags"));Utils.StoreData($e[0],"tags",true);}if(Utils.GetData($e[0],"ajaxUrl")){if(this.options.debug&&window.console&&console.warn){console.warn("Select2: The `data-ajax-url` attribute has been changed to "+"`data-ajax--url` and support for the old attribute will be removed"+" in future versions of Select2.");}$e.attr("ajax--url",Utils.GetData($e[0],"ajaxUrl"));Utils.StoreData($e[0],"ajax-Url",Utils.GetData($e[0],"ajaxUrl"));}var dataset={};function upperCaseLetter(_,letter){return letter.toUpperCase();}for(var attr=0;attr<$e[0].attributes.length;attr++){var attributeName=$e[0].attributes[attr].name;var prefix="data-";if(attributeName.substr(0,prefix.length)==prefix){var dataName=attributeName.substring(prefix.length);var dataValue=Utils.GetData($e[0],dataName);var camelDataName=dataName.replace(/-([a-z])/g,upperCaseLetter);dataset[camelDataName]=dataValue;}}if($.fn.jquery&&$.fn.jquery.substr(0,2)=="1."&&$e[0].dataset){dataset=$.extend(true,{},$e[0].dataset,dataset);}var data=$.extend(true,{},Utils.GetData($e[0]),dataset);data=Utils._convertData(data);for(var key in data){if($.inArray(key,excludedData)>-1){continue;}if($.isPlainObject(this.options[key])){$.extend(this.options[key],data[key]);}else{this.options[key]=data[key];}}return this;};Options.prototype.get=function(key){return this.options[key];};Options.prototype.set=function(key,val){this.options[key]=val;};return Options;});S2.define("select2/core",["jquery","./options","./utils","./keys"],function($,Options,Utils,KEYS){var Select2=function($element,options){if(Utils.GetData($element[0],"select2")!=null){Utils.GetData($element[0],"select2").destroy();}this.$element=$element;this.id=this._generateId($element);options=options||{};this.options=new Options(options,$element);Select2.__super__.constructor.call(this);var tabindex=$element.attr("tabindex")||0;Utils.StoreData($element[0],"old-tabindex",tabindex);$element.attr("tabindex","-1");var DataAdapter=this.options.get("dataAdapter");this.dataAdapter=new DataAdapter($element,this.options);var $container=this.render();this._placeContainer($container);var SelectionAdapter=this.options.get("selectionAdapter");this.selection=new SelectionAdapter($element,this.options);this.$selection=this.selection.render();this.selection.position(this.$selection,$container);var DropdownAdapter=this.options.get("dropdownAdapter");this.dropdown=new DropdownAdapter($element,this.options);this.$dropdown=this.dropdown.render();this.dropdown.position(this.$dropdown,$container);var ResultsAdapter=this.options.get("resultsAdapter");this.results=new ResultsAdapter($element,this.options,this.dataAdapter);this.$results=this.results.render();this.results.position(this.$results,this.$dropdown);var self=this;this._bindAdapters();this._registerDomEvents();this._registerDataEvents();this._registerSelectionEvents();this._registerDropdownEvents();this._registerResultsEvents();this._registerEvents();this.dataAdapter.current(function(initialData){self.trigger("selection:update",{data:initialData});});$element.addClass("select2-hidden-accessible");$element.attr("aria-hidden","true");this._syncAttributes();Utils.StoreData($element[0],"select2",this);$element.data("select2",this);};Utils.Extend(Select2,Utils.Observable);Select2.prototype._generateId=function($element){var id="";if($element.attr("id")!=null){id=$element.attr("id");}else{if($element.attr("name")!=null){id=$element.attr("name")+"-"+Utils.generateChars(2);}else{id=Utils.generateChars(4);}}id=id.replace(/(:|\.|\[|\]|,)/g,"");id="select2-"+id;return id;};Select2.prototype._placeContainer=function($container){$container.insertAfter(this.$element);var width=this._resolveWidth(this.$element,this.options.get("width"));if(width!=null){$container.css("width",width);}};Select2.prototype._resolveWidth=function($element,method){var WIDTH=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if(method=="resolve"){var styleWidth=this._resolveWidth($element,"style");if(styleWidth!=null){return styleWidth;}return this._resolveWidth($element,"element");}if(method=="element"){var elementWidth=$element.outerWidth(false);if(elementWidth<=0){return"auto";}return elementWidth+"px";}if(method=="style"){var style=$element.attr("style");if(typeof(style)!=="string"){return null;}var attrs=style.split(";");for(var i=0,l=attrs.length;i<l;i=i+1){var attr=attrs[i].replace(/\s/g,"");var matches=attr.match(WIDTH);if(matches!==null&&matches.length>=1){return matches[1];}}return null;}if(method=="computedstyle"){var computedStyle=window.getComputedStyle($element[0]);return computedStyle.width;}return method;};Select2.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container);this.selection.bind(this,this.$container);this.dropdown.bind(this,this.$container);this.results.bind(this,this.$container);};Select2.prototype._registerDomEvents=function(){var self=this;this.$element.on("change.select2",function(){self.dataAdapter.current(function(data){self.trigger("selection:update",{data:data});});});this.$element.on("focus.select2",function(evt){self.trigger("focus",evt);});this._syncA=Utils.bind(this._syncAttributes,this);this._syncS=Utils.bind(this._syncSubtree,this);if(this.$element[0].attachEvent){this.$element[0].attachEvent("onpropertychange",this._syncA);}var observer=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(observer!=null){this._observer=new observer(function(mutations){self._syncA();self._syncS(null,mutations);});this._observer.observe(this.$element[0],{attributes:true,childList:true,subtree:false});}else{if(this.$element[0].addEventListener){this.$element[0].addEventListener("DOMAttrModified",self._syncA,false);this.$element[0].addEventListener("DOMNodeInserted",self._syncS,false);this.$element[0].addEventListener("DOMNodeRemoved",self._syncS,false);}}};Select2.prototype._registerDataEvents=function(){var self=this;this.dataAdapter.on("*",function(name,params){self.trigger(name,params);});};Select2.prototype._registerSelectionEvents=function(){var self=this;var nonRelayEvents=["toggle","focus"];this.selection.on("toggle",function(){self.toggleDropdown();});this.selection.on("focus",function(params){self.focus(params);});this.selection.on("*",function(name,params){if($.inArray(name,nonRelayEvents)!==-1){return;}self.trigger(name,params);});};Select2.prototype._registerDropdownEvents=function(){var self=this;this.dropdown.on("*",function(name,params){self.trigger(name,params);});};Select2.prototype._registerResultsEvents=function(){var self=this;this.results.on("*",function(name,params){self.trigger(name,params);});};Select2.prototype._registerEvents=function(){var self=this;this.on("open",function(){self.$container.addClass("select2-container--open");});this.on("close",function(){self.$container.removeClass("select2-container--open");});this.on("enable",function(){self.$container.removeClass("select2-container--disabled");});this.on("disable",function(){self.$container.addClass("select2-container--disabled");});this.on("blur",function(){self.$container.removeClass("select2-container--focus");});this.on("query",function(params){if(!self.isOpen()){self.trigger("open",{});}this.dataAdapter.query(params,function(data){self.trigger("results:all",{data:data,query:params});});});this.on("query:append",function(params){this.dataAdapter.query(params,function(data){self.trigger("results:append",{data:data,query:params});});});this.on("keypress",function(evt){var key=evt.which;if(self.isOpen()){if(key===KEYS.ESC||key===KEYS.TAB||(key===KEYS.UP&&evt.altKey)){self.close(evt);evt.preventDefault();}else{if(key===KEYS.ENTER){self.trigger("results:select",{});evt.preventDefault();}else{if((key===KEYS.SPACE&&evt.ctrlKey)){self.trigger("results:toggle",{});evt.preventDefault();}else{if(key===KEYS.UP){self.trigger("results:previous",{});evt.preventDefault();}else{if(key===KEYS.DOWN){self.trigger("results:next",{});evt.preventDefault();}}}}}}else{if(key===KEYS.ENTER||key===KEYS.SPACE||(key===KEYS.DOWN&&evt.altKey)){self.open();evt.preventDefault();}}});};Select2.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled"));if(this.isDisabled()){if(this.isOpen()){this.close();}this.trigger("disable",{});}else{this.trigger("enable",{});}};Select2.prototype._isChangeMutation=function(evt,mutations){var changed=false;var self=this;if(evt&&evt.target&&(evt.target.nodeName!=="OPTION"&&evt.target.nodeName!=="OPTGROUP")){return;}if(!mutations){changed=true;}else{if(mutations.addedNodes&&mutations.addedNodes.length>0){for(var n=0;n<mutations.addedNodes.length;n++){var node=mutations.addedNodes[n];if(node.selected){changed=true;}}}else{if(mutations.removedNodes&&mutations.removedNodes.length>0){changed=true;}else{if($.isArray(mutations)){$.each(mutations,function(evt,mutation){if(self._isChangeMutation(evt,mutation)){changed=true;return false;}});}}}}return changed;};Select2.prototype._syncSubtree=function(evt,mutations){var changed=this._isChangeMutation(evt,mutations);var self=this;if(changed){this.dataAdapter.current(function(currentData){self.trigger("selection:update",{data:currentData});});}};Select2.prototype.trigger=function(name,args){var actualTrigger=Select2.__super__.trigger;var preTriggerMap={"open":"opening","close":"closing","select":"selecting","unselect":"unselecting","clear":"clearing"};if(args===undefined){args={};}if(name in preTriggerMap){var preTriggerName=preTriggerMap[name];var preTriggerArgs={prevented:false,name:name,args:args};actualTrigger.call(this,preTriggerName,preTriggerArgs);if(preTriggerArgs.prevented){args.prevented=true;return;}}actualTrigger.call(this,name,args);};Select2.prototype.toggleDropdown=function(){if(this.isDisabled()){return;}if(this.isOpen()){this.close();}else{this.open();}};Select2.prototype.open=function(){if(this.isOpen()){return;}if(this.isDisabled()){return;}this.trigger("query",{});};Select2.prototype.close=function(evt){if(!this.isOpen()){return;}this.trigger("close",{originalEvent:evt});};Select2.prototype.isEnabled=function(){return !this.isDisabled();};Select2.prototype.isDisabled=function(){return this.options.get("disabled");};Select2.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open");};Select2.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus");};Select2.prototype.focus=function(data){if(this.hasFocus()){return;}this.$container.addClass("select2-container--focus");this.trigger("focus",{});};Select2.prototype.enable=function(args){if(this.options.get("debug")&&window.console&&console.warn){console.warn('Select2: The `select2("enable")` method has been deprecated and will'+' be removed in later Select2 versions. Use $element.prop("disabled")'+" instead.");}if(args==null||args.length===0){args=[true];}var disabled=!args[0];this.$element.prop("disabled",disabled);};Select2.prototype.data=function(){if(this.options.get("debug")&&arguments.length>0&&window.console&&console.warn){console.warn('Select2: Data can no longer be set using `select2("data")`. You '+"should consider setting the value instead using `$element.val()`.");}var data=[];this.dataAdapter.current(function(currentData){data=currentData;});return data;};Select2.prototype.val=function(args){if(this.options.get("debug")&&window.console&&console.warn){console.warn('Select2: The `select2("val")` method has been deprecated and will be'+" removed in later Select2 versions. Use $element.val() instead.");}if(args==null||args.length===0){return this.$element.val();}var newVal=args[0];if($.isArray(newVal)){newVal=$.map(newVal,function(obj){return obj.toString();});}this.$element.val(newVal).trigger("input").trigger("change");};Select2.prototype.destroy=function(){this.$container.remove();if(this.$element[0].detachEvent){this.$element[0].detachEvent("onpropertychange",this._syncA);}if(this._observer!=null){this._observer.disconnect();this._observer=null;}else{if(this.$element[0].removeEventListener){this.$element[0].removeEventListener("DOMAttrModified",this._syncA,false);this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,false);this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,false);}}this._syncA=null;this._syncS=null;this.$element.off(".select2");this.$element.attr("tabindex",Utils.GetData(this.$element[0],"old-tabindex"));this.$element.removeClass("select2-hidden-accessible");this.$element.attr("aria-hidden","false");Utils.RemoveData(this.$element[0]);this.$element.removeData("select2");this.dataAdapter.destroy();this.selection.destroy();this.dropdown.destroy();this.results.destroy();this.dataAdapter=null;this.selection=null;this.dropdown=null;this.results=null;};Select2.prototype.render=function(){var $container=$('<span class="select2 select2-container">'+'<span class="selection"></span>'+'<span class="dropdown-wrapper" aria-hidden="true"></span>'+"</span>");$container.attr("dir",this.options.get("dir"));this.$container=$container;this.$container.addClass("select2-container--"+this.options.get("theme"));Utils.StoreData($container[0],"element",this.$element);return $container;};return Select2;});S2.define("jquery-mousewheel",["jquery"],function($){return $;});S2.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults","./select2/utils"],function($,_,Select2,Defaults,Utils){if($.fn.select2==null){var thisMethods=["open","close","destroy"];$.fn.select2=function(options){options=options||{};if(typeof options==="object"){this.each(function(){var instanceOptions=$.extend(true,{},options);var instance=new Select2($(this),instanceOptions);});return this;}else{if(typeof options==="string"){var ret;var args=Array.prototype.slice.call(arguments,1);this.each(function(){var instance=Utils.GetData(this,"select2");if(instance==null&&window.console&&console.error){console.error("The select2('"+options+"') method was called on an "+"element that is not using Select2.");}ret=instance[options].apply(instance,args);});if($.inArray(options,thisMethods)>-1){return this;}return ret;}else{throw new Error("Invalid arguments for Select2: "+options);}}};}if($.fn.select2.defaults==null){$.fn.select2.defaults=Defaults;}return Select2;});return{define:S2.define,require:S2.require};}());var select2=S2.require("jquery.select2");jQuery.fn.select2.amd=S2;return select2;}));/*
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function($,document,undefined){var pluses=/\+/g;function raw(s){return s;}function decoded(s){return unRfc2068(decodeURIComponent(s.replace(pluses," ")));}function unRfc2068(value){if(value.indexOf('"')===0){value=value.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\");}return value;}function fromJSON(value){return config.json?JSON.parse(value):value;}var config=$.cookie=function(key,value,options){if(value!==undefined){options=$.extend({},config.defaults,options);if(value===null){options.expires=-1;}if(typeof options.expires==="number"){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);}value=config.json?JSON.stringify(value):String(value);return(document.cookie=[encodeURIComponent(key),"=",config.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join(""));}var decode=config.raw?raw:decoded;var cookies=document.cookie.split("; ");var result=key?null:{};for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split("=");var name=decode(parts.shift());var cookie=decode(parts.join("="));if(key&&key===name){result=fromJSON(cookie);break;}if(!key){result[name]=fromJSON(cookie);}}return result;};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)!==null){$.cookie(key,null,options);return true;}return false;};})(jQuery,document);/*
 * jQuery BBQ: Back Button & Query Library - v1.2.1 - 2/17/2010
 * http://benalman.com/projects/jquery-bbq-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,window){var undefined,aps=Array.prototype.slice,decode=decodeURIComponent,jq_param=$.param,jq_param_fragment,jq_deparam,jq_deparam_fragment,jq_bbq=$.bbq=$.bbq||{},jq_bbq_pushState,jq_bbq_getState,jq_elemUrlAttr,jq_event_special=$.event.special,str_hashchange="hashchange",str_querystring="querystring",str_fragment="fragment",str_elemUrlAttr="elemUrlAttr",str_location="location",str_href="href",str_src="src",re_trim_querystring=/^.*\?|#.*$/g,re_trim_fragment=/^.*\#/,re_no_escape,elemUrlAttr_cache={};function is_string(arg){return typeof arg==="string";}function curry(func){var args=aps.call(arguments,1);return function(){return func.apply(this,args.concat(aps.call(arguments)));};}function get_fragment(url){return url.replace(/^[^#]*#?(.*)$/,"$1");}function get_querystring(url){return url.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1");}function jq_param_sub(is_fragment,get_func,url,params,merge_mode){var result,qs,matches,url_params,hash;if(params!==undefined){matches=url.match(is_fragment?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);hash=matches[3]||"";if(merge_mode===2&&is_string(params)){qs=params.replace(is_fragment?re_trim_fragment:re_trim_querystring,"");}else{url_params=jq_deparam(matches[2]);params=is_string(params)?jq_deparam[is_fragment?str_fragment:str_querystring](params):params;qs=merge_mode===2?params:merge_mode===1?$.extend({},params,url_params):$.extend({},url_params,params);qs=jq_param(qs);if(is_fragment){qs=qs.replace(re_no_escape,decode);}}result=matches[1]+(is_fragment?"#":qs||!matches[1]?"?":"")+qs+hash;}else{result=get_func(url!==undefined?url:window[str_location][str_href]);}return result;}jq_param[str_querystring]=curry(jq_param_sub,0,get_querystring);jq_param[str_fragment]=jq_param_fragment=curry(jq_param_sub,1,get_fragment);jq_param_fragment.noEscape=function(chars){chars=chars||"";var arr=$.map(chars.split(""),encodeURIComponent);re_no_escape=new RegExp(arr.join("|"),"g");};jq_param_fragment.noEscape(",/");$.deparam=jq_deparam=function(params,coerce){var obj={},coerce_types={"true":!0,"false":!1,"null":null};$.each(params.replace(/\+/g," ").split("&"),function(j,v){var param=v.split("="),key=decode(param[0]),val,cur=obj,i=0,keys=key.split("]["),keys_last=keys.length-1;if(/\[/.test(keys[0])&&/\]$/.test(keys[keys_last])){keys[keys_last]=keys[keys_last].replace(/\]$/,"");keys=keys.shift().split("[").concat(keys);keys_last=keys.length-1;}else{keys_last=0;}if(param.length===2){val=decode(param[1]);if(coerce){val=val&&!isNaN(val)?+val:val==="undefined"?undefined:coerce_types[val]!==undefined?coerce_types[val]:val;}if(keys_last){for(;i<=keys_last;i++){key=keys[i]===""?cur.length:keys[i];cur=cur[key]=i<keys_last?cur[key]||(keys[i+1]&&isNaN(keys[i+1])?{}:[]):val;}}else{if($.isArray(obj[key])){obj[key].push(val);}else{if(obj[key]!==undefined){obj[key]=[obj[key],val];}else{obj[key]=val;}}}}else{if(key){obj[key]=coerce?undefined:"";}}});return obj;};function jq_deparam_sub(is_fragment,url_or_params,coerce){if(url_or_params===undefined||typeof url_or_params==="boolean"){coerce=url_or_params;url_or_params=jq_param[is_fragment?str_fragment:str_querystring]();}else{url_or_params=is_string(url_or_params)?url_or_params.replace(is_fragment?re_trim_fragment:re_trim_querystring,""):url_or_params;}return jq_deparam(url_or_params,coerce);}jq_deparam[str_querystring]=curry(jq_deparam_sub,0);jq_deparam[str_fragment]=jq_deparam_fragment=curry(jq_deparam_sub,1);$[str_elemUrlAttr]||($[str_elemUrlAttr]=function(obj){return $.extend(elemUrlAttr_cache,obj);})({a:str_href,base:str_href,iframe:str_src,img:str_src,input:str_src,form:"action",link:str_href,script:str_src});jq_elemUrlAttr=$[str_elemUrlAttr];function jq_fn_sub(mode,force_attr,params,merge_mode){if(!is_string(params)&&typeof params!=="object"){merge_mode=params;params=force_attr;force_attr=undefined;}return this.each(function(){var that=$(this),attr=force_attr||jq_elemUrlAttr()[(this.nodeName||"").toLowerCase()]||"",url=attr&&that.attr(attr)||"";that.attr(attr,jq_param[mode](url,params,merge_mode));});}$.fn[str_querystring]=curry(jq_fn_sub,str_querystring);$.fn[str_fragment]=curry(jq_fn_sub,str_fragment);jq_bbq.pushState=jq_bbq_pushState=function(params,merge_mode){if(is_string(params)&&/^#/.test(params)&&merge_mode===undefined){merge_mode=2;}var has_args=params!==undefined,url=jq_param_fragment(window[str_location][str_href],has_args?params:{},has_args?merge_mode:2);window[str_location][str_href]=url+(/#/.test(url)?"":"#");};jq_bbq.getState=jq_bbq_getState=function(key,coerce){return key===undefined||typeof key==="boolean"?jq_deparam_fragment(key):jq_deparam_fragment(coerce)[key];};jq_bbq.removeState=function(arr){var state={};if(arr!==undefined){state=jq_bbq_getState();$.each($.isArray(arr)?arr:arguments,function(i,v){delete state[v];});}jq_bbq_pushState(state,2);};jq_event_special[str_hashchange]=$.extend(jq_event_special[str_hashchange],{add:function(handleObj){var old_handler;function new_handler(e){var hash=e[str_fragment]=jq_param_fragment();e.getState=function(key,coerce){return key===undefined||typeof key==="boolean"?jq_deparam(hash,key):jq_deparam(hash,coerce)[key];};old_handler.apply(this,arguments);}if($.isFunction(handleObj)){old_handler=handleObj;return new_handler;}else{old_handler=handleObj.handler;handleObj.handler=new_handler;}}});})(jQuery,this);
/*
 * jQuery hashchange event - v1.2 - 2/11/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,window,undefined){var fake_onhashchange,jq_event_special=$.event.special,str_location="location",str_hashchange="hashchange",str_href="href",browser=$.browser,mode=document.documentMode,is_old_ie=browser.msie&&(mode===undefined||mode<8),supports_onhashchange="on"+str_hashchange in window&&!is_old_ie;function get_fragment(url){url=url||window[str_location][str_href];return url.replace(/^[^#]*#?(.*)$/,"$1");}$[str_hashchange+"Delay"]=100;jq_event_special[str_hashchange]=$.extend(jq_event_special[str_hashchange],{setup:function(){if(supports_onhashchange){return false;}$(fake_onhashchange.start);},teardown:function(){if(supports_onhashchange){return false;}$(fake_onhashchange.stop);}});fake_onhashchange=(function(){var self={},timeout_id,iframe,set_history,get_history;function init(){set_history=get_history=function(val){return val;};if(is_old_ie){iframe=$('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;get_history=function(){return get_fragment(iframe.document[str_location][str_href]);};set_history=function(hash,history_hash){if(hash!==history_hash){var doc=iframe.document;doc.open().close();doc[str_location].hash="#"+hash;}};set_history(get_fragment());}}self.start=function(){if(timeout_id){return;}var last_hash=get_fragment();set_history||init();(function loopy(){var hash=get_fragment(),history_hash=get_history(last_hash);if(hash!==last_hash){set_history(last_hash=hash,history_hash);$(window).trigger(str_hashchange);}else{if(history_hash!==last_hash){window[str_location][str_href]=window[str_location][str_href].replace(/#.*/,"")+"#"+history_hash;}}timeout_id=setTimeout(loopy,$[str_hashchange+"Delay"]);})();};self.stop=function(){if(!iframe){timeout_id&&clearTimeout(timeout_id);timeout_id=0;}};return self;})();})(jQuery,this);(function(){var f=0,l=[],n={},j={},a={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},m=/[<>&\"\']/g,b,c=window.setTimeout,d={},e;function h(){this.returnValue=false;}function k(){this.cancelBubble=true;}(function(o){var p=o.split(/,/),q,s,r;for(q=0;q<p.length;q+=2){r=p[q+1].split(/ /);for(s=0;s<r.length;s++){j[r[s]]=p[q];}}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");var g={VERSION:"1.5.7",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:j,ua:(function(){var s=navigator,r=s.userAgent,t=s.vendor,p,o,q;p=/WebKit/.test(r);q=p&&t.indexOf("Apple")!==-1;o=window.opera&&window.opera.buildNumber;return{windows:navigator.platform.indexOf("Win")!==-1,android:/Android/.test(r),ie:!p&&!o&&(/MSIE/gi).test(r)&&(/Explorer/gi).test(s.appName),webkit:p,gecko:!p&&/Gecko/.test(r),safari:q,opera:!!o};}()),typeOf:function(p){return({}).toString.call(p).match(/\s([a-z|A-Z]+)/)[1].toLowerCase();},extend:function(o){g.each(arguments,function(p,q){if(q>0){g.each(p,function(s,r){o[r]=s;});}});return o;},cleanName:function(o){var p,q;q=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(p=0;p<q.length;p+=2){o=o.replace(q[p],q[p+1]);}o=o.replace(/\s+/g,"_");o=o.replace(/[^a-z0-9_\-\.]+/gi,"");return o;},addRuntime:function(o,p){p.name=o;l[o]=p;l.push(p);return p;},guid:function(){var o=new Date().getTime().toString(32),p;for(p=0;p<5;p++){o+=Math.floor(Math.random()*65535).toString(32);}return(g.guidPrefix||"p")+o+(f++).toString(32);},buildUrl:function(p,o){var q="";g.each(o,function(s,r){q+=(q?"&":"")+encodeURIComponent(r)+"="+encodeURIComponent(s);});if(q){p+=(p.indexOf("?")>0?"&":"?")+q;}return p;},each:function(r,s){var q,p,o;if(r){q=r.length;if(q===b){for(p in r){if(r.hasOwnProperty(p)){if(s(r[p],p)===false){return;}}}}else{for(o=0;o<q;o++){if(s(r[o],o)===false){return;}}}}},formatSize:function(o){if(o===b||/\D/.test(o)){return g.translate("N/A");}if(o>1073741824){return Math.round(o/1073741824,1)+" GB";}if(o>1048576){return Math.round(o/1048576,1)+" MB";}if(o>1024){return Math.round(o/1024,1)+" KB";}return o+" b";},getPos:function(p,t){var u=0,s=0,w,v=document,q,r;p=p;t=t||v.body;function o(C){var A,B,z=0,D=0;if(C){B=C.getBoundingClientRect();A=v.compatMode==="CSS1Compat"?v.documentElement:v.body;z=B.left+A.scrollLeft;D=B.top+A.scrollTop;}return{x:z,y:D};}if(p&&p.getBoundingClientRect&&g.ua.ie&&(!v.documentMode||v.documentMode<8)){q=o(p);r=o(t);return{x:q.x-r.x,y:q.y-r.y};}w=p;while(w&&w!=t&&w.nodeType){u+=w.offsetLeft||0;s+=w.offsetTop||0;w=w.offsetParent;}w=p.parentNode;while(w&&w!=t&&w.nodeType){u-=w.scrollLeft||0;s-=w.scrollTop||0;w=w.parentNode;}return{x:u,y:s};},getSize:function(o){return{w:o.offsetWidth||o.clientWidth,h:o.offsetHeight||o.clientHeight};},parseSize:function(o){var p;if(typeof(o)=="string"){o=/^([0-9]+)([mgk]?)$/.exec(o.toLowerCase().replace(/[^0-9mkg]/g,""));p=o[2];o=+o[1];if(p=="g"){o*=1073741824;}if(p=="m"){o*=1048576;}if(p=="k"){o*=1024;}}return o;},xmlEncode:function(o){return o?(""+o).replace(m,function(p){return a[p]?"&"+a[p]+";":p;}):o;},toArray:function(q){var p,o=[];for(p=0;p<q.length;p++){o[p]=q[p];}return o;},inArray:function(q,r){if(r){if(Array.prototype.indexOf){return Array.prototype.indexOf.call(r,q);}for(var o=0,p=r.length;o<p;o++){if(r[o]===q){return o;}}}return -1;},addI18n:function(o){return g.extend(n,o);},translate:function(o){return n[o]||o;},isEmptyObj:function(o){if(o===b){return true;}for(var p in o){return false;}return true;},hasClass:function(q,p){var o;if(q.className==""){return false;}o=new RegExp("(^|\\s+)"+p+"(\\s+|$)");return o.test(q.className);},addClass:function(p,o){if(!g.hasClass(p,o)){p.className=p.className==""?o:p.className.replace(/\s+$/,"")+" "+o;}},removeClass:function(q,p){var o=new RegExp("(^|\\s+)"+p+"(\\s+|$)");q.className=q.className.replace(o,function(s,r,t){return r===" "&&t===" "?" ":"";});},getStyle:function(p,o){if(p.currentStyle){return p.currentStyle[o];}else{if(window.getComputedStyle){return window.getComputedStyle(p,null)[o];}}},addEvent:function(t,o,u){var s,r,q,p;p=arguments[3];o=o.toLowerCase();if(e===b){e="Plupload_"+g.guid();}if(t.addEventListener){s=u;t.addEventListener(o,s,false);}else{if(t.attachEvent){s=function(){var v=window.event;if(!v.target){v.target=v.srcElement;}v.preventDefault=h;v.stopPropagation=k;u(v);};t.attachEvent("on"+o,s);}}if(t[e]===b){t[e]=g.guid();}if(!d.hasOwnProperty(t[e])){d[t[e]]={};}r=d[t[e]];if(!r.hasOwnProperty(o)){r[o]=[];}r[o].push({func:s,orig:u,key:p});},removeEvent:function(t,o){var r,u,q;if(typeof(arguments[2])=="function"){u=arguments[2];}else{q=arguments[2];}o=o.toLowerCase();if(t[e]&&d[t[e]]&&d[t[e]][o]){r=d[t[e]][o];}else{return;}for(var p=r.length-1;p>=0;p--){if(r[p].key===q||r[p].orig===u){if(t.removeEventListener){t.removeEventListener(o,r[p].func,false);}else{if(t.detachEvent){t.detachEvent("on"+o,r[p].func);}}r[p].orig=null;r[p].func=null;r.splice(p,1);if(u!==b){break;}}}if(!r.length){delete d[t[e]][o];}if(g.isEmptyObj(d[t[e]])){delete d[t[e]];try{delete t[e];}catch(s){t[e]=b;}}},removeAllEvents:function(p){var o=arguments[1];if(p[e]===b||!p[e]){return;}g.each(d[p[e]],function(r,q){g.removeEvent(p,q,o);});}};g.Uploader=function(s){var p={},v,u=[],r,q=false;v=new g.QueueProgress();s=g.extend({chunk_size:0,multipart:true,multi_selection:true,file_data_name:"file",filters:[]},s);function t(){var x,y=0,w;if(this.state==g.STARTED){for(w=0;w<u.length;w++){if(!x&&u[w].status==g.QUEUED){x=u[w];x.status=g.UPLOADING;if(this.trigger("BeforeUpload",x)){this.trigger("UploadFile",x);}}else{y++;}}if(y==u.length){this.stop();this.trigger("UploadComplete",u);}}}function o(){var x,w;v.reset();for(x=0;x<u.length;x++){w=u[x];if(w.size!==b){v.size+=w.size;v.loaded+=w.loaded;}else{v.size=b;}if(w.status==g.DONE){v.uploaded++;}else{if(w.status==g.FAILED){v.failed++;}else{v.queued++;}}}if(v.size===b){v.percent=u.length>0?Math.ceil(v.uploaded/u.length*100):0;}else{v.bytesPerSec=Math.ceil(v.loaded/((+new Date()-r||1)/1000));v.percent=v.size>0?Math.ceil(v.loaded/v.size*100):0;}}g.extend(this,{state:g.STOPPED,runtime:"",features:{},files:u,settings:s,total:v,id:g.guid(),init:function(){var B=this,C,y,x,A=0,z;if(typeof(s.preinit)=="function"){s.preinit(B);}else{g.each(s.preinit,function(E,D){B.bind(D,E);});}s.page_url=s.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");if(!/^(\w+:\/\/|\/)/.test(s.url)){s.url=s.page_url+s.url;}s.chunk_size=g.parseSize(s.chunk_size);s.max_file_size=g.parseSize(s.max_file_size);B.bind("FilesAdded",function(D,G){var F,E,I=0,J,H=s.filters;if(H&&H.length){J=[];g.each(H,function(K){g.each(K.extensions.split(/,/),function(L){if(/^\s*\*\s*$/.test(L)){J.push("\\.*");}else{J.push("\\."+L.replace(new RegExp("["+("/^$.*+?|()[]{}\\".replace(/./g,"\\$&"))+"]","g"),"\\$&"));}});});J=new RegExp(J.join("|")+"$","i");}for(F=0;F<G.length;F++){E=G[F];E.loaded=0;E.percent=0;E.status=g.QUEUED;if(J&&!J.test(E.name)){D.trigger("Error",{code:g.FILE_EXTENSION_ERROR,message:g.translate("File extension error."),file:E});continue;}if(E.size!==b&&E.size>s.max_file_size){D.trigger("Error",{code:g.FILE_SIZE_ERROR,message:g.translate("File size error."),file:E});continue;}u.push(E);I++;}if(I){c(function(){B.trigger("QueueChanged");B.refresh();},1);}else{return false;}});if(s.unique_names){B.bind("UploadFile",function(D,E){var G=E.name.match(/\.([^.]+)$/),F="tmp";if(G){F=G[1];}E.target_name=E.id+"."+F;});}B.bind("UploadProgress",function(D,E){E.percent=E.size>0?Math.ceil(E.loaded/E.size*100):100;o();});B.bind("StateChanged",function(D){if(D.state==g.STARTED){r=(+new Date());}else{if(D.state==g.STOPPED){for(C=D.files.length-1;C>=0;C--){if(D.files[C].status==g.UPLOADING){D.files[C].status=g.QUEUED;o();}}}}});B.bind("QueueChanged",o);B.bind("Error",function(D,E){if(E.file){E.file.status=g.FAILED;o();if(D.state==g.STARTED){c(function(){t.call(B);},1);}}});B.bind("FileUploaded",function(D,E){E.status=g.DONE;E.loaded=E.size;D.trigger("UploadProgress",E);c(function(){t.call(B);},1);});if(s.runtimes){y=[];z=s.runtimes.split(/\s?,\s?/);for(C=0;C<z.length;C++){if(l[z[C]]){y.push(l[z[C]]);}}}else{y=l;}function w(){var G=y[A++],F,D,E;if(G){F=G.getFeatures();D=B.settings.required_features;if(D){D=D.split(",");for(E=0;E<D.length;E++){if(!F[D[E]]){w();return;}}}G.init(B,function(H){if(H&&H.success){B.features=F;B.runtime=G.name;B.trigger("Init",{runtime:G.name});B.trigger("PostInit");B.refresh();}else{w();}});}else{B.trigger("Error",{code:g.INIT_ERROR,message:g.translate("Init error.")});}}w();if(typeof(s.init)=="function"){s.init(B);}else{g.each(s.init,function(E,D){B.bind(D,E);});}},refresh:function(){this.trigger("Refresh");},start:function(){if(u.length&&this.state!=g.STARTED){this.state=g.STARTED;this.trigger("StateChanged");t.call(this);}},stop:function(){if(this.state!=g.STOPPED){this.state=g.STOPPED;this.trigger("CancelUpload");this.trigger("StateChanged");}},disableBrowse:function(){q=arguments[0]!==b?arguments[0]:true;this.trigger("DisableBrowse",q);},getFile:function(x){var w;for(w=u.length-1;w>=0;w--){if(u[w].id===x){return u[w];}}},removeFile:function(x){var w;for(w=u.length-1;w>=0;w--){if(u[w].id===x.id){return this.splice(w,1)[0];}}},splice:function(y,w){var x;x=u.splice(y===b?0:y,w===b?u.length:w);this.trigger("FilesRemoved",x);this.trigger("QueueChanged");return x;},trigger:function(x){var z=p[x.toLowerCase()],y,w;if(z){w=Array.prototype.slice.call(arguments);w[0]=this;for(y=0;y<z.length;y++){if(z[y].func.apply(z[y].scope,w)===false){return false;}}}return true;},hasEventListener:function(w){return !!p[w.toLowerCase()];},bind:function(w,y,x){var z;w=w.toLowerCase();z=p[w]||[];z.push({func:y,scope:x||this});p[w]=z;},unbind:function(w){w=w.toLowerCase();var z=p[w],x,y=arguments[1];if(z){if(y!==b){for(x=z.length-1;x>=0;x--){if(z[x].func===y){z.splice(x,1);break;}}}else{z=[];}if(!z.length){delete p[w];}}},unbindAll:function(){var w=this;g.each(p,function(y,x){w.unbind(x);});},destroy:function(){this.stop();this.trigger("Destroy");this.unbindAll();}});};g.File=function(r,p,q){var o=this;o.id=r;o.name=p;o.size=q;o.loaded=0;o.percent=0;o.status=0;};g.Runtime=function(){this.getFeatures=function(){};this.init=function(o,p){};};g.QueueProgress=function(){var o=this;o.size=0;o.loaded=0;o.uploaded=0;o.failed=0;o.queued=0;o.percent=0;o.bytesPerSec=0;o.reset=function(){o.size=o.loaded=o.uploaded=o.failed=o.queued=o.percent=o.bytesPerSec=0;};};g.runtimes={};window.plupload=g;})();(function(){if(window.google&&google.gears){return;}var a=null;if(typeof GearsFactory!="undefined"){a=new GearsFactory();}else{try{a=new ActiveXObject("Gears.Factory");if(a.getBuildInfo().indexOf("ie_mobile")!=-1){a.privateSetGlobalObject(this);}}catch(b){if((typeof navigator.mimeTypes!="undefined")&&navigator.mimeTypes["application/x-googlegears"]){a=document.createElement("object");a.style.display="none";a.width=0;a.height=0;a.type="application/x-googlegears";document.documentElement.appendChild(a);}}}if(!a){return;}if(!window.google){window.google={};}if(!google.gears){google.gears={factory:a};}})();(function(e,b,c,d){var f={};function a(h,k,m){var g,j,l,o;j=google.gears.factory.create("beta.canvas");try{j.decode(h);if(!k.width){k.width=j.width;}if(!k.height){k.height=j.height;}o=Math.min(k.width/j.width,k.height/j.height);if(o<1){j.resize(Math.round(j.width*o),Math.round(j.height*o));}else{if(!k.quality||m!=="image/jpeg"){return h;}}if(k.quality){return j.encode(m,{quality:k.quality/100});}return j.encode(m);}catch(n){}return h;}c.runtimes.Gears=c.addRuntime("gears",{getFeatures:function(){return{dragdrop:true,jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true,multi_selection:true};},init:function(l,n){var m,h,g=false;if(!e.google||!google.gears){return n({success:false});}try{m=google.gears.factory.create("beta.desktop");}catch(k){return n({success:false});}function j(q){var p,o,r=[],s;for(o=0;o<q.length;o++){p=q[o];s=c.guid();f[s]=p.blob;r.push(new c.File(s,p.name,p.blob.length));}l.trigger("FilesAdded",r);}l.bind("PostInit",function(){var p=l.settings,o=b.getElementById(p.drop_element);if(o){c.addEvent(o,"dragover",function(q){m.setDropEffect(q,"copy");q.preventDefault();},l.id);c.addEvent(o,"drop",function(r){var q=m.getDragData(r,"application/x-gears-files");if(q){j(q.files);}r.preventDefault();},l.id);o=0;}c.addEvent(b.getElementById(p.browse_button),"click",function(u){var t=[],r,q,s;u.preventDefault();if(g){return;}no_type_restriction:for(r=0;r<p.filters.length;r++){s=p.filters[r].extensions.split(",");for(q=0;q<s.length;q++){if(s[q]==="*"){t=[];break no_type_restriction;}t.push("."+s[q]);}}m.openFiles(j,{singleFile:!p.multi_selection,filter:t});},l.id);});l.bind("CancelUpload",function(){if(h.abort){h.abort();}});l.bind("UploadFile",function(u,r){var w=0,v,s,t=0,q=u.settings.resize,o;if(q&&/\.(png|jpg|jpeg)$/i.test(r.name)){f[r.id]=a(f[r.id],q,/\.png$/i.test(r.name)?"image/png":"image/jpeg");}r.size=f[r.id].length;s=u.settings.chunk_size;o=s>0;v=Math.ceil(r.size/s);if(!o){s=r.size;v=1;}function p(){var C,y=u.settings.multipart,x=0,B={name:r.target_name||r.name},z=u.settings.url;function A(E){var D,J="----pluploadboundary"+c.guid(),G="--",I="\r\n",F,H;if(y){h.setRequestHeader("Content-Type","multipart/form-data; boundary="+J);D=google.gears.factory.create("beta.blobbuilder");c.each(c.extend(B,u.settings.multipart_params),function(L,K){D.append(G+J+I+'Content-Disposition: form-data; name="'+K+'"'+I+I);D.append(L+I);});H=c.mimeTypes[r.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream";D.append(G+J+I+'Content-Disposition: form-data; name="'+u.settings.file_data_name+'"; filename="'+r.name+'"'+I+"Content-Type: "+H+I+I);D.append(E);D.append(I+G+J+G+I);F=D.getAsBlob();x=F.length-E.length;E=F;}h.send(E);}if(r.status==c.DONE||r.status==c.FAILED||u.state==c.STOPPED){return;}if(o){B.chunk=w;B.chunks=v;}C=Math.min(s,r.size-(w*s));if(!y){z=c.buildUrl(u.settings.url,B);}h=google.gears.factory.create("beta.httprequest");h.open("POST",z);if(!y){h.setRequestHeader("Content-Disposition",'attachment; filename="'+r.name+'"');h.setRequestHeader("Content-Type","application/octet-stream");}c.each(u.settings.headers,function(E,D){h.setRequestHeader(D,E);});h.upload.onprogress=function(D){r.loaded=t+D.loaded-x;u.trigger("UploadProgress",r);};h.onreadystatechange=function(){var D;if(h.readyState==4&&u.state!==c.STOPPED){if(h.status==200){D={chunk:w,chunks:v,response:h.responseText,status:h.status};u.trigger("ChunkUploaded",r,D);if(D.cancelled){r.status=c.FAILED;return;}t+=C;if(++w>=v){r.status=c.DONE;u.trigger("FileUploaded",r,{response:h.responseText,status:h.status});}else{p();}}else{u.trigger("Error",{code:c.HTTP_ERROR,message:c.translate("HTTP Error."),file:r,chunk:w,chunks:v,status:h.status});}}};if(w<v){A(f[r.id].slice(w*s,C));}}p();});l.bind("DisableBrowse",function(o,p){g=p;});l.bind("Destroy",function(o){var p,q,r={browseButton:o.settings.browse_button,dropElm:o.settings.drop_element};for(p in r){q=b.getElementById(r[p]);if(q){c.removeAllEvents(q,o.id);}}});n({success:true});}});})(window,document,plupload);(function(g,b,d,e){var a={},h={};function c(o){var n,m=typeof o,j,l,k;if(o===e||o===null){return"null";}if(m==="string"){n="\bb\tt\nn\ff\rr\"\"''\\\\";return'"'+o.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(r,q){var p=n.indexOf(q);if(p+1){return"\\"+n.charAt(p+1);}r=q.charCodeAt().toString(16);return"\\u"+"0000".substring(r.length)+r;})+'"';}if(m=="object"){j=o.length!==e;n="";if(j){for(l=0;l<o.length;l++){if(n){n+=",";}n+=c(o[l]);}n="["+n+"]";}else{for(k in o){if(o.hasOwnProperty(k)){if(n){n+=",";}n+=c(k)+":"+c(o[k]);}}n="{"+n+"}";}return n;}return""+o;}function f(s){var v=false,j=null,o=null,k,l,m,u,n,q=0;try{try{o=new ActiveXObject("AgControl.AgControl");if(o.IsVersionSupported(s)){v=true;}o=null;}catch(r){var p=navigator.plugins["Silverlight Plug-In"];if(p){k=p.description;if(k==="1.0.30226.2"){k="2.0.30226.2";}l=k.split(".");while(l.length>3){l.pop();}while(l.length<4){l.push(0);}m=s.split(".");while(m.length>4){m.pop();}do{u=parseInt(m[q],10);n=parseInt(l[q],10);q++;}while(q<m.length&&u===n);if(u<=n&&!isNaN(u)){v=true;}}}}catch(t){v=false;}return v;}d.silverlight={trigger:function(n,k){var m=a[n],l,j;if(m){j=d.toArray(arguments).slice(1);j[0]="Silverlight:"+k;setTimeout(function(){m.trigger.apply(m,j);},0);}}};d.runtimes.Silverlight=d.addRuntime("silverlight",{getFeatures:function(){return{jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true,multi_selection:true};},init:function(p,q){var o,m="",n=p.settings.filters,l,k=b.body;if(!f("2.0.31005.0")||(g.opera&&g.opera.buildNumber)){q({success:false});return;}h[p.id]=false;a[p.id]=p;o=b.createElement("div");o.id=p.id+"_silverlight_container";d.extend(o.style,{position:"absolute",top:"0px",background:p.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100px",height:"100px",overflow:"hidden",opacity:p.settings.shim_bgcolor||b.documentMode>8?"":0.01});o.className="plupload silverlight";if(p.settings.container){k=b.getElementById(p.settings.container);if(d.getStyle(k,"position")==="static"){k.style.position="relative";}}k.appendChild(o);for(l=0;l<n.length;l++){m+=(m!=""?"|":"")+n[l].title+" | *."+n[l].extensions.replace(/,/g,";*.");}o.innerHTML='<object id="'+p.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="1024" height="1024"><param name="source" value="'+p.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="id='+p.id+",filter="+m+",multiselect="+p.settings.multi_selection+'"/></object>';function j(){return b.getElementById(p.id+"_silverlight").content.Upload;}p.bind("Silverlight:Init",function(){var r,s={};if(h[p.id]){return;}h[p.id]=true;p.bind("Silverlight:StartSelectFiles",function(t){r=[];});p.bind("Silverlight:SelectFile",function(t,w,u,v){var x;x=d.guid();s[x]=w;s[w]=x;r.push(new d.File(x,u,v));});p.bind("Silverlight:SelectSuccessful",function(){if(r.length){p.trigger("FilesAdded",r);}});p.bind("Silverlight:UploadChunkError",function(t,w,u,x,v){p.trigger("Error",{code:d.IO_ERROR,message:"IO Error.",details:v,file:t.getFile(s[w])});});p.bind("Silverlight:UploadFileProgress",function(t,x,u,w){var v=t.getFile(s[x]);if(v.status!=d.FAILED){v.size=w;v.loaded=u;t.trigger("UploadProgress",v);}});p.bind("Refresh",function(t){var u,v,w;u=b.getElementById(t.settings.browse_button);if(u){v=d.getPos(u,b.getElementById(t.settings.container));w=d.getSize(u);d.extend(b.getElementById(t.id+"_silverlight_container").style,{top:v.y+"px",left:v.x+"px",width:w.w+"px",height:w.h+"px"});}});p.bind("Silverlight:UploadChunkSuccessful",function(t,w,u,z,y){var x,v=t.getFile(s[w]);x={chunk:u,chunks:z,response:y};t.trigger("ChunkUploaded",v,x);if(v.status!=d.FAILED&&t.state!==d.STOPPED){j().UploadNextChunk();}if(u==z-1){v.status=d.DONE;t.trigger("FileUploaded",v,{response:y});}});p.bind("Silverlight:UploadSuccessful",function(t,w,u){var v=t.getFile(s[w]);v.status=d.DONE;t.trigger("FileUploaded",v,{response:u});});p.bind("FilesRemoved",function(t,v){var u;for(u=0;u<v.length;u++){j().RemoveFile(s[v[u].id]);}});p.bind("UploadFile",function(t,v){var w=t.settings,u=w.resize||{};j().UploadFile(s[v.id],t.settings.url,c({name:v.target_name||v.name,mime:d.mimeTypes[v.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:w.chunk_size,image_width:u.width,image_height:u.height,image_quality:u.quality,multipart:!!w.multipart,multipart_params:w.multipart_params||{},file_data_name:w.file_data_name,headers:w.headers}));});p.bind("CancelUpload",function(){j().CancelUpload();});p.bind("Silverlight:MouseEnter",function(t){var u,v;u=b.getElementById(p.settings.browse_button);v=t.settings.browse_button_hover;if(u&&v){d.addClass(u,v);}});p.bind("Silverlight:MouseLeave",function(t){var u,v;u=b.getElementById(p.settings.browse_button);v=t.settings.browse_button_hover;if(u&&v){d.removeClass(u,v);}});p.bind("Silverlight:MouseLeftButtonDown",function(t){var u,v;u=b.getElementById(p.settings.browse_button);v=t.settings.browse_button_active;if(u&&v){d.addClass(u,v);d.addEvent(b.body,"mouseup",function(){d.removeClass(u,v);});}});p.bind("Sliverlight:StartSelectFiles",function(t){var u,v;u=b.getElementById(p.settings.browse_button);v=t.settings.browse_button_active;if(u&&v){d.removeClass(u,v);}});p.bind("DisableBrowse",function(t,u){j().DisableBrowse(u);});p.bind("Destroy",function(t){var u;d.removeAllEvents(b.body,t.id);delete h[t.id];delete a[t.id];u=b.getElementById(t.id+"_silverlight_container");if(u){u.parentNode.removeChild(u);}});q({success:true});});}});})(window,document,plupload);(function(f,b,d,e){var a={},g={};function c(){var h;try{h=navigator.plugins["Shockwave Flash"];h=h.description;}catch(k){try{h=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version");}catch(j){h="0.0";}}h=h.match(/\d+/g);return parseFloat(h[0]+"."+h[1]);}d.flash={trigger:function(k,h,j){setTimeout(function(){var n=a[k],m,l;if(n){n.trigger("Flash:"+h,j);}},0);}};d.runtimes.Flash=d.addRuntime("flash",{getFeatures:function(){return{jpgresize:true,pngresize:true,maxWidth:8091,maxHeight:8091,chunks:true,progress:true,multipart:true,multi_selection:true};},init:function(n,p){var l,m,h=0,j=b.body;if(c()<10){p({success:false});return;}g[n.id]=false;a[n.id]=n;l=b.getElementById(n.settings.browse_button);m=b.createElement("div");m.id=n.id+"_flash_container";d.extend(m.style,{position:"absolute",top:"0px",background:n.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"});m.className="plupload flash";if(n.settings.container){j=b.getElementById(n.settings.container);if(d.getStyle(j,"position")==="static"){j.style.position="relative";}}j.appendChild(m);(function(){var q,r;q='<object id="'+n.id+'_flash" type="application/x-shockwave-flash" data="'+n.settings.flash_swf_url+'" ';if(d.ua.ie){q+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ';}q+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+n.settings.flash_swf_url+'" /><param name="flashvars" value="id='+escape(n.id)+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';if(d.ua.ie){r=b.createElement("div");m.appendChild(r);r.outerHTML=q;r=null;}else{m.innerHTML=q;}}());function o(){return b.getElementById(n.id+"_flash");}function k(){if(h++>5000){p({success:false});return;}if(g[n.id]===false){setTimeout(k,1);}}k();l=m=null;n.bind("Destroy",function(q){var r;d.removeAllEvents(b.body,q.id);delete g[q.id];delete a[q.id];r=b.getElementById(q.id+"_flash_container");if(r){r.parentNode.removeChild(r);}});n.bind("Flash:Init",function(){var s={},r;try{o().setFileFilters(n.settings.filters,n.settings.multi_selection);}catch(q){p({success:false});return;}if(g[n.id]){return;}g[n.id]=true;n.bind("UploadFile",function(t,v){var w=t.settings,u=n.settings.resize||{};o().uploadFile(s[v.id],w.url,{name:v.target_name||v.name,mime:d.mimeTypes[v.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:w.chunk_size,width:u.width,height:u.height,quality:u.quality,multipart:w.multipart,multipart_params:w.multipart_params||{},file_data_name:w.file_data_name,format:/\.(jpg|jpeg)$/i.test(v.name)?"jpg":"png",headers:w.headers,urlstream_upload:w.urlstream_upload});});n.bind("CancelUpload",function(){o().cancelUpload();});n.bind("Flash:UploadProcess",function(u,t){var v=u.getFile(s[t.id]);if(v.status!=d.FAILED){v.loaded=t.loaded;v.size=t.size;u.trigger("UploadProgress",v);}});n.bind("Flash:UploadChunkComplete",function(t,v){var w,u=t.getFile(s[v.id]);w={chunk:v.chunk,chunks:v.chunks,response:v.text};t.trigger("ChunkUploaded",u,w);if(u.status!==d.FAILED&&t.state!==d.STOPPED){o().uploadNextChunk();}if(v.chunk==v.chunks-1){u.status=d.DONE;t.trigger("FileUploaded",u,{response:v.text});}});n.bind("Flash:SelectFiles",function(t,w){var v,u,x=[],y;for(u=0;u<w.length;u++){v=w[u];y=d.guid();s[y]=v.id;s[v.id]=y;x.push(new d.File(y,v.name,v.size));}if(x.length){n.trigger("FilesAdded",x);}});n.bind("Flash:SecurityError",function(t,u){n.trigger("Error",{code:d.SECURITY_ERROR,message:d.translate("Security error."),details:u.message,file:n.getFile(s[u.id])});});n.bind("Flash:GenericError",function(t,u){n.trigger("Error",{code:d.GENERIC_ERROR,message:d.translate("Generic error."),details:u.message,file:n.getFile(s[u.id])});});n.bind("Flash:IOError",function(t,u){n.trigger("Error",{code:d.IO_ERROR,message:d.translate("IO error."),details:u.message,file:n.getFile(s[u.id])});});n.bind("Flash:ImageError",function(t,u){n.trigger("Error",{code:parseInt(u.code,10),message:d.translate("Image error."),file:n.getFile(s[u.id])});});n.bind("Flash:StageEvent:rollOver",function(t){var u,v;u=b.getElementById(n.settings.browse_button);v=t.settings.browse_button_hover;if(u&&v){d.addClass(u,v);}});n.bind("Flash:StageEvent:rollOut",function(t){var u,v;u=b.getElementById(n.settings.browse_button);v=t.settings.browse_button_hover;if(u&&v){d.removeClass(u,v);}});n.bind("Flash:StageEvent:mouseDown",function(t){var u,v;u=b.getElementById(n.settings.browse_button);v=t.settings.browse_button_active;if(u&&v){d.addClass(u,v);d.addEvent(b.body,"mouseup",function(){d.removeClass(u,v);},t.id);}});n.bind("Flash:StageEvent:mouseUp",function(t){var u,v;u=b.getElementById(n.settings.browse_button);v=t.settings.browse_button_active;if(u&&v){d.removeClass(u,v);}});n.bind("Flash:ExifData",function(t,u){n.trigger("ExifData",n.getFile(s[u.id]),u.data);});n.bind("Flash:GpsData",function(t,u){n.trigger("GpsData",n.getFile(s[u.id]),u.data);});n.bind("QueueChanged",function(t){n.refresh();});n.bind("FilesRemoved",function(t,v){var u;for(u=0;u<v.length;u++){o().removeFile(s[v[u].id]);}});n.bind("StateChanged",function(t){n.refresh();});n.bind("Refresh",function(t){var u,v,w;o().setFileFilters(n.settings.filters,n.settings.multi_selection);u=b.getElementById(t.settings.browse_button);if(u){v=d.getPos(u,b.getElementById(t.settings.container));w=d.getSize(u);d.extend(b.getElementById(t.id+"_flash_container").style,{top:v.y+"px",left:v.x+"px",width:w.w+"px",height:w.h+"px"});}});n.bind("DisableBrowse",function(t,u){o().disableBrowse(u);});p({success:true});});}});})(window,document,plupload);(function(a){a.runtimes.BrowserPlus=a.addRuntime("browserplus",{getFeatures:function(){return{dragdrop:true,jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true,multi_selection:true};},init:function(g,j){var e=window.BrowserPlus,h={},d=g.settings,c=d.resize;function f(o){var n,m,k=[],l,p;for(m=0;m<o.length;m++){l=o[m];p=a.guid();h[p]=l;k.push(new a.File(p,l.name,l.size));}if(m){g.trigger("FilesAdded",k);}}function b(){var k=false;g.bind("PostInit",function(){var o,m=d.drop_element,q=g.id+"_droptarget",l=document.getElementById(m),n;function r(t,s){e.DragAndDrop.AddDropTarget({id:t},function(u){e.DragAndDrop.AttachCallbacks({id:t,hover:function(v){if(!v&&s){s();}},drop:function(v){if(s){s();}f(v);}},function(){});});}function p(){document.getElementById(q).style.top="-1000px";}if(l){if(document.attachEvent&&(/MSIE/gi).test(navigator.userAgent)){o=document.createElement("div");o.setAttribute("id",q);a.extend(o.style,{position:"absolute",top:"-1000px",background:"red",filter:"alpha(opacity=0)",opacity:0});document.body.appendChild(o);a.addEvent(l,"dragenter",function(t){var s,u;s=document.getElementById(m);u=a.getPos(s);a.extend(document.getElementById(q).style,{top:u.y+"px",left:u.x+"px",width:s.offsetWidth+"px",height:s.offsetHeight+"px"});});r(q,p);}else{r(m);}}a.addEvent(document.getElementById(d.browse_button),"click",function(y){var s=[],u,t,x=d.filters,w,v;y.preventDefault();if(k){return;}no_type_restriction:for(u=0;u<x.length;u++){w=x[u].extensions.split(",");for(t=0;t<w.length;t++){if(w[t]==="*"){s=[];break no_type_restriction;}v=a.mimeTypes[w[t]];if(v&&a.inArray(v,s)===-1){s.push(a.mimeTypes[w[t]]);}}}e.FileBrowse.OpenBrowseDialog({mimeTypes:s},function(z){if(z.success){f(z.value);}});});l=o=null;});g.bind("CancelUpload",function(){e.Uploader.cancel({},function(){});});g.bind("DisableBrowse",function(l,m){k=m;});g.bind("UploadFile",function(o,l){var n=h[l.id],t={},m=o.settings.chunk_size,p,q=[];function s(u,w){var v;if(l.status==a.FAILED){return;}t.name=l.target_name||l.name;if(m){t.chunk=""+u;t.chunks=""+w;}v=q.shift();e.Uploader.upload({url:o.settings.url,files:{file:v},cookies:document.cookies,postvars:a.extend(t,o.settings.multipart_params),progressCallback:function(z){var y,x=0;p[u]=parseInt(z.filePercent*v.size/100,10);for(y=0;y<p.length;y++){x+=p[y];}l.loaded=x;o.trigger("UploadProgress",l);}},function(y){var x,z;if(y.success){x=y.value.statusCode;if(m){o.trigger("ChunkUploaded",l,{chunk:u,chunks:w,response:y.value.body,status:x});}if(q.length>0){s(++u,w);}else{l.status=a.DONE;o.trigger("FileUploaded",l,{response:y.value.body,status:x});if(x>=400){o.trigger("Error",{code:a.HTTP_ERROR,message:a.translate("HTTP Error."),file:l,status:x});}}}else{o.trigger("Error",{code:a.GENERIC_ERROR,message:a.translate("Generic Error."),file:l,details:y.error});}});}function r(u){l.size=u.size;if(m){e.FileAccess.chunk({file:u,chunkSize:m},function(x){if(x.success){var y=x.value,v=y.length;p=Array(v);for(var w=0;w<v;w++){p[w]=0;q.push(y[w]);}s(0,v);}});}else{p=Array(1);q.push(u);s(0,1);}}if(c&&/\.(png|jpg|jpeg)$/i.test(l.name)){BrowserPlus.ImageAlter.transform({file:n,quality:c.quality||90,actions:[{scale:{maxwidth:c.width,maxheight:c.height}}]},function(u){if(u.success){r(u.value.file);}});}else{r(n);}});j({success:true});}if(e){e.init(function(l){var k=[{service:"Uploader",version:"3"},{service:"DragAndDrop",version:"1"},{service:"FileBrowse",version:"1"},{service:"FileAccess",version:"2"}];if(c){k.push({service:"ImageAlter",version:"4"});}if(l.success){e.require({services:k},function(m){if(m.success){b();}else{j();}});}else{j();}});}else{j();}}});})(plupload);(function(k,m,l,g){var d={},j;function c(s){var r=s.naturalWidth,u=s.naturalHeight;if(r*u>1024*1024){var t=m.createElement("canvas");t.width=t.height=1;var q=t.getContext("2d");q.drawImage(s,-r+1,0);return q.getImageData(0,0,1,1).data[3]===0;}else{return false;}}function f(u,r,z){var q=m.createElement("canvas");q.width=1;q.height=z;var A=q.getContext("2d");A.drawImage(u,0,0);var t=A.getImageData(0,0,1,z).data;var x=0;var v=z;var y=z;while(y>x){var s=t[(y-1)*4+3];if(s===0){v=y;}else{x=y;}y=(v+x)>>1;}var w=(y/z);return(w===0)?1:w;}function o(K,s,t){var v=K.naturalWidth,z=K.naturalHeight;var E=t.width,B=t.height;var F=s.getContext("2d");F.save();var r=c(K);if(r){v/=2;z/=2;}var I=1024;var q=m.createElement("canvas");q.width=q.height=I;var u=q.getContext("2d");var G=f(K,v,z);var A=0;while(A<z){var J=A+I>z?z-A:I;var C=0;while(C<v){var D=C+I>v?v-C:I;u.clearRect(0,0,I,I);u.drawImage(K,-C,-A);var x=(C*E/v)<<0;var y=Math.ceil(D*E/v);var w=(A*B/z/G)<<0;var H=Math.ceil(J*B/z/G);F.drawImage(q,0,0,D,J,x,w,y,H);C+=I;}A+=I;}F.restore();q=u=null;}function p(r,s){var q;if("FileReader" in k){q=new FileReader();q.readAsDataURL(r);q.onload=function(){s(q.result);};}else{return s(r.getAsDataURL());}}function n(r,s){var q;if("FileReader" in k){q=new FileReader();q.readAsBinaryString(r);q.onload=function(){s(q.result);};}else{return s(r.getAsBinary());}}function e(u,s,q,y){var t,r,x,v,w=this;p(d[u.id],function(z){t=m.createElement("canvas");t.style.display="none";m.body.appendChild(t);x=new Image();x.onerror=x.onabort=function(){y({success:false});};x.onload=function(){var F,A,C,B,E;if(!s.width){s.width=x.width;}if(!s.height){s.height=x.height;}v=Math.min(s.width/x.width,s.height/x.height);if(v<1){F=Math.round(x.width*v);A=Math.round(x.height*v);}else{if(s.quality&&q==="image/jpeg"){F=x.width;A=x.height;}else{y({success:false});return;}}t.width=F;t.height=A;o(x,t,{width:F,height:A});if(q==="image/jpeg"){B=new h(atob(z.substring(z.indexOf("base64,")+7)));if(B.headers&&B.headers.length){E=new a();if(E.init(B.get("exif")[0])){E.setExif("PixelXDimension",F);E.setExif("PixelYDimension",A);B.set("exif",E.getBinary());if(w.hasEventListener("ExifData")){w.trigger("ExifData",u,E.EXIF());}if(w.hasEventListener("GpsData")){w.trigger("GpsData",u,E.GPS());}}}}if(s.quality&&q==="image/jpeg"){try{z=t.toDataURL(q,s.quality/100);}catch(D){z=t.toDataURL(q);}}else{z=t.toDataURL(q);}z=z.substring(z.indexOf("base64,")+7);z=atob(z);if(B&&B.headers&&B.headers.length){z=B.restore(z);B.purge();}t.parentNode.removeChild(t);y({success:true,data:z});};x.src=z;});}l.runtimes.Html5=l.addRuntime("html5",{getFeatures:function(){var v,r,u,t,s,q;r=u=s=q=false;if(k.XMLHttpRequest){v=new XMLHttpRequest();u=!!v.upload;r=!!(v.sendAsBinary||v.upload);}if(r){t=!!(v.sendAsBinary||(k.Uint8Array&&k.ArrayBuffer));s=!!(File&&(File.prototype.getAsDataURL||k.FileReader)&&t);q=!!(File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice));}j=l.ua.safari&&l.ua.windows;return{html5:r,dragdrop:(function(){var w=m.createElement("div");return("draggable" in w)||("ondragstart" in w&&"ondrop" in w);}()),jpgresize:s,pngresize:s,multipart:s||!!k.FileReader||!!k.FormData,canSendBinary:t,cantSendBlobInFormData:!!(l.ua.gecko&&k.FormData&&k.FileReader&&!FileReader.prototype.readAsArrayBuffer)||l.ua.android,progress:u,chunks:q,multi_selection:!(l.ua.safari&&l.ua.windows),triggerDialog:(l.ua.gecko&&k.FormData||l.ua.webkit)};},init:function(s,u){var q,t;function r(z){var x,w,y=[],A,v={};for(w=0;w<z.length;w++){x=z[w];if(v[x.name]&&l.ua.safari&&l.ua.windows){continue;}v[x.name]=true;A=l.guid();d[A]=x;y.push(new l.File(A,x.fileName||x.name,x.fileSize||x.size));}if(y.length){s.trigger("FilesAdded",y);}}q=this.getFeatures();if(!q.html5){u({success:false});return;}s.bind("Init",function(A){var J,I,F=[],z,G,w=A.settings.filters,x,E,v=m.body,H;J=m.createElement("div");J.id=A.id+"_html5_container";l.extend(J.style,{position:"absolute",background:s.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:s.settings.shim_bgcolor?"":0});J.className="plupload html5";if(s.settings.container){v=m.getElementById(s.settings.container);if(l.getStyle(v,"position")==="static"){v.style.position="relative";}}v.appendChild(J);no_type_restriction:for(z=0;z<w.length;z++){x=w[z].extensions.split(/,/);for(G=0;G<x.length;G++){if(x[G]==="*"){F=[];break no_type_restriction;}E=l.mimeTypes[x[G]];if(E&&l.inArray(E,F)===-1){F.push(E);}}}J.innerHTML='<input id="'+s.id+'_html5"  style="font-size:999px" type="file" accept="'+F.join(",")+'" '+(s.settings.multi_selection&&s.features.multi_selection?'multiple="multiple"':"")+" />";J.scrollTop=100;H=m.getElementById(s.id+"_html5");if(A.features.triggerDialog){l.extend(H.style,{position:"absolute",width:"100%",height:"100%"});}else{l.extend(H.style,{cssFloat:"right",styleFloat:"right"});}H.onchange=function(){r(this.files);this.value="";};I=m.getElementById(A.settings.browse_button);if(I){var C=A.settings.browse_button_hover,D=A.settings.browse_button_active,B=A.features.triggerDialog?I:J;if(C){l.addEvent(B,"mouseover",function(){l.addClass(I,C);},A.id);l.addEvent(B,"mouseout",function(){l.removeClass(I,C);},A.id);}if(D){l.addEvent(B,"mousedown",function(){l.addClass(I,D);},A.id);l.addEvent(m.body,"mouseup",function(){l.removeClass(I,D);},A.id);}if(A.features.triggerDialog){l.addEvent(I,"click",function(K){var y=m.getElementById(A.id+"_html5");if(y&&!y.disabled){y.click();}K.preventDefault();},A.id);}}});s.bind("PostInit",function(){var v=m.getElementById(s.settings.drop_element);if(v){if(j){l.addEvent(v,"dragenter",function(z){var y,w,x;y=m.getElementById(s.id+"_drop");if(!y){y=m.createElement("input");y.setAttribute("type","file");y.setAttribute("id",s.id+"_drop");y.setAttribute("multiple","multiple");l.addEvent(y,"change",function(){r(this.files);l.removeEvent(y,"change",s.id);y.parentNode.removeChild(y);},s.id);l.addEvent(y,"dragover",function(A){A.stopPropagation();},s.id);v.appendChild(y);}w=l.getPos(v,m.getElementById(s.settings.container));x=l.getSize(v);if(l.getStyle(v,"position")==="static"){l.extend(v.style,{position:"relative"});}l.extend(y.style,{position:"absolute",display:"block",top:0,left:0,width:x.w+"px",height:x.h+"px",opacity:0});},s.id);return;}l.addEvent(v,"dragover",function(w){w.preventDefault();},s.id);l.addEvent(v,"drop",function(x){var w=x.dataTransfer;if(w&&w.files){r(w.files);}x.preventDefault();},s.id);}});s.bind("Refresh",function(v){var w,x,y,A,z;w=m.getElementById(s.settings.browse_button);if(w){x=l.getPos(w,m.getElementById(v.settings.container));y=l.getSize(w);A=m.getElementById(s.id+"_html5_container");l.extend(A.style,{top:x.y+"px",left:x.x+"px",width:y.w+"px",height:y.h+"px"});if(s.features.triggerDialog){if(l.getStyle(w,"position")==="static"){l.extend(w.style,{position:"relative"});}z=parseInt(l.getStyle(w,"zIndex"),10);if(isNaN(z)){z=0;}l.extend(w.style,{zIndex:z});l.extend(A.style,{zIndex:z-1});}}});s.bind("DisableBrowse",function(v,x){var w=m.getElementById(v.id+"_html5");if(w){w.disabled=x;}});s.bind("CancelUpload",function(){if(t&&t.abort){t.abort();}});s.bind("UploadFile",function(v,x){var y=v.settings,B,w;function A(D,G,C){var E;if(File.prototype.slice){try{D.slice();return D.slice(G,C);}catch(F){return D.slice(G,C-G);}}else{if(E=File.prototype.webkitSlice||File.prototype.mozSlice){return E.call(D,G,C);}else{return null;}}}function z(C){var F=0,E=0;function D(){var L,P,N,O,K,M,H,G=v.settings.url;function J(S){if(t.sendAsBinary){t.sendAsBinary(S);}else{if(v.features.canSendBinary){var Q=new Uint8Array(S.length);for(var R=0;R<S.length;R++){Q[R]=(S.charCodeAt(R)&255);}t.send(Q.buffer);}}}function I(R){var V=0,W="----pluploadboundary"+l.guid(),T,S="--",U="\r\n",Q="";t=new XMLHttpRequest;if(t.upload){t.upload.onprogress=function(X){x.loaded=Math.min(x.size,E+X.loaded-V);v.trigger("UploadProgress",x);};}t.onreadystatechange=function(){var X,Z;if(t.readyState==4&&v.state!==l.STOPPED){try{X=t.status;}catch(Y){X=0;}if(X>=400){v.trigger("Error",{code:l.HTTP_ERROR,message:l.translate("HTTP Error."),file:x,status:X});}else{if(N){Z={chunk:F,chunks:N,response:t.responseText,status:X};v.trigger("ChunkUploaded",x,Z);E+=M;if(Z.cancelled){x.status=l.FAILED;return;}x.loaded=Math.min(x.size,(F+1)*K);}else{x.loaded=x.size;}v.trigger("UploadProgress",x);R=L=T=Q=null;if(!N||++F>=N){x.status=l.DONE;v.trigger("FileUploaded",x,{response:t.responseText,status:X});}else{D();}}}};if(v.settings.multipart&&q.multipart){O.name=x.target_name||x.name;t.open("post",G,true);l.each(v.settings.headers,function(Y,X){t.setRequestHeader(X,Y);});if(typeof(R)!=="string"&&!!k.FormData){T=new FormData();l.each(l.extend(O,v.settings.multipart_params),function(Y,X){T.append(X,Y);});T.append(v.settings.file_data_name,R);t.send(T);return;}if(typeof(R)==="string"){t.setRequestHeader("Content-Type","multipart/form-data; boundary="+W);l.each(l.extend(O,v.settings.multipart_params),function(Y,X){Q+=S+W+U+'Content-Disposition: form-data; name="'+X+'"'+U+U;Q+=unescape(encodeURIComponent(Y))+U;});H=l.mimeTypes[x.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream";Q+=S+W+U+'Content-Disposition: form-data; name="'+v.settings.file_data_name+'"; filename="'+unescape(encodeURIComponent(x.name))+'"'+U+"Content-Type: "+H+U+U+R+U+S+W+S+U;V=Q.length-R.length;R=Q;J(R);return;}}G=l.buildUrl(v.settings.url,l.extend(O,v.settings.multipart_params));t.open("post",G,true);t.setRequestHeader("Content-Type","application/octet-stream");l.each(v.settings.headers,function(Y,X){t.setRequestHeader(X,Y);});if(typeof(R)==="string"){J(R);}else{t.send(R);}}if(x.status==l.DONE||x.status==l.FAILED||v.state==l.STOPPED){return;}O={name:x.target_name||x.name};if(y.chunk_size&&x.size>y.chunk_size&&(q.chunks||typeof(C)=="string")){K=y.chunk_size;N=Math.ceil(x.size/K);M=Math.min(K,x.size-(F*K));if(typeof(C)=="string"){L=C.substring(F*K,F*K+M);}else{L=A(C,F*K,F*K+M);}O.chunk=F;O.chunks=N;}else{M=x.size;L=C;}if(v.settings.multipart&&q.multipart&&typeof(L)!=="string"&&k.FileReader&&q.cantSendBlobInFormData&&q.chunks&&v.settings.chunk_size){(function(){var Q=new FileReader();Q.onload=function(){I(Q.result);Q=null;};Q.readAsBinaryString(L);}());}else{I(L);}}D();}B=d[x.id];if(q.jpgresize&&v.settings.resize&&/\.(png|jpg|jpeg)$/i.test(x.name)){e.call(v,x,v.settings.resize,/\.png$/i.test(x.name)?"image/png":"image/jpeg",function(C){if(C.success){x.size=C.data.length;z(C.data);}else{if(q.chunks){z(B);}else{n(B,z);}}});}else{if(!q.chunks&&q.jpgresize){n(B,z);}else{z(B);}}});s.bind("Destroy",function(v){var x,y,w=m.body,z={inputContainer:v.id+"_html5_container",inputFile:v.id+"_html5",browseButton:v.settings.browse_button,dropElm:v.settings.drop_element};for(x in z){y=m.getElementById(z[x]);if(y){l.removeAllEvents(y,v.id);}}l.removeAllEvents(m.body,v.id);if(v.settings.container){w=m.getElementById(v.settings.container);}w.removeChild(m.getElementById(z.inputContainer));});u({success:true});}});function b(){var t=false,r;function u(w,y){var v=t?0:-8*(y-1),z=0,x;for(x=0;x<y;x++){z|=(r.charCodeAt(w+x)<<Math.abs(v+x*8));}return z;}function q(x,v,w){var w=arguments.length===3?w:r.length-v-1;r=r.substr(0,v)+x+r.substr(w+v);}function s(w,x,z){var A="",v=t?0:-8*(z-1),y;for(y=0;y<z;y++){A+=String.fromCharCode((x>>Math.abs(v+y*8))&255);}q(A,w,z);}return{II:function(v){if(v===g){return t;}else{t=v;}},init:function(v){t=false;r=v;},SEGMENT:function(v,x,w){switch(arguments.length){case 1:return r.substr(v,r.length-v-1);case 2:return r.substr(v,x);case 3:q(w,v,x);break;default:return r;}},BYTE:function(v){return u(v,1);},SHORT:function(v){return u(v,2);},LONG:function(v,w){if(w===g){return u(v,4);}else{s(v,w,4);}},SLONG:function(v){var w=u(v,4);return(w>2147483647?w-4294967296:w);},STRING:function(v,w){var x="";for(w+=v;v<w;v++){x+=String.fromCharCode(u(v,1));}return x;}};}function h(v){var x={65505:{app:"EXIF",name:"APP1",signature:"Exif\0"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\0"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\0"}},w=[],u,q,s=g,t=0,r;u=new b();u.init(v);if(u.SHORT(0)!==65496){return;}q=2;r=Math.min(1048576,v.length);while(q<=r){s=u.SHORT(q);if(s>=65488&&s<=65495){q+=2;continue;}if(s===65498||s===65497){break;}t=u.SHORT(q+2)+2;if(x[s]&&u.STRING(q+4,x[s].signature.length)===x[s].signature){w.push({hex:s,app:x[s].app.toUpperCase(),name:x[s].name.toUpperCase(),start:q,length:t,segment:u.SEGMENT(q,t)});}q+=t;}u.init(null);return{headers:w,restore:function(B){u.init(B);var z=new h(B);if(!z.headers){return false;}for(var A=z.headers.length;A>0;A--){var C=z.headers[A-1];u.SEGMENT(C.start,C.length,"");}z.purge();q=u.SHORT(2)==65504?4+u.SHORT(4):2;for(var A=0,y=w.length;A<y;A++){u.SEGMENT(q,0,w[A].segment);q+=w[A].length;}return u.SEGMENT();},get:function(A){var B=[];for(var z=0,y=w.length;z<y;z++){if(w[z].app===A.toUpperCase()){B.push(w[z].segment);}}return B;},set:function(B,A){var C=[];if(typeof(A)==="string"){C.push(A);}else{C=A;}for(var z=ii=0,y=w.length;z<y;z++){if(w[z].app===B.toUpperCase()){w[z].segment=C[ii];w[z].length=C[ii].length;ii++;}if(ii>=C.length){break;}}},purge:function(){w=[];u.init(null);}};}function a(){var t,q,r={},w;t=new b();q={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};w={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};function s(x,F){var z=t.SHORT(x),C,I,J,E,D,y,A,G,H=[],B={};for(C=0;C<z;C++){A=y=x+12*C+2;J=F[t.SHORT(A)];if(J===g){continue;}E=t.SHORT(A+=2);D=t.LONG(A+=2);A+=4;H=[];switch(E){case 1:case 7:if(D>4){A=t.LONG(A)+r.tiffHeader;}for(I=0;I<D;I++){H[I]=t.BYTE(A+I);}break;case 2:if(D>4){A=t.LONG(A)+r.tiffHeader;}B[J]=t.STRING(A,D-1);continue;case 3:if(D>2){A=t.LONG(A)+r.tiffHeader;}for(I=0;I<D;I++){H[I]=t.SHORT(A+I*2);}break;case 4:if(D>1){A=t.LONG(A)+r.tiffHeader;}for(I=0;I<D;I++){H[I]=t.LONG(A+I*4);}break;case 5:A=t.LONG(A)+r.tiffHeader;for(I=0;I<D;I++){H[I]=t.LONG(A+I*4)/t.LONG(A+I*4+4);}break;case 9:A=t.LONG(A)+r.tiffHeader;for(I=0;I<D;I++){H[I]=t.SLONG(A+I*4);}break;case 10:A=t.LONG(A)+r.tiffHeader;for(I=0;I<D;I++){H[I]=t.SLONG(A+I*4)/t.SLONG(A+I*4+4);}break;default:continue;}G=(D==1?H[0]:H);if(w.hasOwnProperty(J)&&typeof G!="object"){B[J]=w[J][G];}else{B[J]=G;}}return B;}function v(){var y=g,x=r.tiffHeader;t.II(t.SHORT(x)==18761);if(t.SHORT(x+=2)!==42){return false;}r.IFD0=r.tiffHeader+t.LONG(x+=2);y=s(r.IFD0,q.tiff);r.exifIFD=("ExifIFDPointer" in y?r.tiffHeader+y.ExifIFDPointer:g);r.gpsIFD=("GPSInfoIFDPointer" in y?r.tiffHeader+y.GPSInfoIFDPointer:g);return true;}function u(z,x,C){var E,B,A,D=0;if(typeof(x)==="string"){var y=q[z.toLowerCase()];for(hex in y){if(y[hex]===x){x=hex;break;}}}E=r[z.toLowerCase()+"IFD"];B=t.SHORT(E);for(i=0;i<B;i++){A=E+12*i+2;if(t.SHORT(A)==x){D=A+8;break;}}if(!D){return false;}t.LONG(D,C);return true;}return{init:function(x){r={tiffHeader:10};if(x===g||!x.length){return false;}t.init(x);if(t.SHORT(0)===65505&&t.STRING(4,5).toUpperCase()==="EXIF\0"){return v();}return false;},EXIF:function(){var y;y=s(r.exifIFD,q.exif);if(y.ExifVersion&&l.typeOf(y.ExifVersion)==="array"){for(var z=0,x="";z<y.ExifVersion.length;z++){x+=String.fromCharCode(y.ExifVersion[z]);}y.ExifVersion=x;}return y;},GPS:function(){var x;x=s(r.gpsIFD,q.gps);if(x.GPSVersionID){x.GPSVersionID=x.GPSVersionID.join(".");}return x;},setExif:function(x,y){if(x!=="PixelXDimension"&&x!=="PixelYDimension"){return false;}return u("exif",x,y);},getBinary:function(){return t.SEGMENT();}};}})(window,document,plupload);(function(d,a,b,c){function e(f){return a.getElementById(f);}b.runtimes.Html4=b.addRuntime("html4",{getFeatures:function(){return{multipart:true,triggerDialog:(b.ua.gecko&&d.FormData||b.ua.webkit)};},init:function(f,g){f.bind("Init",function(p){var j=a.body,n,h="javascript",k,x,q,z=[],r=/MSIE/.test(navigator.userAgent),t=[],m=p.settings.filters,o,l,s,w;no_type_restriction:for(o=0;o<m.length;o++){l=m[o].extensions.split(/,/);for(w=0;w<l.length;w++){if(l[w]==="*"){t=[];break no_type_restriction;}s=b.mimeTypes[l[w]];if(s&&b.inArray(s,t)===-1){t.push(s);}}}t=t.join(",");function v(){var C,A,y,B;q=b.guid();z.push(q);C=a.createElement("form");C.setAttribute("id","form_"+q);C.setAttribute("method","post");C.setAttribute("enctype","multipart/form-data");C.setAttribute("encoding","multipart/form-data");C.setAttribute("target",p.id+"_iframe");C.style.position="absolute";A=a.createElement("input");A.setAttribute("id","input_"+q);A.setAttribute("type","file");A.setAttribute("accept",t);A.setAttribute("size",1);B=e(p.settings.browse_button);if(p.features.triggerDialog&&B){b.addEvent(e(p.settings.browse_button),"click",function(D){if(!A.disabled){A.click();}D.preventDefault();},p.id);}b.extend(A.style,{width:"100%",height:"100%",opacity:0,fontSize:"99px",cursor:"pointer"});b.extend(C.style,{overflow:"hidden"});y=p.settings.shim_bgcolor;if(y){C.style.background=y;}if(r){b.extend(A.style,{filter:"alpha(opacity=0)"});}b.addEvent(A,"change",function(G){var E=G.target,D,F=[],H;if(E.value){e("form_"+q).style.top=-1048575+"px";D=E.value.replace(/\\/g,"/");D=D.substring(D.length,D.lastIndexOf("/")+1);F.push(new b.File(q,D));if(!p.features.triggerDialog){b.removeAllEvents(C,p.id);}else{b.removeEvent(B,"click",p.id);}b.removeEvent(A,"change",p.id);v();if(F.length){f.trigger("FilesAdded",F);}}},p.id);C.appendChild(A);j.appendChild(C);p.refresh();}function u(){var y=a.createElement("div");y.innerHTML='<iframe id="'+p.id+'_iframe" name="'+p.id+'_iframe" src="'+h+':&quot;&quot;" style="display:none"></iframe>';n=y.firstChild;j.appendChild(n);b.addEvent(n,"load",function(D){var E=D.target,C,A;if(!k){return;}try{C=E.contentWindow.document||E.contentDocument||d.frames[E.id].document;}catch(B){p.trigger("Error",{code:b.SECURITY_ERROR,message:b.translate("Security error."),file:k});return;}A=C.documentElement.innerText||C.documentElement.textContent;if(A){k.status=b.DONE;k.loaded=1025;k.percent=100;p.trigger("UploadProgress",k);p.trigger("FileUploaded",k,{response:A});}},p.id);}if(p.settings.container){j=e(p.settings.container);if(b.getStyle(j,"position")==="static"){j.style.position="relative";}}p.bind("UploadFile",function(y,B){var C,A;if(B.status==b.DONE||B.status==b.FAILED||y.state==b.STOPPED){return;}C=e("form_"+B.id);A=e("input_"+B.id);A.setAttribute("name",y.settings.file_data_name);C.setAttribute("action",y.settings.url);b.each(b.extend({name:B.target_name||B.name},y.settings.multipart_params),function(F,D){var E=a.createElement("input");b.extend(E,{type:"hidden",name:D,value:F});C.insertBefore(E,C.firstChild);});k=B;e("form_"+q).style.top=-1048575+"px";C.submit();});p.bind("FileUploaded",function(y){y.refresh();});p.bind("StateChanged",function(y){if(y.state==b.STARTED){u();}else{if(y.state==b.STOPPED){d.setTimeout(function(){b.removeEvent(n,"load",y.id);if(n.parentNode){n.parentNode.removeChild(n);}},0);}}b.each(y.files,function(B,A){if(B.status===b.DONE||B.status===b.FAILED){var C=e("form_"+B.id);if(C){C.parentNode.removeChild(C);}}});});p.bind("Refresh",function(A){var G,B,C,D,y,H,I,F,E;G=e(A.settings.browse_button);if(G){y=b.getPos(G,e(A.settings.container));H=b.getSize(G);I=e("form_"+q);F=e("input_"+q);b.extend(I.style,{top:y.y+"px",left:y.x+"px",width:H.w+"px",height:H.h+"px"});if(A.features.triggerDialog){if(b.getStyle(G,"position")==="static"){b.extend(G.style,{position:"relative"});}E=parseInt(G.style.zIndex,10);if(isNaN(E)){E=0;}b.extend(G.style,{zIndex:E});b.extend(I.style,{zIndex:E-1});}C=A.settings.browse_button_hover;D=A.settings.browse_button_active;B=A.features.triggerDialog?G:I;if(C){b.addEvent(B,"mouseover",function(){b.addClass(G,C);},A.id);b.addEvent(B,"mouseout",function(){b.removeClass(G,C);},A.id);}if(D){b.addEvent(B,"mousedown",function(){b.addClass(G,D);},A.id);b.addEvent(a.body,"mouseup",function(){b.removeClass(G,D);},A.id);}}});f.bind("FilesRemoved",function(y,B){var A,C;for(A=0;A<B.length;A++){C=e("form_"+B[A].id);if(C){C.parentNode.removeChild(C);}}});f.bind("DisableBrowse",function(y,B){var A=a.getElementById("input_"+q);if(A){A.disabled=B;}});f.bind("Destroy",function(y){var A,B,C,D={inputContainer:"form_"+q,inputFile:"input_"+q,browseButton:y.settings.browse_button};for(A in D){B=e(D[A]);if(B){b.removeAllEvents(B,y.id);}}b.removeAllEvents(a.body,y.id);b.each(z,function(F,E){C=e("form_"+F);if(C){C.parentNode.removeChild(C);}});});v();});g({success:true});}});})(window,document,plupload);"use strict";(function(){if(jQuery&&jQuery.jstree){return;}var is_ie6=false,is_ie7=false,is_ff2=false;(function($){$.vakata={};$.vakata.css={get_css:function(rule_name,delete_flag,sheet){rule_name=rule_name.toLowerCase();var css_rules=sheet.cssRules||sheet.rules,j=0;do{if(css_rules.length&&j>css_rules.length+5){return false;}if(css_rules[j].selectorText&&css_rules[j].selectorText.toLowerCase()==rule_name){if(delete_flag===true){if(sheet.removeRule){sheet.removeRule(j);}if(sheet.deleteRule){sheet.deleteRule(j);}return true;}else{return css_rules[j];}}}while(css_rules[++j]);return false;},add_css:function(rule_name,sheet){if($.jstree.css.get_css(rule_name,false,sheet)){return false;}if(sheet.insertRule){sheet.insertRule(rule_name+" { }",0);}else{sheet.addRule(rule_name,null,0);}return $.vakata.css.get_css(rule_name);},remove_css:function(rule_name,sheet){return $.vakata.css.get_css(rule_name,true,sheet);},add_sheet:function(opts){var tmp=false,is_new=true;if(opts.str){if(opts.title){tmp=$("style[id='"+opts.title+"-stylesheet']")[0];}if(tmp){is_new=false;}else{tmp=document.createElement("style");tmp.setAttribute("type","text/css");if(opts.title){tmp.setAttribute("id",opts.title+"-stylesheet");}}if(tmp.styleSheet){if(is_new){document.getElementsByTagName("head")[0].appendChild(tmp);tmp.styleSheet.cssText=opts.str;}else{tmp.styleSheet.cssText=tmp.styleSheet.cssText+" "+opts.str;}}else{tmp.appendChild(document.createTextNode(opts.str));document.getElementsByTagName("head")[0].appendChild(tmp);}return tmp.sheet||tmp.styleSheet;}if(opts.url){if(document.createStyleSheet){try{tmp=document.createStyleSheet(opts.url);}catch(e){}}else{tmp=document.createElement("link");tmp.rel="stylesheet";tmp.type="text/css";tmp.media="all";tmp.href=opts.url;document.getElementsByTagName("head")[0].appendChild(tmp);return tmp.styleSheet;}}}};var instances=[],focused_instance=-1,plugins={},prepared_move={};$.fn.jstree=function(settings){var isMethodCall=(typeof settings=="string"),args=Array.prototype.slice.call(arguments,1),returnValue=this;if(isMethodCall){if(settings.substring(0,1)=="_"){return returnValue;}this.each(function(){var instance=instances[$.data(this,"jstree_instance_id")],methodValue=(instance&&$.isFunction(instance[settings]))?instance[settings].apply(instance,args):instance;if(typeof methodValue!=="undefined"&&(settings.indexOf("is_")===0||(methodValue!==true&&methodValue!==false))){returnValue=methodValue;return false;}});}else{this.each(function(){var instance_id=$.data(this,"jstree_instance_id"),a=[],b=settings?$.extend({},true,settings):{},c=$(this),s=false,t=[];a=a.concat(args);if(c.data("jstree")){a.push(c.data("jstree"));}b=a.length?$.extend.apply(null,[true,b].concat(a)):b;if(typeof instance_id!=="undefined"&&instances[instance_id]){instances[instance_id].destroy();}instance_id=parseInt(instances.push({}),10)-1;$.data(this,"jstree_instance_id",instance_id);b.plugins=$.isArray(b.plugins)?b.plugins:$.jstree.defaults.plugins.slice();b.plugins.unshift("core");b.plugins=b.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");s=$.extend(true,{},$.jstree.defaults,b);s.plugins=b.plugins;$.each(plugins,function(i,val){if($.inArray(i,s.plugins)===-1){s[i]=null;delete s[i];}else{t.push(i);}});s.plugins=t;instances[instance_id]=new $.jstree._instance(instance_id,$(this).addClass("jstree jstree-"+instance_id),s);$.each(instances[instance_id]._get_settings().plugins,function(i,val){instances[instance_id].data[val]={};});$.each(instances[instance_id]._get_settings().plugins,function(i,val){if(plugins[val]){plugins[val].__init.apply(instances[instance_id]);}});setTimeout(function(){if(instances[instance_id]){instances[instance_id].init();}},0);});}return returnValue;};$.jstree={defaults:{plugins:[]},_focused:function(){return instances[focused_instance]||null;},_reference:function(needle){if(instances[needle]){return instances[needle];}var o=$(needle);if(!o.length&&typeof needle==="string"){o=$("#"+needle);}if(!o.length){return null;}return instances[o.closest(".jstree").data("jstree_instance_id")]||null;},_instance:function(index,container,settings){this.data={core:{}};this.get_settings=function(){return $.extend(true,{},settings);};this._get_settings=function(){return settings;};this.get_index=function(){return index;};this.get_container=function(){return container;};this.get_container_ul=function(){return container.children("ul:eq(0)");};this._set_settings=function(s){settings=$.extend(true,{},settings,s);};},_fn:{},plugin:function(pname,pdata){pdata=$.extend({},{__init:$.noop,__destroy:$.noop,_fn:{},defaults:false},pdata);plugins[pname]=pdata;$.jstree.defaults[pname]=pdata.defaults;$.each(pdata._fn,function(i,val){val.plugin=pname;val.old=$.jstree._fn[i];$.jstree._fn[i]=function(){var rslt,func=val,args=Array.prototype.slice.call(arguments),evnt=new $.Event("before.jstree"),rlbk=false;if(this.data.core.locked===true&&i!=="unlock"&&i!=="is_locked"){return;}do{if(func&&func.plugin&&$.inArray(func.plugin,this._get_settings().plugins)!==-1){break;}func=func.old;}while(func);if(!func){return;}if(i.indexOf("_")===0){rslt=func.apply(this,args);}else{rslt=this.get_container().triggerHandler(evnt,{"func":i,"inst":this,"args":args,"plugin":func.plugin});if(rslt===false){return;}if(typeof rslt!=="undefined"){args=rslt;}rslt=func.apply($.extend({},this,{__callback:function(data){this.get_container().triggerHandler(i+".jstree",{"inst":this,"args":args,"rslt":data,"rlbk":rlbk});},__rollback:function(){rlbk=this.get_rollback();return rlbk;},__call_old:function(replace_arguments){return func.old.apply(this,(replace_arguments?Array.prototype.slice.call(arguments,1):args));}}),args);}return rslt;};$.jstree._fn[i].old=val.old;$.jstree._fn[i].plugin=pname;});},rollback:function(rb){if(rb){if(!$.isArray(rb)){rb=[rb];}$.each(rb,function(i,val){instances[val.i].set_rollback(val.h,val.d);});}}};$.jstree._fn=$.jstree._instance.prototype={};$(function(){var u=navigator.userAgent.toLowerCase(),v=(u.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],css_string=""+".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } "+".jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } "+".jstree-rtl li { margin-left:0; margin-right:18px; } "+".jstree > ul > li { margin-left:0px; } "+".jstree-rtl > ul > li { margin-right:0px; } "+".jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } "+".jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } "+".jstree a:focus { outline: none; } "+".jstree a > ins { height:16px; width:16px; } "+".jstree a > .jstree-icon { margin-right:3px; } "+".jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } "+"li.jstree-open > ul { display:block; } "+"li.jstree-closed > ul { display:none; } ";if(/msie/.test(u)&&parseInt(v,10)==6){is_ie6=true;try{document.execCommand("BackgroundImageCache",false,true);}catch(err){}css_string+=""+".jstree li { height:18px; margin-left:0; margin-right:0; } "+".jstree li li { margin-left:18px; } "+".jstree-rtl li li { margin-left:0px; margin-right:18px; } "+"li.jstree-open ul { display:block; } "+"li.jstree-closed ul { display:none !important; } "+".jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } "+".jstree li a ins { height:16px; width:16px; margin-right:3px; } "+".jstree-rtl li a ins { margin-right:0px; margin-left:3px; } ";}if(/msie/.test(u)&&parseInt(v,10)==7){is_ie7=true;css_string+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } ";}if(!/compatible/.test(u)&&/mozilla/.test(u)&&parseFloat(v,10)<1.9){is_ff2=true;css_string+=""+".jstree ins { display:-moz-inline-box; } "+".jstree li { line-height:12px; } "+".jstree a { display:-moz-inline-box; } "+".jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } ";}$.vakata.css.add_sheet({str:css_string,title:"jstree"});});$.jstree.plugin("core",{__init:function(){this.data.core.locked=false;this.data.core.to_open=this.get_settings().core.initially_open;this.data.core.to_load=this.get_settings().core.initially_load;},defaults:{html_titles:false,animation:500,initially_open:[],initially_load:[],open_parents:true,notify_plugins:true,rtl:false,load_open:false,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus();if(this._get_settings().core.rtl){this.get_container().addClass("jstree-rtl").css("direction","rtl");}this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>");this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",$.proxy(function(event){var trgt=$(event.target);this.toggle_node(trgt);},this)).bind("mousedown.jstree",$.proxy(function(){this.set_focus();},this)).bind("dblclick.jstree",function(event){var sel;if(document.selection&&document.selection.empty){document.selection.empty();}else{if(window.getSelection){sel=window.getSelection();try{sel.removeAllRanges();sel.collapse();}catch(err){}}}});if(this._get_settings().core.notify_plugins){this.get_container().bind("load_node.jstree",$.proxy(function(e,data){var o=this._get_node(data.rslt.obj),t=this;if(o===-1){o=this.get_container_ul();}if(!o.length){return;}o.find("li").each(function(){var th=$(this);if(th.data("jstree")){$.each(th.data("jstree"),function(plugin,values){if(t.data[plugin]&&$.isFunction(t["_"+plugin+"_notify"])){t["_"+plugin+"_notify"].call(t,th,values);}});}});},this));}if(this._get_settings().core.load_open){this.get_container().bind("load_node.jstree",$.proxy(function(e,data){var o=this._get_node(data.rslt.obj),t=this;if(o===-1){o=this.get_container_ul();}if(!o.length){return;}o.find("li.jstree-open:not(:has(ul))").each(function(){t.load_node(this,$.noop,$.noop);});},this));}this.__callback();this.load_node(-1,function(){this.loaded();this.reload_nodes();});},destroy:function(){var i,n=this.get_index(),s=this._get_settings(),_this=this;$.each(s.plugins,function(i,val){try{plugins[val].__destroy.apply(_this);}catch(err){}});this.__callback();if(this.is_focused()){for(i in instances){if(instances.hasOwnProperty(i)&&i!=n){instances[i].set_focus();break;}}}if(n===focused_instance){focused_instance=-1;}this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"");});$(document).unbind(".jstree-"+n).undelegate(".jstree-"+n);instances[n]=null;delete instances[n];},_core_notify:function(n,data){if(data.opened){this.open_node(n,false,true);}},lock:function(){this.data.core.locked=true;this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7");this.__callback({});},unlock:function(){this.data.core.locked=false;this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1");this.__callback({});},is_locked:function(){return this.data.core.locked;},save_opened:function(){var _this=this;this.data.core.to_open=[];this.get_container_ul().find("li.jstree-open").each(function(){if(this.id){_this.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"));}});this.__callback(_this.data.core.to_open);},save_loaded:function(){},reload_nodes:function(is_callback){var _this=this,done=true,current=[],remaining=[];if(!is_callback){this.data.core.reopen=false;this.data.core.refreshing=true;this.data.core.to_open=$.map($.makeArray(this.data.core.to_open),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:");});this.data.core.to_load=$.map($.makeArray(this.data.core.to_load),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:");});if(this.data.core.to_open.length){this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open);}}if(this.data.core.to_load.length){$.each(this.data.core.to_load,function(i,val){if(val=="#"){return true;}if($(val).length){current.push(val);}else{remaining.push(val);}});if(current.length){this.data.core.to_load=remaining;$.each(current,function(i,val){if(!_this._is_loaded(val)){_this.load_node(val,function(){_this.reload_nodes(true);},function(){_this.reload_nodes(true);});done=false;}});}}if(this.data.core.to_open.length){$.each(this.data.core.to_open,function(i,val){_this.open_node(val,false,true);});}if(done){if(this.data.core.reopen){clearTimeout(this.data.core.reopen);}this.data.core.reopen=setTimeout(function(){_this.__callback({},_this);},50);this.data.core.refreshing=false;this.reopen();}},reopen:function(){var _this=this;if(this.data.core.to_open.length){$.each(this.data.core.to_open,function(i,val){_this.open_node(val,false,true);});}this.__callback({});},refresh:function(obj){var _this=this;this.save_opened();if(!obj){obj=-1;}obj=this._get_node(obj);if(!obj){obj=-1;}if(obj!==-1){obj.children("UL").remove();}else{this.get_container_ul().empty();}this.load_node(obj,function(){_this.__callback({"obj":obj});_this.reload_nodes();});},loaded:function(){this.__callback();},set_focus:function(){if(this.is_focused()){return;}var f=$.jstree._focused();if(f){f.unset_focus();}this.get_container().addClass("jstree-focused");focused_instance=this.get_index();this.__callback();},is_focused:function(){return focused_instance==this.get_index();},unset_focus:function(){if(this.is_focused()){this.get_container().removeClass("jstree-focused");focused_instance=-1;}this.__callback();},_get_node:function(obj){var $obj=$(obj,this.get_container());if($obj.is(".jstree")||obj==-1){return -1;}$obj=$obj.closest("li",this.get_container());return $obj.length?$obj:false;},_get_next:function(obj,strict){obj=this._get_node(obj);if(obj===-1){return this.get_container().find("> ul > li:first-child");}if(!obj.length){return false;}if(strict){return(obj.nextAll("li").size()>0)?obj.nextAll("li:eq(0)"):false;}if(obj.hasClass("jstree-open")){return obj.find("li:eq(0)");}else{if(obj.nextAll("li").size()>0){return obj.nextAll("li:eq(0)");}else{return obj.parentsUntil(".jstree","li").next("li").eq(0);}}},_get_prev:function(obj,strict){obj=this._get_node(obj);if(obj===-1){return this.get_container().find("> ul > li:last-child");}if(!obj.length){return false;}if(strict){return(obj.prevAll("li").length>0)?obj.prevAll("li:eq(0)"):false;}if(obj.prev("li").length){obj=obj.prev("li").eq(0);while(obj.hasClass("jstree-open")){obj=obj.children("ul:eq(0)").children("li:last");}return obj;}else{var o=obj.parentsUntil(".jstree","li:eq(0)");return o.length?o:false;}},_get_parent:function(obj){obj=this._get_node(obj);if(obj==-1||!obj.length){return false;}var o=obj.parentsUntil(".jstree","li:eq(0)");return o.length?o:-1;},_get_children:function(obj){obj=this._get_node(obj);if(obj===-1){return this.get_container().children("ul:eq(0)").children("li");}if(!obj.length){return false;}return obj.children("ul:eq(0)").children("li");},get_path:function(obj,id_mode){var p=[],_this=this;obj=this._get_node(obj);if(obj===-1||!obj||!obj.length){return false;}obj.parentsUntil(".jstree","li").each(function(){p.push(id_mode?this.id:_this.get_text(this));});p.reverse();p.push(id_mode?obj.attr("id"):this.get_text(obj));return p;},_get_string:function(key){return this._get_settings().core.strings[key]||key;},is_open:function(obj){obj=this._get_node(obj);return obj&&obj!==-1&&obj.hasClass("jstree-open");},is_closed:function(obj){obj=this._get_node(obj);return obj&&obj!==-1&&obj.hasClass("jstree-closed");},is_leaf:function(obj){obj=this._get_node(obj);return obj&&obj!==-1&&obj.hasClass("jstree-leaf");},correct_state:function(obj){obj=this._get_node(obj);if(!obj||obj===-1){return false;}obj.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove();this.__callback({"obj":obj});},open_node:function(obj,callback,skip_animation){obj=this._get_node(obj);if(!obj.length){return false;}if(!obj.hasClass("jstree-closed")){if(callback){callback.call();}return false;}var s=skip_animation||is_ie6?0:this._get_settings().core.animation,t=this;if(!this._is_loaded(obj)){obj.children("a").addClass("jstree-loading");this.load_node(obj,function(){t.open_node(obj,callback,skip_animation);},callback);}else{if(this._get_settings().core.open_parents){obj.parentsUntil(".jstree",".jstree-closed").each(function(){t.open_node(this,false,true);});}if(s){obj.children("ul").css("display","none");}obj.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading");if(s){obj.children("ul").stop(true,true).slideDown(s,function(){this.style.display="";t.after_open(obj);});}else{t.after_open(obj);}this.__callback({"obj":obj});if(callback){callback.call();}}},after_open:function(obj){this.__callback({"obj":obj});},close_node:function(obj,skip_animation){obj=this._get_node(obj);var s=skip_animation||is_ie6?0:this._get_settings().core.animation,t=this;if(!obj.length||!obj.hasClass("jstree-open")){return false;}if(s){obj.children("ul").attr("style","display:block !important");}obj.removeClass("jstree-open").addClass("jstree-closed");if(s){obj.children("ul").stop(true,true).slideUp(s,function(){this.style.display="";t.after_close(obj);});}else{t.after_close(obj);}this.__callback({"obj":obj});},after_close:function(obj){this.__callback({"obj":obj});},toggle_node:function(obj){obj=this._get_node(obj);if(obj.hasClass("jstree-closed")){return this.open_node(obj);}if(obj.hasClass("jstree-open")){return this.close_node(obj);}},open_all:function(obj,do_animation,original_obj){obj=obj?this._get_node(obj):-1;if(!obj||obj===-1){obj=this.get_container_ul();}if(original_obj){obj=obj.find("li.jstree-closed");}else{original_obj=obj;if(obj.is(".jstree-closed")){obj=obj.find("li.jstree-closed").andSelf();}else{obj=obj.find("li.jstree-closed");}}var _this=this;obj.each(function(){var __this=this;if(!_this._is_loaded(this)){_this.open_node(this,function(){_this.open_all(__this,do_animation,original_obj);},!do_animation);}else{_this.open_node(this,false,!do_animation);}});if(original_obj.find("li.jstree-closed").length===0){this.__callback({"obj":original_obj});}},close_all:function(obj,do_animation){var _this=this;obj=obj?this._get_node(obj):this.get_container();if(!obj||obj===-1){obj=this.get_container_ul();}obj.find("li.jstree-open").andSelf().each(function(){_this.close_node(this,!do_animation);});this.__callback({"obj":obj});},clean_node:function(obj){obj=obj&&obj!=-1?$(obj):this.get_container_ul();obj=obj.is("li")?obj.find("li").andSelf():obj.find("li");obj.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");obj.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({"obj":obj});},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(true),d:this.data};},set_rollback:function(html,data){this.get_container().empty().append(html);this.data=data;this.__callback();},load_node:function(obj,s_call,e_call){this.__callback({"obj":obj});},_is_loaded:function(obj){return true;},create_node:function(obj,position,js,callback,is_loaded){obj=this._get_node(obj);position=typeof position==="undefined"?"last":position;var d=$("<li />"),s=this._get_settings().core,tmp;if(obj!==-1&&!obj.length){return false;}if(!is_loaded&&!this._is_loaded(obj)){this.load_node(obj,function(){this.create_node(obj,position,js,callback,true);});return false;}this.__rollback();if(typeof js==="string"){js={"data":js};}if(!js){js={};}if(js.attr){d.attr(js.attr);}if(js.metadata){d.data(js.metadata);}if(js.state){d.addClass("jstree-"+js.state);}if(!js.data){js.data=this._get_string("new_node");}if(!$.isArray(js.data)){tmp=js.data;js.data=[];js.data.push(tmp);}$.each(js.data,function(i,m){tmp=$("<a />");if($.isFunction(m)){m=m.call(this,js);}if(typeof m=="string"){tmp.attr("href","#")[s.html_titles?"html":"text"](m);}else{if(!m.attr){m.attr={};}if(!m.attr.href){m.attr.href="#";}tmp.attr(m.attr)[s.html_titles?"html":"text"](m.title);if(m.language){tmp.addClass(m.language);}}tmp.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!m.icon&&js.icon){m.icon=js.icon;}if(m.icon){if(m.icon.indexOf("/")===-1){tmp.children("ins").addClass(m.icon);}else{tmp.children("ins").css("background","url('"+m.icon+"') center center no-repeat");}}d.append(tmp);});d.prepend("<ins class='jstree-icon'>&#160;</ins>");if(obj===-1){obj=this.get_container();if(position==="before"){position="first";}if(position==="after"){position="last";}}switch(position){case"before":obj.before(d);tmp=this._get_parent(obj);break;case"after":obj.after(d);tmp=this._get_parent(obj);break;case"inside":case"first":if(!obj.children("ul").length){obj.append("<ul />");}obj.children("ul").prepend(d);tmp=obj;break;case"last":if(!obj.children("ul").length){obj.append("<ul />");}obj.children("ul").append(d);tmp=obj;break;default:if(!obj.children("ul").length){obj.append("<ul />");}if(!position){position=0;}tmp=obj.children("ul").children("li").eq(position);if(tmp.length){tmp.before(d);}else{obj.children("ul").append(d);}tmp=obj;break;}if(tmp===-1||tmp.get(0)===this.get_container().get(0)){tmp=-1;}this.clean_node(tmp);this.__callback({"obj":d,"parent":tmp});if(callback){callback.call(this,d);}return d;},get_text:function(obj){obj=this._get_node(obj);if(!obj.length){return false;}var s=this._get_settings().core.html_titles;obj=obj.children("a:eq(0)");if(s){obj=obj.clone();obj.children("INS").remove();return obj.html();}else{obj=obj.contents().filter(function(){return this.nodeType==3;})[0];return obj.nodeValue;}},set_text:function(obj,val){obj=this._get_node(obj);if(!obj.length){return false;}obj=obj.children("a:eq(0)");if(this._get_settings().core.html_titles){var tmp=obj.children("INS").clone();obj.html(val).prepend(tmp);this.__callback({"obj":obj,"name":val});return true;}else{obj=obj.contents().filter(function(){return this.nodeType==3;})[0];this.__callback({"obj":obj,"name":val});return(obj.nodeValue=val);}},rename_node:function(obj,val){obj=this._get_node(obj);this.__rollback();if(obj&&obj.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))){this.__callback({"obj":obj,"name":val});}},delete_node:function(obj){obj=this._get_node(obj);if(!obj.length){return false;}this.__rollback();var p=this._get_parent(obj),prev=$([]),t=this;obj.each(function(){prev=prev.add(t._get_prev(this));});obj=obj.detach();if(p!==-1&&p.find("> ul > li").length===0){p.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");}this.clean_node(p);this.__callback({"obj":obj,"prev":prev,"parent":p});return obj;},prepare_move:function(o,r,pos,cb,is_cb){var p={};p.ot=$.jstree._reference(o)||this;p.o=p.ot._get_node(o);p.r=r===-1?-1:this._get_node(r);p.p=(typeof pos==="undefined"||pos===false)?"last":pos;if(!is_cb&&prepared_move.o&&prepared_move.o[0]===p.o[0]&&prepared_move.r[0]===p.r[0]&&prepared_move.p===p.p){this.__callback(prepared_move);if(cb){cb.call(this,prepared_move);}return;}p.ot=$.jstree._reference(p.o)||this;p.rt=$.jstree._reference(p.r)||this;if(p.r===-1||!p.r){p.cr=-1;switch(p.p){case"first":case"before":case"inside":p.cp=0;break;case"after":case"last":p.cp=p.rt.get_container().find(" > ul > li").length;break;default:p.cp=p.p;break;}}else{if(!/^(before|after)$/.test(p.p)&&!this._is_loaded(p.r)){return this.load_node(p.r,function(){this.prepare_move(o,r,pos,cb,true);});}switch(p.p){case"before":p.cp=p.r.index();p.cr=p.rt._get_parent(p.r);break;case"after":p.cp=p.r.index()+1;p.cr=p.rt._get_parent(p.r);break;case"inside":case"first":p.cp=0;p.cr=p.r;break;case"last":p.cp=p.r.find(" > ul > li").length;p.cr=p.r;break;default:p.cp=p.p;p.cr=p.r;break;}}p.np=p.cr==-1?p.rt.get_container():p.cr;p.op=p.ot._get_parent(p.o);p.cop=p.o.index();if(p.op===-1){p.op=p.ot?p.ot.get_container():this.get_container();}if(!/^(before|after)$/.test(p.p)&&p.op&&p.np&&p.op[0]===p.np[0]&&p.o.index()<p.cp){p.cp++;}p.or=p.np.find(" > ul > li:nth-child("+(p.cp+1)+")");prepared_move=p;this.__callback(prepared_move);if(cb){cb.call(this,prepared_move);}},check_move:function(){var obj=prepared_move,ret=true,r=obj.r===-1?this.get_container():obj.r;if(!obj||!obj.o||obj.or[0]===obj.o[0]){return false;}if(obj.op&&obj.np&&obj.op[0]===obj.np[0]&&obj.cp-1===obj.o.index()){return false;}obj.o.each(function(){if(r.parentsUntil(".jstree","li").andSelf().index(this)!==-1){ret=false;return false;}});return ret;},move_node:function(obj,ref,position,is_copy,is_prepared,skip_check){if(!is_prepared){return this.prepare_move(obj,ref,position,function(p){this.move_node(p,false,false,is_copy,true,skip_check);});}if(is_copy){prepared_move.cy=true;}if(!skip_check&&!this.check_move()){return false;}this.__rollback();var o=false;if(is_copy){o=obj.o.clone(true);o.find("*[id]").andSelf().each(function(){if(this.id){this.id="copy_"+this.id;}});}else{o=obj.o;}if(obj.or.length){obj.or.before(o);}else{if(!obj.np.children("ul").length){$("<ul />").appendTo(obj.np);}obj.np.children("ul:eq(0)").append(o);}try{obj.ot.clean_node(obj.op);obj.rt.clean_node(obj.np);if(!obj.op.find("> ul > li").length){obj.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove();}}catch(e){}if(is_copy){prepared_move.cy=true;prepared_move.oc=o;}this.__callback(prepared_move);return prepared_move;},_get_move:function(){return prepared_move;}}});})(jQuery);(function($){var scrollbar_width,e1,e2;$(function(){if(/msie/.test(navigator.userAgent.toLowerCase())){e1=$('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1000,left:0}).appendTo("body");e2=$('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1000,left:0}).appendTo("body");scrollbar_width=e1.width()-e2.width();e1.add(e2).remove();}else{e1=$("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1000,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200});scrollbar_width=100-e1.width();e1.parent().remove();}});$.jstree.plugin("ui",{__init:function(){this.data.ui.selected=$();this.data.ui.last_selected=false;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",$.proxy(function(event){event.preventDefault();event.currentTarget.blur();if(!$(event.currentTarget).hasClass("jstree-loading")){this.select_node(event.currentTarget,true,event);}},this)).delegate("a","mouseenter.jstree",$.proxy(function(event){if(!$(event.currentTarget).hasClass("jstree-loading")){this.hover_node(event.target);}},this)).delegate("a","mouseleave.jstree",$.proxy(function(event){if(!$(event.currentTarget).hasClass("jstree-loading")){this.dehover_node(event.target);}},this)).bind("reopen.jstree",$.proxy(function(){this.reselect();},this)).bind("get_rollback.jstree",$.proxy(function(){this.dehover_node();this.save_selected();},this)).bind("set_rollback.jstree",$.proxy(function(){this.reselect();},this)).bind("close_node.jstree",$.proxy(function(event,data){var s=this._get_settings().ui,obj=this._get_node(data.rslt.obj),clk=(obj&&obj.length)?obj.children("ul").find("a.jstree-clicked"):$(),_this=this;if(s.selected_parent_close===false||!clk.length){return;}clk.each(function(){_this.deselect_node(this);if(s.selected_parent_close==="select_parent"){_this.select_node(obj);}});},this)).bind("delete_node.jstree",$.proxy(function(event,data){var s=this._get_settings().ui.select_prev_on_delete,obj=this._get_node(data.rslt.obj),clk=(obj&&obj.length)?obj.find("a.jstree-clicked"):[],_this=this;clk.each(function(){_this.deselect_node(this);});if(s&&clk.length){data.rslt.prev.each(function(){if(this.parentNode){_this.select_node(this);return false;}});}},this)).bind("move_node.jstree",$.proxy(function(event,data){if(data.rslt.cy){data.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked");}},this));},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:true,select_prev_on_delete:true,disable_selecting_children:false,initially_select:[]},_fn:{_get_node:function(obj,allow_multiple){if(typeof obj==="undefined"||obj===null){return allow_multiple?this.data.ui.selected:this.data.ui.last_selected;}var $obj=$(obj,this.get_container());if($obj.is(".jstree")||obj==-1){return -1;}$obj=$obj.closest("li",this.get_container());return $obj.length?$obj:false;},_ui_notify:function(n,data){if(data.selected){this.select_node(n,false);}},save_selected:function(){var _this=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){if(this.id){_this.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"));}});this.__callback(this.data.ui.to_select);},reselect:function(){var _this=this,s=this.data.ui.to_select;s=$.map($.makeArray(s),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:");});$.each(s,function(i,val){if(val&&val!=="#"){_this.select_node(val);}});this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode;});this.__callback();},refresh:function(obj){this.save_selected();return this.__call_old();},hover_node:function(obj){obj=this._get_node(obj);if(!obj.length){return false;}if(!obj.hasClass("jstree-hovered")){this.dehover_node();}this.data.ui.hovered=obj.children("a").addClass("jstree-hovered").parent();this._fix_scroll(obj);this.__callback({"obj":obj});},dehover_node:function(){var obj=this.data.ui.hovered,p;if(!obj||!obj.length){return false;}p=obj.children("a").removeClass("jstree-hovered").parent();if(this.data.ui.hovered[0]===p[0]){this.data.ui.hovered=null;}this.__callback({"obj":obj});},select_node:function(obj,check,e){obj=this._get_node(obj);if(obj==-1||!obj||!obj.length){return false;}var s=this._get_settings().ui,is_multiple=(s.select_multiple_modifier=="on"||(s.select_multiple_modifier!==false&&e&&e[s.select_multiple_modifier+"Key"])),is_range=(s.select_range_modifier!==false&&e&&e[s.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==obj[0]&&this.data.ui.last_selected.parent()[0]===obj.parent()[0]),is_selected=this.is_selected(obj),proceed=true,t=this;if(check){if(s.disable_selecting_children&&is_multiple&&((obj.parentsUntil(".jstree","li").children("a.jstree-clicked").length)||(obj.children("ul").find("a.jstree-clicked:eq(0)").length))){return false;}proceed=false;switch(!0){case (is_range):this.data.ui.last_selected.addClass("jstree-last-selected");obj=obj[obj.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf();if(s.select_limit==-1||obj.length<s.select_limit){this.data.ui.last_selected.removeClass("jstree-last-selected");this.data.ui.selected.each(function(){if(this!==t.data.ui.last_selected[0]){t.deselect_node(this);}});is_selected=false;proceed=true;}else{proceed=false;}break;case (is_selected&&!is_multiple):this.deselect_all();is_selected=false;proceed=true;break;case (!is_selected&&!is_multiple):if(s.select_limit==-1||s.select_limit>0){this.deselect_all();proceed=true;}break;case (is_selected&&is_multiple):this.deselect_node(obj);break;case (!is_selected&&is_multiple):if(s.select_limit==-1||this.data.ui.selected.length+1<=s.select_limit){proceed=true;}break;}}if(proceed&&!is_selected){if(!is_range){this.data.ui.last_selected=obj;}obj.children("a").addClass("jstree-clicked");if(s.selected_parent_open){obj.parents(".jstree-closed").each(function(){t.open_node(this,false,true);});}this.data.ui.selected=this.data.ui.selected.add(obj);this._fix_scroll(obj.eq(0));this.__callback({"obj":obj,"e":e});}},_fix_scroll:function(obj){var c=this.get_container()[0],t;if(c.scrollHeight>c.offsetHeight){obj=this._get_node(obj);if(!obj||obj===-1||!obj.length||!obj.is(":visible")){return;}t=obj.offset().top-this.get_container().offset().top;if(t<0){c.scrollTop=c.scrollTop+t-1;}if(t+this.data.core.li_height+(c.scrollWidth>c.offsetWidth?scrollbar_width:0)>c.offsetHeight){c.scrollTop=c.scrollTop+(t-c.offsetHeight+this.data.core.li_height+1+(c.scrollWidth>c.offsetWidth?scrollbar_width:0));}}},deselect_node:function(obj){obj=this._get_node(obj);if(!obj.length){return false;}if(this.is_selected(obj)){obj.children("a").removeClass("jstree-clicked");this.data.ui.selected=this.data.ui.selected.not(obj);if(this.data.ui.last_selected.get(0)===obj.get(0)){this.data.ui.last_selected=this.data.ui.selected.eq(0);}this.__callback({"obj":obj});}},toggle_select:function(obj){obj=this._get_node(obj);if(!obj.length){return false;}if(this.is_selected(obj)){this.deselect_node(obj);}else{this.select_node(obj);}},is_selected:function(obj){return this.data.ui.selected.index(this._get_node(obj))>=0;},get_selected:function(context){return context?$(context).find("a.jstree-clicked").parent():this.data.ui.selected;},deselect_all:function(context){var ret=context?$(context).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();ret.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=$([]);this.data.ui.last_selected=false;this.__callback({"obj":ret});}}});$.jstree.defaults.plugins.push("ui");})(jQuery);(function($){$.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",$.proxy(function(e,data){if(this._get_settings().crrm.move.open_onmove){var t=this;data.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){t.open_node(this,false,true);});}},this));},defaults:{input_width_limit:200,move:{always_copy:false,open_onmove:true,default_position:"last",check_move:function(m){return true;}}},_fn:{_show_input:function(obj,callback){obj=this._get_node(obj);var rtl=this._get_settings().core.rtl,w=this._get_settings().crrm.input_width_limit,w1=obj.children("ins").width(),w2=obj.find("> a:visible > ins").width()*obj.find("> a:visible > ins").length,t=this.get_text(obj),h1=$("<div />",{css:{"position":"absolute","top":"-200px","left":(rtl?"0px":"-1000px"),"visibility":"hidden"}}).appendTo("body"),h2=obj.css("position","relative").append($("<input />",{"value":t,"class":"jstree-rename-input","css":{"padding":"0","border":"1px solid silver","position":"absolute","left":(rtl?"auto":(w1+w2+4)+"px"),"right":(rtl?(w1+w2+4)+"px":"auto"),"top":"0px","height":(this.data.core.li_height-2)+"px","lineHeight":(this.data.core.li_height-2)+"px","width":"150px"},"blur":$.proxy(function(){var i=obj.children(".jstree-rename-input"),v=i.val();if(v===""){v=t;}h1.remove();i.remove();this.set_text(obj,t);this.rename_node(obj,v);callback.call(this,obj,v,t);obj.css("position","");},this),"keyup":function(event){var key=event.keyCode||event.which;if(key==27){this.value=t;this.blur();return;}else{if(key==13){this.blur();return;}else{h2.width(Math.min(h1.text("pW"+this.value).width(),w));}}},"keypress":function(event){var key=event.keyCode||event.which;if(key==13){return false;}}})).children(".jstree-rename-input");this.set_text(obj,"");h1.css({fontFamily:h2.css("fontFamily")||"",fontSize:h2.css("fontSize")||"",fontWeight:h2.css("fontWeight")||"",fontStyle:h2.css("fontStyle")||"",fontStretch:h2.css("fontStretch")||"",fontVariant:h2.css("fontVariant")||"",letterSpacing:h2.css("letterSpacing")||"",wordSpacing:h2.css("wordSpacing")||""});h2.width(Math.min(h1.text("pW"+h2[0].value).width(),w))[0].select();},rename:function(obj){obj=this._get_node(obj);this.__rollback();var f=this.__callback;this._show_input(obj,function(obj,new_name,old_name){f.call(this,{"obj":obj,"new_name":new_name,"old_name":old_name});});},create:function(obj,position,js,callback,skip_rename){var t,_this=this;obj=this._get_node(obj);if(!obj){obj=-1;}this.__rollback();t=this.create_node(obj,position,js,function(t){var p=this._get_parent(t),pos=$(t).index();if(callback){callback.call(this,t);}if(p.length&&p.hasClass("jstree-closed")){this.open_node(p,false,true);}if(!skip_rename){this._show_input(t,function(obj,new_name,old_name){_this.__callback({"obj":obj,"name":new_name,"parent":p,"position":pos});});}else{_this.__callback({"obj":t,"name":this.get_text(t),"parent":p,"position":pos});}});return t;},remove:function(obj){obj=this._get_node(obj,true);var p=this._get_parent(obj),prev=this._get_prev(obj);this.__rollback();obj=this.delete_node(obj);if(obj!==false){this.__callback({"obj":obj,"prev":prev,"parent":p});}},check_move:function(){if(!this.__call_old()){return false;}var s=this._get_settings().crrm.move;if(!s.check_move.call(this,this._get_move())){return false;}return true;},move_node:function(obj,ref,position,is_copy,is_prepared,skip_check){var s=this._get_settings().crrm.move;if(!is_prepared){if(typeof position==="undefined"){position=s.default_position;}if(position==="inside"&&!s.default_position.match(/^(before|after)$/)){position=s.default_position;}return this.__call_old(true,obj,ref,position,is_copy,false,skip_check);}if(s.always_copy===true||(s.always_copy==="multitree"&&obj.rt.get_index()!==obj.ot.get_index())){is_copy=true;}this.__call_old(true,obj,ref,position,is_copy,true,skip_check);},cut:function(obj){obj=this._get_node(obj,true);if(!obj||!obj.length){return false;}this.data.crrm.cp_nodes=false;this.data.crrm.ct_nodes=obj;this.__callback({"obj":obj});},copy:function(obj){obj=this._get_node(obj,true);if(!obj||!obj.length){return false;}this.data.crrm.ct_nodes=false;this.data.crrm.cp_nodes=obj;this.__callback({"obj":obj});},paste:function(obj){obj=this._get_node(obj);if(!obj||!obj.length){return false;}var nodes=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes){return false;}if(this.data.crrm.ct_nodes){this.move_node(this.data.crrm.ct_nodes,obj);this.data.crrm.ct_nodes=false;}if(this.data.crrm.cp_nodes){this.move_node(this.data.crrm.cp_nodes,obj,false,true);}this.__callback({"obj":obj,"nodes":nodes});}}});})(jQuery);(function($){var themes_loaded=[];$.jstree._themes=false;$.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",$.proxy(function(){var s=this._get_settings().themes;this.data.themes.dots=s.dots;this.data.themes.icons=s.icons;this.set_theme(s.theme,s.url);},this)).bind("loaded.jstree",$.proxy(function(){if(!this.data.themes.dots){this.hide_dots();}else{this.show_dots();}if(!this.data.themes.icons){this.hide_icons();}else{this.show_icons();}},this));},defaults:{theme:"default",url:false,dots:true,icons:true},_fn:{set_theme:function(theme_name,theme_url){if(!theme_name){return false;}if(!theme_url){theme_url=$.jstree._themes+theme_name+"/style.css";}if($.inArray(theme_url,themes_loaded)==-1){$.vakata.css.add_sheet({"url":theme_url});themes_loaded.push(theme_url);}if(this.data.themes.theme!=theme_name){this.get_container().removeClass("jstree-"+this.data.themes.theme);this.data.themes.theme=theme_name;}this.get_container().addClass("jstree-"+theme_name);if(!this.data.themes.dots){this.hide_dots();}else{this.show_dots();}if(!this.data.themes.icons){this.hide_icons();}else{this.show_icons();}this.__callback();},get_theme:function(){return this.data.themes.theme;},show_dots:function(){this.data.themes.dots=true;this.get_container().children("ul").removeClass("jstree-no-dots");},hide_dots:function(){this.data.themes.dots=false;this.get_container().children("ul").addClass("jstree-no-dots");},toggle_dots:function(){if(this.data.themes.dots){this.hide_dots();}else{this.show_dots();}},show_icons:function(){this.data.themes.icons=true;this.get_container().children("ul").removeClass("jstree-no-icons");},hide_icons:function(){this.data.themes.icons=false;this.get_container().children("ul").addClass("jstree-no-icons");},toggle_icons:function(){if(this.data.themes.icons){this.hide_icons();}else{this.show_icons();}}}});$(function(){if($.jstree._themes===false){$("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/)){$.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/";return false;}});}if($.jstree._themes===false){$.jstree._themes="themes/";}});$.jstree.defaults.plugins.push("themes");})(jQuery);(function($){var bound=[];function exec(i,event){var f=$.jstree._focused(),tmp;if(f&&f.data&&f.data.hotkeys&&f.data.hotkeys.enabled){tmp=f._get_settings().hotkeys[i];if(tmp){return tmp.call(f,event);}}}$.jstree.plugin("hotkeys",{__init:function(){if(typeof $.hotkeys==="undefined"){throw"jsTree hotkeys: jQuery hotkeys plugin not included.";}if(!this.data.ui){throw"jsTree hotkeys: jsTree UI plugin not included.";}$.each(this._get_settings().hotkeys,function(i,v){if(v!==false&&$.inArray(i,bound)==-1){$(document).bind("keydown",i,function(event){return exec(i,event);});bound.push(i);}});this.get_container().bind("lock.jstree",$.proxy(function(){if(this.data.hotkeys.enabled){this.data.hotkeys.enabled=false;this.data.hotkeys.revert=true;}},this)).bind("unlock.jstree",$.proxy(function(){if(this.data.hotkeys.revert){this.data.hotkeys.enabled=true;}},this));this.enable_hotkeys();},defaults:{"up":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(o));return false;},"ctrl+up":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(o));return false;},"shift+up":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(o));return false;},"down":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(o));return false;},"ctrl+down":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(o));return false;},"shift+down":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(o));return false;},"left":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o){if(o.hasClass("jstree-open")){this.close_node(o);}else{this.hover_node(this._get_prev(o));}}return false;},"ctrl+left":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o){if(o.hasClass("jstree-open")){this.close_node(o);}else{this.hover_node(this._get_prev(o));}}return false;},"shift+left":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o){if(o.hasClass("jstree-open")){this.close_node(o);}else{this.hover_node(this._get_prev(o));}}return false;},"right":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o&&o.length){if(o.hasClass("jstree-closed")){this.open_node(o);}else{this.hover_node(this._get_next(o));}}return false;},"ctrl+right":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o&&o.length){if(o.hasClass("jstree-closed")){this.open_node(o);}else{this.hover_node(this._get_next(o));}}return false;},"shift+right":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o&&o.length){if(o.hasClass("jstree-closed")){this.open_node(o);}else{this.hover_node(this._get_next(o));}}return false;},"space":function(){if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").click();}return false;},"ctrl+space":function(event){event.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(event);}return false;},"shift+space":function(event){event.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(event);}return false;},"f2":function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected);},"del":function(){this.remove(this.data.ui.hovered||this._get_node(null));}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=true;},disable_hotkeys:function(){this.data.hotkeys.enabled=false;}}});})(jQuery);(function($){$.jstree.plugin("json_data",{__init:function(){var s=this._get_settings().json_data;if(s.progressive_unload){this.get_container().bind("after_close.jstree",function(e,data){data.rslt.obj.children("ul").remove();});}},defaults:{data:false,ajax:false,correct_state:true,progressive_render:false,progressive_unload:false},_fn:{load_node:function(obj,s_call,e_call){var _this=this;this.load_node_json(obj,function(){_this.__callback({"obj":_this._get_node(obj)});s_call.call(this);},e_call);},_is_loaded:function(obj){var s=this._get_settings().json_data;obj=this._get_node(obj);return obj==-1||!obj||(!s.ajax&&!s.progressive_render&&!$.isFunction(s.data))||obj.is(".jstree-open, .jstree-leaf")||obj.children("ul").children("li").length>0;},refresh:function(obj){obj=this._get_node(obj);var s=this._get_settings().json_data;if(obj&&obj!==-1&&s.progressive_unload&&($.isFunction(s.data)||!!s.ajax)){obj.removeData("jstree_children");}return this.__call_old();},load_node_json:function(obj,s_call,e_call){var s=this.get_settings().json_data,d,error_func=function(){},success_func=function(){};obj=this._get_node(obj);if(obj&&obj!==-1&&(s.progressive_render||s.progressive_unload)&&!obj.is(".jstree-open, .jstree-leaf")&&obj.children("ul").children("li").length===0&&obj.data("jstree_children")){d=this._parse_json(obj.data("jstree_children"),obj);if(d){obj.append(d);if(!s.progressive_unload){obj.removeData("jstree_children");}}this.clean_node(obj);if(s_call){s_call.call(this);}return;}if(obj&&obj!==-1){if(obj.data("jstree_is_loading")){return;}else{obj.data("jstree_is_loading",true);}}switch(!0){case (!s.data&&!s.ajax):throw"Neither data nor ajax settings supplied.";case ($.isFunction(s.data)):s.data.call(this,obj,$.proxy(function(d){d=this._parse_json(d,obj);if(!d){if(obj===-1||!obj){if(s.correct_state){this.get_container().children("ul").empty();}}else{obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(obj);}}if(e_call){e_call.call(this);}}else{if(obj===-1||!obj){this.get_container().children("ul").empty().append(d.children());}else{obj.append(d).children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");}this.clean_node(obj);if(s_call){s_call.call(this);}}},this));break;case (!!s.data&&!s.ajax)||(!!s.data&&!!s.ajax&&(!obj||obj===-1)):if(!obj||obj==-1){d=this._parse_json(s.data,obj);if(d){this.get_container().children("ul").empty().append(d.children());this.clean_node();}else{if(s.correct_state){this.get_container().children("ul").empty();}}}if(s_call){s_call.call(this);}break;case (!s.data&&!!s.ajax)||(!!s.data&&!!s.ajax&&obj&&obj!==-1):error_func=function(x,t,e){var ef=this.get_settings().json_data.ajax.error;if(ef){ef.call(this,x,t,e);}if(obj!=-1&&obj.length){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(t==="success"&&s.correct_state){this.correct_state(obj);}}else{if(t==="success"&&s.correct_state){this.get_container().children("ul").empty();}}if(e_call){e_call.call(this);}};success_func=function(d,t,x){var sf=this.get_settings().json_data.ajax.success;if(sf){d=sf.call(this,d,t,x)||d;}if(d===""||(d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")==="")||(!$.isArray(d)&&!$.isPlainObject(d))){return error_func.call(this,x,t,"");}d=this._parse_json(d,obj);if(d){if(obj===-1||!obj){this.get_container().children("ul").empty().append(d.children());}else{obj.append(d).children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");}this.clean_node(obj);if(s_call){s_call.call(this);}}else{if(obj===-1||!obj){if(s.correct_state){this.get_container().children("ul").empty();if(s_call){s_call.call(this);}}}else{obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(obj);if(s_call){s_call.call(this);}}}}};s.ajax.context=this;s.ajax.error=error_func;s.ajax.success=success_func;if(!s.ajax.dataType){s.ajax.dataType="json";}if($.isFunction(s.ajax.url)){s.ajax.url=s.ajax.url.call(this,obj);}if($.isFunction(s.ajax.data)){s.ajax.data=s.ajax.data.call(this,obj);}$.ajax(s.ajax);break;}},_parse_json:function(js,obj,is_callback){var d=false,p=this._get_settings(),s=p.json_data,t=p.core.html_titles,tmp,i,j,ul1,ul2;if(!js){return d;}if(s.progressive_unload&&obj&&obj!==-1){obj.data("jstree_children",d);}if($.isArray(js)){d=$();if(!js.length){return false;}for(i=0,j=js.length;i<j;i++){tmp=this._parse_json(js[i],obj,true);if(tmp.length){d=d.add(tmp);}}}else{if(typeof js=="string"){js={data:js};}if(!js.data&&js.data!==""){return d;}d=$("<li />");if(js.attr){d.attr(js.attr);}if(js.metadata){d.data(js.metadata);}if(js.state){d.addClass("jstree-"+js.state);}if(!$.isArray(js.data)){tmp=js.data;js.data=[];js.data.push(tmp);}$.each(js.data,function(i,m){tmp=$("<a />");if($.isFunction(m)){m=m.call(this,js);}if(typeof m=="string"){tmp.attr("href","#")[t?"html":"text"](m);}else{if(!m.attr){m.attr={};}if(!m.attr.href){m.attr.href="#";}tmp.attr(m.attr)[t?"html":"text"](m.title);if(m.language){tmp.addClass(m.language);}}tmp.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!m.icon&&js.icon){m.icon=js.icon;}if(m.icon){if(m.icon.indexOf("/")===-1){tmp.children("ins").addClass(m.icon);}else{tmp.children("ins").css("background","url('"+m.icon+"') center center no-repeat");}}d.append(tmp);});d.prepend("<ins class='jstree-icon'>&#160;</ins>");if(js.children){if(s.progressive_render&&js.state!=="open"){d.addClass("jstree-closed").data("jstree_children",js.children);}else{if(s.progressive_unload){d.data("jstree_children",js.children);}if($.isArray(js.children)&&js.children.length){tmp=this._parse_json(js.children,obj,true);if(tmp.length){ul2=$("<ul />");ul2.append(tmp);d.append(ul2);}}}}}if(!is_callback){ul1=$("<ul />");ul1.append(d);d=ul1;}return d;},get_json:function(obj,li_attr,a_attr,is_callback){var result=[],s=this._get_settings(),_this=this,tmp1,tmp2,li,a,t,lang;obj=this._get_node(obj);if(!obj||obj===-1){obj=this.get_container().find("> ul > li");}li_attr=$.isArray(li_attr)?li_attr:["id","class"];if(!is_callback&&this.data.types){li_attr.push(s.types.type_attr);}a_attr=$.isArray(a_attr)?a_attr:[];obj.each(function(){li=$(this);tmp1={data:[]};if(li_attr.length){tmp1.attr={};}$.each(li_attr,function(i,v){tmp2=li.attr(v);if(tmp2&&tmp2.length&&tmp2.replace(/jstree[^ ]*/ig,"").length){tmp1.attr[v]=(" "+tmp2).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"");}});if(li.hasClass("jstree-open")){tmp1.state="open";}if(li.hasClass("jstree-closed")){tmp1.state="closed";}if(li.data()){tmp1.metadata=li.data();}a=li.children("a");a.each(function(){t=$(this);if(a_attr.length||$.inArray("languages",s.plugins)!==-1||t.children("ins").get(0).style.backgroundImage.length||(t.children("ins").get(0).className&&t.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length)){lang=false;if($.inArray("languages",s.plugins)!==-1&&$.isArray(s.languages)&&s.languages.length){$.each(s.languages,function(l,lv){if(t.hasClass(lv)){lang=lv;return false;}});}tmp2={attr:{},title:_this.get_text(t,lang)};$.each(a_attr,function(k,z){tmp2.attr[z]=(" "+(t.attr(z)||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"");});if($.inArray("languages",s.plugins)!==-1&&$.isArray(s.languages)&&s.languages.length){$.each(s.languages,function(k,z){if(t.hasClass(z)){tmp2.language=z;return true;}});}if(t.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length){tmp2.icon=t.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"");}if(t.children("ins").get(0).style.backgroundImage.length){tmp2.icon=t.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","");}}else{tmp2=_this.get_text(t);}if(a.length>1){tmp1.data.push(tmp2);}else{tmp1.data=tmp2;}});li=li.find("> ul > li");if(li.length){tmp1.children=_this.get_json(li,li_attr,a_attr,true);}result.push(tmp1);});return result;}}});})(jQuery);(function($){$.jstree.plugin("languages",{__init:function(){this._load_css();},defaults:[],_fn:{set_lang:function(i){var langs=this._get_settings().languages,st=false,selector=".jstree-"+this.get_index()+" a";if(!$.isArray(langs)||langs.length===0){return false;}if($.inArray(i,langs)==-1){if(!!langs[i]){i=langs[i];}else{return false;}}if(i==this.data.languages.current_language){return true;}st=$.vakata.css.get_css(selector+"."+this.data.languages.current_language,false,this.data.languages.language_css);if(st!==false){st.style.display="none";}st=$.vakata.css.get_css(selector+"."+i,false,this.data.languages.language_css);if(st!==false){st.style.display="";}this.data.languages.current_language=i;this.__callback(i);return true;},get_lang:function(){return this.data.languages.current_language;},_get_string:function(key,lang){var langs=this._get_settings().languages,s=this._get_settings().core.strings;if($.isArray(langs)&&langs.length){lang=(lang&&$.inArray(lang,langs)!=-1)?lang:this.data.languages.current_language;}if(s[lang]&&s[lang][key]){return s[lang][key];}if(s[key]){return s[key];}return key;},get_text:function(obj,lang){obj=this._get_node(obj)||this.data.ui.last_selected;if(!obj.size()){return false;}var langs=this._get_settings().languages,s=this._get_settings().core.html_titles;if($.isArray(langs)&&langs.length){lang=(lang&&$.inArray(lang,langs)!=-1)?lang:this.data.languages.current_language;obj=obj.children("a."+lang);}else{obj=obj.children("a:eq(0)");}if(s){obj=obj.clone();obj.children("INS").remove();return obj.html();}else{obj=obj.contents().filter(function(){return this.nodeType==3;})[0];return obj.nodeValue;}},set_text:function(obj,val,lang){obj=this._get_node(obj)||this.data.ui.last_selected;if(!obj.size()){return false;}var langs=this._get_settings().languages,s=this._get_settings().core.html_titles,tmp;if($.isArray(langs)&&langs.length){lang=(lang&&$.inArray(lang,langs)!=-1)?lang:this.data.languages.current_language;obj=obj.children("a."+lang);}else{obj=obj.children("a:eq(0)");}if(s){tmp=obj.children("INS").clone();obj.html(val).prepend(tmp);this.__callback({"obj":obj,"name":val,"lang":lang});return true;}else{obj=obj.contents().filter(function(){return this.nodeType==3;})[0];this.__callback({"obj":obj,"name":val,"lang":lang});return(obj.nodeValue=val);}},_load_css:function(){var langs=this._get_settings().languages,str="/* languages css */",selector=".jstree-"+this.get_index()+" a",ln;if($.isArray(langs)&&langs.length){this.data.languages.current_language=langs[0];for(ln=0;ln<langs.length;ln++){str+=selector+"."+langs[ln]+" {";if(langs[ln]!=this.data.languages.current_language){str+=" display:none; ";}str+=" } ";}this.data.languages.language_css=$.vakata.css.add_sheet({"str":str,"title":"jstree-languages"});}},create_node:function(obj,position,js,callback){var t=this.__call_old(true,obj,position,js,function(t){var langs=this._get_settings().languages,a=t.children("a"),ln;if($.isArray(langs)&&langs.length){for(ln=0;ln<langs.length;ln++){if(!a.is("."+langs[ln])){t.append(a.eq(0).clone().removeClass(langs.join(" ")).addClass(langs[ln]));}}a.not("."+langs.join(", .")).remove();}if(callback){callback.call(this,t);}});return t;}}});})(jQuery);(function($){$.jstree.plugin("cookies",{__init:function(){if(typeof $.cookie==="undefined"){throw"jsTree cookie: jQuery cookie plugin not included.";}var s=this._get_settings().cookies,tmp;if(!!s.save_loaded){tmp=$.cookie(s.save_loaded);if(tmp&&tmp.length){this.data.core.to_load=tmp.split(",");}}if(!!s.save_opened){tmp=$.cookie(s.save_opened);if(tmp&&tmp.length){this.data.core.to_open=tmp.split(",");}}if(!!s.save_selected){tmp=$.cookie(s.save_selected);if(tmp&&tmp.length&&this.data.ui){this.data.ui.to_select=tmp.split(",");}}this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",$.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",$.proxy(function(e){if(this._get_settings().cookies.auto_save){this.save_cookie((e.handleObj.namespace+e.handleObj.type).replace("jstree",""));}},this));},this));},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:true,cookie_options:{}},_fn:{save_cookie:function(c){if(this.data.core.refreshing){return;}var s=this._get_settings().cookies;if(!c){if(s.save_loaded){this.save_loaded();$.cookie(s.save_loaded,this.data.core.to_load.join(","),s.cookie_options);}if(s.save_opened){this.save_opened();$.cookie(s.save_opened,this.data.core.to_open.join(","),s.cookie_options);}if(s.save_selected&&this.data.ui){this.save_selected();$.cookie(s.save_selected,this.data.ui.to_select.join(","),s.cookie_options);}return;}switch(c){case"open_node":case"close_node":if(!!s.save_opened){this.save_opened();$.cookie(s.save_opened,this.data.core.to_open.join(","),s.cookie_options);}if(!!s.save_loaded){this.save_loaded();$.cookie(s.save_loaded,this.data.core.to_load.join(","),s.cookie_options);}break;case"select_node":case"deselect_node":if(!!s.save_selected&&this.data.ui){this.save_selected();$.cookie(s.save_selected,this.data.ui.to_select.join(","),s.cookie_options);}break;}}}});})(jQuery);(function($){$.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",$.proxy(function(e,data){var obj=this._get_node(data.rslt.obj);obj=obj===-1?this.get_container().children("ul"):obj.children("ul");this.sort(obj);},this)).bind("rename_node.jstree create_node.jstree create.jstree",$.proxy(function(e,data){this.sort(data.rslt.obj.parent());},this)).bind("move_node.jstree",$.proxy(function(e,data){var m=data.rslt.np==-1?this.get_container():data.rslt.np;this.sort(m.children("ul"));},this));},defaults:function(a,b){return this.get_text(a)>this.get_text(b)?1:-1;},_fn:{sort:function(obj){var s=this._get_settings().sort,t=this;obj.append($.makeArray(obj.children("li")).sort($.proxy(s,t)));obj.find("> li > ul").each(function(){t.sort($(this));});this.clean_node(obj);}}});})(jQuery);(function($){var o=false,r=false,m=false,ml=false,sli=false,sti=false,dir1=false,dir2=false,last_pos=false;$.vakata.dnd={is_down:false,is_drag:false,helper:false,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(e,data,html){if($.vakata.dnd.is_drag){$.vakata.drag_stop({});}try{e.currentTarget.unselectable="on";e.currentTarget.onselectstart=function(){return false;};if(e.currentTarget.style){e.currentTarget.style.MozUserSelect="none";}}catch(err){}$.vakata.dnd.init_x=e.pageX;$.vakata.dnd.init_y=e.pageY;$.vakata.dnd.user_data=data;$.vakata.dnd.is_down=true;$.vakata.dnd.helper=$("<div id='vakata-dragged' />").html(html);$(document).bind("mousemove",$.vakata.dnd.drag);$(document).bind("mouseup",$.vakata.dnd.drag_stop);return false;},drag:function(e){if(!$.vakata.dnd.is_down){return;}if(!$.vakata.dnd.is_drag){if(Math.abs(e.pageX-$.vakata.dnd.init_x)>5||Math.abs(e.pageY-$.vakata.dnd.init_y)>5){$.vakata.dnd.helper.appendTo("body");$.vakata.dnd.is_drag=true;$(document).triggerHandler("drag_start.vakata",{"event":e,"data":$.vakata.dnd.user_data});}else{return;}}if(e.type==="mousemove"){var d=$(document),t=d.scrollTop(),l=d.scrollLeft();if(e.pageY-t<20){if(sti&&dir1==="down"){clearInterval(sti);sti=false;}if(!sti){dir1="up";sti=setInterval(function(){$(document).scrollTop($(document).scrollTop()-$.vakata.dnd.scroll_spd);},150);}}else{if(sti&&dir1==="up"){clearInterval(sti);sti=false;}}if($(window).height()-(e.pageY-t)<20){if(sti&&dir1==="up"){clearInterval(sti);sti=false;}if(!sti){dir1="down";sti=setInterval(function(){$(document).scrollTop($(document).scrollTop()+$.vakata.dnd.scroll_spd);},150);}}else{if(sti&&dir1==="down"){clearInterval(sti);sti=false;}}if(e.pageX-l<20){if(sli&&dir2==="right"){clearInterval(sli);sli=false;}if(!sli){dir2="left";sli=setInterval(function(){$(document).scrollLeft($(document).scrollLeft()-$.vakata.dnd.scroll_spd);},150);}}else{if(sli&&dir2==="left"){clearInterval(sli);sli=false;}}if($(window).width()-(e.pageX-l)<20){if(sli&&dir2==="left"){clearInterval(sli);sli=false;}if(!sli){dir2="right";sli=setInterval(function(){$(document).scrollLeft($(document).scrollLeft()+$.vakata.dnd.scroll_spd);},150);}}else{if(sli&&dir2==="right"){clearInterval(sli);sli=false;}}}$.vakata.dnd.helper.css({left:(e.pageX+$.vakata.dnd.helper_left)+"px",top:(e.pageY+$.vakata.dnd.helper_top)+"px"});$(document).triggerHandler("drag.vakata",{"event":e,"data":$.vakata.dnd.user_data});},drag_stop:function(e){if(sli){clearInterval(sli);}if(sti){clearInterval(sti);}$(document).unbind("mousemove",$.vakata.dnd.drag);$(document).unbind("mouseup",$.vakata.dnd.drag_stop);$(document).triggerHandler("drag_stop.vakata",{"event":e,"data":$.vakata.dnd.user_data});$.vakata.dnd.helper.remove();$.vakata.dnd.init_x=0;$.vakata.dnd.init_y=0;$.vakata.dnd.user_data={};$.vakata.dnd.is_down=false;$.vakata.dnd.is_drag=false;}};$(function(){var css_string="#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";$.vakata.css.add_sheet({str:css_string,title:"vakata"});});$.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:false,after:false,inside:false,before:false,off:false,prepared:false,w:0,to1:false,to2:false,cof:false,cw:false,ch:false,i1:false,i2:false,mto:false};this.get_container().bind("mouseenter.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(this.data.themes){m.attr("class","jstree-"+this.data.themes.theme);if(ml){ml.attr("class","jstree-"+this.data.themes.theme);}$.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme);}if(e.currentTarget===e.target&&$.vakata.dnd.user_data.obj&&$($.vakata.dnd.user_data.obj).length&&$($.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==e.target){var tr=$.jstree._reference(e.target),dc;if(tr.data.dnd.foreign){dc=tr._get_settings().dnd.drag_check.call(this,{"o":o,"r":tr.get_container(),is_root:true});if(dc===true||dc.inside===true||dc.before===true||dc.after===true){$.vakata.dnd.helper.children("ins").attr("class","jstree-ok");}}else{tr.prepare_move(o,tr.get_container(),"last");if(tr.check_move()){$.vakata.dnd.helper.children("ins").attr("class","jstree-ok");}}}}},this)).bind("mouseup.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&e.currentTarget===e.target&&$.vakata.dnd.user_data.obj&&$($.vakata.dnd.user_data.obj).length&&$($.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==e.target){var tr=$.jstree._reference(e.currentTarget),dc;if(tr.data.dnd.foreign){dc=tr._get_settings().dnd.drag_check.call(this,{"o":o,"r":tr.get_container(),is_root:true});if(dc===true||dc.inside===true||dc.before===true||dc.after===true){tr._get_settings().dnd.drag_finish.call(this,{"o":o,"r":tr.get_container(),is_root:true});}}else{tr.move_node(o,tr.get_container(),"last",e[tr._get_settings().dnd.copy_modifier+"Key"]);}}},this)).bind("mouseleave.jstree",$.proxy(function(e){if(e.relatedTarget&&e.relatedTarget.id&&e.relatedTarget.id==="jstree-marker-line"){return false;}if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1);}if(this.data.dnd.i2){clearInterval(this.data.dnd.i2);}if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);}if($.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");}}},this)).bind("mousemove.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){var cnt=this.get_container()[0];if(e.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1);}this.data.dnd.i1=setInterval($.proxy(function(){this.scrollLeft+=$.vakata.dnd.scroll_spd;},cnt),100);}else{if(e.pageX-24<this.data.dnd.cof.left){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1);}this.data.dnd.i1=setInterval($.proxy(function(){this.scrollLeft-=$.vakata.dnd.scroll_spd;},cnt),100);}else{if(this.data.dnd.i1){clearInterval(this.data.dnd.i1);}}}if(e.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2);}this.data.dnd.i2=setInterval($.proxy(function(){this.scrollTop+=$.vakata.dnd.scroll_spd;},cnt),100);}else{if(e.pageY-24<this.data.dnd.cof.top){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2);}this.data.dnd.i2=setInterval($.proxy(function(){this.scrollTop-=$.vakata.dnd.scroll_spd;},cnt),100);}else{if(this.data.dnd.i2){clearInterval(this.data.dnd.i2);}}}}},this)).bind("scroll.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&m&&ml){m.hide();ml.hide();}},this)).delegate("a","mousedown.jstree",$.proxy(function(e){if(e.which===1){this.start_drag(e.currentTarget,e);return false;}},this)).delegate("a","mouseenter.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){this.dnd_enter(e.currentTarget);}},this)).delegate("a","mousemove.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(!r||!r.length||r.children("a")[0]!==e.currentTarget){this.dnd_enter(e.currentTarget);}if(typeof this.data.dnd.off.top==="undefined"){this.data.dnd.off=$(e.target).offset();}this.data.dnd.w=(e.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height;if(this.data.dnd.w<0){this.data.dnd.w+=this.data.core.li_height;}this.dnd_show();}},this)).delegate("a","mouseleave.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(e.relatedTarget&&e.relatedTarget.id&&e.relatedTarget.id==="jstree-marker-line"){return false;}if(m){m.hide();}if(ml){ml.hide();}this.data.dnd.mto=setTimeout((function(t){return function(){t.dnd_leave(e);};})(this),0);}},this)).delegate("a","mouseup.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){this.dnd_finish(e);}},this));$(document).bind("drag_stop.vakata",$.proxy(function(){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);}if(this.data.dnd.i1){clearInterval(this.data.dnd.i1);}if(this.data.dnd.i2){clearInterval(this.data.dnd.i2);}this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;this.data.dnd.off=false;this.data.dnd.prepared=false;this.data.dnd.w=false;this.data.dnd.to1=false;this.data.dnd.to2=false;this.data.dnd.i1=false;this.data.dnd.i2=false;this.data.dnd.active=false;this.data.dnd.foreign=false;if(m){m.css({"top":"-2000px"});}if(ml){ml.css({"top":"-2000px"});}},this)).bind("drag_start.vakata",$.proxy(function(e,data){if(data.data.jstree){var et=$(data.event.target);if(et.closest(".jstree").hasClass("jstree-"+this.get_index())){this.dnd_enter(et);}}},this));var s=this._get_settings().dnd;if(s.drag_target){$(document).delegate(s.drag_target,"mousedown.jstree-"+this.get_index(),$.proxy(function(e){o=e.target;$.vakata.dnd.drag_start(e,{jstree:true,obj:e.target},"<ins class='jstree-icon'></ins>"+$(e.target).text());if(this.data.themes){if(m){m.attr("class","jstree-"+this.data.themes.theme);}if(ml){ml.attr("class","jstree-"+this.data.themes.theme);}$.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme);}$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var cnt=this.get_container();this.data.dnd.cof=cnt.offset();this.data.dnd.cw=parseInt(cnt.width(),10);this.data.dnd.ch=parseInt(cnt.height(),10);this.data.dnd.foreign=true;e.preventDefault();},this));}if(s.drop_target){$(document).delegate(s.drop_target,"mouseenter.jstree-"+this.get_index(),$.proxy(function(e){if(this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{"o":o,"r":$(e.target),"e":e})){$.vakata.dnd.helper.children("ins").attr("class","jstree-ok");}},this)).delegate(s.drop_target,"mouseleave.jstree-"+this.get_index(),$.proxy(function(e){if(this.data.dnd.active){$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");}},this)).delegate(s.drop_target,"mouseup.jstree-"+this.get_index(),$.proxy(function(e){if(this.data.dnd.active&&$.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){this._get_settings().dnd.drop_finish.call(this,{"o":o,"r":$(e.target),"e":e});}},this));}},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(data){return true;},drop_finish:$.noop,drag_target:".jstree-draggable",drag_finish:$.noop,drag_check:function(data){return{after:false,before:false,inside:true};}},_fn:{dnd_prepare:function(){if(!r||!r.length){return;}this.data.dnd.off=r.offset();if(this._get_settings().core.rtl){this.data.dnd.off.right=this.data.dnd.off.left+r.width();}if(this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{"o":o,"r":r});this.data.dnd.after=a.after;this.data.dnd.before=a.before;this.data.dnd.inside=a.inside;this.data.dnd.prepared=true;return this.dnd_show();}this.prepare_move(o,r,"before");this.data.dnd.before=this.check_move();this.prepare_move(o,r,"after");this.data.dnd.after=this.check_move();if(this._is_loaded(r)){this.prepare_move(o,r,"inside");this.data.dnd.inside=this.check_move();}else{this.data.dnd.inside=false;}this.data.dnd.prepared=true;return this.dnd_show();},dnd_show:function(){if(!this.data.dnd.prepared){return;}var o=["before","inside","after"],r=false,rtl=this._get_settings().core.rtl,pos;if(this.data.dnd.w<this.data.core.li_height/3){o=["before","inside","after"];}else{if(this.data.dnd.w<=this.data.core.li_height*2/3){o=this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"];}else{o=["after","inside","before"];}}$.each(o,$.proxy(function(i,val){if(this.data.dnd[val]){$.vakata.dnd.helper.children("ins").attr("class","jstree-ok");r=val;return false;}},this));if(r===false){$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");}pos=rtl?(this.data.dnd.off.right-18):(this.data.dnd.off.left+10);switch(r){case"before":m.css({"left":pos+"px","top":(this.data.dnd.off.top-6)+"px"}).show();if(ml){ml.css({"left":(pos+8)+"px","top":(this.data.dnd.off.top-1)+"px"}).show();}break;case"after":m.css({"left":pos+"px","top":(this.data.dnd.off.top+this.data.core.li_height-6)+"px"}).show();if(ml){ml.css({"left":(pos+8)+"px","top":(this.data.dnd.off.top+this.data.core.li_height-1)+"px"}).show();}break;case"inside":m.css({"left":pos+(rtl?-4:4)+"px","top":(this.data.dnd.off.top+this.data.core.li_height/2-5)+"px"}).show();if(ml){ml.hide();}break;default:m.hide();if(ml){ml.hide();}break;}last_pos=r;return r;},dnd_open:function(){this.data.dnd.to2=false;this.open_node(r,$.proxy(this.dnd_prepare,this),true);},dnd_finish:function(e){if(this.data.dnd.foreign){if(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside){this._get_settings().dnd.drag_finish.call(this,{"o":o,"r":r,"p":last_pos});}}else{this.dnd_prepare();this.move_node(o,r,last_pos,e[this._get_settings().dnd.copy_modifier+"Key"]);}o=false;r=false;m.hide();if(ml){ml.hide();}},dnd_enter:function(obj){if(this.data.dnd.mto){clearTimeout(this.data.dnd.mto);this.data.dnd.mto=false;}var s=this._get_settings().dnd;this.data.dnd.prepared=false;r=this._get_node(obj);if(s.check_timeout){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);}this.data.dnd.to1=setTimeout($.proxy(this.dnd_prepare,this),s.check_timeout);}else{this.dnd_prepare();}if(s.open_timeout){if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);}if(r&&r.length&&r.hasClass("jstree-closed")){this.data.dnd.to2=setTimeout($.proxy(this.dnd_open,this),s.open_timeout);}}else{if(r&&r.length&&r.hasClass("jstree-closed")){this.dnd_open();}}},dnd_leave:function(e){this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");m.hide();if(ml){ml.hide();}if(r&&r[0]===e.target.parentNode){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);this.data.dnd.to1=false;}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);this.data.dnd.to2=false;}}},start_drag:function(obj,e){o=this._get_node(obj);if(this.data.ui&&this.is_selected(o)){o=this._get_node(null,true);}var dt=o.length>1?this._get_string("multiple_selection"):this.get_text(o),cnt=this.get_container();if(!this._get_settings().core.html_titles){dt=dt.replace(/</ig,"&lt;").replace(/>/ig,"&gt;");}$.vakata.dnd.drag_start(e,{jstree:true,obj:o},"<ins class='jstree-icon'></ins>"+dt);if(this.data.themes){if(m){m.attr("class","jstree-"+this.data.themes.theme);}if(ml){ml.attr("class","jstree-"+this.data.themes.theme);}$.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme);}this.data.dnd.cof=cnt.offset();this.data.dnd.cw=parseInt(cnt.width(),10);this.data.dnd.ch=parseInt(cnt.height(),10);this.data.dnd.active=true;}}});$(function(){var css_string=""+"#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px; "+" -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; "+"} "+"#vakata-dragged .jstree-ok { background:green; } "+"#vakata-dragged .jstree-invalid { background:red; } "+"#jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } "+"#jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43; "+" cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666; "+" -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; "+"}"+"";$.vakata.css.add_sheet({str:css_string,title:"jstree"});m=$("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(e){m.hide();ml.hide();e.preventDefault();e.stopImmediatePropagation();return false;}).appendTo("body");ml=$("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(e){if(r&&r.length){r.children("a").trigger(e);e.preventDefault();e.stopImmediatePropagation();return false;}}).bind("mouseleave",function(e){var rt=$(e.relatedTarget);if(rt.is(".jstree")||rt.closest(".jstree").length===0){if(r&&r.length){r.children("a").trigger(e);m.hide();ml.hide();e.preventDefault();e.stopImmediatePropagation();return false;}}}).appendTo("body");$(document).bind("drag_start.vakata",function(e,data){if(data.data.jstree){m.show();if(ml){ml.show();}}});$(document).bind("drag_stop.vakata",function(e,data){if(data.data.jstree){m.hide();if(ml){ml.hide();}}});});})(jQuery);(function($){$.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui;if(this.data.ui&&this.data.checkbox.noui){this.select_node=this.deselect_node=this.deselect_all=$.noop;this.get_selected=this.get_checked;}this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",$.proxy(function(e,data){this._prepare_checkboxes(data.rslt.obj);},this)).bind("loaded.jstree",$.proxy(function(e){this._prepare_checkboxes();},this)).delegate((this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox"),"click.jstree",$.proxy(function(e){e.preventDefault();if(this._get_node(e.target).hasClass("jstree-checked")){this.uncheck_node(e.target);}else{this.check_node(e.target);}if(this.data.ui&&this.data.checkbox.noui){this.save_selected();if(this.data.cookies){this.save_cookie("select_node");}}else{e.stopImmediatePropagation();return false;}},this));},defaults:{override_ui:false,two_state:false,real_checkboxes:false,checked_parent_open:true,real_checkboxes_names:function(n){return[("check_"+(n[0].id||Math.ceil(Math.random()*10000))),1];}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove();},_fn:{_checkbox_notify:function(n,data){if(data.checked){this.check_node(n,false);}},_prepare_checkboxes:function(obj){obj=!obj||obj==-1?this.get_container().find("> ul > li"):this._get_node(obj);if(obj===false){return;}var c,_this=this,t,ts=this._get_settings().checkbox.two_state,rc=this._get_settings().checkbox.real_checkboxes,rcn=this._get_settings().checkbox.real_checkboxes_names;obj.each(function(){t=$(this);c=t.is("li")&&(t.hasClass("jstree-checked")||(rc&&t.children(":checked").length))?"jstree-checked":"jstree-unchecked";t.find("li").andSelf().each(function(){var $t=$(this),nm;$t.children("a"+(_this.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(ts?"jstree-unchecked":c);if(rc){if(!$t.children(":checkbox").length){nm=rcn.call(_this,$t);$t.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+nm[0]+"' name='"+nm[0]+"' value='"+nm[1]+"' />");}else{$t.children(":checkbox").addClass("jstree-real-checkbox");}}if(!ts){if(c==="jstree-checked"||$t.hasClass("jstree-checked")||$t.children(":checked").length){$t.find("li").andSelf().addClass("jstree-checked").children(":checkbox").prop("checked",true);}}else{if($t.hasClass("jstree-checked")||$t.children(":checked").length){$t.addClass("jstree-checked").children(":checkbox").prop("checked",true);}}});});if(!ts){obj.find(".jstree-checked").parent().parent().each(function(){_this._repair_state(this);});}},change_state:function(obj,state){obj=this._get_node(obj);var coll=false,rc=this._get_settings().checkbox.real_checkboxes;if(!obj||obj===-1){return false;}state=(state===false||state===true)?state:obj.hasClass("jstree-checked");if(this._get_settings().checkbox.two_state){if(state){obj.removeClass("jstree-checked").addClass("jstree-unchecked");if(rc){obj.children(":checkbox").prop("checked",false);}}else{obj.removeClass("jstree-unchecked").addClass("jstree-checked");if(rc){obj.children(":checkbox").prop("checked",true);}}}else{if(state){coll=obj.find("li").andSelf();if(!coll.filter(".jstree-checked, .jstree-undetermined").length){return false;}coll.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");if(rc){coll.children(":checkbox").prop("checked",false);}}else{coll=obj.find("li").andSelf();if(!coll.filter(".jstree-unchecked, .jstree-undetermined").length){return false;}coll.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(rc){coll.children(":checkbox").prop("checked",true);}if(this.data.ui){this.data.ui.last_selected=obj;}this.data.checkbox.last_selected=obj;}obj.parentsUntil(".jstree","li").each(function(){var $this=$(this);if(state){if($this.children("ul").children("li.jstree-checked, li.jstree-undetermined").length){$this.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(rc){$this.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",false);}return false;}else{$this.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");if(rc){$this.children(":checkbox").prop("checked",false);}}}else{if($this.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length){$this.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(rc){$this.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",false);}return false;}else{$this.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(rc){$this.children(":checkbox").prop("checked",true);}}}});}if(this.data.ui&&this.data.checkbox.noui){this.data.ui.selected=this.get_checked();}this.__callback(obj);return true;},check_node:function(obj){if(this.change_state(obj,false)){obj=this._get_node(obj);if(this._get_settings().checkbox.checked_parent_open){var t=this;obj.parents(".jstree-closed").each(function(){t.open_node(this,false,true);});}this.__callback({"obj":obj});}},uncheck_node:function(obj){if(this.change_state(obj,true)){this.__callback({"obj":this._get_node(obj)});}},check_all:function(){var _this=this,coll=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");coll.each(function(){_this.change_state(this,false);});this.__callback();},uncheck_all:function(){var _this=this,coll=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");coll.each(function(){_this.change_state(this,true);});this.__callback();},is_checked:function(obj){obj=this._get_node(obj);return obj.length?obj.is(".jstree-checked"):false;},get_checked:function(obj,get_all){obj=!obj||obj===-1?this.get_container():this._get_node(obj);return get_all||this._get_settings().checkbox.two_state?obj.find(".jstree-checked"):obj.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked");},get_unchecked:function(obj,get_all){obj=!obj||obj===-1?this.get_container():this._get_node(obj);return get_all||this._get_settings().checkbox.two_state?obj.find(".jstree-unchecked"):obj.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked");},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes");},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes");},_repair_state:function(obj){obj=this._get_node(obj);if(!obj.length){return;}if(this._get_settings().checkbox.two_state){obj.find("li").andSelf().not(".jstree-checked").removeClass("jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",true);return;}var rc=this._get_settings().checkbox.real_checkboxes,a=obj.find("> ul > .jstree-checked").length,b=obj.find("> ul > .jstree-undetermined").length,c=obj.find("> ul > li").length;if(c===0){if(obj.hasClass("jstree-undetermined")){this.change_state(obj,false);}}else{if(a===0&&b===0){this.change_state(obj,true);}else{if(a===c){this.change_state(obj,false);}else{obj.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(rc){obj.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",false);}}}}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var _this=this,s=this.data.ui.to_select;s=$.map($.makeArray(s),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:");});this.deselect_all();$.each(s,function(i,val){_this.check_node(val);});this.__callback();}else{this.__call_old();}},save_loaded:function(){var _this=this;this.data.core.to_load=[];this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){if(this.id){_this.data.core.to_load.push("#"+this.id);}});}}});$(function(){var css_string=".jstree .jstree-real-checkbox { display:none; } ";$.vakata.css.add_sheet({str:css_string,title:"jstree"});});})(jQuery);(function($){$.vakata.xslt=function(xml,xsl,callback){var rs="",xm,xs,processor,support;if(document.recalc){xm=document.createElement("xml");xs=document.createElement("xml");xm.innerHTML=xml;xs.innerHTML=xsl;$("body").append(xm).append(xs);setTimeout((function(xm,xs,callback){return function(){callback.call(null,xm.transformNode(xs.XMLDocument));setTimeout((function(xm,xs){return function(){$(xm).remove();$(xs).remove();};})(xm,xs),200);};})(xm,xs,callback),100);return true;}if(typeof window.DOMParser!=="undefined"&&typeof window.XMLHttpRequest!=="undefined"&&typeof window.XSLTProcessor==="undefined"){xml=new DOMParser().parseFromString(xml,"text/xml");xsl=new DOMParser().parseFromString(xsl,"text/xml");}if(typeof window.DOMParser!=="undefined"&&typeof window.XMLHttpRequest!=="undefined"&&typeof window.XSLTProcessor!=="undefined"){processor=new XSLTProcessor();support=$.isFunction(processor.transformDocument)?(typeof window.XMLSerializer!=="undefined"):true;if(!support){return false;}xml=new DOMParser().parseFromString(xml,"text/xml");xsl=new DOMParser().parseFromString(xsl,"text/xml");if($.isFunction(processor.transformDocument)){rs=document.implementation.createDocument("","",null);processor.transformDocument(xml,xsl,rs,null);callback.call(null,new XMLSerializer().serializeToString(rs));return true;}else{processor.importStylesheet(xsl);rs=processor.transformToFragment(xml,document);callback.call(null,$("<div />").append(rs).html());return true;}}return false;};var xsl={"nest":"<"+'?xml version="1.0" encoding="utf-8" ?>'+'<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >'+'<xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" />'+'<xsl:template match="/">'+'	<xsl:call-template name="nodes">'+'		<xsl:with-param name="node" select="/root" />'+"	</xsl:call-template>"+"</xsl:template>"+'<xsl:template name="nodes">'+'	<xsl:param name="node" />'+"	<ul>"+'	<xsl:for-each select="$node/item">'+'		<xsl:variable name="children" select="count(./item) &gt; 0" />'+"		<li>"+'			<xsl:attribute name="class">'+'				<xsl:if test="position() = last()">jstree-last </xsl:if>'+"				<xsl:choose>"+"					<xsl:when test=\"@state = 'open'\">jstree-open </xsl:when>"+"					<xsl:when test=\"$children or @hasChildren or @state = 'closed'\">jstree-closed </xsl:when>"+"					<xsl:otherwise>jstree-leaf </xsl:otherwise>"+"				</xsl:choose>"+'				<xsl:value-of select="@class" />'+"			</xsl:attribute>"+'			<xsl:for-each select="@*">'+"				<xsl:if test=\"name() != 'class' and name() != 'state' and name() != 'hasChildren'\">"+'					<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+"				</xsl:if>"+"			</xsl:for-each>"+'	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>'+'			<xsl:for-each select="content/name">'+"				<a>"+'				<xsl:attribute name="href">'+"					<xsl:choose>"+'					<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>'+"					<xsl:otherwise>#</xsl:otherwise>"+"					</xsl:choose>"+"				</xsl:attribute>"+'				<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>'+'				<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>'+'				<xsl:for-each select="@*">'+"					<xsl:if test=\"name() != 'style' and name() != 'class' and name() != 'href'\">"+'						<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+"					</xsl:if>"+"				</xsl:for-each>"+"					<ins>"+'						<xsl:attribute name="class">jstree-icon '+'							<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>'+"						</xsl:attribute>"+'						<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>'+"						<xsl:text>&#xa0;</xsl:text>"+"					</ins>"+'					<xsl:copy-of select="./child::node()" />'+"				</a>"+"			</xsl:for-each>"+'			<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>'+"		</li>"+"	</xsl:for-each>"+"	</ul>"+"</xsl:template>"+"</xsl:stylesheet>","flat":"<"+'?xml version="1.0" encoding="utf-8" ?>'+'<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >'+'<xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" />'+'<xsl:template match="/">'+"	<ul>"+'	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">'+'		<xsl:call-template name="nodes">'+'			<xsl:with-param name="node" select="." />'+'			<xsl:with-param name="is_last" select="number(position() = last())" />'+"		</xsl:call-template>"+"	</xsl:for-each>"+"	</ul>"+"</xsl:template>"+'<xsl:template name="nodes">'+'	<xsl:param name="node" />'+'	<xsl:param name="is_last" />'+'	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />'+"	<li>"+'	<xsl:attribute name="class">'+'		<xsl:if test="$is_last = true()">jstree-last </xsl:if>'+"		<xsl:choose>"+"			<xsl:when test=\"@state = 'open'\">jstree-open </xsl:when>"+"			<xsl:when test=\"$children or @hasChildren or @state = 'closed'\">jstree-closed </xsl:when>"+"			<xsl:otherwise>jstree-leaf </xsl:otherwise>"+"		</xsl:choose>"+'		<xsl:value-of select="@class" />'+"	</xsl:attribute>"+'	<xsl:for-each select="@*">'+"		<xsl:if test=\"name() != 'parent_id' and name() != 'hasChildren' and name() != 'class' and name() != 'state'\">"+'		<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+"		</xsl:if>"+"	</xsl:for-each>"+'	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>'+'	<xsl:for-each select="content/name">'+"		<a>"+'		<xsl:attribute name="href">'+"			<xsl:choose>"+'			<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>'+"			<xsl:otherwise>#</xsl:otherwise>"+"			</xsl:choose>"+"		</xsl:attribute>"+'		<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>'+'		<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>'+'		<xsl:for-each select="@*">'+"			<xsl:if test=\"name() != 'style' and name() != 'class' and name() != 'href'\">"+'				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+"			</xsl:if>"+"		</xsl:for-each>"+"			<ins>"+'				<xsl:attribute name="class">jstree-icon '+'					<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>'+"				</xsl:attribute>"+'				<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>'+"				<xsl:text>&#xa0;</xsl:text>"+"			</ins>"+'			<xsl:copy-of select="./child::node()" />'+"		</a>"+"	</xsl:for-each>"+'	<xsl:if test="$children">'+"		<ul>"+'		<xsl:for-each select="//item[@parent_id=$node/attribute::id]">'+'			<xsl:call-template name="nodes">'+'				<xsl:with-param name="node" select="." />'+'				<xsl:with-param name="is_last" select="number(position() = last())" />'+"			</xsl:call-template>"+"		</xsl:for-each>"+"		</ul>"+"	</xsl:if>"+"	</li>"+"</xsl:template>"+"</xsl:stylesheet>"},escape_xml=function(string){return string.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;");};$.jstree.plugin("xml_data",{defaults:{data:false,ajax:false,xsl:"flat",clean_node:false,correct_state:true,get_skip_empty:false,get_include_preamble:true},_fn:{load_node:function(obj,s_call,e_call){var _this=this;this.load_node_xml(obj,function(){_this.__callback({"obj":_this._get_node(obj)});s_call.call(this);},e_call);},_is_loaded:function(obj){var s=this._get_settings().xml_data;obj=this._get_node(obj);return obj==-1||!obj||(!s.ajax&&!$.isFunction(s.data))||obj.is(".jstree-open, .jstree-leaf")||obj.children("ul").children("li").size()>0;},load_node_xml:function(obj,s_call,e_call){var s=this.get_settings().xml_data,error_func=function(){},success_func=function(){};obj=this._get_node(obj);if(obj&&obj!==-1){if(obj.data("jstree_is_loading")){return;}else{obj.data("jstree_is_loading",true);}}switch(!0){case (!s.data&&!s.ajax):throw"Neither data nor ajax settings supplied.";case ($.isFunction(s.data)):s.data.call(this,obj,$.proxy(function(d){this.parse_xml(d,$.proxy(function(d){if(d){d=d.replace(/ ?xmlns="[^"]*"/ig,"");if(d.length>10){d=$(d);if(obj===-1||!obj){this.get_container().children("ul").empty().append(d.children());}else{obj.children("a.jstree-loading").removeClass("jstree-loading");obj.append(d);obj.removeData("jstree_is_loading");}if(s.clean_node){this.clean_node(obj);}if(s_call){s_call.call(this);}}else{if(obj&&obj!==-1){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(obj);if(s_call){s_call.call(this);}}}else{if(s.correct_state){this.get_container().children("ul").empty();if(s_call){s_call.call(this);}}}}}},this));},this));break;case (!!s.data&&!s.ajax)||(!!s.data&&!!s.ajax&&(!obj||obj===-1)):if(!obj||obj==-1){this.parse_xml(s.data,$.proxy(function(d){if(d){d=d.replace(/ ?xmlns="[^"]*"/ig,"");if(d.length>10){d=$(d);this.get_container().children("ul").empty().append(d.children());if(s.clean_node){this.clean_node(obj);}if(s_call){s_call.call(this);}}}else{if(s.correct_state){this.get_container().children("ul").empty();if(s_call){s_call.call(this);}}}},this));}break;case (!s.data&&!!s.ajax)||(!!s.data&&!!s.ajax&&obj&&obj!==-1):error_func=function(x,t,e){var ef=this.get_settings().xml_data.ajax.error;if(ef){ef.call(this,x,t,e);}if(obj!==-1&&obj.length){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(t==="success"&&s.correct_state){this.correct_state(obj);}}else{if(t==="success"&&s.correct_state){this.get_container().children("ul").empty();}}if(e_call){e_call.call(this);}};success_func=function(d,t,x){d=x.responseText;var sf=this.get_settings().xml_data.ajax.success;if(sf){d=sf.call(this,d,t,x)||d;}if(d===""||(d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")==="")){return error_func.call(this,x,t,"");}this.parse_xml(d,$.proxy(function(d){if(d){d=d.replace(/ ?xmlns="[^"]*"/ig,"");if(d.length>10){d=$(d);if(obj===-1||!obj){this.get_container().children("ul").empty().append(d.children());}else{obj.children("a.jstree-loading").removeClass("jstree-loading");obj.append(d);obj.removeData("jstree_is_loading");}if(s.clean_node){this.clean_node(obj);}if(s_call){s_call.call(this);}}else{if(obj&&obj!==-1){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(obj);if(s_call){s_call.call(this);}}}else{if(s.correct_state){this.get_container().children("ul").empty();if(s_call){s_call.call(this);}}}}}},this));};s.ajax.context=this;s.ajax.error=error_func;s.ajax.success=success_func;if(!s.ajax.dataType){s.ajax.dataType="xml";}if($.isFunction(s.ajax.url)){s.ajax.url=s.ajax.url.call(this,obj);}if($.isFunction(s.ajax.data)){s.ajax.data=s.ajax.data.call(this,obj);}$.ajax(s.ajax);break;}},parse_xml:function(xml,callback){var s=this._get_settings().xml_data;$.vakata.xslt(xml,xsl[s.xsl],callback);},get_xml:function(tp,obj,li_attr,a_attr,is_callback){var result="",s=this._get_settings(),_this=this,tmp1,tmp2,li,a,lang;if(!tp){tp="flat";}if(!is_callback){is_callback=0;}obj=this._get_node(obj);if(!obj||obj===-1){obj=this.get_container().find("> ul > li");}li_attr=$.isArray(li_attr)?li_attr:["id","class"];if(!is_callback&&this.data.types&&$.inArray(s.types.type_attr,li_attr)===-1){li_attr.push(s.types.type_attr);}a_attr=$.isArray(a_attr)?a_attr:[];if(!is_callback){if(s.xml_data.get_include_preamble){result+="<"+'?xml version="1.0" encoding="UTF-8"?'+">";}result+="<root>";}obj.each(function(){result+="<item";li=$(this);$.each(li_attr,function(i,v){var t=li.attr(v);if(!s.xml_data.get_skip_empty||typeof t!=="undefined"){result+=" "+v+'="'+escape_xml((" "+(t||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"';}});if(li.hasClass("jstree-open")){result+=' state="open"';}if(li.hasClass("jstree-closed")){result+=' state="closed"';}if(tp==="flat"){result+=' parent_id="'+escape_xml(is_callback)+'"';}result+=">";result+="<content>";a=li.children("a");a.each(function(){tmp1=$(this);lang=false;result+="<name";if($.inArray("languages",s.plugins)!==-1){$.each(s.languages,function(k,z){if(tmp1.hasClass(z)){result+=' lang="'+escape_xml(z)+'"';lang=z;return false;}});}if(a_attr.length){$.each(a_attr,function(k,z){var t=tmp1.attr(z);if(!s.xml_data.get_skip_empty||typeof t!=="undefined"){result+=" "+z+'="'+escape_xml((" "+t||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"';}});}if(tmp1.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length){result+=' icon="'+escape_xml(tmp1.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"';}if(tmp1.children("ins").get(0).style.backgroundImage.length){result+=' icon="'+escape_xml(tmp1.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"';}result+=">";result+="<![CDATA["+_this.get_text(tmp1,lang)+"]]>";result+="</name>";});result+="</content>";tmp2=li[0].id||true;li=li.find("> ul > li");if(li.length){tmp2=_this.get_xml(tp,li,li_attr,a_attr,tmp2);}else{tmp2="";}if(tp=="nest"){result+=tmp2;}result+="</item>";if(tp=="flat"){result+=tmp2;}});if(!is_callback){result+="</root>";}return result;}}});})(jQuery);(function($){$.expr[":"].jstree_contains=function(a,i,m){return(a.textContent||a.innerText||"").toLowerCase().indexOf(m[3].toLowerCase())>=0;};$.expr[":"].jstree_title_contains=function(a,i,m){return(a.getAttribute("title")||"").toLowerCase().indexOf(m[3].toLowerCase())>=0;};$.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=$();if(this._get_settings().search.show_only_matches){this.get_container().bind("search.jstree",function(e,data){$(this).children("ul").find("li").hide().removeClass("jstree-last");data.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){$(this).children("li:visible").eq(-1).addClass("jstree-last");});}).bind("clear_search.jstree",function(){$(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1);});}},defaults:{ajax:false,search_method:"jstree_contains",show_only_matches:false},_fn:{search:function(str,skip_async){if($.trim(str)===""){this.clear_search();return;}var s=this.get_settings().search,t=this,error_func=function(){},success_func=function(){};this.data.search.str=str;if(!skip_async&&s.ajax!==false&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0){this.search.supress_callback=true;error_func=function(){};success_func=function(d,t,x){var sf=this.get_settings().search.ajax.success;if(sf){d=sf.call(this,d,t,x)||d;}this.data.search.to_open=d;this._search_open();};s.ajax.context=this;s.ajax.error=error_func;s.ajax.success=success_func;if($.isFunction(s.ajax.url)){s.ajax.url=s.ajax.url.call(this,str);}if($.isFunction(s.ajax.data)){s.ajax.data=s.ajax.data.call(this,str);}if(!s.ajax.data){s.ajax.data={"search_string":str};}if(!s.ajax.dataType||/^json/.exec(s.ajax.dataType)){s.ajax.dataType="json";}$.ajax(s.ajax);return;}if(this.data.search.result.length){this.clear_search();}this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+(s.search_method)+"("+this.data.search.str+")");this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){t.open_node(this,false,true);});this.__callback({nodes:this.data.search.result,str:str});},clear_search:function(str){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=$();},_search_open:function(is_callback){var _this=this,done=true,current=[],remaining=[];if(this.data.search.to_open.length){$.each(this.data.search.to_open,function(i,val){if(val=="#"){return true;}if($(val).length&&$(val).is(".jstree-closed")){current.push(val);}else{remaining.push(val);}});if(current.length){this.data.search.to_open=remaining;$.each(current,function(i,val){_this.open_node(val,function(){_this._search_open(true);});});done=false;}}if(done){this.search(this.data.search.str,true);}}}});})(jQuery);(function($){$.vakata.context={hide_on_mouseleave:false,cnt:$("<div id='vakata-contextmenu' />"),vis:false,tgt:false,par:false,func:false,data:false,rtl:false,show:function(s,t,x,y,d,p,rtl){$.vakata.context.rtl=!!rtl;var html=$.vakata.context.parse(s),h,w;if(!html){return;}$.vakata.context.vis=true;$.vakata.context.tgt=t;$.vakata.context.par=p||t||null;$.vakata.context.data=d||null;$.vakata.context.cnt.html(html).css({"visibility":"hidden","display":"block","left":0,"top":0});if($.vakata.context.hide_on_mouseleave){$.vakata.context.cnt.one("mouseleave",function(e){$.vakata.context.hide();});}h=$.vakata.context.cnt.height();w=$.vakata.context.cnt.width();if(x+w>$(document).width()){x=$(document).width()-(w+5);$.vakata.context.cnt.find("li > ul").addClass("right");}if(y+h>$(document).height()){y=y-(h+t[0].offsetHeight);$.vakata.context.cnt.find("li > ul").addClass("bottom");}$.vakata.context.cnt.css({"left":x,"top":y}).find("li:has(ul)").bind("mouseenter",function(e){var w=$(document).width(),h=$(document).height(),ul=$(this).children("ul").show();if(w!==$(document).width()){ul.toggleClass("right");}if(h!==$(document).height()){ul.toggleClass("bottom");}}).bind("mouseleave",function(e){$(this).children("ul").hide();}).end().css({"visibility":"visible"}).show();$(document).triggerHandler("context_show.vakata");},hide:function(){$.vakata.context.vis=false;$.vakata.context.cnt.attr("class","").css({"visibility":"hidden"});$(document).triggerHandler("context_hide.vakata");},parse:function(s,is_callback){if(!s){return false;}var str="",tmp=false,was_sep=true;if(!is_callback){$.vakata.context.func={};}str+="<ul>";$.each(s,function(i,val){if(!val){return true;}$.vakata.context.func[i]=val.action;if(!was_sep&&val.separator_before){str+="<li class='vakata-separator vakata-separator-before'></li>";}was_sep=false;str+="<li class='"+(val._class||"")+(val._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ";if(val.icon&&val.icon.indexOf("/")===-1){str+=" class='"+val.icon+"' ";}if(val.icon&&val.icon.indexOf("/")!==-1){str+=" style='background:url("+val.icon+") center center no-repeat;' ";}str+=">&#160;</ins><a href='#' rel='"+i+"'>";if(val.submenu){str+="<span style='float:"+($.vakata.context.rtl?"left":"right")+";'>&raquo;</span>";}str+=val.label+"</a>";if(val.submenu){tmp=$.vakata.context.parse(val.submenu,true);if(tmp){str+=tmp;}}str+="</li>";if(val.separator_after){str+="<li class='vakata-separator vakata-separator-after'></li>";was_sep=true;}});str=str.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,"");str+="</ul>";$(document).triggerHandler("context_parse.vakata");return str.length>10?str:false;},exec:function(i){if($.isFunction($.vakata.context.func[i])){$.vakata.context.func[i].call($.vakata.context.data,$.vakata.context.par);return true;}else{return false;}}};$(function(){var css_string=""+"#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } "+"#vakata-contextmenu ul { min-width:180px; *width:180px; } "+"#vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } "+"#vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } "+"#vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } "+"#vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } "+"#vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } "+"#vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } "+"#vakata-contextmenu .right { right:100%; left:auto; } "+"#vakata-contextmenu .bottom { bottom:-1px; top:auto; } "+"#vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";$.vakata.css.add_sheet({str:css_string,title:"vakata"});$.vakata.context.cnt.delegate("a","click",function(e){e.preventDefault();}).delegate("a","mouseup",function(e){if(!$(this).parent().hasClass("jstree-contextmenu-disabled")&&$.vakata.context.exec($(this).attr("rel"))){$.vakata.context.hide();}else{$(this).blur();}}).delegate("a","mouseover",function(){$.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover");}).appendTo("body");$(document).bind("mousedown",function(e){if($.vakata.context.vis&&!$.contains($.vakata.context.cnt[0],e.target)){$.vakata.context.hide();}});if(typeof $.hotkeys!=="undefined"){$(document).bind("keydown","up",function(e){if($.vakata.context.vis){var o=$.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();if(!o.length){o=$.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last();}o.addClass("vakata-hover");e.stopImmediatePropagation();e.preventDefault();}}).bind("keydown","down",function(e){if($.vakata.context.vis){var o=$.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();if(!o.length){o=$.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first();}o.addClass("vakata-hover");e.stopImmediatePropagation();e.preventDefault();}}).bind("keydown","right",function(e){if($.vakata.context.vis){$.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover");e.stopImmediatePropagation();e.preventDefault();}}).bind("keydown","left",function(e){if($.vakata.context.vis){$.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover");e.stopImmediatePropagation();e.preventDefault();}}).bind("keydown","esc",function(e){$.vakata.context.hide();e.preventDefault();}).bind("keydown","space",function(e){$.vakata.context.cnt.find(".vakata-hover").last().children("a").click();e.preventDefault();});}});$.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",$.proxy(function(e){e.preventDefault();if(!$(e.currentTarget).hasClass("jstree-loading")){this.show_contextmenu(e.currentTarget,e.pageX,e.pageY);}},this)).delegate("a","click.jstree",$.proxy(function(e){if(this.data.contextmenu){$.vakata.context.hide();}},this)).bind("destroy.jstree",$.proxy(function(){if(this.data.contextmenu){$.vakata.context.hide();}},this));$(document).bind("context_hide.vakata",$.proxy(function(){this.data.contextmenu=false;},this));},defaults:{select_node:false,show_at_node:true,items:{"create":{"separator_before":false,"separator_after":true,"label":"Create","action":function(obj){this.create(obj);}},"rename":{"separator_before":false,"separator_after":false,"label":"Rename","action":function(obj){this.rename(obj);}},"remove":{"separator_before":false,"icon":false,"separator_after":false,"label":"Delete","action":function(obj){if(this.is_selected(obj)){this.remove();}else{this.remove(obj);}}},"ccp":{"separator_before":true,"icon":false,"separator_after":false,"label":"Edit","action":false,"submenu":{"cut":{"separator_before":false,"separator_after":false,"label":"Cut","action":function(obj){this.cut(obj);}},"copy":{"separator_before":false,"icon":false,"separator_after":false,"label":"Copy","action":function(obj){this.copy(obj);}},"paste":{"separator_before":false,"icon":false,"separator_after":false,"label":"Paste","action":function(obj){this.paste(obj);}}}}}},_fn:{show_contextmenu:function(obj,x,y){obj=this._get_node(obj);var s=this.get_settings().contextmenu,a=obj.children("a:visible:eq(0)"),o=false,i=false;if(s.select_node&&this.data.ui&&!this.is_selected(obj)){this.deselect_all();this.select_node(obj,true);}if(s.show_at_node||typeof x==="undefined"||typeof y==="undefined"){o=a.offset();x=o.left;y=o.top+this.data.core.li_height;}i=obj.data("jstree")&&obj.data("jstree").contextmenu?obj.data("jstree").contextmenu:s.items;if($.isFunction(i)){i=i.call(this,obj);}this.data.contextmenu=true;$.vakata.context.show(i,a,x,y,this,obj,this._get_settings().core.rtl);if(this.data.themes){$.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context");}}}});})(jQuery);(function($){$.jstree.plugin("types",{__init:function(){var s=this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",$.proxy(function(){var types=s.types,attr=s.type_attr,icons_css="",_this=this;$.each(types,function(i,tp){$.each(tp,function(k,v){if(!/^(max_depth|max_children|icon|valid_children)$/.test(k)){_this.data.types.attach_to.push(k);}});if(!tp.icon){return true;}if(tp.icon.image||tp.icon.position){if(i=="default"){icons_css+=".jstree-"+_this.get_index()+" a > .jstree-icon { ";}else{icons_css+=".jstree-"+_this.get_index()+" li["+attr+'="'+i+'"] > a > .jstree-icon { ';}if(tp.icon.image){icons_css+=" background-image:url("+tp.icon.image+"); ";}if(tp.icon.position){icons_css+=" background-position:"+tp.icon.position+"; ";}else{icons_css+=" background-position:0 0; ";}icons_css+="} ";}});if(icons_css!==""){$.vakata.css.add_sheet({"str":icons_css,title:"jstree-types"});}},this)).bind("before.jstree",$.proxy(function(e,data){var s,t,o=this._get_settings().types.use_data?this._get_node(data.args[0]):false,d=o&&o!==-1&&o.length?o.data("jstree"):false;if(d&&d.types&&d.types[data.func]===false){e.stopImmediatePropagation();return false;}if($.inArray(data.func,this.data.types.attach_to)!==-1){if(!data.args[0]||(!data.args[0].tagName&&!data.args[0].jquery)){return;}s=this._get_settings().types.types;t=this._get_type(data.args[0]);if(((s[t]&&typeof s[t][data.func]!=="undefined")||(s["default"]&&typeof s["default"][data.func]!=="undefined"))&&this._check(data.func,data.args[0])===false){e.stopImmediatePropagation();return false;}}},this));if(is_ie6){this.get_container().bind("load_node.jstree set_type.jstree",$.proxy(function(e,data){var r=data&&data.rslt&&data.rslt.obj&&data.rslt.obj!==-1?this._get_node(data.rslt.obj).parent():this.get_container_ul(),c=false,s=this._get_settings().types;$.each(s.types,function(i,tp){if(tp.icon&&(tp.icon.image||tp.icon.position)){c=i==="default"?r.find("li > a > .jstree-icon"):r.find("li["+s.type_attr+"='"+i+"'] > a > .jstree-icon");if(tp.icon.image){c.css("backgroundImage","url("+tp.icon.image+")");}c.css("backgroundPosition",tp.icon.position||"0 0");}});},this));}},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:false,type_attr:"rel",types:{"default":{"max_children":-1,"max_depth":-1,"valid_children":"all"}}},_fn:{_types_notify:function(n,data){if(data.type&&this._get_settings().types.use_data){this.set_type(data.type,n);}},_get_type:function(obj){obj=this._get_node(obj);return(!obj||!obj.length)?false:obj.attr(this._get_settings().types.type_attr)||"default";},set_type:function(str,obj){obj=this._get_node(obj);var ret=(!obj.length||!str)?false:obj.attr(this._get_settings().types.type_attr,str);if(ret){this.__callback({obj:obj,type:str});}return ret;},_check:function(rule,obj,opts){obj=this._get_node(obj);var v=false,t=this._get_type(obj),d=0,_this=this,s=this._get_settings().types,data=false;if(obj===-1){if(!!s[rule]){v=s[rule];}else{return;}}else{if(t===false){return;}data=s.use_data?obj.data("jstree"):false;if(data&&data.types&&typeof data.types[rule]!=="undefined"){v=data.types[rule];}else{if(!!s.types[t]&&typeof s.types[t][rule]!=="undefined"){v=s.types[t][rule];}else{if(!!s.types["default"]&&typeof s.types["default"][rule]!=="undefined"){v=s.types["default"][rule];}}}}if($.isFunction(v)){v=v.call(this,obj);}if(rule==="max_depth"&&obj!==-1&&opts!==false&&s.max_depth!==-2&&v!==0){obj.children("a:eq(0)").parentsUntil(".jstree","li").each(function(i){if(s.max_depth!==-1&&s.max_depth-(i+1)<=0){v=0;return false;}d=(i===0)?v:_this._check(rule,this,false);if(d!==-1&&d-(i+1)<=0){v=0;return false;}if(d>=0&&(d-(i+1)<v||v<0)){v=d-(i+1);}if(s.max_depth>=0&&(s.max_depth-(i+1)<v||v<0)){v=s.max_depth-(i+1);}});}return v;},check_move:function(){if(!this.__call_old()){return false;}var m=this._get_move(),s=m.rt._get_settings().types,mc=m.rt._check("max_children",m.cr),md=m.rt._check("max_depth",m.cr),vc=m.rt._check("valid_children",m.cr),ch=0,d=1,t;if(vc==="none"){return false;}if($.isArray(vc)&&m.ot&&m.ot._get_type){m.o.each(function(){if($.inArray(m.ot._get_type(this),vc)===-1){d=false;return false;}});if(d===false){return false;}}if(s.max_children!==-2&&mc!==-1){ch=m.cr===-1?this.get_container().find("> ul > li").not(m.o).length:m.cr.find("> ul > li").not(m.o).length;if(ch+m.o.length>mc){return false;}}if(s.max_depth!==-2&&md!==-1){d=0;if(md===0){return false;}if(typeof m.o.d==="undefined"){t=m.o;while(t.length>0){t=t.find("> ul > li");d++;}m.o.d=d;}if(md-m.o.d<0){return false;}}return true;},create_node:function(obj,position,js,callback,is_loaded,skip_check){if(!skip_check&&(is_loaded||this._is_loaded(obj))){var p=(typeof position=="string"&&position.match(/^before|after$/i)&&obj!==-1)?this._get_parent(obj):this._get_node(obj),s=this._get_settings().types,mc=this._check("max_children",p),md=this._check("max_depth",p),vc=this._check("valid_children",p),ch;if(typeof js==="string"){js={data:js};}if(!js){js={};}if(vc==="none"){return false;}if($.isArray(vc)){if(!js.attr||!js.attr[s.type_attr]){if(!js.attr){js.attr={};}js.attr[s.type_attr]=vc[0];}else{if($.inArray(js.attr[s.type_attr],vc)===-1){return false;}}}if(s.max_children!==-2&&mc!==-1){ch=p===-1?this.get_container().find("> ul > li").length:p.find("> ul > li").length;if(ch+1>mc){return false;}}if(s.max_depth!==-2&&md!==-1&&(md-1)<0){return false;}}return this.__call_old(true,obj,position,js,callback,is_loaded,skip_check);}}});})(jQuery);(function($){$.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(true);this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return this.nodeType==3;}).remove();},defaults:{data:false,ajax:false,correct_state:true},_fn:{load_node:function(obj,s_call,e_call){var _this=this;this.load_node_html(obj,function(){_this.__callback({"obj":_this._get_node(obj)});s_call.call(this);},e_call);},_is_loaded:function(obj){obj=this._get_node(obj);return obj==-1||!obj||(!this._get_settings().html_data.ajax&&!$.isFunction(this._get_settings().html_data.data))||obj.is(".jstree-open, .jstree-leaf")||obj.children("ul").children("li").size()>0;},load_node_html:function(obj,s_call,e_call){var d,s=this.get_settings().html_data,error_func=function(){},success_func=function(){};obj=this._get_node(obj);if(obj&&obj!==-1){if(obj.data("jstree_is_loading")){return;}else{obj.data("jstree_is_loading",true);}}switch(!0){case ($.isFunction(s.data)):s.data.call(this,obj,$.proxy(function(d){if(d&&d!==""&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")!==""){d=$(d);if(!d.is("ul")){d=$("<ul />").append(d);}if(obj==-1||!obj){this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS";}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");}else{obj.children("a.jstree-loading").removeClass("jstree-loading");obj.append(d).children("ul").find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS";}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");obj.removeData("jstree_is_loading");}this.clean_node(obj);if(s_call){s_call.call(this);}}else{if(obj&&obj!==-1){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(obj);if(s_call){s_call.call(this);}}}else{if(s.correct_state){this.get_container().children("ul").empty();if(s_call){s_call.call(this);}}}}},this));break;case (!s.data&&!s.ajax):if(!obj||obj==-1){this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS";}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node();}if(s_call){s_call.call(this);}break;case (!!s.data&&!s.ajax)||(!!s.data&&!!s.ajax&&(!obj||obj===-1)):if(!obj||obj==-1){d=$(s.data);if(!d.is("ul")){d=$("<ul />").append(d);}this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS";}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node();}if(s_call){s_call.call(this);}break;case (!s.data&&!!s.ajax)||(!!s.data&&!!s.ajax&&obj&&obj!==-1):obj=this._get_node(obj);error_func=function(x,t,e){var ef=this.get_settings().html_data.ajax.error;if(ef){ef.call(this,x,t,e);}if(obj!=-1&&obj.length){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(t==="success"&&s.correct_state){this.correct_state(obj);}}else{if(t==="success"&&s.correct_state){this.get_container().children("ul").empty();}}if(e_call){e_call.call(this);}};success_func=function(d,t,x){var sf=this.get_settings().html_data.ajax.success;if(sf){d=sf.call(this,d,t,x)||d;}if(d===""||(d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")==="")){return error_func.call(this,x,t,"");}if(d){d=$(d);if(!d.is("ul")){d=$("<ul />").append(d);}if(obj==-1||!obj){this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS";}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");}else{obj.children("a.jstree-loading").removeClass("jstree-loading");obj.append(d).children("ul").find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS";}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");obj.removeData("jstree_is_loading");}this.clean_node(obj);if(s_call){s_call.call(this);}}else{if(obj&&obj!==-1){obj.children("a.jstree-loading").removeClass("jstree-loading");obj.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(obj);if(s_call){s_call.call(this);}}}else{if(s.correct_state){this.get_container().children("ul").empty();if(s_call){s_call.call(this);}}}}};s.ajax.context=this;s.ajax.error=error_func;s.ajax.success=success_func;if(!s.ajax.dataType){s.ajax.dataType="html";}if($.isFunction(s.ajax.url)){s.ajax.url=s.ajax.url.call(this,obj);}if($.isFunction(s.ajax.data)){s.ajax.data=s.ajax.data.call(this,obj);}$.ajax(s.ajax);break;}}}});$.jstree.defaults.plugins.push("html_data");})(jQuery);(function($){$.jstree.plugin("themeroller",{__init:function(){var s=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(e){if(!$(e.currentTarget).hasClass("jstree-loading")){$(this).addClass(s.item_h);}}).delegate("a","mouseleave.jstree",function(){$(this).removeClass(s.item_h);}).bind("init.jstree",$.proxy(function(e,data){data.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh");this._themeroller(data.inst.get_container().find("> ul > li"));},this)).bind("open_node.jstree create_node.jstree",$.proxy(function(e,data){this._themeroller(data.rslt.obj);},this)).bind("loaded.jstree refresh.jstree",$.proxy(function(e){this._themeroller();},this)).bind("close_node.jstree",$.proxy(function(e,data){this._themeroller(data.rslt.obj);},this)).bind("delete_node.jstree",$.proxy(function(e,data){this._themeroller(data.rslt.parent);},this)).bind("correct_state.jstree",$.proxy(function(e,data){data.rslt.obj.children("ins.jstree-icon").removeClass(s.opened+" "+s.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")===-1;}).removeClass(s.item_open+" "+s.item_clsd).addClass(s.item_leaf||"jstree-no-icon");},this)).bind("select_node.jstree",$.proxy(function(e,data){data.rslt.obj.children("a").addClass(s.item_a);},this)).bind("deselect_node.jstree deselect_all.jstree",$.proxy(function(e,data){this.get_container().find("a."+s.item_a).removeClass(s.item_a).end().find("a.jstree-clicked").addClass(s.item_a);},this)).bind("dehover_node.jstree",$.proxy(function(e,data){data.rslt.obj.children("a").removeClass(s.item_h);},this)).bind("hover_node.jstree",$.proxy(function(e,data){this.get_container().find("a."+s.item_h).not(data.rslt.obj).removeClass(s.item_h);data.rslt.obj.children("a").addClass(s.item_h);},this)).bind("move_node.jstree",$.proxy(function(e,data){this._themeroller(data.rslt.o);this._themeroller(data.rslt.op);},this));},__destroy:function(){var s=this._get_settings().themeroller,c=["ui-icon"];$.each(s,function(i,v){v=v.split(" ");if(v.length){c=c.concat(v);}});this.get_container().removeClass("ui-widget-content").find("."+c.join(", .")).removeClass(c.join(" "));},_fn:{_themeroller:function(obj){var s=this._get_settings().themeroller;obj=!obj||obj==-1?this.get_container_ul():this._get_node(obj).parent();obj.find("li.jstree-closed").children("ins.jstree-icon").removeClass(s.opened).addClass("ui-icon "+s.closed).end().children("a").addClass(s.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")===-1;}).removeClass(s.item_leaf+" "+s.item_open).addClass(s.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(s.closed).addClass("ui-icon "+s.opened).end().children("a").addClass(s.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")===-1;}).removeClass(s.item_leaf+" "+s.item_clsd).addClass(s.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(s.closed+" ui-icon "+s.opened).end().children("a").addClass(s.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")===-1;}).removeClass(s.item_clsd+" "+s.item_open).addClass(s.item_leaf||"jstree-no-icon");}},defaults:{"opened":"ui-icon-triangle-1-se","closed":"ui-icon-triangle-1-e","item":"ui-state-default","item_h":"ui-state-hover","item_a":"ui-state-active","item_open":"ui-icon-folder-open","item_clsd":"ui-icon-folder-collapsed","item_leaf":"ui-icon-document"}});$(function(){var css_string=""+".jstree-themeroller .ui-icon { overflow:visible; } "+".jstree-themeroller a { padding:0 2px; } "+".jstree-themeroller .jstree-no-icon { display:none; }";$.vakata.css.add_sheet({str:css_string,title:"jstree"});});})(jQuery);(function($){$.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",$.proxy(function(e,data){var nms=[],res=true,p,t;if(data.func=="move_node"){if(data.args[4]===true){if(data.args[0].o&&data.args[0].o.length){data.args[0].o.children("a").each(function(){nms.push($(this).text().replace(/^\s+/g,""));});res=this._check_unique(nms,data.args[0].np.find("> ul > li").not(data.args[0].o),"move_node");}}}if(data.func=="create_node"){if(data.args[4]||this._is_loaded(data.args[0])){p=this._get_node(data.args[0]);if(data.args[1]&&(data.args[1]==="before"||data.args[1]==="after")){p=this._get_parent(data.args[0]);if(!p||p===-1){p=this.get_container();}}if(typeof data.args[2]==="string"){nms.push(data.args[2]);}else{if(!data.args[2]||!data.args[2].data){nms.push(this._get_string("new_node"));}else{nms.push(data.args[2].data);}}res=this._check_unique(nms,p.find("> ul > li"),"create_node");}}if(data.func=="rename_node"){nms.push(data.args[1]);t=this._get_node(data.args[0]);p=this._get_parent(t);if(!p||p===-1){p=this.get_container();}res=this._check_unique(nms,p.find("> ul > li").not(t),"rename_node");}if(!res){e.stopPropagation();return false;}},this));},defaults:{error_callback:$.noop},_fn:{_check_unique:function(nms,p,func){var cnms=[];p.children("a").each(function(){cnms.push($(this).text().replace(/^\s+/g,""));});if(!cnms.length||!nms.length){return true;}cnms=cnms.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");if((cnms.length+nms.length)!=cnms.concat(nms).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length){this._get_settings().unique.error_callback.call(null,nms,p,func);return false;}return true;},check_move:function(){if(!this.__call_old()){return false;}var p=this._get_move(),nms=[];if(p.o&&p.o.length){p.o.children("a").each(function(){nms.push($(this).text().replace(/^\s+/g,""));});return this._check_unique(nms,p.np.find("> ul > li").not(p.o),"check_move");}return true;}}});})(jQuery);(function($){$.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui){throw"jsTree wholerow: jsTree UI plugin not included.";}this.data.wholerow.html=false;this.data.wholerow.to=false;this.get_container().bind("init.jstree",$.proxy(function(e,data){this._get_settings().core.animation=0;},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",$.proxy(function(e,data){this._prepare_wholerow_span(data&&data.rslt&&data.rslt.obj?data.rslt.obj:-1);},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",$.proxy(function(e,data){if(this.data.to){clearTimeout(this.data.to);}this.data.to=setTimeout((function(t,o){return function(){t._prepare_wholerow_ul(o);};})(this,data&&data.rslt&&data.rslt.obj?data.rslt.obj:-1),0);},this)).bind("deselect_all.jstree",$.proxy(function(e,data){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""));},this)).bind("select_node.jstree deselect_node.jstree ",$.proxy(function(e,data){data.rslt.obj.each(function(){var ref=data.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+(parseInt((($(this).offset().top-data.inst.get_container().offset().top+data.inst.get_container()[0].scrollTop)/data.inst.data.core.li_height),10))+")");ref.children("a").attr("class",data.rslt.obj.children("a").attr("class"));});},this)).bind("hover_node.jstree dehover_node.jstree",$.proxy(function(e,data){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));if(e.type==="hover_node"){var ref=this.get_container().find(" > .jstree-wholerow li:visible:eq("+(parseInt(((data.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height),10))+")");ref.children("a").attr("class",data.rslt.obj.children(".jstree-hovered").attr("class"));}},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(e){var n=$(e.currentTarget);if(e.target.tagName==="A"||(e.target.tagName==="INS"&&n.closest("li").is(".jstree-open, .jstree-closed"))){return;}n.closest("li").children("a:visible:eq(0)").click();e.stopImmediatePropagation();}).delegate("li","mouseover.jstree",$.proxy(function(e){e.stopImmediatePropagation();if($(e.currentTarget).children(".jstree-hovered, .jstree-clicked").length){return false;}this.hover_node(e.currentTarget);return false;},this)).delegate("li","mouseleave.jstree",$.proxy(function(e){if($(e.currentTarget).children("a").hasClass("jstree-hovered").length){return;}this.dehover_node(e.currentTarget);},this));if(is_ie7||is_ie6){$.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"});}},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove();this.get_container().find(".jstree-wholerow-span").remove();},_fn:{_prepare_wholerow_span:function(obj){obj=!obj||obj==-1?this.get_container().find("> ul > li"):this._get_node(obj);if(obj===false){return;}obj.each(function(){$(this).find("li").andSelf().each(function(){var $t=$(this);if($t.children(".jstree-wholerow-span").length){return true;}$t.prepend("<span class='jstree-wholerow-span' style='width:"+($t.parentsUntil(".jstree","li").length*18)+"px;'>&#160;</span>");});});},_prepare_wholerow_ul:function(){var o=this.get_container().children("ul").eq(0),h=o.html();o.addClass("jstree-wholerow-real");if(this.data.wholerow.last_html!==h){this.data.wholerow.last_html=h;this.get_container().children(".jstree-wholerow").remove();this.get_container().append(o.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(o.parent()[0].scrollWidth).css("top",(o.height()+(is_ie7?5:0))*-1).find("li[id]").each(function(){this.removeAttribute("id");}).end());}}}});$(function(){var css_string=""+".jstree .jstree-wholerow-real { position:relative; z-index:1; } "+".jstree .jstree-wholerow-real li { cursor:pointer; } "+".jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } "+".jstree .jstree-wholerow { position:relative; z-index:0; height:0; } "+".jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } "+".jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } "+".jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }"+".jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }"+".jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } "+".jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";if(is_ff2){css_string+=""+".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } "+".jstree .jstree-wholerow-real a { border-color:transparent !important; } ";}if(is_ie7||is_ie6){css_string+=""+".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } "+".jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ";}$.vakata.css.add_sheet({str:css_string,title:"jstree"});});})(jQuery);(function($){var nodeInterface=["getChildren","getChildrenCount","getAttr","getName","getProps"],validateInterface=function(obj,inter){var valid=true;obj=obj||{};inter=[].concat(inter);$.each(inter,function(i,v){if(!$.isFunction(obj[v])){valid=false;return false;}});return valid;};$.jstree.plugin("model",{__init:function(){if(!this.data.json_data){throw"jsTree model: jsTree json_data plugin not included.";}this._get_settings().json_data.data=function(n,b){var obj=(n==-1)?this._get_settings().model.object:n.data("jstree_model");if(!validateInterface(obj,nodeInterface)){return b.call(null,false);}if(this._get_settings().model.async){obj.getChildren($.proxy(function(data){this.model_done(data,b);},this));}else{this.model_done(obj.getChildren(),b);}};},defaults:{object:false,id_prefix:false,async:false},_fn:{model_done:function(data,callback){var ret=[],s=this._get_settings(),_this=this;if(!$.isArray(data)){data=[data];}$.each(data,function(i,nd){var r=nd.getProps()||{};r.attr=nd.getAttr()||{};if(nd.getChildrenCount()){r.state="closed";}r.data=nd.getName();if(!$.isArray(r.data)){r.data=[r.data];}if(_this.data.types&&$.isFunction(nd.getType)){r.attr[s.types.type_attr]=nd.getType();}if(r.attr.id&&s.model.id_prefix){r.attr.id=s.model.id_prefix+r.attr.id;}if(!r.metadata){r.metadata={};}r.metadata.jstree_model=nd;ret.push(r);});callback.call(null,ret);}}});})(jQuery);})();(function($){var renderAWidth,renderATitle,htmlstripre,SPECIAL_TITLE="_DATA_",bound=false,styled=false;htmlstripre=/<\/?[^>]+>/gi;renderAWidth=function(node,tree){var depth,a=node.get(0).tagName.toLowerCase()==="a"?node:node.children("a"),width=parseInt(tree.data.grid.columns[0].width)+parseInt(tree.data.grid.treeWidthDiff);depth=a.parentsUntil(tree.get_container().get(0).tagName+".jstree").filter("li").length;width=width-depth*18;a.css({width:width,"vertical-align":"top","overflow":"hidden","float":"left"});};renderATitle=function(node,t,tree){var a=node.get(0).tagName.toLowerCase()==="a"?node:node.children("a"),title,col=tree.data.grid.columns[0];title="";if(col.title){if(col.title===SPECIAL_TITLE){title=tree.get_text(t);}else{if(t.attr(col.title)){title=t.attr(col.title);}}}title=title.replace(htmlstripre,"");if(title){a.attr("title",title);}};$.jstree.plugin("grid",{__init:function(){var s=this._get_settings().grid||{},styles;this.data.grid.columns=s.columns||[];this.data.grid.treeClass="jstree-grid-col-0";this.data.grid.columnWidth=s.width;this.data.grid.defaultConf={display:"inline-block","*display":"inline","*+display":"inline","float":"left"};this.data.grid.isThemeroller=!!this.data.themeroller;this.data.grid.treeWidthDiff=-9;this.data.grid.resizable=s.resizable;if($.browser.msie&&parseInt($.browser.version.substr(0,1),10)<8){this.data.grid.defaultConf.display="inline";this.data.grid.defaultConf.zoom="1";}if(!styled){styled=true;styles=[".jstree-grid-cell {padding-left: 4px; vertical-align: top; overflow:hidden;}",".jstree-grid-separator {display: inline-block; border-width: 0 2px 0 0; *display:inline; *+display:inline; margin-right:0px;float:left;}",".jstree-grid-header-cell {float: left;}",".jstree-grid-header-themeroller {border: 0; padding: 1px 3px;}",".jstree-grid-header-regular {background-color: #EBF3FD;}",".jstree-grid-resizable-separator {cursor: col-resize;}",".jstree-grid-separator-regular {border-color: #d0d0d0; border-style: solid;}",".jstree-grid-cell-themeroller {border: none !important; background: transparent !important;}"];$('<style type="text/css">'+styles.join("\n")+"</style>").appendTo("head");}this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree change_node.jstree",$.proxy(function(e,data){var target=data&&data.rslt&&data.rslt.obj?data.rslt.obj:e.target;target=$(target);this._prepare_grid(target);},this)).bind("loaded.jstree",$.proxy(function(e){this._prepare_headers();this._prepare_grid();this.get_container().trigger("loaded_grid.jstree");},this)).bind("move_node.jstree",$.proxy(function(e,data){var node=data.rslt.o;renderAWidth(node,this);node.find("li > a").each($.proxy(function(i,elm){renderAWidth($(elm),this);},this));},this));if(this.data.grid.isThemeroller){this.get_container().bind("select_node.jstree",$.proxy(function(e,data){data.rslt.obj.children("a").nextAll("div").addClass("ui-state-active");},this)).bind("deselect_node.jstree deselect_all.jstree",$.proxy(function(e,data){data.rslt.obj.children("a").nextAll("div").removeClass("ui-state-active");},this)).bind("hover_node.jstree",$.proxy(function(e,data){data.rslt.obj.children("a").nextAll("div").addClass("ui-state-hover");},this)).bind("dehover_node.jstree",$.proxy(function(e,data){data.rslt.obj.children("a").nextAll("div").removeClass("ui-state-hover");},this));}},__destroy:function(){var parent=this.data.grid.parent,container=this.get_container();container.detach();$("div.jstree-grid-wrapper",parent).remove();parent.append(container);},defaults:{width:25},_fn:{_prepare_headers:function(){var header,i,cols=this.data.grid.columns||[],width,defaultWidth=this.data.grid.columnWidth,resizable=this.data.grid.resizable||false,cl,val,margin,last,tr=this.data.grid.isThemeroller,classAdd=(tr?"themeroller":"regular"),cHeight,hHeight,container=this.get_container(),parent=container.parent(),hasHeaders=0,conf=this.data.grid.defaultConf,isClickedSep=false,oldMouseX=0,newMouseX=0,currentTree=null,colNum=0,toResize=null,clickedSep=null,borPadWidth=0;this.data.grid.parent=parent;header=this.data.grid.header||$("<div></div>").addClass((tr?"ui-widget-header ":"")+"jstree-grid-header jstree-grid-header-"+classAdd);for(i=0;i<cols.length;i++){cl=cols[i].headerClass||"";val=cols[i].header||"";if(val){hasHeaders=true;}width=cols[i].width||defaultWidth;borPadWidth=tr?1+6:2+8;width-=borPadWidth;margin=i===0?3:0;last=$("<div></div>").css(conf).css({"margin-left":margin,"width":width,"padding":"1 3 2 5"}).addClass((tr?"ui-widget-header ":"")+"jstree-grid-header jstree-grid-header-cell jstree-grid-header-"+classAdd+" "+cl).text(val).appendTo(header).after("<div class='jstree-grid-separator jstree-grid-separator-"+classAdd+(tr?" ui-widget-header":"")+(resizable?" jstree-grid-resizable-separator":"")+"'>&nbsp;</div>");}last.addClass((tr?"ui-widget-header ":"")+"jstree-grid-header jstree-grid-header-"+classAdd);$("<div></div>").css("clear","both").appendTo(header);if(hasHeaders){$("<div></div>").addClass("jstree-grid-wrapper").appendTo(parent).append(header).append(container);this.data.grid.divOffset=header.parent().offset().left;this.data.grid.header=header;}if(!bound&&resizable){bound=true;$(".jstree-grid-separator").live("selectstart",function(){return false;}).live("mousedown",function(e){clickedSep=$(this);isClickedSep=true;currentTree=clickedSep.parents(".jstree-grid-wrapper").children(".jstree");oldMouseX=e.clientX;colNum=clickedSep.prevAll(".jstree-grid-header").length-1;toResize=clickedSep.prev().add(currentTree.find(".jstree-grid-col-"+colNum));return false;});$(document).mouseup(function(){var i,ref,cols,widths,headers;if(isClickedSep){ref=$.jstree._reference(currentTree);cols=ref.data.grid.columns;headers=clickedSep.parent().children(".jstree-grid-header");widths={};if(!colNum){ref.data.grid.treeWidthDiff=currentTree.find("ins:eq(0)").width()+currentTree.find("a:eq(0)").width()-ref.data.grid.columns[0].width;}isClickedSep=false;for(i=0;i<cols.length;i++){widths[cols[i].header]={w:parseFloat(headers[i].style.width)+borPadWidth,r:i===colNum};}currentTree.trigger("resize_column.jstree-grid",[widths]);}}).mousemove(function(e){if(isClickedSep){newMouseX=e.clientX;var diff=newMouseX-oldMouseX;toResize.each(function(){this.style.width=parseFloat(this.style.width)+diff+"px";});oldMouseX=newMouseX;}});}},_prepare_grid:function(obj){var c=this.data.grid.treeClass,_this=this,t,cols=this.data.grid.columns||[],width,tr=this.data.grid.isThemeroller,classAdd=(tr?"themeroller":"regular"),img,defaultWidth=this.data.grid.columnWidth,divOffset=this.data.grid.divOffset,conf=this.data.grid.defaultConf;obj=!obj||obj===-1?this.get_container():this._get_node(obj);obj.each(function(){var i,val,cl,wcl,a,last,valClass,wideValClass,span,paddingleft,title,isAlreadyGrid,col,content,s,tmpWidth;t=$(this);a=t.children("a");isAlreadyGrid=a.hasClass(c);if(a.length===1){a.prev().css("float","left");a.addClass(c);renderAWidth(a,_this);renderATitle(a,t,_this);last=a;for(i=1;i<cols.length;i++){col=cols[i];s=col.source||"attr";cl=col.cellClass||"";wcl=col.wideCellClass||"";if(s==="attr"){val=col.value&&t.attr(col.value)?t.attr(col.value):"";}else{if(s==="metadata"){val=col.value&&t.data(col.value)?t.data(col.value):"";}}if(col.images){img=col.images[val]||col.images["default"];if(img){content=img[0]==="*"?'<span class="'+img.substr(1)+'"></span>':'<img src="'+img+'">';}}else{content=val;}valClass=col.valueClass&&t.attr(col.valueClass)?t.attr(col.valueClass):"";if(valClass&&col.valueClassPrefix&&col.valueClassPrefix!==""){valClass=col.valueClassPrefix+valClass;}wideValClass=col.wideValueClass&&t.attr(col.wideValueClass)?t.attr(col.wideValueClass):"";if(wideValClass&&col.wideValueClassPrefix&&col.wideValueClassPrefix!==""){wideValClass=col.wideValueClassPrefix+wideValClass;}title=col.title&&t.attr(col.title)?t.attr(col.title):"";title=title.replace(htmlstripre,"");paddingleft=7;width=col.width||defaultWidth;tmpWidth=$.support.boxModel?$(".jstree-grid-col-"+i+":first",t).width():$(".jstree-grid-col-"+i+":first",t).outerWidth();width=tmpWidth||(width-paddingleft);last=isAlreadyGrid?a.nextAll("div:eq("+(i-1)+")"):$("<div></div>").insertAfter(last);span=isAlreadyGrid?last.children("span"):$("<span></span>").appendTo(last);span.addClass(cl+" "+valClass).css({"margin-right":"0px","display":"inline-block","*display":"inline","*+display":"inline"}).html(content).click((function(val,col,s){return function(){$(this).trigger("select_cell.jstree-grid",[{value:val,column:col.header,node:$(this).closest("li"),sourceName:col.value,sourceType:s}]);};}(val,col,s)));last=last.css(conf).css({width:width,"padding-left":paddingleft+"px"}).addClass("jstree-grid-cell jstree-grid-cell-"+classAdd+" "+wcl+" "+wideValClass+(tr?" ui-state-default":"")).addClass("jstree-grid-col-"+i);if(title){span.attr("title",title);}}last.addClass("jstree-grid-cell-last"+(tr?" ui-state-default":""));$("<div></div>").css("clear","both").insertAfter(last);}});if(obj.is("li")){this._repair_state(obj);}else{obj.find("> ul > li").each(function(){_this._repair_state(this);});}}}});}(jQuery));(function(utilis,$,undefined){var extend=function(baseType,type){function tmpPrototype(){}tmpPrototype.prototype=baseType.prototype;var newProptotype=new tmpPrototype;$.each(type.prototype,function(key,value){if(_.isFunction(baseType.prototype[key])){newProptotype[key]=function(){var tmpSuper=this._super;this._super=baseType.prototype[key];var result=value.apply(this,arguments);this._super=tmpSuper;return result;};}else{newProptotype[key]=value;}});var tmpType=function(){this._super=baseType;type.apply(this,arguments);this._super=null;};tmpType.setInherit=function(extendingType){return extend(tmpType,extendingType);};tmpType.prototype=newProptotype;tmpType.prototype.constructor=type;return tmpType;};function Class(){}utilis.Class=extend(function(){},Class);})(window.utilis=window.utilis||{},jQuery);(function(utilis,$,undefined){function DataSource(client,options){if(!this.options){this.options=$.extend(true,{},defaults,options);}this.data=this.options.Data||[];this.readUrl=this.options.Read.Url;this._ajax=null;}DataSource.prototype={read:function(){var async=null;var readOptions=this.options.Read;if(!!readOptions&&this.readUrl){if(!!this._ajax){this._ajax.abort();}this._ajax=$.ajax({url:this.readUrl,dataType:readOptions.Type,type:"POST",contentType:readOptions.ContentType,data:JSON.stringify(readOptions.Data)}).done($.proxy(function(d){this.data=d.data;$(this).trigger("done.read.DataSource",d);},this));async=this._ajax;}else{var def=$.Deferred();def.resolve();async=def.promise();$(this).trigger("done.read.DataSource",{data:this.data,total:_.size(this.data)});}return async;},clear:function(){this.data=[];this.readUrl=null;this.read();},_init:function(){}};utilis.DataSource=utilis.Class.setInherit(DataSource);var defaults={Data:null,Read:{Url:null,Type:"json",ContentType:"application/json"}};})(window.utilis,jQuery);(function(utilis,$,undefined){function Sortable(client,options){if(!this.options){this.options=$.extend(true,{},defaults,options);}}Sortable.prototype={_init:function(){}};utilis.Sortable=utilis.Class.setInherit(Sortable);var defaults={DefaultSort:null};})(window.utilis,jQuery);(function(utilis,$,undefined){function Selectable(client,options){if(!this.options){this.options=$.extend(true,{},defaults,options);}this.client=client;this.selected=ko.observableArray([]);}Selectable.prototype={_init:function(){this.client._element.addClass("u-selectable");},selected:function(){var list=this.data();return _.filter(list,function(item){return item._selected();},this);},select:function(data,isMultiple){var isMultiple=isMultiple&&this.options.Multiple;var isSelected=data._selected();if(isMultiple){data._selected(!isSelected);if(!isSelected){this.selected.push(data);}else{this.selected.remove(data);}var args={control:this,isMultiple:isMultiple,data:data};this.client._element.trigger("multiselect.Selectable.utilis",args);}else{if(!isSelected||this.selected().length>1){_.each(this.data(),function(item){item._selected(false);},this);data._selected(true);this.selected([data]);var args={control:this,isMultiple:isMultiple,data:data};this.client._element.trigger("select.Selectable.utilis",args);}}},triggerSelect:function(isMultiple){var lastSelected=_.last(this.selected());if(lastSelected){var isMultiple=isMultiple&&this.options.Multiple;if(isMultiple){var args={control:this,isMultiple:isMultiple,data:lastSelected};this.client._element.trigger("multiselect.Selectable.utilis",args);}else{var args={control:this,isMultiple:isMultiple,data:lastSelected};this.client._element.trigger("select.Selectable.utilis",args);}}},setData:function(oArray){this.data=oArray;this.data.subscribe($.proxy(this._dataChanged,this));},_dataChanged:function(data){var list=this.data();_.each(list,function(item){item._selected=ko.observable(false);item.bindSelected=ko.computed({read:item._selected,write:function(newValue){this.select(item,true);}},this);},this);var dataDict=this._dataToDictionary(data);var newSelection=_.chain(this.selected()).map(function(item){return dataDict[item.Id];},this).filter(function(item){return item!=null;},this).map(function(item){item._selected(true);return item;},this).value();var selItem=null;var hasSelected=!_.isEmpty(newSelection);if(this.options.PreselectId){selItem=this._findItemById(this.options.PreselectId,list);this.options.PreselectId=null;}if(!selItem&&this.options.PreselectFirst&&!hasSelected){selItem=_.first(list);}if(selItem){this.select(selItem);}else{this.selected(newSelection);if(!hasSelected){var args={control:this};this.client._element.trigger("empty.Selectable.utilis",args);}}},_dataToDictionary:function(items){var list=ko.isObservable(items)?items():items;var obj={};_.each(list,function(item){obj[item.Id]=item;},this);return obj;},_findItemById:function(id,items){var list=ko.isObservable(items)?items():items;return _.find(list,function(item){return item.Id==id;},this);},_checkboxClick:function(item,e){e.stopPropagation();return true;}};utilis.Selectable=utilis.Class.setInherit(Selectable);var defaults={Multiple:false};})(window.utilis,jQuery);(function(utilis,$,undefined){function AppContext(){this.data=this._getDataFromCookie();}AppContext.prototype={handleDetailSectionClose:function(grid,deleteSelector,e,args){var isDeleted=$(e.target).is(deleteSelector);if(!!args.value){if(!isDeleted){args.cancel();}if(!!args.value.KeyId){if(grid){grid.Selectable.options.PreselectId=args.value.KeyId;}}if(grid){grid.refresh();}}else{if(!isDeleted){if(grid){grid.Selectable.triggerSelect();}}}},_getDataFromCookie:function(){var data=null;var cookie=$.cookie("AppContext");if(cookie){try{data=JSON.parse(cookie||null);}catch(e){console.error("Cookie value is not in JSON format");}}return data;}};utilis.AppContext=utilis.Class.setInherit(AppContext);if(utilis.Context==null){utilis.Context=new utilis.AppContext();}$(document).bind("ajaxSend",function(e,jqXHR,settings){var ctx=utilis.Context;if(ctx&&ctx.data){var data=JSON.parse(settings.data||null)||{};if(!data.AppContext){data=$.extend(data,{AppContext:ctx.data});settings.data=JSON.stringify(data);}}});})(window.utilis,jQuery);(function(utilis,$,undefined){function GridActions(client,options){if(!this.options){this.options=$.extend(true,{},defaults,options);}this.client=client;}GridActions.prototype={_init:function(){this.client._element.on("select.Selectable.utilis",$.proxy(function(e,args){if(this.options.SelectUrl&&this.options.SectionSelector){var url=$.utilis.parseUrl(this.options.SelectUrl);url.path=this._executeParameter(url.path,ko.toJS(args.data));url.search=this._executeParameter(url.search,ko.toJS(args.data));url.hash=this._executeParameter(url.hash,ko.toJS(args.data));var sections=$(this.options.SectionSelector).section();sections.each($.proxy(function(i,n){var el=$(n);var ctrl=el.section("control");ctrl.url=url;ctrl.open(this.client._element);},this));}if(this.options.TriggerChildSelector){var childs=$(this.options.TriggerChildSelector);_.each(childs,$.proxy(function(el){var grid=$(el).data("u-grid2");if(grid&&args){var childUrl=grid.DataSource.options.Read.Url;if(childUrl){var dsUrl=$.utilis.parseUrl(childUrl);dsUrl.path=this._executeParameter(dsUrl.path,ko.toJS(args.data));dsUrl.search=this._executeParameter(dsUrl.search,ko.toJS(args.data));dsUrl.hash=this._executeParameter(dsUrl.hash,ko.toJS(args.data));grid.DataSource.readUrl=dsUrl.combine();}grid.DataSource.read();}},this));}},this));this.client._element.on("empty.Selectable.utilis",$.proxy(function(e,args){if(this.options.SectionSelector){var sections=$(this.options.SectionSelector).section();sections.each($.proxy(function(i,n){var el=$(n);var ctrl=el.section("control");ctrl.close();},this));}if(this.options.TriggerChildSelector){var childs=$(this.options.TriggerChildSelector);_.each(childs,$.proxy(function(el){var grid=$(el).data("u-grid2");if(grid&&grid.DataSource){grid.DataSource.clear();}},this));}},this));},_executeParameter:function(obj,data){var result=null;if(_.isString(obj)){result=this._evalString(obj,data);}else{if(_.isObject(obj)){result=obj;_.each(obj,function(value,key){obj[key]=this._evalString(value,data);},this);}}return result;},_evalString:function(str,$data){if(_.isString(str)){var re=/({{0,1}[^{}]+}{0,1})/g;var result=[];var match=null;while(match=re.exec(str)){var s=match[1];try{var item=eval(match[1]);result.push(item);}catch(e){result.push(s);}}return result.join("");}return str;}};utilis.GridActions=utilis.Class.setInherit(GridActions);var defaults={SelectUrl:null,SectionSelector:null,TriggerChildSelector:null};})(window.utilis,jQuery);(function($){$.fn.toJson=function(){function parse(val){if(val==""){return null;}if(val=="true"){return true;}if(val=="false"){return false;}return val;}function toNestedObject(obj,arr){var key=arr.shift();if(arr.length>0){obj[key]=toNestedObject(obj[key]||{},arr);return obj;}return key;}if(this.length==1){return _.chain(this[0].elements).filter(function(e){return e.name!=null&&e.name!=""&&(e.type=="radio"?e.checked:true);}).map(function(e){var names=e.name.split(".");if(e.type=="checkbox"){e.value=e.checked;names.push(parse(e.value));}else{if(e.type=="select-multiple"){var selectedOptions=[];for(var i=0;i<e.length;i++){if(e.options[i].selected){selectedOptions.push(e.options[i].value);}}names.push(selectedOptions);}else{names.push(parse(e.value));}}return names;}).reduce(toNestedObject,{}).value();}else{if(this.length>1){throw"toJson can work on a single form only";}else{return{};}}};$.flatten=function(obj){var ret={};for(var key in obj){if(typeof obj[key]=="object"){var fobj=$.flatten(obj[key]);for(var extkey in fobj){ret[key+"."+extkey]=fobj[extkey];}}else{ret[key]=String(obj[key]);}}return ret;};})(jQuery);/*
** Unobtrusive Ajax support library for jQuery
** Copyright (C) Microsoft Corporation. All rights reserved.
*/
(function($){var data_click="unobtrusiveAjaxClick",data_validation="unobtrusiveValidation",submit_done="unobtrusiveAjaxSubmitDone";function getFunction(code,argNames){var fn=window,parts=(code||"").split(".");while(fn&&parts.length){fn=fn[parts.shift()];}if(typeof(fn)==="function"){return fn;}argNames.push(code);return Function.constructor.apply(null,argNames);}function isMethodProxySafe(method){return method==="GET"||method==="POST";}function asyncOnBeforeSend(xhr,method){if(!isMethodProxySafe(method)){xhr.setRequestHeader("X-HTTP-Method-Override",method);}}function asyncOnSuccess(element,data,contentType){var mode;if(contentType.indexOf("application/x-javascript")!==-1){return;}mode=(element.getAttribute("data-ajax-mode")||"").toUpperCase();$(element.getAttribute("data-ajax-update")).each(function(i,update){var top;switch(mode){case"BEFORE":top=update.firstChild;$("<div />").html(data).contents().each(function(){update.insertBefore(this,top);});break;case"AFTER":$("<div />").html(data).contents().each(function(){update.appendChild(this);});break;default:$(update).html(data);break;}$(update).trigger("loaded.ajax");});if(element.getAttribute("data-ajax-update")==null){var $element=$(element);var ajaxUpdate=$element.parents('[data-ajax-update="true"]:first');var triggerTarget=ajaxUpdate.parent();if(!!ajaxUpdate.length){ajaxUpdate.replaceWith(data);triggerTarget.trigger("loaded.ajax");}}}function asyncRequest(element,options){var confirm,loading,method,duration;confirm=element.getAttribute("data-ajax-confirm");if(confirm&&!window.confirm(confirm)){return;}loading=$(element.getAttribute("data-ajax-loading"));duration=element.getAttribute("data-ajax-loading-duration")||0;$.extend(options,{type:element.getAttribute("data-ajax-method")||undefined,url:element.getAttribute("data-ajax-url")||undefined,beforeSend:function(xhr){var result;asyncOnBeforeSend(xhr,method);result=getFunction(element.getAttribute("data-ajax-begin"),["xhr"]).apply(this,arguments);if(result!==false){loading.show(duration);}return result;},complete:function(){loading.hide(duration);getFunction(element.getAttribute("data-ajax-complete"),["xhr","status"]).apply(this,arguments);},success:function(data,status,xhr){asyncOnSuccess(element,data,xhr.getResponseHeader("Content-Type")||"text/html");getFunction(element.getAttribute("data-ajax-success"),["data","status","xhr"]).apply(this,arguments);},error:getFunction(element.getAttribute("data-ajax-failure"),["xhr","status","error"])});method=options.type.toUpperCase();options.contentType="application/json";$.ajax(options);}function validate(form){var validationInfo=$(form).data(data_validation);return !validationInfo||!validationInfo.validate||validationInfo.validate();}$("a[data-ajax=true]").live("click",function(evt){evt.preventDefault();asyncRequest(this,{url:this.href,type:"GET",data:[]});});$("form[data-ajax=true] input[type=image]").live("click",function(evt){var name=evt.target.name,$target=$(evt.target),form=$target.parents("form")[0],offset=$target.offset();$(form).data(data_click,[{name:name+".x",value:Math.round(evt.pageX-offset.left)},{name:name+".y",value:Math.round(evt.pageY-offset.top)}]);setTimeout(function(){$(form).removeData(data_click);},0);});$("form[data-ajax=true] :submit").live("click",function(evt){var name=evt.target.name,form=$(evt.target).parents("form")[0];$(form).data(data_click,name?[{name:name,value:evt.target.value}]:[]);setTimeout(function(){$(form).removeData(data_click);},0);});$("form[data-ajax=true]").live("submit",function(evt){evt.preventDefault();if(!validate(this)){return;}if($(this).data(submit_done)){return false;}else{$(this).data(submit_done,true);setTimeout($.proxy(function(){$(this).data(submit_done,false);},this),$(this).attr("data-disablable-time")||1000);}var form=$(this);var cbx=form.find(":checkbox[name]");var selectors=$.map(cbx,function(n){return $.format(':hidden[name="{0}"]',$(n).attr("name"));});if(!!selectors.length){form.find(selectors.join(",")).attr("name",null);}asyncRequest(this,{url:this.action,type:this.method||"GET",data:JSON.stringify($(this).toJson())});});}(jQuery));(function(utilis,$,undefined){var dataFormValidationGroupKey="__dataFormValidation__";$.extend(utilis,{pluginInit:function(name,control,options,defaults){var dataAttrOptions=$.format("data-{0}-options",name);var init=function(el,opt){var $el=$(el);var controlInstance=$el.data(name);if(!controlInstance||!(controlInstance instanceof control)){var attrOptions=$el.getAttributes(dataAttrOptions);var attrObjectOptions=utilis.parseJS($el.attr(dataAttrOptions));var mergedOptions=$.extend(true,{},defaults,attrOptions,attrObjectOptions,opt);controlInstance=new control(el,mergedOptions);$el.data(name,controlInstance);}return controlInstance;};if(typeof(options)=="string"&&options=="control"){var controls=this.map(function(i,n){return init(n,null);});return controls[0];}else{var controls=this.map(function(i,n){return init(n,options);});}return this;},addValidationGroupSupport:function(){var orginalCheck=$.validator.prototype.check;$.extend(true,$.validator,{prototype:{check:function(element){var $form=$(this.currentForm);var info=$form.data(dataFormValidationGroupKey);var validSelector=":not([data-val-group])";if(!!info&&!!info.group){validSelector=$.format("[data-val-group~={0}]",info.group);}if(!$(element).is(validSelector)){this.successList.push(element);return true;}return orginalCheck.call(this,element);}}});var onSubmit=function(e){var $form=$(this).parents("form:first");var valGroup=$(this).attr("data-val-group");var info={group:valGroup};$form.data(dataFormValidationGroupKey,info);$.validator.unobtrusive.parse($form);};$(document).on("click","form :submit",onSubmit);$(document).on("change",'form [data-u-autopostback="true"][data-val-group]',onSubmit);},addPostCommandSupport:function(){var onSubmit=function(e){var btn=$(this);var command=btn.attr("data-u-button-command");var argument=btn.attr("data-u-button-argument");var form=btn.parents("form:first");var addRemoveHidden=function(hiddenName,value){var inputArg=form.find($.format(":hidden[name={0}]",hiddenName));if(!inputArg.length){inputArg=$('<input type="hidden" />').attr("name",hiddenName).insertAfter(btn);}inputArg.val(value);};if(!!command){addRemoveHidden("submitCommand",command);}if(!!argument){addRemoveHidden("submitArgument",argument);}if(!!e.data&&!!e.data.submit){form.submit();}};$(document).on("click","form :submit[data-u-button-command], form :submit[data-u-button-argument]",onSubmit);$(document).on("change",'form [data-u-autopostback="true"]',{submit:true},onSubmit);},addBankersRoundingSupport:function(){var orginalRound=Math.round;function evenRound(num,decimalPlaces){var result=null;if(decimalPlaces==null){result=orginalRound(num);}else{var d=decimalPlaces||0;var m=Math.pow(10,d);var n=+(d?num*m:num).toFixed(8);var i=Math.floor(n),f=n-i;var r=(f==0.5)?((i%2==0)?i:i+1):orginalRound(n);result=d?r/m:r;}return result;}Math.round=evenRound;},parseUrl:function(url){var parseObj=function(str){var r=null,re=/([^&\?#=]+)=([^&]*)/g,m;if(str){r={};var s=str[0];while(m=re.exec(s)){r[m[1]]=m[2];}}return r;};var urlDecoded=decodeURIComponent(url||"");var hostPathMatch=urlDecoded.match(/[^\?#]+/);var hostPath=hostPathMatch!=null?hostPathMatch[0]:null;var searchMatch=urlDecoded.match(/(?=\?)[^#]+/);var hashMatch=urlDecoded.match(/(?=#).+/);return{search:parseObj(searchMatch),hash:parseObj(hashMatch),path:hostPath,combine:function(){var r="";if(this.path){r=r+this.path;}if(this.search){r=r+"?"+$.param(this.search,true);}if(this.hash){r=r+"#"+$.param(this.hash);}return r;}};},parseJS:function(JSstring){var result=null;try{result=eval($.format("({0})",JSstring));}catch(ex){}return result;},getObject:function(obj,name){var names=name.split(".");$.each(names,function(i,n){obj=obj[n];if(obj==null){return false;}});return obj;}});})(jQuery.utilis=jQuery.utilis||{},jQuery);(function($,undefined){$.fn.getAttributes=function(prefix){var el=this[0];var result=null;if(!!el){var searchAttr=$.format("{0}-",prefix);var re=new RegExp(searchAttr,"i");var attrs=_.chain(el.attributes).filter(function(x){return x.name.search(re)==0;}).map(function(x){var isString=x.value.match(/^true$|^false$|^\d+[\.]?\d+$/)==null;var name=_.last(x.name.split(re));var formatValue=' "{0}": "{1}" ';if(!isString){formatValue=' "{0}": {1} ';}return $.format(formatValue,name,x.value);}).value();if(!!attrs.length){var attrsString=$.format("{{0}}",attrs.join(","));result=$.utilis.parseJS(attrsString);}}return result;};$.fn.forceVisible=function(fun){var hidders=this.filter(":hidden").parents().filter(function(){return $(this).css("display")=="none";});hidders.addClass("visible_important");fun.call(this);hidders.removeClass("visible_important");return this;};$.fn.onx=function(){var selector=null;var eventType=null;var handler=null;var func=function(e){if(e.currentTarget!=e.target){return;}handler.apply(this,arguments);};if(_.isFunction(arguments[1])){eventType=arguments[0];handler=arguments[1];this.on(eventType,func);}else{selector=arguments[0];eventType=arguments[1];handler=arguments[2];this.on(selector,eventType,func);}};if(window.ko){var MS_JSON_DATE_REGEX=/\/(Date\(-?\d*\))\/$/;var updateObservableFormatted=function(element,valueAccessor,allBindingsAccessor,viewModel){var allBindings=allBindingsAccessor();var format=allBindings.format;var value=ko.utils.unwrapObservable(valueAccessor());var updateValue=value;if(_.isString(value)){var matchDate=value.match(MS_JSON_DATE_REGEX);if(matchDate){updateValue=eval("new "+matchDate[1]);if(!format){format="d";}}}if(!!format){updateValue=Globalize.format(updateValue,format);}updateValue=updateValue==null?"":updateValue;if(!!allBindings.value){$(element).val(updateValue);}else{$(element).text(updateValue);}};ko.bindingHandlers.text.update=updateObservableFormatted;ko.bindingHandlers.value.update=updateObservableFormatted;ko.bindingHandlers.selected={init:function(element,valueAccessor,allBindingsAccessor,viewModel){$(element).bind("blur",function(e){valueAccessor()(false);});},update:function(element,valueAccessor,allBindingsAccessor,viewModel,bindingContext){var selected=ko.utils.unwrapObservable(valueAccessor());if(!!selected&&!$(element).is(":focus")){$(element).select().focus();}}};ko.bindingHandlers.datepicker={init:function(element,valueAccessor,allBindingsAccessor,viewModel){var options=allBindingsAccessor().datepicker||{};$(element).datepicker(options);}};ko.bindingHandlers.datetimepicker={init:function(element,valueAccessor,allBindingsAccessor,viewModel){var options={dateFormat:$.format("{0} 00:00",$.datepicker._defaults.dateFormat)};$.extend(options,allBindingsAccessor().datetimepicker||{});$(element).datepicker(options);}};ko.bindingHandlers.buttonset={init:function(element,valueAccessor,allBindingsAccessor,viewModel){var options=allBindingsAccessor().buttonset||{};$(element).buttonset(options);}};ko.format=function(format){var args=_.chain(arguments).tail().map(function(n){return ko.toJS(n);}).value();return $.format.apply(this,[format].concat(args));};}})(jQuery);(function($,undefined){$.utilisMsgBox=function(winTitle,showClose,override){var id="sc-msg-dialog";var loadingBox=$("#"+id);var scDialog=createProgresWindow(winTitle,showClose);if(!loadingBox.length){loadingBox=$('<div id="'+id+'">'+scDialog.body+"<b></b></div>");loadingBox.appendTo(document.body).hide();}var isVisible=winTitle!=null&&$.trim(winTitle)!="";if(isVisible){if(!$.utilisMsgBox.isVisible||override){scDialog.show();Timer.setTimeout(function(){scDialog.setProperty("opacity",100);},250);}}else{if(typeof progresWindow!="undefined"&&progresWindow){scDialog.close();}}};function createProgresWindow(windowTitle,error){return isc.Window.create({ID:"progresWindow",title:windowTitle,autoCenter:true,isModal:true,height:150,width:300,opacity:0,showCloseButton:false,items:[isc.VLayout.create({autoDraw:false,width:120,height:120,layoutMargin:10,membersMargin:10,layoutAlign:"center",members:[isc.Img.create({ID:"imgSpinner",width:60,height:60,layoutAlign:"center",src:(error?STATIC_CONTENT_DIRECTORY+"/images/errorPic.png":STATIC_CONTENT_DIRECTORY+"/images/spinner.gif")}),isc.Button.create({visibility:error?"visible":"hidden",newWrap:true,title:"OK",width:60,height:25,layoutAlign:"center",click:function(){if(typeof progresWindow!="undefined"&&progresWindow){progresWindow.close();}}})]}),]});}$.utilisMsgBox.isVisible=false;var hasError=false;$(document).ajaxSend(function(e,xhr){xhr.fail(function(xhr,type){if(xhr.status==401){RPCManager.loginRequired();return;}var noDialogDiv=document.getElementById("remarisNoLoadingProgressWindow");if(noDialogDiv==null){if((type==="error"&&xhr.status!==0)||type=="timeout"){hasError=true;var ex=null;try{ex=$.parseJSON(xhr.responseText);}catch(ee){}var msg=languageUtilis.errorOnServer;if(!!ex&&!!ex.Message){msg+=$.format("{0}",ex.Message);if(!!ex.StackTrace){msg=$.format("{0}\n\n{1}",msg,ex.StackTrace);}}console.log(msg);$.utilisMsgBox("Dogodila se neoekivana greka na serveru.",true,true);}}});}).ajaxStart(function(e){var noDialogDiv=document.getElementById("remarisNoLoadingProgressWindow");if(noDialogDiv==null){hasError=null;$.utilisMsgBox(languageUtilis.loadingPleaseWait,false,true);}}).ajaxStop(function(e){var noDialogDiv=document.getElementById("remarisNoLoadingProgressWindow");if(noDialogDiv==null){if(!hasError){$.utilisMsgBox(null);}}});})(jQuery);(function($){var control=function(element,options){this.options=options;this._element=$(element);this._filesContainer=this._element.find(".u-upload-queue");this._error=this._element.find(".field-validation-error");this.options.uploader.flash_swf_url=this.options.runtime_url+this.options.uploader.flash_swf_url;this.options.uploader.silverlight_xap_url=this.options.runtime_url+this.options.uploader.silverlight_xap_url;this.uploadButton=this._element.find('[data-u-upload-button-start="true"]');this.uploadButton.on("click",$.proxy(this._start,this)).hide();var elId=this._element.attr("id");if(!elId){elId=$.format("__upload_{0}",plupload.guid());this._element.attr("id",elId);}this.options.uploader.container=elId;setTimeout($.proxy(this._init,this),10);};control.prototype={_init:function(){if(this._element.is(":visible")){this.uploader=new plupload.Uploader(this.options.uploader);this.uploader.init();this.uploader.bind("FilesAdded",$.proxy(this._filesAdded,this));this.uploader.bind("QueueChanged",$.proxy(this._queueChanged,this));this.uploader.bind("FileUploaded",$.proxy(this._fileUploaded,this));this.uploader.bind("UploadProgress",$.proxy(this._uploadProgress,this));this.uploader.bind("Error",$.proxy(this._uploadError,this));}},_queueChanged:function(){this._filesContainer.empty();this.queue={};$.each(this.uploader.files,$.proxy(function(i,file){var div=$($.format('<div class="u-upload-file"><span class="u-upload-file-name">{0} ({1})</span></div>',file.name,plupload.formatSize(file.size)));var progressBox=$('<span class="u-upload-progress" />');var progress=$("<span />").appendTo(progressBox);progress.width("0%");div.append(progressBox);this.queue[file.id]={file:file,el:div,progress:progress};this._filesContainer.append(div);},this));var uploadButtonVisible=!!this.uploader.files.length&&this.uploader.state==plupload.STOPPED;this.uploadButton.toggle(uploadButtonVisible);this._error.empty();},_start:function(){this.uploader.start();this.uploadButton.hide();this._error.empty();},_filesAdded:function(u,files){this.uploader.files.splice(0,this.uploader.files.length-1);},_fileUploaded:function(u,file,data){var f=this.queue[file.id];this.uploader.removeFile(file);f.el.hide();var result=$.parseJSON(data.response);var fileDownload=this._element.parents("[data-ajax-update=true]").find(".u-download");var secondText=this._element.parents("[data-ajax-update=true]").find(".u-download-second");var $img=fileDownload.find(".u-logo-path");if($img.length>0){$img.attr("src",result.url);}else{fileDownload.empty();fileDownload.text(result.text);if(secondText.length>0){secondText.text(result.text2);}}},_uploadProgress:function(u,file){var f=this.queue[file.id];f.progress.width($.format("{0}%",file.percent));},_uploadError:function(u,ex){var exMessage=ex.message;switch(ex.code){case plupload.HTTP_ERROR:var f=this.queue[ex.file.id];this.uploader.removeFile(ex.file);if(ex.status===417){exMessage=this.options.error_certificate_fail;}else{exMessage=this.options.error_http||exMessage;}break;case plupload.FILE_SIZE_ERROR:exMessage=this.options.error_file_size||exMessage;break;}this._error.text(exMessage);}};$.fn.upload=function(options){return $.utilis.pluginInit.call(this,"u-upload",control,options,$.fn.upload.defaults);};$.fn.upload.defaults={uploader:{url:null,browse_button:null,multi_selection:false,multiple_queues:true,runtimes:"html5,html4,flash",urlstream_upload:true,flash_swf_url:"plupload.flash.swf",silverlight_xap_url:"plupload.silverlight.xap"},runtime_url:"/",error_http:null,error_file_size:null};})(jQuery);(function($){var control=function(element,options){this.options=options;this._element=$(element);this._pagination=this._element.find(".pagination").hide();this._state={page:this.options.page,perpage:this.options.perpage,sort:this.options.sort||""};this.searchForm=null;var searchFormId=this.options.searchformid;if(!!searchFormId){this.searchForm=$("#"+searchFormId);var formState=this.searchForm.toJson();$.extend(this._state,formState);}var currentState=$.bbq.getState();$.extend(this._state,currentState);this.init();this._initSorting();this._initPaging();if(this.options.dataonload){this.refresh();}else{this._element.hide();}$.extend(true,this,this.options.model_extensions);ko.applyBindings(this,element);};control.prototype={init:function(){this.rows=ko.observableArray();if(this.searchForm){this._setFormState();$(document).off("submit",this.searchForm.selector).on("submit",this.searchForm.selector,$.proxy(function(e){var form$=$(e.target);var formState=form$.toJson();$.extend(this._state,formState);this._state.page=0;if(this.options.usestate){$.bbq.pushState(this._state,2);}else{this.refresh();}return false;},this));if(this.options.usestate){$(window).bind("hashchange",$.proxy(function(e){this._state=e.getState();this._setFormState();this.refresh();},this));}}if(!!this.options.trigger){this._trigger=$(this.options.trigger);var getFormState=$.proxy(function(){this._state.page=0;var formState=this._trigger.find("form").toJson();return formState;},this);this._trigger.on("loaded.ajax",$.proxy(function(e){var isSearchValid=!!this._trigger.find('[data-u-grid-refresh="true"]').length;if(isSearchValid){var formState=getFormState();this.refresh(formState);}},this));var formState=getFormState();$.extend(this._state,formState);}this.actionClick=$.proxy(function(action,item,e){this._element.trigger($.format("{0}.grid.utilis",action),ko.toJS(item));},this);},refresh:function(post){$.extend(this._state,post);_.each(this._state,function(val,key){if(_.isArray(val)){this._state[key]=val[0];}},this);if(!!this._ajax){this._ajax.abort();}this._ajax=$.ajax({url:this.options.url,dataType:"json",type:"POST",contentType:"application/json",data:JSON.stringify(this._state)}).success($.proxy(function(d){if(d.data){this.mappingRules=d.mappingRules||{};var mappedItems=$.map(d.data,$.proxy(function(item){if(!item.highlighted){item.highlighted=false;}var mappedItem=ko.mapping.fromJS(item,this.mappingRules);var extendedItem=$.extend(mappedItem,this.options.extensions);if(extendedItem._init){extendedItem._init(this);}return extendedItem;},this));this.rows(mappedItems);this._element.show();this._data=d.data;this._total=d.total;if(!!d.sort){this._state.sort=d.sort;}this._setSortButton();this._paginate();}},this));},addSingleRow:function(item){this.rows.push(item);},removeSingleRow:function(item){this.rows.remove(item);},addSingleRawItem:function(item){if(!item.highlighted){item.highlighted=false;}var mappedItem=ko.mapping.fromJS(item,this.mappingRules);var extendedItem=$.extend(mappedItem,this.options.extensions);this.rows.push(extendedItem);},removeSingleRowById:function(id){$.each(this.rows(),$.proxy(function(index,value){if(id==value.Id){this.rows.remove(value);return false;}},this));},setSort:function(sortBy){this._state.sort=sortBy;},_initSorting:function(){this._setSortButton();this._element.on("click mouseover mouseout","table > thead > tr > th > span[data-u-grid-sort]",$.proxy(function(e){var btn=$(e.currentTarget);var sortField=btn.attr("data-u-grid-sort");if(sortField){switch(e.type){case"click":e.preventDefault();e.stopPropagation();var sort=this._parseSort(this._state.sort);var direction=sort.direction;var isChangingField=sort.field!=sortField;if(isChangingField){direction="asc";}else{direction=sort.direction=="asc"?"desc":"asc";}this._state.sort=$.format("{0} {1}",sortField,direction);this._setSortButton();this.refresh();break;case"mouseover":btn.addClass("hover");break;case"mouseout":btn.removeClass("hover");break;}}},this));},_setSortButton:function(){var sort=this._parseSort(this._state.sort);if(!!sort.field){var sortable=this._element.find("table > thead > tr > th:has(span[data-u-grid-sort])");sortable.removeClass("asc desc");var th=sortable.filter($.format(':has(span[data-u-grid-sort="{0}"])',sort.field));th.addClass(sort.direction);}},_parseSort:function(sortBy){var result={field:null,direction:null};if(!!sortBy){var sortSplit=sortBy.split(" ");result.field=sortSplit[0];result.direction=sortSplit[1]=="desc"?"desc":"asc";}return result;},_initPaging:function(){this._element.on("click",".pagination a",$.proxy(function(e){e.preventDefault();var btn=$(e.currentTarget);this._state.page=parseInt(btn.attr("data-u-grid-page"))-1;this.refresh();},this));},_paginate:function(){var total=this._total;var itemsPerPage=this._state.perpage;var skip=this._state.page*this._state.perpage;var page=this._state.page+1;if(itemsPerPage&&total>itemsPerPage){this._pagination.empty();this._element.width("auto");var tbl=this._element.find("table");var size={tableWidth:300};tbl.forceVisible($.proxy(function(){size.tableWidth=tbl.outerWidth(true);},this));this._element.width(size.tableWidth);this._pagination.width(size.tableWidth);var splitSize=size.tableWidth*0.006;var totalPages=Math.ceil(total/itemsPerPage);if(totalPages!=Infinity){if(page<=splitSize){splitSize+=splitSize-page;}else{if(page>=totalPages-splitSize){splitSize+=splitSize-(totalPages-page);}}var pText=$("<span/>").html($.format("{0} {1}/{2}&nbsp;","Stranica",page,totalPages));this._pagination.append(pText);var pages=[];for(var i=1;i<totalPages+1;i++){if(i<=splitSize||i>=totalPages-splitSize||(i<=page+splitSize&&i>=page-splitSize)){if(_.indexOf(pages,i)==-1){pages.push(i);}}}$.each(pages,$.proxy(function(i,n){var before=pages[i-1];if(before!=null&&before<n-1){this._pagination.append("<span>...</span>");}var a=$('<a href="#"></a>').html(n).attr("data-u-grid-page",n);if(page==n){a.addClass("selected");}this._pagination.append(a);},this));this._pagination.css("display","block");}}else{this._pagination.hide();}},_setFormState:function(){$.each(this._state,$.proxy(function(i,column){this.searchForm.find($.format('[name="{0}"]',i)).val(column);},this));},_rowClicked:function(row,e){if(e.target.tagName!="A"&&!$(e.target).hasClass("u-icon")&&!$(e.target).hasClass("u-skipdefault")){if(row.rowUrl){document.location.href=row.rowUrl();return false;}else{if(row.rowDialog){var dialog=$("#"+row.rowDialog()).dialogManager();var dialogControl=dialog.dialogManager("control");if(row.rowDialogUrl){dialogControl.url=$.utilis.parseUrl(row.rowDialogUrl());}else{if(row.rowDialogQuery){dialogControl.url.search=ko.toJS(row.rowDialogQuery);}}dialogControl.open();return false;}}}return true;}};$.fn.grid=function(options){return $.utilis.pluginInit.call(this,"u-grid",control,options,$.fn.grid.defaults);};$.fn.grid.defaults={usestate:false,dataonload:true,perpage:10,page:0,sort:null,trigger:null,extensions:null,model_extensions:null};})(jQuery);(function($){var control=function(element,options){this.options=options;this._element=$(element);this._initPlugins();this._state={};this.data=ko.observableArray();if(this.Sortable){this._state.sort=this.Sortable.options.DefaultSort||"";}if(this.Selectable){this.Selectable.setData(this.data);}if(this.DataSource){this._state.page=this.DataSource.options.Page;this._state.perpage=this.DataSource.options.PageSize;this.DataSource.options.Read.Data=this._state;$(this.DataSource).bind("done.read.DataSource",$.proxy(this._dataLoaded,this));}this._pagination=this._element.find(".pagination").hide();this.searchForm=null;var searchFormId=this.options.SearchForm;if(!!searchFormId){this.searchForm=$("#"+searchFormId);var formState=this.searchForm.find("form:first").toJson();$.extend(this._state,formState);}this._init();this._initSorting();this._initPaging();if(this.options.DataOnLoad){this.refresh();}else{this._element.hide();}$.extend(true,this,this.options.model_extensions);ko.applyBindings(this,element);};control.prototype={refresh:function(post){var async=null;$.extend(this._state,post);if(this.DataSource){this.DataSource.options.Read.Data=this._state;async=this.DataSource.read();}else{var def=$.Deferred();def.resolve();async=def.promise();}return async;},_initPlugins:function(){$.each(this.options,$.proxy(function(key,value){var pluginClass=utilis[key];if(!!pluginClass&&pluginClass.prototype instanceof utilis.Class){var plugin=this[key]=new pluginClass(this,value);plugin._init();}},this));},_init:function(){if(this.searchForm){$(document).off("submit",this.searchForm.selector).on("submit",this.searchForm.selector,$.proxy(function(e){var form$=$(e.target);var formState=form$.toJson();$.extend(this._state,formState);this._state.page=0;this.refresh();return false;},this));}if(!!this.options.Trigger){this._trigger=$(this.options.Trigger);var getFormState=$.proxy(function(){return this._trigger.find("form").toJson();},this);this._trigger.on("loaded.ajax",$.proxy(function(e){var isSearchValid=!!this._trigger.find('[data-u-grid-refresh="true"]').length;if(isSearchValid){var formState=getFormState();this.refresh(formState);}},this));$.extend(this._state,getFormState());this._state.page=0;}this.actionClick=$.proxy(function(action,item,e){this._element.trigger($.format("{0}.grid.utilis",action),ko.toJS(item));},this);},_dataLoaded:function(e,d){if(d.data){this.mappingRules=d.mappingRules||{};var mappedItems=$.map(d.data,$.proxy(function(item){var mappedItem=ko.mapping.fromJS(item,this.mappingRules);var extendedItem=$.extend(mappedItem,this.options.extensions);if(extendedItem._init){extendedItem._init(this);}return extendedItem;},this));this.data(mappedItems);if($.browser.msie&&$.browser.version=="8.0"){this._element.hide();_.defer($.proxy(function(){this._element.show();},this));}else{this._element.show();}this._data=d.data;this._total=d.total;if(!!d.sort){this._state.sort=d.sort;}this._setSortButton();this._paginate();}},_initSorting:function(){this._setSortButton();this._element.on("click mouseover mouseout","table > thead > tr > th > span[data-u-grid-sort]",$.proxy(function(e){var btn=$(e.currentTarget);var sortField=btn.attr("data-u-grid-sort");if(sortField){switch(e.type){case"click":e.preventDefault();e.stopPropagation();var sort=this._parseSort(this._state.sort);var direction=sort.direction;var isChangingField=sort.field!=sortField;if(isChangingField){direction="asc";}else{direction=sort.direction=="asc"?"desc":"asc";}this._state.sort=$.format("{0} {1}",sortField,direction);this._setSortButton();this.refresh();break;case"mouseover":btn.addClass("hover");break;case"mouseout":btn.removeClass("hover");break;}}},this));},_setSortButton:function(){var sort=this._parseSort(this._state.sort);if(!!sort.field){var sortable=this._element.find("table > thead > tr > th:has(span[data-u-grid-sort])");sortable.removeClass("asc desc");var th=sortable.filter($.format(':has(span[data-u-grid-sort="{0}"])',sort.field));th.addClass(sort.direction);}},_parseSort:function(sortBy){var result={field:null,direction:null};if(!!sortBy){var sortSplit=sortBy.split(" ");result.field=sortSplit[0];result.direction=sortSplit[1]=="desc"?"desc":"asc";}return result;},_initPaging:function(){this._element.on("click",".pagination a",$.proxy(function(e){e.preventDefault();var btn=$(e.currentTarget);this._state.page=parseInt(btn.attr("data-u-grid-page"))-1;this.refresh();},this));},_paginate:function(){var total=this._total;var itemsPerPage=this._state.perpage;var skip=this._state.page*this._state.perpage;var page=this._state.page+1;if(itemsPerPage&&total>itemsPerPage){this._pagination.empty();this._element.width("auto");var tbl=this._element.find("table");var size={tableWidth:300};tbl.forceVisible($.proxy(function(){size.tableWidth=tbl.outerWidth(true);},this));this._element.width(size.tableWidth);this._pagination.width(size.tableWidth);var splitSize=size.tableWidth*0.006;var totalPages=Math.ceil(total/itemsPerPage);if(totalPages!=Infinity){if(page<=splitSize){splitSize+=splitSize-page;}else{if(page>=totalPages-splitSize){splitSize+=splitSize-(totalPages-page);}}var pText=$("<span/>").html($.format("{0} {1}/{2}&nbsp;","Stranica",page,totalPages));this._pagination.append(pText);var pages=[];for(var i=1;i<totalPages+1;i++){if(i<=splitSize||i>=totalPages-splitSize||(i<=page+splitSize&&i>=page-splitSize)){if(_.indexOf(pages,i)==-1){pages.push(i);}}}$.each(pages,$.proxy(function(i,n){var before=pages[i-1];if(before!=null&&before<n-1){this._pagination.append("<span>...</span>");}var a=$('<a href="#"></a>').html(n).attr("data-u-grid-page",n);if(page==n){a.addClass("selected");}this._pagination.append(a);},this));this._pagination.css("display","block");}}else{this._pagination.hide();}},_rowClicked:function(item,e){if(this.Selectable){var isControlKeyDown=e.ctrlKey;this.Selectable.select(item,isControlKeyDown);}return true;}};$.fn.grid2=function(options){return $.utilis.pluginInit.call(this,"u-grid2",control,options,$.fn.grid2.defaults);};$.fn.grid2.defaults={Trigger:null,DataOnLoad:true,SearchForm:null,extensions:null,model_extensions:null};})(jQuery);(function($){$(document).on("click","[data-u-dialog-open]",function(e){var target=$(e.currentTarget);var dialogId=target.attr("data-u-dialog-open");var dialog=$("#"+dialogId).dialogManager();var dialogControl=dialog.dialogManager("control");dialogControl.open(target);e.preventDefault();});var control=function(element,options){this.options=options;this._element=$(element);this.isOpen=false;this.url=$.utilis.parseUrl(this.options.url);if(this.options.autoopen){this.open();}};control.prototype={open:function(target){if(!this.isOpen){var continueOpen=true;var args={cancel:function(){continueOpen=false;},control:this,target:target,url:$.extend(true,{},this.url)};this._element.trigger("open.dialog.utilis",args);if(continueOpen){var url=args.url;this.reload(url,true);}}},close:function(closeObj){var continueClose=true;var args={cancel:function(){continueClose=false;},control:this,value:closeObj||null};this._element.trigger("close.dialog.utilis",args);if(continueClose){this.dialog.dialog("destroy");this.dialog.remove();this.dialog=null;this.isOpen=false;$.fn.dialogManager.active=null;}},reload:function(url,forceOpen){this.lastUrl=url||this.lastUrl;if(!!this.lastUrl){if(this.isOpen||!!forceOpen){$.ajax({url:this.lastUrl.combine()}).done($.proxy(function(data){this._createDialog(data);this.dialog.trigger("loaded.ajax");},this));}}else{this._createDialog();}},_createDialog:function(html){var isDialogExist=this.dialog!=null;var dialogContent=this.dialog||$("<div/>");dialogContent.html(html);var dialogButtons=this._getDialogButtons(dialogContent);var dialogOptions=$.extend({},this.options.dialog,{buttons:dialogButtons,close:$.proxy(function(){this.close();},this)});this.dialog=dialogContent.dialog(dialogOptions);this.isOpen=true;if(!isDialogExist){this.dialog.on("loaded.ajax",$.proxy(this._ajaxLoaded,this));var args={control:this,dialog:this.dialog};this._element.trigger("create.dialog.utilis",args);}$.fn.dialogManager.active=this;},_getDialogButtons:function(container){var inputButtons=container.find("[data-u-dialog-button=true]");var dialogButtons=inputButtons.map($.proxy(function(i,n){var $n=$(n);var isCloseBtn=$n.is("[data-u-dialog-button-close=true]");var clickHandler=null;if(isCloseBtn){clickHandler=function(){$(this).dialog("close");};}else{clickHandler=function(e){$n.click();};}var button={text:$n.val()||$n.text(),click:clickHandler,"class":$n.attr("class")};return button;},this));inputButtons.hide();return dialogButtons;},_ajaxLoaded:function(){var dialogButtons=this._getDialogButtons(this.dialog);if(this.dialog){this.dialog.dialog("option","buttons",dialogButtons);}var dataSave=this.dialog.find("[data-u-dialog-save]:first").attr("data-u-dialog-save");if(!!dataSave){var retValue=$.parseJSON(dataSave);this.close(retValue);}else{var args={control:this,dialog:this.dialog};this._element.trigger("loaded.dialog.utilis",args);}}};$.fn.dialogManager=function(options){return $.utilis.pluginInit.call(this,"u-dialog",control,options,$.fn.dialogManager.defaults);};$.fn.dialogManager.active=null;$.fn.dialogManager.closeActive=function(){var active=$.fn.dialogManager.active;if(!!active){active.close();}};$.fn.dialogManager.defaults={dialog:{modal:true,resizable:false},autoopen:false,url:null};})(jQuery);(function($){$(document).on("click","[data-u-section-open]",function(e){var target=$(e.currentTarget);var sectionSelector=target.attr("data-u-section-open");var sections=$(sectionSelector).section();sections.each(function(i,n){var el=$(n);var ctrl=el.section("control");var sectionUrl=target.attr("data-u-section-url");if(sectionUrl){ctrl.url=$.utilis.parseUrl(sectionUrl);}ctrl.open(target);});e.preventDefault();});var handleContentCommands={empty:function(){this.contentCommands.empty();},add:function(sectionButtons){this.contentCommands=$(".content-commands").empty();$.each(sectionButtons,$.proxy(function(i,n){var button=$("<button/>").addClass(n["class"]).text(n.text).click(n.click).appendTo(this.contentCommands).button();if(n.managerpermission){button.attr("data-u-managerpermission",n.managerpermission);button.attr("data-u-managerpermissiontype",n.managerpermissiontype);button.button({disabled:true});}},this));},contentCommands:null};var control=function(element,options){this.options=options;this._element=$(element);this.isVisible=false;this.url=$.utilis.parseUrl(this.options.url);this.container=null;if(this.options.autoopen){this.open(this._element);}};control.prototype={open:function(target){var continueOpen=true;var args={cancel:function(){continueOpen=false;},control:this,target:target,url:$.extend(true,{},this.url)};this._element.trigger("open.section.utilis",args);if(continueOpen){var url=args.url;this.reload(url,true);}},close:function(closeObj,targetElement){if(this.isVisible){var continueClose=true;var args={cancel:function(){continueClose=false;},control:this,target:targetElement,value:closeObj||null};this._element.trigger("close.section.utilis",args);if(continueClose){if(!this.options.indialog){(!this.options.nocontentcommands)&&handleContentCommands.empty();}else{this.container.dialog("destroy");}this.container.remove();this.container=null;this.isVisible=false;}}},reload:function(url,forceVisible){if(_.isString(url)){url=$.utilis.parseUrl(url);}this.lastUrl=url||this.lastUrl;if(!!this.lastUrl&&!!this.lastUrl.path){if(this.isVisible||!!forceVisible){if(!!this._ajax){this._ajax.abort();}this._ajax=$.ajax({url:this.lastUrl.combine()}).done($.proxy(function(data){this._dataLoaded(data);this.container.trigger("loaded.ajax");},this));}}},_dataLoaded:function(html){this._ensureContainer();this.container.html(html);this.isVisible=true;if(!this.options.indialog){this.container.appendTo(this._element);}else{var dialogButtons=this._getSectionButtons(this.container);var dialogOptions=$.extend({},this.options.dialog,{buttons:dialogButtons,close:$.proxy(function(){this.close();},this),closeOnEscape:false});this.container.dialog(dialogOptions);}},_ensureContainer:function(){var isContainerExist=this.container!=null;if(!isContainerExist){this.container=$("<div/>");this.container.on("loaded.ajax",$.proxy(this._ajaxLoaded,this));var args={control:this,container:this.container};this._element.trigger("create.section.utilis",args);this.container.on("click","[data-u-section-button-close=true]",$.proxy(function(e){this.close(null,e.currentTarget);},this));}},_getSectionButtons:function(container){var inputButtons=container.find("[data-u-section-button=true]");var sectionButtons=inputButtons.map($.proxy(function(i,n){var $n=$(n);var clickHandler=null;clickHandler=function(e){$n.click();};var button={text:$n.val()||$n.text(),click:clickHandler,"class":$n.attr("class")};if($n.data("u-managerpermission")&&$n.data("u-managerpermissiontype")){button["managerpermission"]=$n.data("u-managerpermission");button["managerpermissiontype"]=$n.data("u-managerpermissiontype");$n.removeAttr("data-u-managerpermission");$n.removeAttr("data-u-managerpermissiontype");}return button;},this));inputButtons.hide();return sectionButtons;},_ajaxLoaded:function(e){var sectionButtons=this._getSectionButtons(this.container);if(!this.options.indialog){(!this.options.nocontentcommands)&&handleContentCommands.add(sectionButtons);}else{for(var i=0;i<sectionButtons.length;i++){if(sectionButtons[i].managerpermission&&sectionButtons[i].managerpermissiontype){sectionButtons[i]["data-u-managerpermission"]=sectionButtons[i].managerpermission;sectionButtons[i]["data-u-managerpermissiontype"]=sectionButtons[i].managerpermissiontype;sectionButtons[i].managerpermission=null;sectionButtons[i].managerpermissiontype=null;sectionButtons[i].disabled=true;}}this.container.dialog("option","buttons",sectionButtons);}var dataSaveEl=this.container.find("[data-u-section-save]:first");var dataSave=dataSaveEl.attr("data-u-section-save");dataSaveEl.remove();if(!!dataSave){var retValue=$.parseJSON(dataSave);this.close(retValue);}else{var args={control:this,container:this.container};this._element.trigger("loaded.section.utilis",args);}}};$.fn.section=function(options){return $.utilis.pluginInit.call(this,"u-section",control,options,$.fn.section.defaults);};$.fn.section.defaults={indialog:false,dialog:{modal:true,resizable:false,position:"center"},autoopen:false,url:null};})(jQuery);(function($){var control=function(element,options){this.options=options;this._element=$(element);this._init();$.each(options.plugins,$.proxy(function(index,plugin){this.options[plugin]._init.call(this);},this));this.create();};control.prototype={_init:function(){this.jsTreeConfiguration={core:{html_titles:true},"json_data":{"ajax":{type:"GET",url:this.options.url,data:$.proxy(function(n){var itemId=this.options.rootId;if(n!=-1){var item=n.data("item");itemId=item.id;}return{id:itemId};},this),success:$.proxy(function(data){return data.d;},this)}},"ui":{disable_selecting_children:true},"themes":{theme:"default"},"plugins":["themes","ui","json_data"]};var self=this;if(this.options.typesConfig){this.jsTreeConfiguration.plugins.push("types");this.jsTreeConfiguration.types=this.options.typesConfig;if(this.options.contextmenu){this.jsTreeConfiguration.plugins.push("contextmenu");this.jsTreeConfiguration.contextmenu={items:{remove:{label:"Brii",action:$.proxy(function(obj){this._element.trigger($.format("{0}.hierarhy.utilis","delete"),$(obj).data("item"));},this)},rename:false,edit:{label:"Uredi",action:$.proxy(function(obj){this._element.trigger($.format("{0}.hierarhy.utilis","edit"),$(obj).data("item"));},this)},create:{label:"Dodaj novi",action:false,submenu:{}},add:false,ccp:false}};$.each(this.options.typesConfig.types,$.proxy(function(index,item){this.jsTreeConfiguration.contextmenu.items.create.submenu[item.name]={"label":item.displayName,"action":$.proxy(function(obj){this._element.trigger($.format("{0}.hierarhy.utilis",item.name),$(obj).data("item"));},self)};},self));}}if(this.options.checkBox){this.jsTreeConfiguration.plugins.push("checkbox");this.jsTreeConfiguration.checkbox={override_ui:true};}if(this.options.drag_drop){this.jsTreeConfiguration.plugins.push("dnd");this.jsTreeConfiguration.dnd={drop_target:".ui-droppable",copy_modifier:true,"drop_check":$.proxy(function(data){var dragged=$(data.o);var dropTarget=$(data.e.currentTarget);if(!!dragged.length&&!!dropTarget.data("droppable")){var dropOptions=dropTarget.droppable("option");var acceptFilter=dropOptions.accept;if(_.isFunction(acceptFilter)){acceptFilter=function(i,el){return dropOptions.accept.call(dropTarget[0],$(el));};}var isAccepted=dragged.filter(acceptFilter);return !!isAccepted.length;}else{return false;}},this),"drop_finish":$.proxy(function(data){var dragged=$(data.o);var dropTarget=$(data.e.currentTarget);if(!!dragged.length&&!!dropTarget.data("data-u-drop")){var drop=dropTarget.drop("control");var args={draggable:data.o,helper:data.o,data:data};var deferred=drop.drop.call(drop,data.e,args).done($.proxy(function(){this.jsTreeRef.refresh(-1);},this));}return true;},this),"drag_check":function(data){return{after:false,before:false,inside:true};}};}this.jsTreeConfiguration.plugins.push("crrm");this.jsTreeConfiguration.crrm={"move":{"check_move":$.proxy(function(m){var isRoot=m.rt._get_parent(m.r)===-1;var action=m.p;return true;},this)}};},jsTreeConfiguration:{},create:function(){this._element.jstree(this.jsTreeConfiguration);this.jsTreeRef=$.jstree._reference(this._element);this._element.on("move_node.jstree",$.proxy(function(e,data){this.addNodes(data.rslt.o,data.rslt.r.attr("data_node_id"),data.rslt.p,data.rlbk);},this));this._element.on("loaded.jstree refresh.jstree",$.proxy(function(e,data){if(this.selectedItem!=null){var selectSelector=$.format("li[data_node_id={0}]",this.selectedItem.id);if(!$(selectSelector).length){selectSelector=$.format("li[data_node_id={0}]",this.selectedItem.parentId);}this.jsTreeRef.select_node(selectSelector);this.jsTreeRef.open_node();}},this));this._element.on("select_node.jstree",$.proxy(function(e,data){this.selectedItem=data.rslt.obj.data("item");},this));},addNodes:function(nodesFrom,nodesTo,actionType,rlbk,refresh){if(!nodesTo){nodesTo=this.options.rootId;}if(!actionType){actionType="inside";}var mappedItems=$.map(nodesFrom,$.proxy(function(item){return $(item).data("item").id;},this));var datatoSend={itemFrom:mappedItems,itemTo:nodesTo,action:actionType};$.ajax({url:this.options.saveDropUrl,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(datatoSend)}).done($.proxy(function(d){if(d.success){if(refresh){this.jsTreeRef.refresh(-1);}}else{if(rlbk){$.jstree.rollback(rlbk);}}},this)).fail(function(){if(rlbk){$.jstree.rollback(rlbk);}});}};$.fn.hierarchy=function(options){return $.utilis.pluginInit.call(this,"u-hierarchy",control,options,$.fn.hierarchy.defaults);};$.fn.hierarchy.defaults={rootId:null,url:null,typesConfig:{"valid_children":"all","types":{"product":{"valid_children":"all"}}},drag_drop:false,plugins:[]};})(jQuery);(function($){$.fn.hierarchy.defaults.section={_init:function(){if(this.options.typesConfig){this.openHDialog=function(url){var section=$(this.options.sectionSelector).section();var sectionControl=section.section("control");sectionControl.url=$.utilis.parseUrl(url);sectionControl.open();};this.jsTreeConfiguration.contextmenu={items:{remove:{label:"Brii",action:$.proxy(function(obj){this.openHDialog(this.options.typesConfig.types[$(obj).data("item").type].url_delete+"/"+$(obj).data("item").id);},this)},rename:false,edit:{label:"Uredi",action:$.proxy(function(obj){this.openHDialog(this.options.typesConfig.types[$(obj).data("item").type].url_edit+"/"+$(obj).data("item").itemId);},this)},create:{label:"Dodaj novi",action:false,submenu:{}},add:false,ccp:false}};$.each(this.options.typesConfig.types,$.proxy(function(index,item){this.jsTreeConfiguration.contextmenu.items.create.submenu[item.name]={"label":item.displayName,"action":$.proxy(function(obj){this.openHDialog(item.url_create+"?parentid="+$(obj).data("item").id);},this)};},this));$(this.options.sectionSelector).off("close.section.utilis");$(this.options.sectionSelector).on("close.section.utilis",$.proxy(function(e,args){if(!!args.value){this.jsTreeRef.refresh(-1);}},this));}}};})(jQuery);(function($){var control=function(element,options){this.options=options;this._element=$(element);this._init();};control.prototype={_init:function(){if(!!this.options.types){var acceptMap=_.map(this.options.types,$.proxy(function(n){return $.format('{0} .u-draggable[rel="{1}"]',this.options.parent,n);},this));var accept=acceptMap.join(", ");this.options.accept=accept;}this._element.droppable(this.options);},drop:function(e,args){var mappedItems=$.map(args.draggable,$.proxy(function(item){return $(item).data("item").id;},this));var datatoSend={itemFrom:mappedItems,itemTo:this.options.root_id,action:"inside"};return $.ajax({url:this.options.drop_url,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(datatoSend)}).done($.proxy(function(){var treeRef=$.jstree._reference($(this.options.refresh_target));if(!!treeRef){treeRef.refresh(-1);}},this));}};$.fn.drop=function(options){return $.utilis.pluginInit.call(this,"u-drop",control,options,$.fn.drop.defaults);};$.fn.drop.defaults={parent:"*",types:[],root_id:null,drop_url:null,refresh_target:null};})(jQuery);(function($){$.fn.hierarchy.defaults.dependableTree={_init:function(){if(this.options.dependantTree&&this.jsTreeConfiguration.dnd){var selector="#"+this.options.dependantTree;this.jsTreeConfiguration.dnd.drop_check=$.proxy(function(data){return true;},this);this.jsTreeConfiguration.dnd.drop_finish=$.proxy(function(data){if(data.r.hasClass("foreign-continer")||data.r.parents().hasClass("foreign-continer")){$.each(data.o,function myfunction(index,item){var itemData=$(item).data("item");console.log("o : "+itemData.id);});console.log("o : "+data.r.find("#"+this.options.dependantTree+"_tree"));var control=$(selector).hierarchy("control");control.selectedItem=data.o.data("item");control.addNodes(data.o,null,null,null,true);if(!this.options.dependantTreeCopy){this.jsTreeRef.remove(data.o);}}},this);}}};})(jQuery);(function($){var GRID_EDIT_COLUMN="GridEditColumn";var GRID_EDIT_DROPDOWN_COLUMN="GridEditDropdownColumn";var GRID_EDIT_CHECKBOX_COLUMN="GridEditCheckboxColumn";var handleSave_nextColumn=function(item,keyCode,e){var column=item.selectedColumn;if(!!column){var isValid=ko.utils.unwrapObservable(item[column.name].isValid);if(isValid){var data=this.rows||this.data;var items=data();var indexOfTmpRow=_.indexOf(items,item,false);var allEditableColumns=_.filter(this.options.columns,function(column){return column.type==GRID_EDIT_COLUMN||column.type==GRID_EDIT_DROPDOWN_COLUMN||column.type==GRID_EDIT_CHECKBOX_COLUMN;});var isUp=(keyCode==$.ui.keyCode.TAB||keyCode==$.ui.keyCode.ENTER)&&e.shiftKey;var indexOfTmpColumn=_.indexOf(allEditableColumns,column);var nextColumnIndex=isUp?indexOfTmpColumn-1:indexOfTmpColumn+1;var nextRowIndex=indexOfTmpRow;if(_.last(allEditableColumns)===column&&!isUp){nextColumnIndex=0;nextRowIndex=indexOfTmpRow+1;}else{if(_.first(allEditableColumns)===column&&isUp){nextColumnIndex=allEditableColumns.length-1;nextRowIndex=indexOfTmpRow-1;}}var nextColumn=allEditableColumns[nextColumnIndex];var next=items[nextRowIndex];if(!!next){item[nextColumn.name].isEdit(false);next[nextColumn.name].isEdit(true);}}else{}}};var handleSave_nextRow=function(item,keyCode,e){var column=item.selectedColumn;if(!!column){var isValid=ko.utils.unwrapObservable(item[column.name].isValid);if(isValid){var data=this.rows||this.data;var items=data();var idx=_.indexOf(items,item,false);var isUp=keyCode==$.ui.keyCode.UP||((keyCode==$.ui.keyCode.TAB||keyCode==$.ui.keyCode.ENTER)&&e.shiftKey);if(isUp){var prev=items[idx-1];if(!!prev){item[column.name].isEdit(false);setTimeout(function(){prev[column.name].isEdit(true);},100);}}else{var next=items[idx+1];if(!!next){item[column.name].isEdit(false);setTimeout(function(){next[column.name].isEdit(true);},100);}}}else{}}};var model_extensions={keyHandler:function(item,e){var preventDefault=false;var keyCode=e.which||e.keyCode;if(e.type=="keyup"){switch(keyCode){case $.ui.keyCode.ESCAPE:var column=item.selectedColumn;if(!!column){var field=item[column.name];field.rollback();var $el=$(e.currentTarget);$el.select();}preventDefault=true;break;}}else{if(e.type=="keydown"){switch(keyCode){case $.ui.keyCode.LEFT:case $.ui.keyCode.RIGHT:break;case $.ui.keyCode.UP:case $.ui.keyCode.DOWN:if(item.selectedColumn.type!==GRID_EDIT_DROPDOWN_COLUMN){handleSave_nextRow.call(this,item,keyCode,e);preventDefault=true;}break;case $.ui.keyCode.ENTER:handleSave_nextRow.call(this,item,keyCode,e);preventDefault=true;break;case $.ui.keyCode.TAB:handleSave_nextColumn.call(this,item,keyCode,e);preventDefault=true;break;case $.ui.keyCode.ESCAPE:preventDefault=true;break;}}}return !preventDefault;}};var defaultValidator={validate:function(value){var isNonEmptyString=_.isString(value)&&$.trim(value)!="";var result=null;if(isNonEmptyString){result=this.getValue(value);}else{result=this.nullValue;}return{value:result,isValid:result!=null};},getValue:function(value){return value;},nullValue:null};var validators={"Default":defaultValidator,"Decimal":$.extend({},defaultValidator,{getValue:function(value){var result=Globalize.parseFloat(value);return isNaN(result)?null:result;},nullValue:0}),"PositiveDecimal":$.extend({},defaultValidator,{getValue:function(value){var result=Globalize.parseFloat(value);return isNaN(result)||result<0?null:result;},nullValue:0}),"Int32":$.extend({},defaultValidator,{getValue:function(value){var result=Globalize.parseInt(value);return isNaN(result)?null:result;},nullValue:0})};ko.extenders.inlineEditor=function(target,args){var result=target;var columnFormat=args.column.format;var columnValidator=validators[args.column.dataType||"Default"];result.value=ko.observable(target());var lastValue=result.value();var savedValue=result.value();var asyncSave=null;result.subscribe(function(value){if(_.isString(value)){var validate=columnValidator.validate(value);result.value(validate.value);result.isValid(validate.isValid);}else{result.value(value);result.isValid(true);}});result.isValid=ko.observable(true);result.isSaving=ko.observable(false);result.isEdit=ko.observable(false);result.isEdit.subscribe(function(newValue){if(newValue){args.item.selectedColumn=args.column;if(this.Selectable){this.Selectable.select(args.item);}}else{if(result.isValid()){result.saveAsync();}else{result.rollback();}}},args.root);result.rollback=function(){result(savedValue);};result.saveAsync=function(localDataValue){var whenDone=$.Deferred();var isValid=result.isValid();if(isValid){var isChanged=result.value()!=lastValue;if(isChanged){lastValue=result.value();if(args.column.editUrl){var dataToSend={Id:args.item.Id};dataToSend[args.column.name]=Globalize.format(lastValue,columnFormat);if(asyncSave!=null){asyncSave.abort();}result.isSaving(true);asyncSave=$.ajax({url:args.column.editUrl,type:"POST",contentType:"application/json",data:JSON.stringify(dataToSend)}).done($.proxy(function(data){savedValue=data.d;target(data.d);if(args.column.refreshOnSave){args.root.refresh();}var remoteSaveFunction=$.format("{0}_on_remote_save",args.column.name);if(args.root.options[remoteSaveFunction]){args.root.options[remoteSaveFunction].call(args.item,args.root,localDataValue);}},this)).fail(function(){lastValue=savedValue;}).always(function(){result.isSaving(false);});}else{savedValue=result.value();target(result.value());var localSaveFunction=$.format("{0}_on_local_save",args.column.name);if(args.root.options[localSaveFunction]){args.root.options[localSaveFunction].call(args.item,args.root,localDataValue);}}}whenDone.resolve();}else{whenDone.reject();}return whenDone.promise();};return result;};ko.extenders.checkboxEditor=function(target,args){var currentValue=target();var lastValue=currentValue;var savedValue=currentValue;var asyncSave=null;var result=target;var result=ko.computed({read:function(){return this();},write:function(value){currentValue=value;_.defer($.proxy(function(){this(value);},this));},owner:target});result.isValid=true;result.isSaving=ko.observable(false);result.isEdit=ko.observable(false);result.isEdit.subscribe(function(newValue){if(newValue){args.item.selectedColumn=args.column;if(this.Selectable){this.Selectable.select(args.item);}}else{result.saveAsync();}},args.root);result.rollback=function(){result(savedValue);};result.saveAsync=function(){var whenDone=$.Deferred();var isChanged=currentValue!=lastValue;if(isChanged){lastValue=currentValue;if(args.column.editUrl){var dataToSend={Id:args.item.Id};dataToSend[args.column.name]=lastValue;if(asyncSave!=null){asyncSave.abort();}result.isSaving(true);asyncSave=$.ajax({url:args.column.editUrl,type:"POST",contentType:"application/json",data:JSON.stringify(dataToSend)}).done($.proxy(function(data){savedValue=data.d;target(data.d);if(args.column.refreshOnSave){args.root.refresh();}},this)).fail(function(){lastValue=savedValue;}).always(function(){result.isSaving(false);});}else{savedValue=currentValue;target(currentValue);}}whenDone.resolve();return whenDone.promise();};return result;};ko.extenders.dropDownListEditor=function(target,args){var result=ko.observable();var savedValue=target;result.selectedValue=ko.observable();var asyncSave=null;var dropDownList=$.format("{0}_SelectList",args.column.name);result.selectList=args.item[dropDownList]||ko.observableArray(args.column.selectList)||ko.observableArray();var tmpSel=_.find(result.selectList(),function(item){return ko.toJS(item.ValueProp)==savedValue();});result(tmpSel?ko.toJS(tmpSel.TextProp):"");result.selectedValue(savedValue());result.isValid=true;result.isSaving=ko.observable(false);result.isEdit=ko.observable(false);result.tmpModel=ko.observable();result.isEdit.subscribe(function(newValue){if(newValue){args.item.selectedColumn=args.column;if(this.Selectable){this.Selectable.select(args.item);}result.tmpModel(args.item);}else{result.saveAsync();result.tmpModel(undefined);}},args.root);result.rollback=function(){result.selectedValue(savedValue());};result.saveAsync=function(){var whenDone=$.Deferred();var isChanged=result.selectedValue()!=savedValue();if(isChanged){if(args.column.editUrl){var dataToSend={Id:args.item.Id};dataToSend[args.column.name]=result.selectedValue()?result.selectedValue():null;if(asyncSave!=null){asyncSave.abort();}result.isSaving(true);asyncSave=$.ajax({url:args.column.editUrl,type:"POST",contentType:"application/json",data:JSON.stringify(dataToSend)}).done($.proxy(function(data){var findSaved=_.find(result.selectList(),function(item){return ko.toJS(item.ValueProp)==data.d;});result(findSaved?ko.toJS(findSaved.TextProp):"");savedValue(findSaved?ko.toJS(findSaved.ValueProp):null);result.selectedValue(savedValue());},this)).always(function(){result.isSaving(false);});}else{var selectedTmp=result.selectedValue();var findSaved=_.find(result.selectList(),function(item){return ko.toJS(item.ValueProp)==selectedTmp;});result(findSaved?ko.toJS(findSaved.TextProp):"");savedValue(findSaved?ko.toJS(findSaved.ValueProp):null);}}whenDone.resolve();return whenDone.promise();};return result;};var extension={_init:function(root){_.each(root.options.columns,function(column){if(column.type===GRID_EDIT_COLUMN){this[column.name]=this[column.name].extend({inlineEditor:{root:root,column:column,item:this}});}else{if(column.type===GRID_EDIT_CHECKBOX_COLUMN){this[column.name]=this[column.name].extend({checkboxEditor:{root:root,column:column,item:this}});}else{if(column.type===GRID_EDIT_DROPDOWN_COLUMN){this[column.name]=this[column.name].extend({dropDownListEditor:{root:root,column:column,item:this}});}}}},this);}};$.fn.grid.defaults.extensions=extension;$.fn.grid.defaults.model_extensions=model_extensions;$.fn.grid2.defaults.extensions=extension;$.fn.grid2.defaults.model_extensions=model_extensions;})(jQuery);(function($){var control=function(element,options){this.options=options;this._element=$(element);this._init();};control.prototype={_init:function(){this.asyncSave=null;$(this._element).button({icons:{primary:this.options.button_primary_icon},text:false}).click($.proxy(function(e){this.handleSortProducts();},this));},handleSortProducts:function(){var grid=$(this.options.gridSelector).data("u-grid2");if(!_.isEmpty(grid.Selectable.selected())){var selectedItem=_.last(grid.Selectable.selected());var selectedIndex=grid.data.indexOf(selectedItem);var nextIndex=this.options.isUp?selectedIndex-1:selectedIndex+1;var nextItem=grid.data()[nextIndex];if(nextItem){this.options.isUp?grid.data.splice(nextIndex,2,selectedItem,nextItem):grid.data.splice(nextIndex-1,2,nextItem,selectedItem);var dataToSend={selectedId:selectedItem.Id,nextItemId:nextItem.Id,isUp:this.options.isUp};this.saveAsync(dataToSend);}}},saveAsync:function(dataToSend){if(this.asyncSave!=null){asyncSave.abort();}this.asyncSave=$.ajax({url:this.options.url,type:"POST",contentType:"application/json",data:JSON.stringify(dataToSend)}).done($.proxy(function(data){this.asyncSave=null;},this));}};$.fn.sortgridbutton=function(options){return $.utilis.pluginInit.call(this,"u-sortgridbutton",control,options,$.fn.sortgridbutton.defaults);};$.fn.sortgridbutton.defaults={url:null,isUp:false,gridSelector:"#mainGrid",button_primary_icon:"ui-icon-arrowthick-1-n"};})(jQuery);jQuery(function($){$(".nav li, .nav ul").click(function(){if($(this).hasClass("iehover")){$(this).removeClass("iehover");}else{$(this).addClass("iehover");}});});var jscolor={dir:"",bindClass:"color",binding:true,preloading:true,install:function(){jscolor.addEvent(window,"load",jscolor.init);},init:function(){if(jscolor.binding){jscolor.bind();}if(jscolor.preloading){jscolor.preload();}},getDir:function(){return STATIC_CONTENT_DIRECTORY;},detectDir:function(){var base=location.href;var e=document.getElementsByTagName("base");for(var i=0;i<e.length;i+=1){if(e[i].href){base=e[i].href;}}var e=document.getElementsByTagName("script");for(var i=0;i<e.length;i+=1){if(e[i].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(e[i].src)){var src=new jscolor.URI(e[i].src);var srcAbs=src.toAbsolute(base);srcAbs.path=srcAbs.path.replace(/[^\/]+$/,"");srcAbs.query=null;srcAbs.fragment=null;return srcAbs.toString();}}return false;},bind:function(){var matchClass=new RegExp("(^|\\s)("+jscolor.bindClass+")(\\s*(\\{[^}]*\\})|\\s|$)","i");var e=document.getElementsByTagName("input");for(var i=0;i<e.length;i+=1){if(jscolor.isColorAttrSupported&&e[i].type.toLowerCase()=="color"){continue;}var m;if(!e[i].color&&e[i].className&&(m=e[i].className.match(matchClass))){var prop={};if(m[4]){try{prop=(new Function("return ("+m[4]+")"))();}catch(eInvalidProp){}}e[i].color=new jscolor.color(e[i],prop);}}},preload:function(){for(var fn in jscolor.imgRequire){if(jscolor.imgRequire.hasOwnProperty(fn)){jscolor.loadImage(fn);}}},images:{pad:[181,101],sld:[16,101],cross:[15,15],arrow:[7,11]},imgRequire:{},imgLoaded:{},requireImage:function(filename){jscolor.imgRequire[filename]=true;},loadImage:function(filename){if(!jscolor.imgLoaded[filename]){jscolor.imgLoaded[filename]=new Image();jscolor.imgLoaded[filename].src=jscolor.getDir()+filename;}},fetchElement:function(mixed){return typeof mixed==="string"?document.getElementById(mixed):mixed;},addEvent:function(el,evnt,func){if(el.addEventListener){el.addEventListener(evnt,func,false);}else{if(el.attachEvent){el.attachEvent("on"+evnt,func);}}},fireEvent:function(el,evnt){if(!el){return;}if(document.createEvent){var ev=document.createEvent("HTMLEvents");ev.initEvent(evnt,true,true);el.dispatchEvent(ev);}else{if(document.createEventObject){var ev=document.createEventObject();el.fireEvent("on"+evnt,ev);}else{if(el["on"+evnt]){el["on"+evnt]();}}}},getElementPos:function(e){var e1=e,e2=e;var x=0,y=0;if(e1.offsetParent){do{x+=e1.offsetLeft;y+=e1.offsetTop;}while(e1=e1.offsetParent);}while((e2=e2.parentNode)&&e2.nodeName.toUpperCase()!=="BODY"){x-=e2.scrollLeft;y-=e2.scrollTop;}return[x,y];},getElementSize:function(e){return[e.offsetWidth,e.offsetHeight];},getRelMousePos:function(e){var x=0,y=0;if(!e){e=window.event;}if(typeof e.offsetX==="number"){x=e.offsetX;y=e.offsetY;}else{if(typeof e.layerX==="number"){x=e.layerX;y=e.layerY;}}return{x:x,y:y};},getViewPos:function(){if(typeof window.pageYOffset==="number"){return[window.pageXOffset,window.pageYOffset];}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){return[document.body.scrollLeft,document.body.scrollTop];}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){return[document.documentElement.scrollLeft,document.documentElement.scrollTop];}else{return[0,0];}}}},getViewSize:function(){if(typeof window.innerWidth==="number"){return[window.innerWidth,window.innerHeight];}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){return[document.body.clientWidth,document.body.clientHeight];}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){return[document.documentElement.clientWidth,document.documentElement.clientHeight];}else{return[0,0];}}}},URI:function(uri){this.scheme=null;this.authority=null;this.path="";this.query=null;this.fragment=null;this.parse=function(uri){var m=uri.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);this.scheme=m[3]?m[2]:null;this.authority=m[5]?m[6]:null;this.path=m[7];this.query=m[9]?m[10]:null;this.fragment=m[12]?m[13]:null;return this;};this.toString=function(){var result="";if(this.scheme!==null){result=result+this.scheme+":";}if(this.authority!==null){result=result+"//"+this.authority;}if(this.path!==null){result=result+this.path;}if(this.query!==null){result=result+"?"+this.query;}if(this.fragment!==null){result=result+"#"+this.fragment;}return result;};this.toAbsolute=function(base){var base=new jscolor.URI(base);var r=this;var t=new jscolor.URI;if(base.scheme===null){return false;}if(r.scheme!==null&&r.scheme.toLowerCase()===base.scheme.toLowerCase()){r.scheme=null;}if(r.scheme!==null){t.scheme=r.scheme;t.authority=r.authority;t.path=removeDotSegments(r.path);t.query=r.query;}else{if(r.authority!==null){t.authority=r.authority;t.path=removeDotSegments(r.path);t.query=r.query;}else{if(r.path===""){t.path=base.path;if(r.query!==null){t.query=r.query;}else{t.query=base.query;}}else{if(r.path.substr(0,1)==="/"){t.path=removeDotSegments(r.path);}else{if(base.authority!==null&&base.path===""){t.path="/"+r.path;}else{t.path=base.path.replace(/[^\/]+$/,"")+r.path;}t.path=removeDotSegments(t.path);}t.query=r.query;}t.authority=base.authority;}t.scheme=base.scheme;}t.fragment=r.fragment;return t;};function removeDotSegments(path){var out="";while(path){if(path.substr(0,3)==="../"||path.substr(0,2)==="./"){path=path.replace(/^\.+/,"").substr(1);}else{if(path.substr(0,3)==="/./"||path==="/."){path="/"+path.substr(3);}else{if(path.substr(0,4)==="/../"||path==="/.."){path="/"+path.substr(4);out=out.replace(/\/?[^\/]*$/,"");}else{if(path==="."||path===".."){path="";}else{var rm=path.match(/^\/?[^\/]*/)[0];path=path.substr(rm.length);out=out+rm;}}}}}return out;}if(uri){this.parse(uri);}},color:function(target,prop){this.required=true;this.adjust=true;this.hash=false;this.caps=true;this.slider=true;this.valueElement=target;this.styleElement=target;this.onImmediateChange=null;this.hsv=[0,0,1];this.rgb=[1,1,1];this.minH=0;this.maxH=6;this.minS=0;this.maxS=1;this.minV=0;this.maxV=1;this.pickerOnfocus=true;this.pickerMode="HSV";this.pickerPosition="right";this.pickerSmartPosition=true;this.pickerButtonHeight=20;this.pickerClosable=false;this.pickerCloseText="Close";this.pickerButtonColor="ButtonText";this.pickerFace=10;this.pickerFaceColor="ThreeDFace";this.pickerBorder=1;this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight";this.pickerInset=1;this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow";this.pickerZIndex=10000;for(var p in prop){if(prop.hasOwnProperty(p)){this[p]=prop[p];}}this.hidePicker=function(){if(isPickerOwner()){removePicker();}};this.showPicker=function(){if(!isPickerOwner()){var tp=jscolor.getElementPos(target);var ts=jscolor.getElementSize(target);var vp=jscolor.getViewPos();var vs=jscolor.getViewSize();var ps=getPickerDims(this);var a,b,c;switch(this.pickerPosition.toLowerCase()){case"left":a=1;b=0;c=-1;break;case"right":a=1;b=0;c=1;break;case"top":a=0;b=1;c=-1;break;default:a=0;b=1;c=1;break;}var l=(ts[b]+ps[b])/2;if(!this.pickerSmartPosition){var pp=[tp[a],tp[b]+ts[b]-l+l*c];}else{var pp=[-vp[a]+tp[a]+ps[a]>vs[a]?(-vp[a]+tp[a]+ts[a]/2>vs[a]/2&&tp[a]+ts[a]-ps[a]>=0?tp[a]+ts[a]-ps[a]:tp[a]):tp[a],-vp[b]+tp[b]+ts[b]+ps[b]-l+l*c>vs[b]?(-vp[b]+tp[b]+ts[b]/2>vs[b]/2&&tp[b]+ts[b]-l-l*c>=0?tp[b]+ts[b]-l-l*c:tp[b]+ts[b]-l+l*c):(tp[b]+ts[b]-l+l*c>=0?tp[b]+ts[b]-l+l*c:tp[b]+ts[b]-l-l*c)];}drawPicker(pp[a],pp[b]);}};this.importColor=function(){if(!valueElement){this.exportColor();}else{if(!this.adjust){if(!this.fromString(valueElement.value,leaveValue)){styleElement.style.backgroundImage=styleElement.jscStyle.backgroundImage;styleElement.style.backgroundColor=styleElement.jscStyle.backgroundColor;styleElement.style.color=styleElement.jscStyle.color;this.exportColor(leaveValue|leaveStyle);}}else{if(!this.required&&/^\s*$/.test(valueElement.value)){valueElement.value="";styleElement.style.backgroundImage=styleElement.jscStyle.backgroundImage;styleElement.style.backgroundColor=styleElement.jscStyle.backgroundColor;styleElement.style.color=styleElement.jscStyle.color;this.exportColor(leaveValue|leaveStyle);}else{if(this.fromString(valueElement.value)){}else{this.exportColor();}}}}};this.exportColor=function(flags){if(!(flags&leaveValue)&&valueElement){var value=this.toString();if(this.caps){value=value.toUpperCase();}if(this.hash){value="#"+value;}valueElement.value=value;}if(!(flags&leaveStyle)&&styleElement){styleElement.style.backgroundImage="none";styleElement.style.backgroundColor="#"+this.toString();styleElement.style.color=0.213*this.rgb[0]+0.715*this.rgb[1]+0.072*this.rgb[2]<0.5?"#FFF":"#000";}if(!(flags&leavePad)&&isPickerOwner()){redrawPad();}if(!(flags&leaveSld)&&isPickerOwner()){redrawSld();}};this.fromHSV=function(h,s,v,flags){if(h!==null){h=Math.max(0,this.minH,Math.min(6,this.maxH,h));}if(s!==null){s=Math.max(0,this.minS,Math.min(1,this.maxS,s));}if(v!==null){v=Math.max(0,this.minV,Math.min(1,this.maxV,v));}this.rgb=HSV_RGB(h===null?this.hsv[0]:(this.hsv[0]=h),s===null?this.hsv[1]:(this.hsv[1]=s),v===null?this.hsv[2]:(this.hsv[2]=v));this.exportColor(flags);};this.fromRGB=function(r,g,b,flags){if(r!==null){r=Math.max(0,Math.min(1,r));}if(g!==null){g=Math.max(0,Math.min(1,g));}if(b!==null){b=Math.max(0,Math.min(1,b));}var hsv=RGB_HSV(r===null?this.rgb[0]:r,g===null?this.rgb[1]:g,b===null?this.rgb[2]:b);if(hsv[0]!==null){this.hsv[0]=Math.max(0,this.minH,Math.min(6,this.maxH,hsv[0]));}if(hsv[2]!==0){this.hsv[1]=hsv[1]===null?null:Math.max(0,this.minS,Math.min(1,this.maxS,hsv[1]));}this.hsv[2]=hsv[2]===null?null:Math.max(0,this.minV,Math.min(1,this.maxV,hsv[2]));var rgb=HSV_RGB(this.hsv[0],this.hsv[1],this.hsv[2]);this.rgb[0]=rgb[0];this.rgb[1]=rgb[1];this.rgb[2]=rgb[2];this.exportColor(flags);};this.fromString=function(hex,flags){var m=hex.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);if(!m){return false;}else{if(m[1].length===6){this.fromRGB(parseInt(m[1].substr(0,2),16)/255,parseInt(m[1].substr(2,2),16)/255,parseInt(m[1].substr(4,2),16)/255,flags);}else{this.fromRGB(parseInt(m[1].charAt(0)+m[1].charAt(0),16)/255,parseInt(m[1].charAt(1)+m[1].charAt(1),16)/255,parseInt(m[1].charAt(2)+m[1].charAt(2),16)/255,flags);}return true;}};this.toString=function(){return((256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1));};function RGB_HSV(r,g,b){var n=Math.min(Math.min(r,g),b);var v=Math.max(Math.max(r,g),b);var m=v-n;if(m===0){return[null,0,v];}var h=r===n?3+(b-g)/m:(g===n?5+(r-b)/m:1+(g-r)/m);return[h===6?0:h,m/v,v];}function HSV_RGB(h,s,v){if(h===null){return[v,v,v];}var i=Math.floor(h);var f=i%2?h-i:1-(h-i);var m=v*(1-s);var n=v*(1-s*f);switch(i){case 6:case 0:return[v,n,m];case 1:return[n,v,m];case 2:return[m,v,n];case 3:return[m,n,v];case 4:return[n,m,v];case 5:return[v,m,n];}}function removePicker(){delete jscolor.picker.owner;document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB);}function drawPicker(x,y){if(!jscolor.picker){jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),btn:document.createElement("div"),btnS:document.createElement("span"),btnT:document.createTextNode(THIS.pickerCloseText)};for(var i=0,segSize=4;i<jscolor.images.sld[1];i+=segSize){var seg=document.createElement("div");seg.style.height=segSize+"px";seg.style.fontSize="1px";seg.style.lineHeight="0";jscolor.picker.sld.appendChild(seg);}jscolor.picker.sldB.appendChild(jscolor.picker.sld);jscolor.picker.box.appendChild(jscolor.picker.sldB);jscolor.picker.box.appendChild(jscolor.picker.sldM);jscolor.picker.padB.appendChild(jscolor.picker.pad);jscolor.picker.box.appendChild(jscolor.picker.padB);jscolor.picker.box.appendChild(jscolor.picker.padM);jscolor.picker.btnS.appendChild(jscolor.picker.btnT);jscolor.picker.btn.appendChild(jscolor.picker.btnS);jscolor.picker.box.appendChild(jscolor.picker.btn);jscolor.picker.boxB.appendChild(jscolor.picker.box);}var p=jscolor.picker;p.box.onmouseup=p.box.onmouseout=function(){target.focus();};p.box.onmousedown=function(){abortBlur=true;};p.box.onmousemove=function(e){if(holdPad||holdSld){holdPad&&setPad(e);holdSld&&setSld(e);if(document.selection){document.selection.empty();}else{if(window.getSelection){window.getSelection().removeAllRanges();}}dispatchImmediateChange();}};if("ontouchstart" in window){var handle_touchmove=function(e){var event={"offsetX":e.touches[0].pageX-touchOffset.X,"offsetY":e.touches[0].pageY-touchOffset.Y};if(holdPad||holdSld){holdPad&&setPad(event);holdSld&&setSld(event);dispatchImmediateChange();}e.stopPropagation();e.preventDefault();};p.box.removeEventListener("touchmove",handle_touchmove,false);p.box.addEventListener("touchmove",handle_touchmove,false);}p.padM.onmouseup=p.padM.onmouseout=function(){if(holdPad){holdPad=false;jscolor.fireEvent(valueElement,"change");}};p.padM.onmousedown=function(e){switch(modeID){case 0:if(THIS.hsv[2]===0){THIS.fromHSV(null,null,1);}break;case 1:if(THIS.hsv[1]===0){THIS.fromHSV(null,1,null);}break;}holdSld=false;holdPad=true;setPad(e);dispatchImmediateChange();};if("ontouchstart" in window){p.padM.addEventListener("touchstart",function(e){touchOffset={"X":e.target.offsetParent.offsetLeft,"Y":e.target.offsetParent.offsetTop};this.onmousedown({"offsetX":e.touches[0].pageX-touchOffset.X,"offsetY":e.touches[0].pageY-touchOffset.Y});});}p.sldM.onmouseup=p.sldM.onmouseout=function(){if(holdSld){holdSld=false;jscolor.fireEvent(valueElement,"change");}};p.sldM.onmousedown=function(e){holdPad=false;holdSld=true;setSld(e);dispatchImmediateChange();};if("ontouchstart" in window){p.sldM.addEventListener("touchstart",function(e){touchOffset={"X":e.target.offsetParent.offsetLeft,"Y":e.target.offsetParent.offsetTop};this.onmousedown({"offsetX":e.touches[0].pageX-touchOffset.X,"offsetY":e.touches[0].pageY-touchOffset.Y});});}var dims=getPickerDims(THIS);p.box.style.width=dims[0]+"px";p.box.style.height=dims[1]+"px";p.boxB.style.position="absolute";p.boxB.style.clear="both";p.boxB.style.left=x+"px";p.boxB.style.top=y+"px";p.boxB.style.zIndex=THIS.pickerZIndex;p.boxB.style.border=THIS.pickerBorder+"px solid";p.boxB.style.borderColor=THIS.pickerBorderColor;p.boxB.style.background=THIS.pickerFaceColor;p.pad.style.width=jscolor.images.pad[0]+"px";p.pad.style.height=jscolor.images.pad[1]+"px";p.padB.style.position="absolute";p.padB.style.left=THIS.pickerFace+"px";p.padB.style.top=THIS.pickerFace+"px";p.padB.style.border=THIS.pickerInset+"px solid";p.padB.style.borderColor=THIS.pickerInsetColor;p.padM.style.position="absolute";p.padM.style.left="0";p.padM.style.top="0";p.padM.style.width=THIS.pickerFace+2*THIS.pickerInset+jscolor.images.pad[0]+jscolor.images.arrow[0]+"px";p.padM.style.height=p.box.style.height;p.padM.style.cursor="crosshair";p.sld.style.overflow="hidden";p.sld.style.width=jscolor.images.sld[0]+"px";p.sld.style.height=jscolor.images.sld[1]+"px";p.sldB.style.display=THIS.slider?"block":"none";p.sldB.style.position="absolute";p.sldB.style.right=THIS.pickerFace+"px";p.sldB.style.top=THIS.pickerFace+"px";p.sldB.style.border=THIS.pickerInset+"px solid";p.sldB.style.borderColor=THIS.pickerInsetColor;p.sldM.style.display=THIS.slider?"block":"none";p.sldM.style.position="absolute";p.sldM.style.right="0";p.sldM.style.top="0";p.sldM.style.width=jscolor.images.sld[0]+jscolor.images.arrow[0]+THIS.pickerFace+2*THIS.pickerInset+"px";p.sldM.style.height=p.box.style.height;try{p.sldM.style.cursor="pointer";}catch(eOldIE){p.sldM.style.cursor="hand";}function setBtnBorder(){var insetColors=THIS.pickerInsetColor.split(/\s+/);var pickerOutsetColor=insetColors.length<2?insetColors[0]:insetColors[1]+" "+insetColors[0]+" "+insetColors[0]+" "+insetColors[1];p.btn.style.borderColor=pickerOutsetColor;}p.btn.style.display=THIS.pickerClosable?"block":"none";p.btn.style.position="absolute";p.btn.style.left=THIS.pickerFace+"px";p.btn.style.bottom=THIS.pickerFace+"px";p.btn.style.padding="0 15px";p.btn.style.height="18px";p.btn.style.border=THIS.pickerInset+"px solid";setBtnBorder();p.btn.style.color=THIS.pickerButtonColor;p.btn.style.font="12px sans-serif";p.btn.style.textAlign="center";try{p.btn.style.cursor="pointer";}catch(eOldIE){p.btn.style.cursor="hand";}p.btn.onmousedown=function(){THIS.hidePicker();};p.btnS.style.lineHeight=p.btn.style.height;switch(modeID){case 0:var padImg="images/hs.png";break;case 1:var padImg="images/hv.png";break;}p.padM.style.backgroundImage="url('"+jscolor.getDir()+"images/cross.gif')";p.padM.style.backgroundRepeat="no-repeat";p.sldM.style.backgroundImage="url('"+jscolor.getDir()+"images/arrow.gif')";p.sldM.style.backgroundRepeat="no-repeat";p.pad.style.backgroundImage="url('"+jscolor.getDir()+padImg+"')";p.pad.style.backgroundRepeat="no-repeat";p.pad.style.backgroundPosition="0 0";redrawPad();redrawSld();jscolor.picker.owner=THIS;document.getElementsByTagName("body")[0].appendChild(p.boxB);}function getPickerDims(o){var dims=[2*o.pickerInset+2*o.pickerFace+jscolor.images.pad[0]+(o.slider?2*o.pickerInset+2*jscolor.images.arrow[0]+jscolor.images.sld[0]:0),o.pickerClosable?4*o.pickerInset+3*o.pickerFace+jscolor.images.pad[1]+o.pickerButtonHeight:2*o.pickerInset+2*o.pickerFace+jscolor.images.pad[1]];return dims;}function redrawPad(){switch(modeID){case 0:var yComponent=1;break;case 1:var yComponent=2;break;}var x=Math.round((THIS.hsv[0]/6)*(jscolor.images.pad[0]-1));var y=Math.round((1-THIS.hsv[yComponent])*(jscolor.images.pad[1]-1));jscolor.picker.padM.style.backgroundPosition=(THIS.pickerFace+THIS.pickerInset+x-Math.floor(jscolor.images.cross[0]/2))+"px "+(THIS.pickerFace+THIS.pickerInset+y-Math.floor(jscolor.images.cross[1]/2))+"px";var seg=jscolor.picker.sld.childNodes;switch(modeID){case 0:var rgb=HSV_RGB(THIS.hsv[0],THIS.hsv[1],1);for(var i=0;i<seg.length;i+=1){seg[i].style.backgroundColor="rgb("+(rgb[0]*(1-i/seg.length)*100)+"%,"+(rgb[1]*(1-i/seg.length)*100)+"%,"+(rgb[2]*(1-i/seg.length)*100)+"%)";}break;case 1:var rgb,s,c=[THIS.hsv[2],0,0];var i=Math.floor(THIS.hsv[0]);var f=i%2?THIS.hsv[0]-i:1-(THIS.hsv[0]-i);switch(i){case 6:case 0:rgb=[0,1,2];break;case 1:rgb=[1,0,2];break;case 2:rgb=[2,0,1];break;case 3:rgb=[2,1,0];break;case 4:rgb=[1,2,0];break;case 5:rgb=[0,2,1];break;}for(var i=0;i<seg.length;i+=1){s=1-1/(seg.length-1)*i;c[1]=c[0]*(1-s*f);c[2]=c[0]*(1-s);seg[i].style.backgroundColor="rgb("+(c[rgb[0]]*100)+"%,"+(c[rgb[1]]*100)+"%,"+(c[rgb[2]]*100)+"%)";}break;}}function redrawSld(){switch(modeID){case 0:var yComponent=2;break;case 1:var yComponent=1;break;}var y=Math.round((1-THIS.hsv[yComponent])*(jscolor.images.sld[1]-1));jscolor.picker.sldM.style.backgroundPosition="0 "+(THIS.pickerFace+THIS.pickerInset+y-Math.floor(jscolor.images.arrow[1]/2))+"px";}function isPickerOwner(){return jscolor.picker&&jscolor.picker.owner===THIS;}function blurTarget(){if(valueElement===target){THIS.importColor();}if(THIS.pickerOnfocus){THIS.hidePicker();}}function blurValue(){if(valueElement!==target){THIS.importColor();}}function setPad(e){var mpos=jscolor.getRelMousePos(e);var x=mpos.x-THIS.pickerFace-THIS.pickerInset;var y=mpos.y-THIS.pickerFace-THIS.pickerInset;switch(modeID){case 0:THIS.fromHSV(x*(6/(jscolor.images.pad[0]-1)),1-y/(jscolor.images.pad[1]-1),null,leaveSld);break;case 1:THIS.fromHSV(x*(6/(jscolor.images.pad[0]-1)),null,1-y/(jscolor.images.pad[1]-1),leaveSld);break;}}function setSld(e){var mpos=jscolor.getRelMousePos(e);var y=mpos.y-THIS.pickerFace-THIS.pickerInset;switch(modeID){case 0:THIS.fromHSV(null,null,1-y/(jscolor.images.sld[1]-1),leavePad);break;case 1:THIS.fromHSV(null,1-y/(jscolor.images.sld[1]-1),null,leavePad);break;}}function dispatchImmediateChange(){if(THIS.onImmediateChange){var callback;if(typeof THIS.onImmediateChange==="string"){callback=new Function(THIS.onImmediateChange);}else{callback=THIS.onImmediateChange;}callback.call(THIS);}}var THIS=this;var modeID=this.pickerMode.toLowerCase()==="hvs"?1:0;var abortBlur=false;var valueElement=jscolor.fetchElement(this.valueElement),styleElement=jscolor.fetchElement(this.styleElement);var holdPad=false,holdSld=false,touchOffset={};var leaveValue=1<<0,leaveStyle=1<<1,leavePad=1<<2,leaveSld=1<<3;jscolor.isColorAttrSupported=false;var el=document.createElement("input");if(el.setAttribute){el.setAttribute("type","color");if(el.type.toLowerCase()=="color"){jscolor.isColorAttrSupported=true;}}jscolor.addEvent(target,"focus",function(){if(THIS.pickerOnfocus){THIS.showPicker();}});jscolor.addEvent(target,"blur",function(){if(!abortBlur){window.setTimeout(function(){abortBlur||blurTarget();abortBlur=false;},0);}else{abortBlur=false;}});if(valueElement){var updateField=function(){THIS.fromString(valueElement.value,leaveValue);dispatchImmediateChange();};jscolor.addEvent(valueElement,"keyup",updateField);jscolor.addEvent(valueElement,"input",updateField);jscolor.addEvent(valueElement,"blur",blurValue);valueElement.setAttribute("autocomplete","off");}if(styleElement){styleElement.jscStyle={backgroundImage:styleElement.style.backgroundImage,backgroundColor:styleElement.style.backgroundColor,color:styleElement.style.color};}switch(modeID){case 0:jscolor.requireImage("images/hs.png");break;case 1:jscolor.requireImage("images/hv.png");break;}jscolor.requireImage("images/cross.gif");jscolor.requireImage("images/arrow.gif");this.importColor();}};jscolor.install();(function(D,ea){typeof module==="object"&&module.exports?module.exports=D.document?ea(D):ea:D.Highcharts=ea(D);})(typeof window!=="undefined"?window:this,function(D){function ea(a,b){var c="Highcharts error #"+a+": www.highcharts.com/errors/"+a;if(b){throw Error(c);}D.console&&console.log(c);}function tb(a,b,c){this.options=b;this.elem=a;this.prop=c;}function E(){var a,b=arguments,c,d={},e=function(a,b){var c,d;typeof a!=="object"&&(a={});for(d in b){b.hasOwnProperty(d)&&(c=b[d],a[d]=u.isObject(c,!0)&&d!=="renderTo"&&typeof c.nodeType!=="number"?e(a[d]||{},c):b[d]);}return a;};b[0]===!0&&(d=b[1],b=Array.prototype.slice.call(b,2));c=b.length;for(a=0;a<c;a++){d=e(d,b[a]);}return d;}function B(a,b){return parseInt(a,b||10);}function ya(a){return typeof a==="string";}function za(a){a=Object.prototype.toString.call(a);return a==="[object Array]"||a==="[object Array Iterator]";}function ra(a,b){for(var c=a.length;c--;){if(a[c]===b){a.splice(c,1);break;}}}function s(a){return a!==z&&a!==null;}function O(a,b,c){var d,e;if(ya(b)){s(c)?a.setAttribute(b,c):a&&a.getAttribute&&(e=a.getAttribute(b));}else{if(s(b)&&ba(b)){for(d in b){a.setAttribute(d,b[d]);}}}return e;}function ua(a){return za(a)?a:[a];}function Sa(a,b,c){if(b){return setTimeout(a,b,c);}a.call(0,c);}function M(a,b){if(Aa&&!fa&&b&&b.opacity!==z){b.filter="alpha(opacity="+b.opacity*100+")";}x(a.style,b);}function ca(a,b,c,d,e){a=y.createElement(a);b&&x(a,b);e&&M(a,{padding:0,border:"none",margin:0});c&&M(a,c);d&&d.appendChild(a);return a;}function sa(a,b){var c=function(){};c.prototype=new a;x(c.prototype,b);return c;}function Ga(a,b,c){return Array((b||2)+1-String(a).length).join(c||0)+a;}function ab(a){return(bb&&bb(a)||ub||0)*60000;}function Na(a,b){for(var c="{",d=!1,e,f,g,h,i,j=[];(c=a.indexOf(c))!==-1;){e=a.slice(0,c);if(d){f=e.split(":");g=f.shift().split(".");i=g.length;e=b;for(h=0;h<i;h++){e=e[g[h]];}if(f.length){f=f.join(":"),g=/\.([0-9])/,h=T.lang,i=void 0,/f$/.test(f)?(i=(i=f.match(g))?i[1]:-1,e!==null&&(e=u.numberFormat(e,i,h.decimalPoint,f.indexOf(",")>-1?h.thousandsSep:""))):e=Ta(f,e);}}j.push(e);a=a.slice(c+1);c=(d=!d)?"}":"{";}j.push(a);return j.join("");}function vb(a){return Z.pow(10,V(Z.log(a)/Z.LN10));}function wb(a,b,c,d,e){var f,g=a,c=p(c,1);f=a/c;b||(b=[1,2,2.5,5,10],d===!1&&(c===1?b=[1,2,5,10]:c<=0.1&&(b=[1/c])));for(d=0;d<b.length;d++){if(g=b[d],e&&g*c>=a||!e&&f<=(b[d]+(b[d+1]||b[d]))/2){break;}}g*=c;return g;}function kb(a,b){var c=a.length,d,e;for(e=0;e<c;e++){a[e].safeI=e;}a.sort(function(a,c){d=b(a,c);return d===0?a.safeI-c.safeI:d;});for(e=0;e<c;e++){delete a[e].safeI;}}function Oa(a){for(var b=a.length,c=a[0];b--;){a[b]<c&&(c=a[b]);}return c;}function Ha(a){for(var b=a.length,c=a[0];b--;){a[b]>c&&(c=a[b]);}return c;}function Ua(a,b){for(var c in a){a[c]&&a[c]!==b&&a[c].destroy&&a[c].destroy(),delete a[c];}}function Va(a){lb||(lb=ca(Pa));a&&lb.appendChild(a);lb.innerHTML="";}function $(a,b){return parseFloat(a.toPrecision(b||14));}function cb(a,b){b.renderer.globalAnimation=p(a,b.animation);}function Wa(a){return ba(a)?E(a):{duration:a?500:0};}function Hb(){var a=T.global,b=a.useUTC,c=b?"getUTC":"get",d=b?"setUTC":"set";ma=a.Date||D.Date;ub=b&&a.timezoneOffset;bb=b&&a.getTimezoneOffset;mb=function(a,c,d,h,i,j){var k;b?(k=ma.UTC.apply(0,arguments),k+=ab(k)):k=(new ma(a,c,p(d,1),p(h,0),p(i,0),p(j,0))).getTime();return k;};xb=c+"Minutes";yb=c+"Hours";zb=c+"Day";Xa=c+"Date";db=c+"Month";eb=c+"FullYear";Ib=d+"Milliseconds";Jb=d+"Seconds";Kb=d+"Minutes";Lb=d+"Hours";nb=d+"Date";Ab=d+"Month";Bb=d+"FullYear";}function na(a){if(!(this instanceof na)){return new na(a);}this.init(a);}function J(){}function Ya(a,b,c,d){this.axis=a;this.pos=b;this.type=c||"";this.isNew=!0;!c&&!d&&this.addLabel();}function Mb(a,b,c,d,e){var f=a.chart.inverted;this.axis=a;this.isNegative=c;this.options=b;this.x=d;this.total=null;this.points={};this.stack=e;this.rightCliff=this.leftCliff=0;this.alignOptions={align:b.align||(f?c?"left":"right":"center"),verticalAlign:b.verticalAlign||(f?"middle":c?"bottom":"top"),y:p(b.y,f?4:c?14:-6),x:p(b.x,f?c?-6:6:0)};this.textAlign=b.textAlign||(f?c?"right":"left":"center");}var z,y=D.document,Z=Math,C=Z.round,V=Z.floor,va=Z.ceil,t=Z.max,F=Z.min,Q=Z.abs,W=Z.cos,da=Z.sin,ta=Z.PI,ka=ta*2/360,Ba=D.navigator&&D.navigator.userAgent||"",Nb=D.opera,Aa=/(msie|trident|edge)/i.test(Ba)&&!Nb,ob=y&&y.documentMode===8,pb=!Aa&&/AppleWebKit/.test(Ba),Qa=/Firefox/.test(Ba),Ob=/(Mobile|Android|Windows Phone)/.test(Ba),Ia="http://www.w3.org/2000/svg",fa=y&&y.createElementNS&&!!y.createElementNS(Ia,"svg").createSVGRect,Sb=Qa&&parseInt(Ba.split("Firefox/")[1],10)<4,la=y&&!fa&&!Aa&&!!y.createElement("canvas").getContext,fb,gb,Pb={},Cb=0,lb,T,Ta,G,Ca=function(){},U=[],hb=0,Pa="div",X="M",S="L",Tb=/[0-9]/g,qb=["plotTop","marginRight","marginBottom","plotLeft"],ma,mb,ub,bb,xb,yb,zb,Xa,db,eb,Ib,Jb,Kb,Lb,nb,Ab,Bb,L={},u;u=D.Highcharts?ea(16,!0):{win:D};u.seriesTypes=L;var Ja=[],oa,pa,q,Da,Db,Ea,N,Y,H,Za,Ka;tb.prototype={dSetter:function(){var a=this.paths[0],b=this.paths[1],c=[],d=this.now,e=a.length,f;if(d===1){c=this.toD;}else{if(e===b.length&&d<1){for(;e--;){f=parseFloat(a[e]),c[e]=isNaN(f)?a[e]:d*parseFloat(b[e]-f)+f;}}else{c=b;}}this.elem.attr("d",c);},update:function(){var a=this.elem,b=this.prop,c=this.now,d=this.options.step;if(this[b+"Setter"]){this[b+"Setter"]();}else{a.attr?a.element&&a.attr(b,c):a.style[b]=c+this.unit;}d&&d.call(a,c,this);},run:function(a,b,c){var d=this,e=function(a){return e.stopped?!1:d.step(a);},f;this.startTime=+new ma;this.start=a;this.end=b;this.unit=c;this.now=this.start;this.pos=0;e.elem=this.elem;if(e()&&Ja.push(e)===1){e.timerId=setInterval(function(){for(f=0;f<Ja.length;f++){Ja[f]()||Ja.splice(f--,1);}Ja.length||clearInterval(e.timerId);},13);}},step:function(a){var b=+new ma,c,d=this.options;c=this.elem;var e=d.complete,f=d.duration,g=d.curAnim,h;if(c.attr&&!c.element){c=!1;}else{if(a||b>=f+this.startTime){this.now=this.end;this.pos=1;this.update();a=g[this.prop]=!0;for(h in g){g[h]!==!0&&(a=!1);}a&&e&&e.call(c);c=!1;}else{this.pos=d.easing((b-this.startTime)/f),this.now=this.start+(this.end-this.start)*this.pos,this.update(),c=!0;}}return c;},initPath:function(a,b,c){function d(a){for(n=a.length;n--;){(a[n]===X||a[n]===S)&&a.splice(n+1,0,a[n+1],a[n+2],a[n+1],a[n+2]);}}function e(a,b){for(;a.length<l;){a[0]=b[l-a.length];var c=a.slice(0,k);[].splice.apply(a,[0,0].concat(c));o&&(c=a.slice(a.length-k),[].splice.apply(a,[a.length,0].concat(c)),n--);}a[0]="M";}function f(a,b){for(var c=(l-a.length)/k;c>0&&c--;){m=a.slice().splice(a.length/A-k,k*A),m[0]=b[l-k-c*k],j&&(m[k-6]=m[k-2],m[k-5]=m[k-1]),[].splice.apply(a,[a.length/A,0].concat(m)),o&&c--;}}var b=b||"",g,h=a.startX,i=a.endX,j=b.indexOf("C")>-1,k=j?7:3,l,m,n,b=b.split(" "),c=c.slice(),o=a.isArea,A=o?2:1,r;j&&(d(b),d(c));if(h&&i){for(n=0;n<h.length;n++){if(h[n]===i[0]){g=n;break;}else{if(h[0]===i[i.length-h.length+n]){g=n;r=!0;break;}}}g===void 0&&(b=[]);}b.length&&u.isNumber(g)&&(l=c.length+g*A*k,r?(e(b,c),f(c,b)):(e(c,b),f(b,c)));return[b,c];}};var x=u.extend=function(a,b){var c;a||(a={});for(c in b){a[c]=b[c];}return a;},ba=u.isObject=function(a,b){return a&&typeof a==="object"&&(!b||!za(a));},I=u.isNumber=function(a){return typeof a==="number"&&!isNaN(a);},p=u.pick=function(){var a=arguments,b,c,d=a.length;for(b=0;b<d;b++){if(c=a[b],c!==z&&c!==null){return c;}}},ib=u.wrap=function(a,b,c){var d=a[b];a[b]=function(){var a=Array.prototype.slice.call(arguments);a.unshift(d);return c.apply(this,a);};};Ta=function(a,b,c){if(!s(b)||isNaN(b)){return T.lang.invalidDate||"";}var a=p(a,"%Y-%m-%d %H:%M:%S"),d=new ma(b-ab(b)),e,f=d[yb](),g=d[zb](),h=d[Xa](),i=d[db](),j=d[eb](),k=T.lang,l=k.weekdays,m=k.shortWeekdays,d=x({a:m?m[g]:l[g].substr(0,3),A:l[g],d:Ga(h),e:Ga(h,2," "),w:g,b:k.shortMonths[i],B:k.months[i],m:Ga(i+1),y:j.toString().substr(2,2),Y:j,H:Ga(f),k:f,I:Ga(f%12||12),l:f%12||12,M:Ga(d[xb]()),p:f<12?"AM":"PM",P:f<12?"am":"pm",S:Ga(d.getSeconds()),L:Ga(C(b%1000),3)},u.dateFormats);for(e in d){for(;a.indexOf("%"+e)!==-1;){a=a.replace("%"+e,typeof d[e]==="function"?d[e](b):d[e]);}}return c?a.substr(0,1).toUpperCase()+a.substr(1):a;};G={millisecond:1,second:1000,minute:60000,hour:3600000,day:86400000,week:604800000,month:2419200000,year:31449600000};u.numberFormat=function(a,b,c,d){var a=+a||0,b=+b,e=T.lang,f=(a.toString().split(".")[1]||"").length,g,h,i=Math.abs(a);b===-1?b=Math.min(f,20):I(b)||(b=2);g=String(B(i.toFixed(b)));h=g.length>3?g.length%3:0;c=p(c,e.decimalPoint);d=p(d,e.thousandsSep);a=a<0?"-":"";a+=h?g.substr(0,h)+d:"";a+=g.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+d);b&&(d=Math.abs(i-g+Math.pow(10,-Math.max(b,f)-1)),a+=c+d.toFixed(b).slice(2));return a;};Math.easeInOutSine=function(a){return -0.5*(Math.cos(Math.PI*a)-1);};oa=function(a,b){var c;if(b==="width"){return Math.min(a.offsetWidth,a.scrollWidth)-oa(a,"padding-left")-oa(a,"padding-right");}else{if(b==="height"){return Math.min(a.offsetHeight,a.scrollHeight)-oa(a,"padding-top")-oa(a,"padding-bottom");}}return(c=D.getComputedStyle(a,void 0))&&B(c.getPropertyValue(b));};pa=function(a,b){return b.indexOf?b.indexOf(a):[].indexOf.call(b,a);};Da=function(a,b){return[].filter.call(a,b);};Ea=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++){c[d]=b.call(a[d],a[d],d,a);}return c;};Db=function(a){var b=y.documentElement,a=a.getBoundingClientRect();return{top:a.top+(D.pageYOffset||b.scrollTop)-(b.clientTop||0),left:a.left+(D.pageXOffset||b.scrollLeft)-(b.clientLeft||0)};};Ka=function(a){for(var b=Ja.length;b--;){if(Ja[b].elem===a){Ja[b].stopped=!0;}}};q=function(a,b){return Array.prototype.forEach.call(a,b);};N=function(a,b,c){function d(b){b.target=b.srcElement||D;c.call(a,b);}var e=a.hcEvents=a.hcEvents||{};if(a.addEventListener){a.addEventListener(b,c,!1);}else{if(a.attachEvent){if(!a.hcEventsIE){a.hcEventsIE={};}a.hcEventsIE[c.toString()]=d;a.attachEvent("on"+b,d);}}e[b]||(e[b]=[]);e[b].push(c);};Y=function(a,b,c){function d(b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&(c=a.hcEventsIE[c.toString()],a.detachEvent("on"+b,c));}function e(){var c,e,f;if(a.nodeName){for(f in b?(c={},c[b]=!0):c=g,c){if(g[f]){for(e=g[f].length;e--;){d(f,g[f][e]);}}}}}var f,g=a.hcEvents,h;if(g){b?(f=g[b]||[],c?(h=pa(c,f),h>-1&&(f.splice(h,1),g[b]=f),d(b,c)):(e(),g[b]=[])):(e(),a.hcEvents={});}};H=function(a,b,c,d){var e;e=a.hcEvents;var f,g,c=c||{};if(y.createEvent&&(a.dispatchEvent||a.fireEvent)){e=y.createEvent("Events"),e.initEvent(b,!0,!0),e.target=a,x(e,c),a.dispatchEvent?a.dispatchEvent(e):a.fireEvent(b,e);}else{if(e){e=e[b]||[];f=e.length;if(!c.preventDefault){c.preventDefault=function(){c.defaultPrevented=!0;};}c.target=a;if(!c.type){c.type=b;}for(b=0;b<f;b++){(g=e[b])&&g.call(a,c)===!1&&c.preventDefault();}}}d&&!c.defaultPrevented&&d(c);};Za=function(a,b,c){var d,e="",f,g,h;ba(c)||(d=arguments,c={duration:d[2],easing:d[3],complete:d[4]});if(!I(c.duration)){c.duration=400;}c.easing=typeof c.easing==="function"?c.easing:Math[c.easing]||Math.easeInOutSine;c.curAnim=E(b);for(h in b){g=new tb(a,c,h),f=null,h==="d"?(g.paths=g.initPath(a,a.d,b.d),g.toD=b.d,d=0,f=1):a.attr?d=a.attr(h):(d=parseFloat(oa(a,h))||0,h!=="opacity"&&(e="px")),f||(f=b[h]),f.match&&f.match("px")&&(f=f.replace(/px/g,"")),g.run(d,f,e);}};if(D.jQuery){D.jQuery.fn.highcharts=function(){var a=[].slice.call(arguments);if(this[0]){return a[0]?(new (u[ya(a[0])?a.shift():"Chart"])(this[0],a[0],a[1]),this):U[O(this[0],"data-highcharts-chart")];}};}y&&!y.defaultView&&(oa=function(a,b){var c;c={width:"clientWidth",height:"clientHeight"}[b];if(a.style[b]){return B(a.style[b]);}b==="opacity"&&(b="filter");if(c){return a.style.zoom=1,Math.max(a[c]-2*oa(a,"padding"),0);}c=a.currentStyle[b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase();})];b==="filter"&&(c=c.replace(/alpha\(opacity=([0-9]+)\)/,function(a,b){return b/100;}));return c===""?1:B(c);});Array.prototype.forEach||(q=function(a,b){for(var c=0,d=a.length;c<d;c++){if(b.call(a[c],a[c],c,a)===!1){return c;}}});Array.prototype.indexOf||(pa=function(a,b){var c,d=0;if(b){for(c=b.length;d<c;d++){if(b[d]===a){return d;}}}return -1;});Array.prototype.filter||(Da=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++){b(a[d],d)&&c.push(a[d]);}return c;});u.Fx=tb;u.inArray=pa;u.each=q;u.grep=Da;u.offset=Db;u.map=Ea;u.addEvent=N;u.removeEvent=Y;u.fireEvent=H;u.animate=Za;u.animObject=Wa;u.stop=Ka;T={colors:"#7cb5ec,#434348,#90ed7d,#f7a35c,#8085e9,#f15c80,#e4d354,#2b908f,#f45b5b,#91e8e1".split(","),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),decimalPoint:".",numericSymbols:"k,M,G,T,P,E".split(","),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:!0,canvasToolsURL:"http://code.highcharts.com/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/4.2.7/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}},width:null,height:null},title:{text:"Chart title",align:"center",margin:15,style:{color:"#333333",fontSize:"18px"},widthAdjust:-44},subtitle:{text:"",align:"center",style:{color:"#555555"},widthAdjust:-44},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1000},events:{},lineWidth:2,marker:{lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0,lineWidthPlus:1,radiusPlus:2},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return this.y===null?"":u.numberFormat(this.y,-1);},style:{color:"contrast",fontSize:"11px",fontWeight:"bold",textShadow:"0 0 6px contrast, 0 0 3px contrast"},verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,softThreshold:!0,states:{hover:{lineWidthPlus:1,marker:{},halo:{size:10,opacity:0.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1000}},labels:{style:{position:"absolute",color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name;},borderColor:"#909090",borderRadius:0,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"white",opacity:0.5,textAlign:"center"}},tooltip:{enabled:!0,animation:fa,backgroundColor:"rgba(249, 249, 249, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,snap:Ob?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",pointerEvents:"none",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var ga=T.plotOptions,ha=ga.line;Hb();na.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(a){return[B(a[1]),B(a[2]),B(a[3]),parseFloat(a[4],10)];}},{regex:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(a){return[B(a[1],16),B(a[2],16),B(a[3],16),1];}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(a){return[B(a[1]),B(a[2]),B(a[3]),1];}}],init:function(a){var b,c,d,e;if((this.input=a)&&a.stops){this.stops=Ea(a.stops,function(a){return new na(a[1]);});}else{for(d=this.parsers.length;d--&&!c;){e=this.parsers[d],(b=e.regex.exec(a))&&(c=e.parse(b));}}this.rgba=c||[];},get:function(a){var b=this.input,c=this.rgba,d;this.stops?(d=E(b),d.stops=[].concat(d.stops),q(this.stops,function(b,c){d.stops[c]=[d.stops[c][0],b.get(a)];})):d=c&&I(c[0])?a==="rgb"||!a&&c[3]===1?"rgb("+c[0]+","+c[1]+","+c[2]+")":a==="a"?c[3]:"rgba("+c.join(",")+")":b;return d;},brighten:function(a){var b,c=this.rgba;if(this.stops){q(this.stops,function(b){b.brighten(a);});}else{if(I(a)&&a!==0){for(b=0;b<3;b++){c[b]+=B(a*255),c[b]<0&&(c[b]=0),c[b]>255&&(c[b]=255);}}}return this;},setOpacity:function(a){this.rgba[3]=a;return this;}};J.prototype={opacity:1,textProps:"direction,fontSize,fontWeight,fontFamily,fontStyle,color,lineHeight,width,textDecoration,textOverflow,textShadow".split(","),init:function(a,b){this.element=b==="span"?ca(b):y.createElementNS(Ia,b);this.renderer=a;},animate:function(a,b,c){b=p(b,this.renderer.globalAnimation,!0);Ka(this);if(b){if(c){b.complete=c;}Za(this,a,b);}else{this.attr(a,null,c);}return this;},colorGradient:function(a,b,c){var d=this.renderer,e,f,g,h,i,j,k,l,m,n,o,A=[],r;a.linearGradient?f="linearGradient":a.radialGradient&&(f="radialGradient");if(f){g=a[f];i=d.gradients;k=a.stops;n=c.radialReference;za(g)&&(a[f]=g={x1:g[0],y1:g[1],x2:g[2],y2:g[3],gradientUnits:"userSpaceOnUse"});f==="radialGradient"&&n&&!s(g.gradientUnits)&&(h=g,g=E(g,d.getRadialAttr(n,h),{gradientUnits:"userSpaceOnUse"}));for(o in g){o!=="id"&&A.push(o,g[o]);}for(o in k){A.push(k[o]);}A=A.join(",");i[A]?n=i[A].attr("id"):(g.id=n="highcharts-"+Cb++,i[A]=j=d.createElement(f).attr(g).add(d.defs),j.radAttr=h,j.stops=[],q(k,function(a){a[1].indexOf("rgba")===0?(e=na(a[1]),l=e.get("rgb"),m=e.get("a")):(l=a[1],m=1);a=d.createElement("stop").attr({offset:a[0],"stop-color":l,"stop-opacity":m}).add(j);j.stops.push(a);}));r="url("+d.url+"#"+n+")";c.setAttribute(b,r);c.gradient=A;a.toString=function(){return r;};}},applyTextShadow:function(a){var b=this.element,c,d=a.indexOf("contrast")!==-1,e={},f=this.renderer.forExport,g=f||b.style.textShadow!==z&&!Aa;if(d){e.textShadow=a=a.replace(/contrast/g,this.renderer.getContrast(b.style.fill));}if(pb||f){e.textRendering="geometricPrecision";}g?this.css(e):(this.fakeTS=!0,this.ySetter=this.xSetter,c=[].slice.call(b.getElementsByTagName("tspan")),q(a.split(/\s?,\s?/g),function(a){var d=b.firstChild,e,f,a=a.split(" ");e=a[a.length-1];(f=a[a.length-2])&&q(c,function(a,c){var g;c===0&&(a.setAttribute("x",b.getAttribute("x")),c=b.getAttribute("y"),a.setAttribute("y",c||0),c===null&&b.setAttribute("y",0));g=a.cloneNode(1);O(g,{"class":"highcharts-text-shadow",fill:e,stroke:e,"stroke-opacity":1/t(B(f),3),"stroke-width":f,"stroke-linejoin":"round"});b.insertBefore(g,d);});}));},attr:function(a,b,c){var d,e=this.element,f,g=this,h;typeof a==="string"&&b!==z&&(d=a,a={},a[d]=b);if(typeof a==="string"){g=(this[a+"Getter"]||this._defaultGetter).call(this,a,e);}else{for(d in a){b=a[d];h=!1;this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(d)&&(f||(this.symbolAttr(a),f=!0),h=!0);if(this.rotation&&(d==="x"||d==="y")){this.doTransform=!0;}h||(h=this[d+"Setter"]||this._defaultSetter,h.call(this,b,d,e),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(d)&&this.updateShadows(d,b,h));}if(this.doTransform){this.updateTransform(),this.doTransform=!1;}}c&&c();return g;},updateShadows:function(a,b,c){for(var d=this.shadows,e=d.length;e--;){c.call(d[e],a==="height"?Math.max(b-(d[e].cutHeight||0),0):a==="d"?this.d:b,a,d[e]);}},addClass:function(a){var b=this.element,c=O(b,"class")||"";c.indexOf(a)===-1&&O(b,"class",c+" "+a);return this;},symbolAttr:function(a){var b=this;q("x,y,r,start,end,width,height,innerR,anchorX,anchorY".split(","),function(c){b[c]=p(a[c],b[c]);});b.attr({d:b.renderer.symbols[b.symbolName](b.x,b.y,b.width,b.height,b)});},clip:function(a){return this.attr("clip-path",a?"url("+this.renderer.url+"#"+a.id+")":"none");},crisp:function(a){var b,c={},d,e=this.strokeWidth||0;d=C(e)%2/2;a.x=V(a.x||this.x||0)+d;a.y=V(a.y||this.y||0)+d;a.width=V((a.width||this.width||0)-2*d);a.height=V((a.height||this.height||0)-2*d);a.strokeWidth=e;for(b in a){this[b]!==a[b]&&(this[b]=c[b]=a[b]);}return c;},css:function(a){var b=this.styles,c={},d=this.element,e,f,g="";e=!b;if(a&&a.color){a.fill=a.color;}if(b){for(f in a){a[f]!==b[f]&&(c[f]=a[f],e=!0);}}if(e){e=this.textWidth=a&&a.width&&d.nodeName.toLowerCase()==="text"&&B(a.width)||this.textWidth;b&&(a=x(b,c));this.styles=a;e&&(la||!fa&&this.renderer.forExport)&&delete a.width;if(Aa&&!fa){M(this.element,a);}else{b=function(a,b){return"-"+b.toLowerCase();};for(f in a){g+=f.replace(/([A-Z])/g,b)+":"+a[f]+";";}O(d,"style",g);}e&&this.added&&this.renderer.buildText(this);}return this;},on:function(a,b){var c=this,d=c.element;gb&&a==="click"?(d.ontouchstart=function(a){c.touchEventFired=ma.now();a.preventDefault();b.call(d,a);},d.onclick=function(a){(Ba.indexOf("Android")===-1||ma.now()-(c.touchEventFired||0)>1100)&&b.call(d,a);}):d["on"+a]=b;return this;},setRadialReference:function(a){var b=this.renderer.gradients[this.element.gradient];this.element.radialReference=a;b&&b.radAttr&&b.animate(this.renderer.getRadialAttr(a,b.radAttr));return this;},translate:function(a,b){return this.attr({translateX:a,translateY:b});},invert:function(){this.inverted=!0;this.updateTransform();return this;},updateTransform:function(){var a=this.translateX||0,b=this.translateY||0,c=this.scaleX,d=this.scaleY,e=this.inverted,f=this.rotation,g=this.element;e&&(a+=this.attr("width"),b+=this.attr("height"));a=["translate("+a+","+b+")"];e?a.push("rotate(90) scale(-1,1)"):f&&a.push("rotate("+f+" "+(g.getAttribute("x")||0)+" "+(g.getAttribute("y")||0)+")");(s(c)||s(d))&&a.push("scale("+p(c,1)+" "+p(d,1)+")");a.length&&g.setAttribute("transform",a.join(" "));},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this;},align:function(a,b,c){var d,e,f,g,h={};e=this.renderer;f=e.alignedObjects;if(a){if(this.alignOptions=a,this.alignByTranslate=b,!c||ya(c)){this.alignTo=d=c||"renderer",ra(f,this),f.push(this),c=null;}}else{a=this.alignOptions,b=this.alignByTranslate,d=this.alignTo;}c=p(c,e[d],e);d=a.align;e=a.verticalAlign;f=(c.x||0)+(a.x||0);g=(c.y||0)+(a.y||0);if(d==="right"||d==="center"){f+=(c.width-(a.width||0))/{right:1,center:2}[d];}h[b?"translateX":"x"]=C(f);if(e==="bottom"||e==="middle"){g+=(c.height-(a.height||0))/({bottom:1,middle:2}[e]||1);}h[b?"translateY":"y"]=C(g);this[this.placed?"animate":"attr"](h);this.placed=!0;this.alignAttr=h;return this;},getBBox:function(a,b){var c,d=this.renderer,e,f,g,h=this.element,i=this.styles;e=this.textStr;var j,k=h.style,l,m=d.cache,n=d.cacheKeys,o;f=p(b,this.rotation);g=f*ka;e!==z&&(o=e.toString().replace(Tb,"0")+["",f||0,i&&i.fontSize,h.style.width].join(","));o&&!a&&(c=m[o]);if(!c){if(h.namespaceURI===Ia||d.forExport){try{l=this.fakeTS&&function(a){q(h.querySelectorAll(".highcharts-text-shadow"),function(b){b.style.display=a;});},Qa&&k.textShadow?(j=k.textShadow,k.textShadow=""):l&&l("none"),c=h.getBBox?x({},h.getBBox()):{width:h.offsetWidth,height:h.offsetHeight},j?k.textShadow=j:l&&l("");}catch(A){}if(!c||c.width<0){c={width:0,height:0};}}else{c=this.htmlGetBBox();}if(d.isSVG){d=c.width;e=c.height;if(Aa&&i&&i.fontSize==="11px"&&e.toPrecision(3)==="16.9"){c.height=e=14;}if(f){c.width=Q(e*da(g))+Q(d*W(g)),c.height=Q(e*W(g))+Q(d*da(g));}}if(o&&c.height>0){for(;n.length>250;){delete m[n.shift()];}m[o]||n.push(o);m[o]=c;}}return c;},show:function(a){return this.attr({visibility:a?"inherit":"visible"});},hide:function(){return this.attr({visibility:"hidden"});},fadeOut:function(a){var b=this;b.animate({opacity:0},{duration:a||150,complete:function(){b.attr({y:-9999});}});},add:function(a){var b=this.renderer,c=this.element,d;if(a){this.parentGroup=a;}this.parentInverted=a&&a.inverted;this.textStr!==void 0&&b.buildText(this);this.added=!0;if(!a||a.handleZ||this.zIndex){d=this.zIndexSetter();}d||(a?a.element:b.box).appendChild(c);if(this.onAdd){this.onAdd();}return this;},safeRemoveChild:function(a){var b=a.parentNode;b&&b.removeChild(a);},destroy:function(){var a=this,b=a.element||{},c=a.shadows,d=a.renderer.isSVG&&b.nodeName==="SPAN"&&a.parentGroup,e,f;b.onclick=b.onmouseout=b.onmouseover=b.onmousemove=b.point=null;Ka(a);if(a.clipPath){a.clipPath=a.clipPath.destroy();}if(a.stops){for(f=0;f<a.stops.length;f++){a.stops[f]=a.stops[f].destroy();}a.stops=null;}a.safeRemoveChild(b);for(c&&q(c,function(b){a.safeRemoveChild(b);});d&&d.div&&d.div.childNodes.length===0;){b=d.parentGroup,a.safeRemoveChild(d.div),delete d.div,d=b;}a.alignTo&&ra(a.renderer.alignedObjects,a);for(e in a){delete a[e];}return null;},shadow:function(a,b,c){var d=[],e,f,g=this.element,h,i,j,k;if(a){i=p(a.width,3);j=(a.opacity||0.15)/i;k=this.parentInverted?"(-1,-1)":"("+p(a.offsetX,1)+", "+p(a.offsetY,1)+")";for(e=1;e<=i;e++){f=g.cloneNode(0);h=i*2+1-2*e;O(f,{isShadow:"true",stroke:a.color||"black","stroke-opacity":j*e,"stroke-width":h,transform:"translate"+k,fill:"none"});if(c){O(f,"height",t(O(f,"height")-h,0)),f.cutHeight=h;}b?b.element.appendChild(f):g.parentNode.insertBefore(f,g);d.push(f);}this.shadows=d;}return this;},xGetter:function(a){this.element.nodeName==="circle"&&(a={x:"cx",y:"cy"}[a]||a);return this._defaultGetter(a);},_defaultGetter:function(a){a=p(this[a],this.element?this.element.getAttribute(a):null,0);/^[\-0-9\.]+$/.test(a)&&(a=parseFloat(a));return a;},dSetter:function(a,b,c){a&&a.join&&(a=a.join(" "));/(NaN| {2}|^$)/.test(a)&&(a="M 0 0");c.setAttribute(b,a);this[b]=a;},dashstyleSetter:function(a){var b,c=this["stroke-width"];c==="inherit"&&(c=1);if(a=a&&a.toLowerCase()){a=a.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(b=a.length;b--;){a[b]=B(a[b])*c;}a=a.join(",").replace(/NaN/g,"none");this.element.setAttribute("stroke-dasharray",a);}},alignSetter:function(a){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[a]);},titleSetter:function(a){var b=this.element.getElementsByTagName("title")[0];b||(b=y.createElementNS(Ia,"title"),this.element.appendChild(b));b.firstChild&&b.removeChild(b.firstChild);b.appendChild(y.createTextNode(String(p(a),"").replace(/<[^>]*>/g,"")));},textSetter:function(a){if(a!==this.textStr){delete this.bBox,this.textStr=a,this.added&&this.renderer.buildText(this);}},fillSetter:function(a,b,c){typeof a==="string"?c.setAttribute(b,a):a&&this.colorGradient(a,b,c);},visibilitySetter:function(a,b,c){a==="inherit"?c.removeAttribute(b):c.setAttribute(b,a);},zIndexSetter:function(a,b){var c=this.renderer,d=this.parentGroup,c=(d||c).element||c.box,e,f,g=this.element,h;e=this.added;var i;if(s(a)){g.zIndex=a,a=+a,this[b]===a&&(e=!1),this[b]=a;}if(e){if((a=this.zIndex)&&d){d.handleZ=!0;}d=c.childNodes;for(i=0;i<d.length&&!h;i++){if(e=d[i],f=e.zIndex,e!==g&&(B(f)>a||!s(a)&&s(f))){c.insertBefore(g,e),h=!0;}}h||c.appendChild(g);}return h;},_defaultSetter:function(a,b,c){c.setAttribute(b,a);}};J.prototype.yGetter=J.prototype.xGetter;J.prototype.translateXSetter=J.prototype.translateYSetter=J.prototype.rotationSetter=J.prototype.verticalAlignSetter=J.prototype.scaleXSetter=J.prototype.scaleYSetter=function(a,b){this[b]=a;this.doTransform=!0;};J.prototype.opacitySetter=J.prototype.displaySetter=function(a,b,c){this[b]=a;c.setAttribute(b,a);};J.prototype["stroke-widthSetter"]=J.prototype.strokeSetter=function(a,b,c){this[b]=a;if(this.stroke&&this["stroke-width"]){this.strokeWidth=this["stroke-width"],J.prototype.fillSetter.call(this,this.stroke,"stroke",c),c.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0;}else{if(b==="stroke-width"&&a===0&&this.hasStroke){c.removeAttribute("stroke"),this.hasStroke=!1;}}};var Fa=function(){this.init.apply(this,arguments);};Fa.prototype={Element:J,init:function(a,b,c,d,e,f){var g,d=this.createElement("svg").attr({version:"1.1"}).css(this.getStyle(d));g=d.element;a.appendChild(g);a.innerHTML.indexOf("xmlns")===-1&&O(g,"xmlns",Ia);this.isSVG=!0;this.box=g;this.boxWrapper=d;this.alignedObjects=[];this.url=(Qa||pb)&&y.getElementsByTagName("base").length?D.location.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"";this.createElement("desc").add().element.appendChild(y.createTextNode("Created with Highcharts 4.2.7"));this.defs=this.createElement("defs").add();this.allowHTML=f;this.forExport=e;this.gradients={};this.cache={};this.cacheKeys=[];this.imgCount=0;this.setSize(b,c,!1);var h;if(Qa&&a.getBoundingClientRect){this.subPixelFix=b=function(){M(a,{left:0,top:0});h=a.getBoundingClientRect();M(a,{left:va(h.left)-h.left+"px",top:va(h.top)-h.top+"px"});},b(),N(D,"resize",b);}},getStyle:function(a){return this.style=x({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},a);},isHidden:function(){return !this.boxWrapper.getBBox().width;},destroy:function(){var a=this.defs;this.box=null;this.boxWrapper=this.boxWrapper.destroy();Ua(this.gradients||{});this.gradients=null;if(a){this.defs=a.destroy();}this.subPixelFix&&Y(D,"resize",this.subPixelFix);return this.alignedObjects=null;},createElement:function(a){var b=new this.Element;b.init(this,a);return b;},draw:function(){},getRadialAttr:function(a,b){return{cx:a[0]-a[2]/2+b.cx*a[2],cy:a[1]-a[2]/2+b.cy*a[2],r:b.r*a[2]};},buildText:function(a){for(var b=a.element,c=this,d=c.forExport,e=p(a.textStr,"").toString(),f=e.indexOf("<")!==-1,g=b.childNodes,h,i,j,k=O(b,"x"),l=a.styles,m=a.textWidth,n=l&&l.lineHeight,o=l&&l.textShadow,A=l&&l.textOverflow==="ellipsis",r=g.length,K=m&&!a.added&&this.box,w=function(a){return n?B(n):c.fontMetrics(/(px|em)$/.test(a&&a.style.fontSize)?a.style.fontSize:l&&l.fontSize||c.style.fontSize||12,a).h;},v=function(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">");};r--;){b.removeChild(g[r]);}!f&&!o&&!A&&!m&&e.indexOf(" ")===-1?b.appendChild(y.createTextNode(v(e))):(h=/<.*style="([^"]+)".*>/,i=/<.*href="(http[^"]+)".*>/,K&&K.appendChild(b),e=f?e.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[e],e=Da(e,function(a){return a!=="";}),q(e,function(e,f){var g,n=0,e=e.replace(/^\s+|\s+$/g,"").replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");g=e.split("|||");q(g,function(e){if(e!==""||g.length===1){var o={},r=y.createElementNS(Ia,"tspan"),p;h.test(e)&&(p=e.match(h)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),O(r,"style",p));i.test(e)&&!d&&(O(r,"onclick",'location.href="'+e.match(i)[1]+'"'),M(r,{cursor:"pointer"}));e=v(e.replace(/<(.|\n)*?>/g,"")||" ");if(e!==" "){r.appendChild(y.createTextNode(e));if(n){o.dx=0;}else{if(f&&k!==null){o.x=k;}}O(r,o);b.appendChild(r);!n&&f&&(!fa&&d&&M(r,{display:"block"}),O(r,"dy",w(r)));if(m){for(var o=e.replace(/([^\^])-/g,"$1- ").split(" "),q=l.whiteSpace==="nowrap",K=g.length>1||f||o.length>1&&!q,Ra,s,La=[],t=w(r),x=1,C=a.rotation,u=e,z=u.length;(K||A)&&(o.length||La.length);){a.rotation=0,Ra=a.getBBox(!0),s=Ra.width,!fa&&c.forExport&&(s=c.measureSpanWidth(r.firstChild.data,a.styles)),Ra=s>m,j===void 0&&(j=Ra),A&&j?(z/=2,u===""||!Ra&&z<0.5?o=[]:(u=e.substring(0,u.length+(Ra?-1:1)*va(z)),o=[u+(m>3?"\u2026":"")],r.removeChild(r.firstChild))):!Ra||o.length===1?(o=La,La=[],o.length&&!q&&(x++,r=y.createElementNS(Ia,"tspan"),O(r,{dy:t,x:k}),p&&O(r,"style",p),b.appendChild(r)),s>m&&(m=s)):(r.removeChild(r.firstChild),La.unshift(o.pop())),o.length&&r.appendChild(y.createTextNode(o.join(" ").replace(/- /g,"-")));}a.rotation=C;}n++;}}});}),j&&a.attr("title",a.textStr),K&&K.removeChild(b),o&&a.applyTextShadow&&a.applyTextShadow(o));},getContrast:function(a){a=na(a).rgba;return a[0]+a[1]+a[2]>384?"#000000":"#FFFFFF";},button:function(a,b,c,d,e,f,g,h,i){var j=this.label(a,b,c,i,null,null,null,null,"button"),k=0,l,m,n,o,A,r,a={x1:0,y1:0,x2:0,y2:1},e=E({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:a,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},e);n=e.style;delete e.style;f=E(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#FFF"],[1,"#ACF"]]}},f);o=f.style;delete f.style;g=E(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#9BD"],[1,"#CDF"]]}},g);A=g.style;delete g.style;h=E(e,{style:{color:"#CCC"}},h);r=h.style;delete h.style;N(j.element,Aa?"mouseover":"mouseenter",function(){k!==3&&j.attr(f).css(o);});N(j.element,Aa?"mouseout":"mouseleave",function(){k!==3&&(l=[e,f,g][k],m=[n,o,A][k],j.attr(l).css(m));});j.setState=function(a){(j.state=k=a)?a===2?j.attr(g).css(A):a===3&&j.attr(h).css(r):j.attr(e).css(n);};return j.on("click",function(a){k!==3&&d.call(j,a);}).attr(e).css(x({cursor:"default"},n));},crispLine:function(a,b){a[1]===a[4]&&(a[1]=a[4]=C(a[1])-b%2/2);a[2]===a[5]&&(a[2]=a[5]=C(a[2])+b%2/2);return a;},path:function(a){var b={fill:"none"};za(a)?b.d=a:ba(a)&&x(b,a);return this.createElement("path").attr(b);},circle:function(a,b,c){a=ba(a)?a:{x:a,y:b,r:c};b=this.createElement("circle");b.xSetter=b.ySetter=function(a,b,c){c.setAttribute("c"+b,a);};return b.attr(a);},arc:function(a,b,c,d,e,f){if(ba(a)){b=a.y,c=a.r,d=a.innerR,e=a.start,f=a.end,a=a.x;}a=this.symbol("arc",a||0,b||0,c||0,c||0,{innerR:d||0,start:e||0,end:f||0});a.r=c;return a;},rect:function(a,b,c,d,e,f){var e=ba(a)?a.r:e,g=this.createElement("rect"),a=ba(a)?a:a===z?{}:{x:a,y:b,width:t(c,0),height:t(d,0)};if(f!==z){g.strokeWidth=f,a=g.crisp(a);}if(e){a.r=e;}g.rSetter=function(a,b,c){O(c,{rx:a,ry:a});};return g.attr(a);},setSize:function(a,b,c){var d=this.alignedObjects,e=d.length;this.width=a;this.height=b;for(this.boxWrapper[p(c,!0)?"animate":"attr"]({width:a,height:b});e--;){d[e].align();}},g:function(a){var b=this.createElement("g");return s(a)?b.attr({"class":"highcharts-"+a}):b;},image:function(a,b,c,d,e){var f={preserveAspectRatio:"none"};arguments.length>1&&x(f,{x:b,y:c,width:d,height:e});f=this.createElement("image").attr(f);f.element.setAttributeNS?f.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a):f.element.setAttribute("hc-svg-href",a);return f;},symbol:function(a,b,c,d,e,f){var g=this,h,i=this.symbols[a],i=i&&i(C(b),C(c),d,e,f),j=/^url\((.*?)\)$/,k,l;if(i){h=this.path(i),x(h,{symbolName:a,x:b,y:c,width:d,height:e}),f&&x(h,f);}else{if(j.test(a)){l=function(a,b){a.element&&(a.attr({width:b[0],height:b[1]}),a.alignByTranslate||a.translate(C((d-b[0])/2),C((e-b[1])/2)));},k=a.match(j)[1],a=Pb[k]||f&&f.width&&f.height&&[f.width,f.height],h=this.image(k).attr({x:b,y:c}),h.isImg=!0,a?l(h,a):(h.attr({width:0,height:0}),ca("img",{onload:function(){var a=U[g.chartIndex];this.width===0&&(M(this,{position:"absolute",top:"-999em"}),y.body.appendChild(this));l(h,Pb[k]=[this.width,this.height]);this.parentNode&&this.parentNode.removeChild(this);g.imgCount--;if(!g.imgCount&&a&&a.onload){a.onload();}},src:k}),this.imgCount++);}}return h;},symbols:{circle:function(a,b,c,d){var e=0.166*c;return[X,a+c/2,b,"C",a+c+e,b,a+c+e,b+d,a+c/2,b+d,"C",a-e,b+d,a-e,b,a+c/2,b,"Z"];},square:function(a,b,c,d){return[X,a,b,S,a+c,b,a+c,b+d,a,b+d,"Z"];},triangle:function(a,b,c,d){return[X,a+c/2,b,S,a+c,b+d,a,b+d,"Z"];},"triangle-down":function(a,b,c,d){return[X,a,b,S,a+c,b,a+c/2,b+d,"Z"];},diamond:function(a,b,c,d){return[X,a+c/2,b,S,a+c,b+d/2,a+c/2,b+d,a,b+d/2,"Z"];},arc:function(a,b,c,d,e){var f=e.start,c=e.r||c||d,g=e.end-0.001,d=e.innerR,h=e.open,i=W(f),j=da(f),k=W(g),g=da(g),e=e.end-f<ta?0:1;return[X,a+c*i,b+c*j,"A",c,c,0,e,1,a+c*k,b+c*g,h?X:S,a+d*k,b+d*g,"A",d,d,0,e,0,a+d*i,b+d*j,h?"":"Z"];},callout:function(a,b,c,d,e){var f=F(e&&e.r||0,c,d),g=f+6,h=e&&e.anchorX,e=e&&e.anchorY,i;i=["M",a+f,b,"L",a+c-f,b,"C",a+c,b,a+c,b,a+c,b+f,"L",a+c,b+d-f,"C",a+c,b+d,a+c,b+d,a+c-f,b+d,"L",a+f,b+d,"C",a,b+d,a,b+d,a,b+d-f,"L",a,b+f,"C",a,b,a,b,a+f,b];h&&h>c&&e>b+g&&e<b+d-g?i.splice(13,3,"L",a+c,e-6,a+c+6,e,a+c,e+6,a+c,b+d-f):h&&h<0&&e>b+g&&e<b+d-g?i.splice(33,3,"L",a,e+6,a-6,e,a,e-6,a,b+f):e&&e>d&&h>a+g&&h<a+c-g?i.splice(23,3,"L",h+6,b+d,h,b+d+6,h-6,b+d,a+f,b+d):e&&e<0&&h>a+g&&h<a+c-g&&i.splice(3,3,"L",h-6,b,h,b-6,h+6,b,c-f,b);return i;}},clipRect:function(a,b,c,d){var e="highcharts-"+Cb++,f=this.createElement("clipPath").attr({id:e}).add(this.defs),a=this.rect(a,b,c,d,0).add(f);a.id=e;a.clipPath=f;a.count=0;return a;},text:function(a,b,c,d){var e=la||!fa&&this.forExport,f={};if(d&&(this.allowHTML||!this.forExport)){return this.html(a,b,c);}f.x=Math.round(b||0);if(c){f.y=Math.round(c);}if(a||a===0){f.text=a;}a=this.createElement("text").attr(f);e&&a.css({position:"absolute"});if(!d){a.xSetter=function(a,b,c){var d=c.getElementsByTagName("tspan"),e,f=c.getAttribute(b),m;for(m=0;m<d.length;m++){e=d[m],e.getAttribute(b)===f&&e.setAttribute(b,a);}c.setAttribute(b,a);};}return a;},fontMetrics:function(a,b){var c,d,a=a||this.style.fontSize;!a&&b&&D.getComputedStyle&&(b=b.element||b,a=(c=D.getComputedStyle(b,""))&&c.fontSize);a=/px/.test(a)?B(a):/em/.test(a)?parseFloat(a)*12:12;c=a<24?a+3:C(a*1.2);d=C(c*0.8);return{h:c,b:d,f:a};},rotCorr:function(a,b,c){var d=a;b&&c&&(d=t(d*W(b*ka),4));return{x:-a/3*da(b*ka),y:d};},label:function(a,b,c,d,e,f,g,h,i){var j=this,k=j.g(i),l=j.text("",0,0,g).attr({zIndex:1}),m,n,o=0,A=3,r=0,p,w,v,La,rb=0,aa={},t,u=/^url\((.*?)\)$/.test(d),y=u,F,D,B;F=function(){var a,b;a=l.element.style;n=(p===void 0||w===void 0||k.styles.textAlign)&&s(l.textStr)&&l.getBBox();k.width=(p||n.width||0)+2*A+r;k.height=(w||n.height||0)+2*A;t=A+j.fontMetrics(a&&a.fontSize,l).b;if(y){if(!m){a=rb,b=(h?-t:0)+rb,k.box=m=j.symbols[d]||u?j.symbol(d,a,b,k.width,k.height,aa):j.rect(a,b,k.width,k.height,0,aa["stroke-width"]),m.isImg||m.attr("fill","none"),m.add(k);}m.isImg||m.attr(x({width:C(k.width),height:C(k.height)},aa));aa=null;}};D=function(){var a=k.styles,a=a&&a.textAlign,b=r+A,c;c=h?0:t;if(s(p)&&n&&(a==="center"||a==="right")){b+={center:0.5,right:1}[a]*(p-n.width);}if(b!==l.x||c!==l.y){l.attr("x",b),c!==z&&l.attr("y",c);}l.x=b;l.y=c;};B=function(a,b){m?m.attr(a,b):aa[a]=b;};k.onAdd=function(){l.add(k);k.attr({text:a||a===0?a:"",x:b,y:c});m&&s(e)&&k.attr({anchorX:e,anchorY:f});};k.widthSetter=function(a){p=a;};k.heightSetter=function(a){w=a;};k.paddingSetter=function(a){if(s(a)&&a!==A){A=k.padding=a,D();}};k.paddingLeftSetter=function(a){s(a)&&a!==r&&(r=a,D());};k.alignSetter=function(a){a={left:0,center:0.5,right:1}[a];a!==o&&(o=a,n&&k.attr({x:v}));};k.textSetter=function(a){a!==z&&l.textSetter(a);F();D();};k["stroke-widthSetter"]=function(a,b){a&&(y=!0);rb=a%2/2;B(b,a);};k.strokeSetter=k.fillSetter=k.rSetter=function(a,b){b==="fill"&&a&&(y=!0);B(b,a);};k.anchorXSetter=function(a,b){e=a;B(b,C(a)-rb-v);};k.anchorYSetter=function(a,b){f=a;B(b,a-La);};k.xSetter=function(a){k.x=a;o&&(a-=o*((p||n.width)+2*A));v=C(a);k.attr("translateX",v);};k.ySetter=function(a){La=k.y=C(a);k.attr("translateY",La);};var G=k.css;return x(k,{css:function(a){if(a){var b={},a=E(a);q(k.textProps,function(c){a[c]!==z&&(b[c]=a[c],delete a[c]);});l.css(b);}return G.call(k,a);},getBBox:function(){return{width:n.width+2*A,height:n.height+2*A,x:n.x-A,y:n.y-A};},shadow:function(a){m&&m.shadow(a);return k;},destroy:function(){Y(k.element,"mouseenter");Y(k.element,"mouseleave");l&&(l=l.destroy());m&&(m=m.destroy());J.prototype.destroy.call(k);k=j=F=D=B=null;}});}};fb=Fa;x(J.prototype,{htmlCss:function(a){var b=this.element;if(b=a&&b.tagName==="SPAN"&&a.width){delete a.width,this.textWidth=b,this.updateTransform();}if(a&&a.textOverflow==="ellipsis"){a.whiteSpace="nowrap",a.overflow="hidden";}this.styles=x(this.styles,a);M(this.element,a);return this;},htmlGetBBox:function(){var a=this.element;if(a.nodeName==="text"){a.style.position="absolute";}return{x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight};},htmlUpdateTransform:function(){if(this.added){var a=this.renderer,b=this.element,c=this.translateX||0,d=this.translateY||0,e=this.x||0,f=this.y||0,g=this.textAlign||"left",h={left:0,center:0.5,right:1}[g],i=this.shadows,j=this.styles;M(b,{marginLeft:c,marginTop:d});i&&q(i,function(a){M(a,{marginLeft:c+1,marginTop:d+1});});this.inverted&&q(b.childNodes,function(c){a.invertChild(c,b);});if(b.tagName==="SPAN"){var i=this.rotation,k=B(this.textWidth),l=j&&j.whiteSpace,m=[i,g,b.innerHTML,this.textWidth,this.textAlign].join(",");if(m!==this.cTT){j=a.fontMetrics(b.style.fontSize).b;s(i)&&this.setSpanRotation(i,h,j);M(b,{width:"",whiteSpace:l||"nowrap"});if(b.offsetWidth>k&&/[ \-]/.test(b.textContent||b.innerText)){M(b,{width:k+"px",display:"block",whiteSpace:l||"normal"});}this.getSpanCorrection(b.offsetWidth,j,h,i,g);}M(b,{left:e+(this.xCorr||0)+"px",top:f+(this.yCorr||0)+"px"});if(pb){j=b.offsetHeight;}this.cTT=m;}}else{this.alignOnAdd=!0;}},setSpanRotation:function(a,b,c){var d={},e=Aa?"-ms-transform":pb?"-webkit-transform":Qa?"MozTransform":Nb?"-o-transform":"";d[e]=d.transform="rotate("+a+"deg)";d[e+(Qa?"Origin":"-origin")]=d.transformOrigin=b*100+"% "+c+"px";M(this.element,d);},getSpanCorrection:function(a,b,c){this.xCorr=-a*c;this.yCorr=-b;}});x(Fa.prototype,{html:function(a,b,c){var d=this.createElement("span"),e=d.element,f=d.renderer,g=f.isSVG,h=function(a,b){q(["display","opacity","visibility"],function(c){ib(a,c+"Setter",function(a,c,d,e){a.call(this,c,d,e);b[d]=c;});});};d.textSetter=function(a){a!==e.innerHTML&&delete this.bBox;e.innerHTML=this.textStr=a;d.htmlUpdateTransform();};g&&h(d,d.element.style);d.xSetter=d.ySetter=d.alignSetter=d.rotationSetter=function(a,b){b==="align"&&(b="textAlign");d[b]=a;d.htmlUpdateTransform();};d.attr({text:a,x:C(b),y:C(c)}).css({position:"absolute",fontFamily:this.style.fontFamily,fontSize:this.style.fontSize});e.style.whiteSpace="nowrap";d.css=d.htmlCss;if(g){d.add=function(a){var b,c=f.box.parentNode,g=[];if(this.parentGroup=a){if(b=a.div,!b){for(;a;){g.push(a),a=a.parentGroup;}q(g.reverse(),function(a){var d,e=O(a.element,"class");e&&(e={className:e});b=a.div=a.div||ca(Pa,e,{position:"absolute",left:(a.translateX||0)+"px",top:(a.translateY||0)+"px",display:a.display,opacity:a.opacity,pointerEvents:a.styles&&a.styles.pointerEvents},b||c);d=b.style;x(a,{translateXSetter:function(b,c){d.left=b+"px";a[c]=b;a.doTransform=!0;},translateYSetter:function(b,c){d.top=b+"px";a[c]=b;a.doTransform=!0;}});h(a,d);});}}else{b=c;}b.appendChild(e);d.added=!0;d.alignOnAdd&&d.htmlUpdateTransform();return d;};}return d;}});var P;if(!fa&&!la){P={init:function(a,b){var c=["<",b,' filled="f" stroked="f"'],d=["position: ","absolute",";"],e=b===Pa;(b==="shape"||e)&&d.push("left:0;top:0;width:1px;height:1px;");d.push("visibility: ",e?"hidden":"visible");c.push(' style="',d.join(""),'"/>');if(b){c=e||b==="span"||b==="img"?c.join(""):a.prepVML(c),this.element=ca(c);}this.renderer=a;},add:function(a){var b=this.renderer,c=this.element,d=b.box,e=a&&a.inverted,d=a?a.element||a:d;if(a){this.parentGroup=a;}e&&b.invertChild(c,d);d.appendChild(c);this.added=!0;this.alignOnAdd&&!this.deferUpdateTransform&&this.updateTransform();if(this.onAdd){this.onAdd();}return this;},updateTransform:J.prototype.htmlUpdateTransform,setSpanRotation:function(){var a=this.rotation,b=W(a*ka),c=da(a*ka);M(this.element,{filter:a?["progid:DXImageTransform.Microsoft.Matrix(M11=",b,", M12=",-c,", M21=",c,", M22=",b,", sizingMethod='auto expand')"].join(""):"none"});},getSpanCorrection:function(a,b,c,d,e){var f=d?W(d*ka):1,g=d?da(d*ka):0,h=p(this.elemHeight,this.element.offsetHeight),i;this.xCorr=f<0&&-a;this.yCorr=g<0&&-h;i=f*g<0;this.xCorr+=g*b*(i?1-c:c);this.yCorr-=f*b*(d?i?c:1-c:1);e&&e!=="left"&&(this.xCorr-=a*c*(f<0?-1:1),d&&(this.yCorr-=h*c*(g<0?-1:1)),M(this.element,{textAlign:e}));},pathToVML:function(a){for(var b=a.length,c=[];b--;){if(I(a[b])){c[b]=C(a[b]*10)-5;}else{if(a[b]==="Z"){c[b]="x";}else{if(c[b]=a[b],a.isArc&&(a[b]==="wa"||a[b]==="at")){c[b+5]===c[b+7]&&(c[b+7]+=a[b+7]>a[b+5]?1:-1),c[b+6]===c[b+8]&&(c[b+8]+=a[b+8]>a[b+6]?1:-1);}}}}return c.join(" ")||"x";},clip:function(a){var b=this,c;a?(c=a.members,ra(c,b),c.push(b),b.destroyClip=function(){ra(c,b);},a=a.getCSS(b)):(b.destroyClip&&b.destroyClip(),a={clip:ob?"inherit":"rect(auto)"});return b.css(a);},css:J.prototype.htmlCss,safeRemoveChild:function(a){a.parentNode&&Va(a);},destroy:function(){this.destroyClip&&this.destroyClip();return J.prototype.destroy.apply(this);},on:function(a,b){this.element["on"+a]=function(){var a=D.event;a.target=a.srcElement;b(a);};return this;},cutOffPath:function(a,b){var c,a=a.split(/[ ,]/);c=a.length;if(c===9||c===11){a[c-4]=a[c-2]=B(a[c-2])-10*b;}return a.join(" ");},shadow:function(a,b,c){var d=[],e,f=this.element,g=this.renderer,h,i=f.style,j,k=f.path,l,m,n,o;k&&typeof k.value!=="string"&&(k="x");m=k;if(a){n=p(a.width,3);o=(a.opacity||0.15)/n;for(e=1;e<=3;e++){l=n*2+1-2*e;c&&(m=this.cutOffPath(k.value,l+0.5));j=['<shape isShadow="true" strokeweight="',l,'" filled="false" path="',m,'" coordsize="10 10" style="',f.style.cssText,'" />'];h=ca(g.prepVML(j),null,{left:B(i.left)+p(a.offsetX,1),top:B(i.top)+p(a.offsetY,1)});if(c){h.cutOff=l+1;}j=['<stroke color="',a.color||"black",'" opacity="',o*e,'"/>'];ca(g.prepVML(j),null,null,h);b?b.element.appendChild(h):f.parentNode.insertBefore(h,f);d.push(h);}this.shadows=d;}return this;},updateShadows:Ca,setAttr:function(a,b){ob?this.element[a]=b:this.element.setAttribute(a,b);},classSetter:function(a){this.element.className=a;},dashstyleSetter:function(a,b,c){(c.getElementsByTagName("stroke")[0]||ca(this.renderer.prepVML(["<stroke/>"]),null,null,c))[b]=a||"solid";this[b]=a;},dSetter:function(a,b,c){var d=this.shadows,a=a||[];this.d=a.join&&a.join(" ");c.path=a=this.pathToVML(a);if(d){for(c=d.length;c--;){d[c].path=d[c].cutOff?this.cutOffPath(a,d[c].cutOff):a;}}this.setAttr(b,a);},fillSetter:function(a,b,c){var d=c.nodeName;if(d==="SPAN"){c.style.color=a;}else{if(d!=="IMG"){c.filled=a!=="none",this.setAttr("fillcolor",this.renderer.color(a,c,b,this));}}},"fill-opacitySetter":function(a,b,c){ca(this.renderer.prepVML(["<",b.split("-")[0],' opacity="',a,'"/>']),null,null,c);},opacitySetter:Ca,rotationSetter:function(a,b,c){c=c.style;this[b]=c[b]=a;c.left=-C(da(a*ka)+1)+"px";c.top=C(W(a*ka))+"px";},strokeSetter:function(a,b,c){this.setAttr("strokecolor",this.renderer.color(a,c,b,this));},"stroke-widthSetter":function(a,b,c){c.stroked=!!a;this[b]=a;I(a)&&(a+="px");this.setAttr("strokeweight",a);},titleSetter:function(a,b){this.setAttr(b,a);},visibilitySetter:function(a,b,c){a==="inherit"&&(a="visible");this.shadows&&q(this.shadows,function(c){c.style[b]=a;});c.nodeName==="DIV"&&(a=a==="hidden"?"-999em":0,ob||(c.style[b]=a?"visible":"hidden"),b="top");c.style[b]=a;},displaySetter:function(a,b,c){c.style[b]=a;},xSetter:function(a,b,c){this[b]=a;b==="x"?b="left":b==="y"&&(b="top");this.updateClipping?(this[b]=a,this.updateClipping()):c.style[b]=a;},zIndexSetter:function(a,b,c){c.style[b]=a;}};P["stroke-opacitySetter"]=P["fill-opacitySetter"];u.VMLElement=P=sa(J,P);P.prototype.ySetter=P.prototype.widthSetter=P.prototype.heightSetter=P.prototype.xSetter;var Eb={Element:P,isIE8:Ba.indexOf("MSIE 8.0")>-1,init:function(a,b,c,d){var e;this.alignedObjects=[];d=this.createElement(Pa).css(x(this.getStyle(d),{position:"relative"}));e=d.element;a.appendChild(d.element);this.isVML=!0;this.box=e;this.boxWrapper=d;this.gradients={};this.cache={};this.cacheKeys=[];this.imgCount=0;this.setSize(b,c,!1);if(!y.namespaces.hcv){y.namespaces.add("hcv","urn:schemas-microsoft-com:vml");try{y.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } ";}catch(f){y.styleSheets[0].cssText+="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } ";}}},isHidden:function(){return !this.box.offsetWidth;},clipRect:function(a,b,c,d){var e=this.createElement(),f=ba(a);return x(e,{members:[],count:0,left:(f?a.x:a)+1,top:(f?a.y:b)+1,width:(f?a.width:c)-1,height:(f?a.height:d)-1,getCSS:function(a){var b=a.element,c=b.nodeName,a=a.inverted,d=this.top-(c==="shape"?b.offsetTop:0),e=this.left,b=e+this.width,f=d+this.height,d={clip:"rect("+C(a?e:d)+"px,"+C(a?f:b)+"px,"+C(a?b:f)+"px,"+C(a?d:e)+"px)"};!a&&ob&&c==="DIV"&&x(d,{width:b+"px",height:f+"px"});return d;},updateClipping:function(){q(e.members,function(a){a.element&&a.css(e.getCSS(a));});}});},color:function(a,b,c,d){var e=this,f,g=/^rgba/,h,i,j="none";a&&a.linearGradient?i="gradient":a&&a.radialGradient&&(i="pattern");if(i){var k,l,m=a.linearGradient||a.radialGradient,n,o,A,r,p,w="",a=a.stops,v,s=[],t=function(){h=['<fill colors="'+s.join(",")+'" opacity="',A,'" o:opacity2="',o,'" type="',i,'" ',w,'focus="100%" method="any" />'];ca(e.prepVML(h),null,null,b);};n=a[0];v=a[a.length-1];n[0]>0&&a.unshift([0,n[1]]);v[0]<1&&a.push([1,v[1]]);q(a,function(a,b){g.test(a[1])?(f=na(a[1]),k=f.get("rgb"),l=f.get("a")):(k=a[1],l=1);s.push(a[0]*100+"% "+k);b?(A=l,r=k):(o=l,p=k);});if(c==="fill"){if(i==="gradient"){c=m.x1||m[0]||0,a=m.y1||m[1]||0,n=m.x2||m[2]||0,m=m.y2||m[3]||0,w='angle="'+(90-Z.atan((m-a)/(n-c))*180/ta)+'"',t();}else{var j=m.r,aa=j*2,x=j*2,u=m.cx,C=m.cy,z=b.radialReference,y,j=function(){z&&(y=d.getBBox(),u+=(z[0]-y.x)/y.width-0.5,C+=(z[1]-y.y)/y.height-0.5,aa*=z[2]/y.width,x*=z[2]/y.height);w='src="'+T.global.VMLRadialGradientURL+'" size="'+aa+","+x+'" origin="0.5,0.5" position="'+u+","+C+'" color2="'+p+'" ';t();};d.added?j():d.onAdd=j;j=r;}}else{j=k;}}else{if(g.test(a)&&b.tagName!=="IMG"){f=na(a),d[c+"-opacitySetter"](f.get("a"),c,b),j=f.get("rgb");}else{j=b.getElementsByTagName(c);if(j.length){j[0].opacity=1,j[0].type="solid";}j=a;}}return j;},prepVML:function(a){var b=this.isIE8,a=a.join("");b?(a=a.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),a=a.indexOf('style="')===-1?a.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):a.replace('style="','style="display:inline-block;behavior:url(#default#VML);')):a=a.replace("<","<hcv:");return a;},text:Fa.prototype.html,path:function(a){var b={coordsize:"10 10"};za(a)?b.d=a:ba(a)&&x(b,a);return this.createElement("shape").attr(b);},circle:function(a,b,c){var d=this.symbol("circle");if(ba(a)){c=a.r,b=a.y,a=a.x;}d.isCircle=!0;d.r=c;return d.attr({x:a,y:b});},g:function(a){var b;a&&(b={className:"highcharts-"+a,"class":"highcharts-"+a});return this.createElement(Pa).attr(b);},image:function(a,b,c,d,e){var f=this.createElement("img").attr({src:a});arguments.length>1&&f.attr({x:b,y:c,width:d,height:e});return f;},createElement:function(a){return a==="rect"?this.symbol(a):Fa.prototype.createElement.call(this,a);},invertChild:function(a,b){var c=this,d=b.style,e=a.tagName==="IMG"&&a.style;M(a,{flip:"x",left:B(d.width)-(e?B(e.top):1),top:B(d.height)-(e?B(e.left):1),rotation:-90});q(a.childNodes,function(b){c.invertChild(b,a);});},symbols:{arc:function(a,b,c,d,e){var f=e.start,g=e.end,h=e.r||c||d,c=e.innerR,d=W(f),i=da(f),j=W(g),k=da(g);if(g-f===0){return["x"];}f=["wa",a-h,b-h,a+h,b+h,a+h*d,b+h*i,a+h*j,b+h*k];e.open&&!c&&f.push("e",X,a,b);f.push("at",a-c,b-c,a+c,b+c,a+c*j,b+c*k,a+c*d,b+c*i,"x","e");f.isArc=!0;return f;},circle:function(a,b,c,d,e){e&&(c=d=2*e.r);e&&e.isCircle&&(a-=c/2,b-=d/2);return["wa",a,b,a+c,b+d,a+c,b+d/2,a+c,b+d/2,"e"];},rect:function(a,b,c,d,e){return Fa.prototype.symbols[!s(e)||!e.r?"square":"callout"].call(0,a,b,c,d,e);}}};u.VMLRenderer=P=function(){this.init.apply(this,arguments);};P.prototype=E(Fa.prototype,Eb);fb=P;}Fa.prototype.measureSpanWidth=function(a,b){var c=y.createElement("span"),d;d=y.createTextNode(a);c.appendChild(d);M(c,b);this.box.appendChild(c);d=c.offsetWidth;Va(c);return d;};var Qb;if(la){u.CanVGRenderer=P=function(){Ia="http://www.w3.org/1999/xhtml";},P.prototype.symbols={},Qb=function(){function a(){var a=b.length,d;for(d=0;d<a;d++){b[d]();}b=[];}var b=[];return{push:function(c,d){if(b.length===0){var e=y.getElementsByTagName("head")[0],f=y.createElement("script");f.type="text/javascript";f.src=d;f.onload=a;e.appendChild(f);}b.push(c);}};}(),fb=P;}Ya.prototype={addLabel:function(){var a=this.axis,b=a.options,c=a.chart,d=a.categories,e=a.names,f=this.pos,g=b.labels,h=a.tickPositions,i=f===h[0],j=f===h[h.length-1],e=d?p(d[f],e[f],f):f,d=this.label,h=h.info,k;a.isDatetimeAxis&&h&&(k=b.dateTimeLabelFormats[h.higherRanks[f]||h.unitName]);this.isFirst=i;this.isLast=j;b=a.labelFormatter.call({axis:a,chart:c,isFirst:i,isLast:j,dateTimeLabelFormat:k,value:a.isLog?$(a.lin2log(e)):e});s(d)?d&&d.attr({text:b}):(this.labelLength=(this.label=d=s(b)&&g.enabled?c.renderer.text(b,0,0,g.useHTML).css(E(g.style)).add(a.labelGroup):null)&&d.getBBox().width,this.rotation=0);},getLabelSize:function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0;},handleOverflow:function(a){var b=this.axis,c=a.x,d=b.chart.chartWidth,e=b.chart.spacing,f=p(b.labelLeft,F(b.pos,e[3])),e=p(b.labelRight,t(b.pos+b.len,d-e[1])),g=this.label,h=this.rotation,i={left:0,center:0.5,right:1}[b.labelAlign],j=g.getBBox().width,k=b.getSlotWidth(),l=k,m=1,n,o={};if(h){h<0&&c-i*j<f?n=C(c/W(h*ka)-f):h>0&&c+i*j>e&&(n=C((d-c)/W(h*ka)));}else{if(d=c+(1-i)*j,c-i*j<f?l=a.x+l*(1-i)-f:d>e&&(l=e-a.x+l*i,m=-1),l=F(k,l),l<k&&b.labelAlign==="center"&&(a.x+=m*(k-l-i*(k-F(j,l)))),j>l||b.autoRotation&&g.styles.width){n=l;}}if(n){o.width=n;if(!b.options.labels.style.textOverflow){o.textOverflow="ellipsis";}g.css(o);}},getPosition:function(a,b,c,d){var e=this.axis,f=e.chart,g=d&&f.oldChartHeight||f.chartHeight;return{x:a?e.translate(b+c,null,null,d)+e.transB:e.left+e.offset+(e.opposite?(d&&f.oldChartWidth||f.chartWidth)-e.right-e.left:0),y:a?g-e.bottom+e.offset-(e.opposite?e.height:0):g-e.translate(b+c,null,null,d)-e.transB};},getLabelPosition:function(a,b,c,d,e,f,g,h){var i=this.axis,j=i.transA,k=i.reversed,l=i.staggerLines,m=i.tickRotCorr||{x:0,y:0},n=e.y;s(n)||(n=i.side===0?c.rotation?-8:-c.getBBox().height:i.side===2?m.y+8:W(c.rotation*ka)*(m.y-c.getBBox(!1,0).height/2));a=a+e.x+m.x-(f&&d?f*j*(k?-1:1):0);b=b+n-(f&&!d?f*j*(k?1:-1):0);l&&(c=g/(h||1)%l,i.opposite&&(c=l-c-1),b+=c*(i.labelOffset/l));return{x:a,y:C(b)};},getMarkPath:function(a,b,c,d,e,f){return f.crispLine([X,a,b,S,a+(e?0:-c),b+(e?c:0)],d);},render:function(a,b,c){var d=this.axis,e=d.options,f=d.chart.renderer,g=d.horiz,h=this.type,i=this.label,j=this.pos,k=e.labels,l=this.gridLine,m=h?h+"Grid":"grid",n=h?h+"Tick":"tick",o=e[m+"LineWidth"],A=e[m+"LineColor"],r=e[m+"LineDashStyle"],m=d.tickSize(n),n=e[n+"Color"],q=this.mark,w=k.step,v=!0,s=d.tickmarkOffset,t=this.getPosition(g,j,s,b),aa=t.x,t=t.y,x=g&&aa===d.pos+d.len||!g&&t===d.pos?-1:1,c=p(c,1);this.isActive=!0;if(o){j=d.getPlotLinePath(j+s,o*x,b,!0);if(l===z){l={stroke:A,"stroke-width":o};if(r){l.dashstyle=r;}if(!h){l.zIndex=1;}if(b){l.opacity=0;}this.gridLine=l=o?f.path(j).attr(l).add(d.gridGroup):null;}if(!b&&l&&j){l[this.isNew?"attr":"animate"]({d:j,opacity:c});}}if(m){d.opposite&&(m[0]=-m[0]),h=this.getMarkPath(aa,t,m[0],m[1]*x,g,f),q?q.animate({d:h,opacity:c}):this.mark=f.path(h).attr({stroke:n,"stroke-width":m[1],opacity:c}).add(d.axisGroup);}if(i&&I(aa)){i.xy=t=this.getLabelPosition(aa,t,i,g,k,s,a,w),this.isFirst&&!this.isLast&&!p(e.showFirstLabel,1)||this.isLast&&!this.isFirst&&!p(e.showLastLabel,1)?v=!1:g&&!d.isRadial&&!k.step&&!k.rotation&&!b&&c!==0&&this.handleOverflow(t),w&&a%w&&(v=!1),v&&I(t.y)?(t.opacity=c,i[this.isNew?"attr":"animate"](t)):(Ka(i),i.attr("y",-9999)),this.isNew=!1;}},destroy:function(){Ua(this,this.axis);}};u.PlotLineOrBand=function(a,b){this.axis=a;if(b){this.options=b,this.id=b.id;}};u.PlotLineOrBand.prototype={render:function(){var a=this,b=a.axis,c=b.horiz,d=a.options,e=d.label,f=a.label,g=d.width,h=d.to,i=d.from,j=s(i)&&s(h),k=d.value,l=d.dashStyle,m=a.svgElem,n=[],o,A=d.color,r=p(d.zIndex,0),q=d.events,w={},v=b.chart.renderer,n=b.log2lin;b.isLog&&(i=n(i),h=n(h),k=n(k));if(g){if(n=b.getPlotLinePath(k,g),w={stroke:A,"stroke-width":g},l){w.dashstyle=l;}}else{if(j){n=b.getPlotBandPath(i,h,d);if(A){w.fill=A;}if(d.borderWidth){w.stroke=d.borderColor,w["stroke-width"]=d.borderWidth;}}else{return;}}w.zIndex=r;if(m){if(n){m.show(),m.animate({d:n});}else{if(m.hide(),f){a.label=f=f.destroy();}}}else{if(n&&n.length&&(a.svgElem=m=v.path(n).attr(w).add(),q)){for(o in d=function(b){m.on(b,function(c){q[b].apply(a,[c]);});},q){d(o);}}}e&&s(e.text)&&n&&n.length&&b.width>0&&b.height>0&&!n.flat?(e=E({align:c&&j&&"center",x:c?!j&&4:10,verticalAlign:!c&&j&&"middle",y:c?j?16:10:j?6:-4,rotation:c&&!j&&90},e),this.renderLabel(e,n,j,r)):f&&f.hide();return a;},renderLabel:function(a,b,c,d){var e=this.label,f=this.axis.chart.renderer;if(!e){e={align:a.textAlign||a.align,rotation:a.rotation},e.zIndex=d,this.label=e=f.text(a.text,0,0,a.useHTML).attr(e).css(a.style).add();}d=[b[1],b[4],c?b[6]:b[1]];b=[b[2],b[5],c?b[7]:b[2]];c=Oa(d);f=Oa(b);e.align(a,!1,{x:c,y:f,width:Ha(d)-c,height:Ha(b)-f});e.show();},destroy:function(){ra(this.axis.plotLinesAndBands,this);delete this.axis;Ua(this);}};var ia=u.Axis=function(){this.init.apply(this,arguments);};ia.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#D8D8D8",labels:{enabled:!0,style:{color:"#606060",cursor:"default",fontSize:"11px"},x:0},lineColor:"#C0D0E0",lineWidth:1,minPadding:0.01,maxPadding:0.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",title:{align:"middle",style:{color:"#707070"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},lineWidth:0,maxPadding:0.05,minPadding:0.05,startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return u.numberFormat(this.total,-1);},style:E(ga.line.dataLabels.style,{color:"#000000"})}},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},init:function(a,b){var c=b.isX;this.chart=a;this.horiz=a.inverted?!c:c;this.isXAxis=c;this.coll=this.coll||(c?"xAxis":"yAxis");this.opposite=b.opposite;this.side=b.side||(this.horiz?this.opposite?0:2:this.opposite?1:3);this.setOptions(b);var d=this.options,e=d.type;this.labelFormatter=d.labels.formatter||this.defaultLabelFormatter;this.userOptions=b;this.minPixelPadding=0;this.reversed=d.reversed;this.visible=d.visible!==!1;this.zoomEnabled=d.zoomEnabled!==!1;this.hasNames=e==="category"||d.categories===!0;this.categories=d.categories||this.hasNames;this.names=this.names||[];this.isLog=e==="logarithmic";this.isDatetimeAxis=e==="datetime";this.isLinked=s(d.linkedTo);this.ticks={};this.labelEdge=[];this.minorTicks={};this.plotLinesAndBands=[];this.alternateBands={};this.len=0;this.minRange=this.userMinRange=d.minRange||d.maxZoom;this.range=d.range;this.offset=d.offset||0;this.stacks={};this.oldStacks={};this.stacksTouched=0;this.min=this.max=null;this.crosshair=p(d.crosshair,ua(a.options.tooltip.crosshairs)[c?0:1],!1);var f,d=this.options.events;pa(this,a.axes)===-1&&(c?a.axes.splice(a.xAxis.length,0,this):a.axes.push(this),a[this.coll].push(this));this.series=this.series||[];if(a.inverted&&c&&this.reversed===z){this.reversed=!0;}this.removePlotLine=this.removePlotBand=this.removePlotBandOrLine;for(f in d){N(this,f,d[f]);}if(this.isLog){this.val2lin=this.log2lin,this.lin2val=this.lin2log;}},setOptions:function(a){this.options=E(this.defaultOptions,this.coll==="yAxis"&&this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],E(T[this.coll],a));},defaultLabelFormatter:function(){var a=this.axis,b=this.value,c=a.categories,d=this.dateTimeLabelFormat,e=T.lang.numericSymbols,f=e&&e.length,g,h=a.options.labels.format,a=a.isLog?b:a.tickInterval;if(h){g=Na(h,this);}else{if(c){g=b;}else{if(d){g=Ta(d,b);}else{if(f&&a>=1000){for(;f--&&g===z;){c=Math.pow(1000,f+1),a>=c&&b*10%c===0&&e[f]!==null&&b!==0&&(g=u.numberFormat(b/c,-1)+e[f]);}}}}}g===z&&(g=Q(b)>=10000?u.numberFormat(b,-1):u.numberFormat(b,-1,z,""));return g;},getSeriesExtremes:function(){var a=this,b=a.chart;a.hasVisibleSeries=!1;a.dataMin=a.dataMax=a.threshold=null;a.softThreshold=!a.isXAxis;a.buildStacks&&a.buildStacks();q(a.series,function(c){if(c.visible||!b.options.chart.ignoreHiddenSeries){var d=c.options,e=d.threshold,f;a.hasVisibleSeries=!0;a.isLog&&e<=0&&(e=null);if(a.isXAxis){if(d=c.xData,d.length){c=Oa(d),!I(c)&&!(c instanceof ma)&&(d=Da(d,function(a){return I(a);}),c=Oa(d)),a.dataMin=F(p(a.dataMin,d[0]),c),a.dataMax=t(p(a.dataMax,d[0]),Ha(d));}}else{c.getExtremes();f=c.dataMax;c=c.dataMin;if(s(c)&&s(f)){a.dataMin=F(p(a.dataMin,c),c),a.dataMax=t(p(a.dataMax,f),f);}if(s(e)){a.threshold=e;}if(!d.softThreshold||a.isLog){a.softThreshold=!1;}}}});},translate:function(a,b,c,d,e,f){var g=this.linkedParent||this,h=1,i=0,j=d?g.oldTransA:g.transA,d=d?g.oldMin:g.min,k=g.minPixelPadding,e=(g.isOrdinal||g.isBroken||g.isLog&&e)&&g.lin2val;if(!j){j=g.transA;}if(c){h*=-1,i=g.len;}g.reversed&&(h*=-1,i-=h*(g.sector||g.len));b?(a=a*h+i,a-=k,a=a/j+d,e&&(a=g.lin2val(a))):(e&&(a=g.val2lin(a)),f==="between"&&(f=0.5),a=h*(a-d)*j+i+h*k+(I(f)?j*f*g.pointRange:0));return a;},toPixels:function(a,b){return this.translate(a,!1,!this.horiz,null,!0)+(b?0:this.pos);},toValue:function(a,b){return this.translate(a-(b?0:this.pos),!0,!this.horiz,null,!0);},getPlotLinePath:function(a,b,c,d,e){var f=this.chart,g=this.left,h=this.top,i,j,k=c&&f.oldChartHeight||f.chartHeight,l=c&&f.oldChartWidth||f.chartWidth,m;i=this.transB;var n=function(a,b,c){if(a<b||a>c){d?a=F(t(b,a),c):m=!0;}return a;},e=p(e,this.translate(a,null,null,c)),a=c=C(e+i);i=j=C(k-e-i);I(e)?this.horiz?(i=h,j=k-this.bottom,a=c=n(a,g,g+this.width)):(a=g,c=l-this.right,i=j=n(i,h,h+this.height)):m=!0;return m&&!d?null:f.renderer.crispLine([X,a,i,S,c,j],b||1);},getLinearTickPositions:function(a,b,c){var d,e=$(V(b/a)*a),f=$(va(c/a)*a),g=[];if(b===c&&I(b)){return[b];}for(b=e;b<=f;){g.push(b);b=$(b+a);if(b===d){break;}d=b;}return g;},getMinorTickPositions:function(){var a=this.options,b=this.tickPositions,c=this.minorTickInterval,d=[],e,f=this.pointRangePadding||0;e=this.min-f;var f=this.max+f,g=f-e;if(g&&g/c<this.len/3){if(this.isLog){f=b.length;for(e=1;e<f;e++){d=d.concat(this.getLogTickPositions(c,b[e-1],b[e],!0));}}else{if(this.isDatetimeAxis&&a.minorTickInterval==="auto"){d=d.concat(this.getTimeTicks(this.normalizeTimeTickInterval(c),e,f,a.startOfWeek));}else{for(b=e+(b[0]-e)%c;b<=f;b+=c){d.push(b);}}}}d.length!==0&&this.trimTicks(d,a.startOnTick,a.endOnTick);return d;},adjustForMinRange:function(){var a=this.options,b=this.min,c=this.max,d,e=this.dataMax-this.dataMin>=this.minRange,f,g,h,i,j,k;if(this.isXAxis&&this.minRange===z&&!this.isLog){s(a.min)||s(a.max)?this.minRange=null:(q(this.series,function(a){i=a.xData;for(g=j=a.xIncrement?1:i.length-1;g>0;g--){if(h=i[g]-i[g-1],f===z||h<f){f=h;}}}),this.minRange=F(f*5,this.dataMax-this.dataMin));}if(c-b<this.minRange){k=this.minRange,d=(k-c+b)/2,d=[b-d,p(a.min,b-d)],e&&(d[2]=this.isLog?this.log2lin(this.dataMin):this.dataMin),b=Ha(d),c=[b+k,p(a.max,b+k)],e&&(c[2]=this.isLog?this.log2lin(this.dataMax):this.dataMax),c=Oa(c),c-b<k&&(d[0]=c-k,d[1]=p(a.min,c-k),b=Ha(d));}this.min=b;this.max=c;},getClosest:function(){var a;this.categories?a=1:q(this.series,function(b){var c=b.closestPointRange;!b.noSharedTooltip&&s(c)&&(a=s(a)?F(a,c):c);});return a;},nameToX:function(a){var b=za(this.categories),c=b?this.categories:this.names,d=a.options.x,e;a.series.requireSorting=!1;s(d)||(d=this.options.nameToX===!1?a.series.autoIncrement():pa(a.name,c));if(d===-1){if(!b){e=c.length;}}else{e=d;}this.names[e]=a.name;return e;},updateNames:function(){var a=this;if(this.names.length>0){this.names.length=0,this.minRange=void 0,q(this.series||[],function(b){b.processedXData||(b.processData(),b.generatePoints());q(b.points,function(c,d){var e;if(c.options&&c.options.x===void 0&&(e=a.nameToX(c),e!==c.x)){c.x=e,b.xData[d]=e;}});});}},setAxisTranslation:function(a){var b=this,c=b.max-b.min,d=b.axisPointRange||0,e,f=0,g=0,h=b.linkedParent,i=!!b.categories,j=b.transA,k=b.isXAxis;if(k||i||d){if(h?(f=h.minPointOffset,g=h.pointRangePadding):(e=b.getClosest(),q(b.series,function(a){var c=i?1:k?p(a.options.pointRange,e,0):b.axisPointRange||0,a=a.options.pointPlacement;d=t(d,c);b.single||(f=t(f,ya(a)?0:c/2),g=t(g,a==="on"?0:c));})),h=b.ordinalSlope&&e?b.ordinalSlope/e:1,b.minPointOffset=f*=h,b.pointRangePadding=g*=h,b.pointRange=F(d,c),k){b.closestPointRange=e;}}if(a){b.oldTransA=j;}b.translationSlope=b.transA=j=b.len/(c+g||1);b.transB=b.horiz?b.left:b.bottom;b.minPixelPadding=j*f;},minFromRange:function(){return this.max-this.range;},setTickInterval:function(a){var b=this,c=b.chart,d=b.options,e=b.isLog,f=b.log2lin,g=b.isDatetimeAxis,h=b.isXAxis,i=b.isLinked,j=d.maxPadding,k=d.minPadding,l=d.tickInterval,m=d.tickPixelInterval,n=b.categories,o=b.threshold,A=b.softThreshold,r,K,w,v;!g&&!n&&!i&&this.getTickAmount();w=p(b.userMin,d.min);v=p(b.userMax,d.max);i?(b.linkedParent=c[b.coll][d.linkedTo],c=b.linkedParent.getExtremes(),b.min=p(c.min,c.dataMin),b.max=p(c.max,c.dataMax),d.type!==b.linkedParent.options.type&&ea(11,1)):(!A&&s(o)&&(b.dataMin>=o?(r=o,k=0):b.dataMax<=o&&(K=o,j=0)),b.min=p(w,r,b.dataMin),b.max=p(v,K,b.dataMax));if(e){!a&&F(b.min,p(b.dataMin,b.min))<=0&&ea(10,1),b.min=$(f(b.min),15),b.max=$(f(b.max),15);}if(b.range&&s(b.max)){b.userMin=b.min=w=t(b.min,b.minFromRange()),b.userMax=v=b.max,b.range=null;}H(b,"foundExtremes");b.beforePadding&&b.beforePadding();b.adjustForMinRange();if(!n&&!b.axisPointRange&&!b.usePercentage&&!i&&s(b.min)&&s(b.max)&&(f=b.max-b.min)){!s(w)&&k&&(b.min-=f*k),!s(v)&&j&&(b.max+=f*j);}if(I(d.floor)){b.min=t(b.min,d.floor);}if(I(d.ceiling)){b.max=F(b.max,d.ceiling);}if(A&&s(b.dataMin)){if(o=o||0,!s(w)&&b.min<o&&b.dataMin>=o){b.min=o;}else{if(!s(v)&&b.max>o&&b.dataMax<=o){b.max=o;}}}b.tickInterval=b.min===b.max||b.min===void 0||b.max===void 0?1:i&&!l&&m===b.linkedParent.options.tickPixelInterval?l=b.linkedParent.tickInterval:p(l,this.tickAmount?(b.max-b.min)/t(this.tickAmount-1,1):void 0,n?1:(b.max-b.min)*m/t(b.len,m));h&&!a&&q(b.series,function(a){a.processData(b.min!==b.oldMin||b.max!==b.oldMax);});b.setAxisTranslation(!0);b.beforeSetTickPositions&&b.beforeSetTickPositions();if(b.postProcessTickInterval){b.tickInterval=b.postProcessTickInterval(b.tickInterval);}if(b.pointRange&&!l){b.tickInterval=t(b.pointRange,b.tickInterval);}a=p(d.minTickInterval,b.isDatetimeAxis&&b.closestPointRange);if(!l&&b.tickInterval<a){b.tickInterval=a;}if(!g&&!e&&!l){b.tickInterval=wb(b.tickInterval,null,vb(b.tickInterval),p(d.allowDecimals,!(b.tickInterval>0.5&&b.tickInterval<5&&b.max>1000&&b.max<9999)),!!this.tickAmount);}if(!this.tickAmount){b.tickInterval=b.unsquish();}this.setTickPositions();},setTickPositions:function(){var a=this.options,b,c=a.tickPositions,d=a.tickPositioner,e=a.startOnTick,f=a.endOnTick,g;this.tickmarkOffset=this.categories&&a.tickmarkPlacement==="between"&&this.tickInterval===1?0.5:0;this.minorTickInterval=a.minorTickInterval==="auto"&&this.tickInterval?this.tickInterval/5:a.minorTickInterval;this.tickPositions=b=c&&c.slice();if(!b&&(b=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,a.units),this.min,this.max,a.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),b.length>this.len&&(b=[b[0],b.pop()]),this.tickPositions=b,d&&(d=d.apply(this,[this.min,this.max])))){this.tickPositions=b=d;}if(!this.isLinked){this.trimTicks(b,e,f),this.min===this.max&&s(this.min)&&!this.tickAmount&&(g=!0,this.min-=0.5,this.max+=0.5),this.single=g,!c&&!d&&this.adjustTickAmount();}},trimTicks:function(a,b,c){var d=a[0],e=a[a.length-1],f=this.minPointOffset||0;if(b){this.min=d;}else{for(;this.min-f>a[0];){a.shift();}}if(c){this.max=e;}else{for(;this.max+f<a[a.length-1];){a.pop();}}a.length===0&&s(d)&&a.push((e+d)/2);},alignToOthers:function(){var a={},b,c=this.options;this.chart.options.chart.alignTicks!==!1&&c.alignTicks!==!1&&q(this.chart[this.coll],function(c){var e=c.options,e=[c.horiz?e.left:e.top,e.width,e.height,e.pane].join(",");c.series.length&&(a[e]?b=!0:a[e]=1);});return b;},getTickAmount:function(){var a=this.options,b=a.tickAmount,c=a.tickPixelInterval;!s(a.tickInterval)&&this.len<c&&!this.isRadial&&!this.isLog&&a.startOnTick&&a.endOnTick&&(b=2);!b&&this.alignToOthers()&&(b=va(this.len/c)+1);if(b<4){this.finalTickAmt=b,b=5;}this.tickAmount=b;},adjustTickAmount:function(){var a=this.tickInterval,b=this.tickPositions,c=this.tickAmount,d=this.finalTickAmt,e=b&&b.length;if(e<c){for(;b.length<c;){b.push($(b[b.length-1]+a));}this.transA*=(e-1)/(c-1);this.max=b[b.length-1];}else{e>c&&(this.tickInterval*=2,this.setTickPositions());}if(s(d)){for(a=c=b.length;a--;){(d===3&&a%2===1||d<=2&&a>0&&a<c-1)&&b.splice(a,1);}this.finalTickAmt=z;}},setScale:function(){var a,b;this.oldMin=this.min;this.oldMax=this.max;this.oldAxisLength=this.len;this.setAxisSize();b=this.len!==this.oldAxisLength;q(this.series,function(b){if(b.isDirtyData||b.isDirty||b.xAxis.isDirty){a=!0;}});if(b||a||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax||this.alignToOthers()){if(this.resetStacks&&this.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,!this.isDirty){this.isDirty=b||this.min!==this.oldMin||this.max!==this.oldMax;}}else{this.cleanStacks&&this.cleanStacks();}},setExtremes:function(a,b,c,d,e){var f=this,g=f.chart,c=p(c,!0);q(f.series,function(a){delete a.kdTree;});e=x(e,{min:a,max:b});H(f,"setExtremes",e,function(){f.userMin=a;f.userMax=b;f.eventArgs=e;c&&g.redraw(d);});},zoom:function(a,b){var c=this.dataMin,d=this.dataMax,e=this.options,f=F(c,p(e.min,c)),e=t(d,p(e.max,d));this.allowZoomOutside||(s(c)&&a<=f&&(a=f),s(d)&&b>=e&&(b=e));this.displayBtn=a!==z||b!==z;this.setExtremes(a,b,!1,z,{trigger:"zoom"});return !0;},setAxisSize:function(){var a=this.chart,b=this.options,c=b.offsetLeft||0,d=this.horiz,e=p(b.width,a.plotWidth-c+(b.offsetRight||0)),f=p(b.height,a.plotHeight),g=p(b.top,a.plotTop),b=p(b.left,a.plotLeft+c),c=/%$/;c.test(f)&&(f=Math.round(parseFloat(f)/100*a.plotHeight));c.test(g)&&(g=Math.round(parseFloat(g)/100*a.plotHeight+a.plotTop));this.left=b;this.top=g;this.width=e;this.height=f;this.bottom=a.chartHeight-f-g;this.right=a.chartWidth-e-b;this.len=t(d?e:f,0);this.pos=d?b:g;},getExtremes:function(){var a=this.isLog,b=this.lin2log;return{min:a?$(b(this.min)):this.min,max:a?$(b(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax};},getThreshold:function(a){var b=this.isLog,c=this.lin2log,d=b?c(this.min):this.min,b=b?c(this.max):this.max;a===null?a=d:d>a?a=d:b<a&&(a=b);return this.translate(a,0,1,0,1);},autoLabelAlign:function(a){a=(p(a,0)-this.side*90+720)%360;return a>15&&a<165?"right":a>195&&a<345?"left":"center";},tickSize:function(a){var b=this.options,c=b[a+"Length"],d=p(b[a+"Width"],a==="tick"&&this.isXAxis?1:0);if(d&&c){return b[a+"Position"]==="inside"&&(c=-c),[c,d];}},labelMetrics:function(){return this.chart.renderer.fontMetrics(this.options.labels.style.fontSize,this.ticks[0]&&this.ticks[0].label);},unsquish:function(){var a=this.options.labels,b=this.horiz,c=this.tickInterval,d=c,e=this.len/(((this.categories?1:0)+this.max-this.min)/c),f,g=a.rotation,h=this.labelMetrics(),i,j=Number.MAX_VALUE,k,l=function(a){a/=e||1;a=a>1?va(a):1;return a*c;};b?(k=!a.staggerLines&&!a.step&&(s(g)?[g]:e<p(a.autoRotationLimit,80)&&a.autoRotation))&&q(k,function(a){var b;if(a===g||a&&a>=-90&&a<=90){i=l(Q(h.h/da(ka*a))),b=i+Q(a/360),b<j&&(j=b,f=a,d=i);}}):a.step||(d=l(h.h));this.autoRotation=k;this.labelRotation=p(f,g);return d;},getSlotWidth:function(){var a=this.chart,b=this.horiz,c=this.options.labels,d=Math.max(this.tickPositions.length-(this.categories?0:1),1),e=a.margin[3];return b&&(c.step||0)<2&&!c.rotation&&(this.staggerLines||1)*a.plotWidth/d||!b&&(e&&e-a.spacing[3]||a.chartWidth*0.33);},renderUnsquish:function(){var a=this.chart,b=a.renderer,c=this.tickPositions,d=this.ticks,e=this.options.labels,f=this.horiz,g=this.getSlotWidth(),h=t(1,C(g-2*(e.padding||5))),i={},j=this.labelMetrics(),k=e.style.textOverflow,l,m=0,n,o;if(!ya(e.rotation)){i.rotation=e.rotation||0;}q(c,function(a){if((a=d[a])&&a.labelLength>m){m=a.labelLength;}});this.maxLabelLength=m;if(this.autoRotation){m>h&&m>j.h?i.rotation=this.labelRotation:this.labelRotation=0;}else{if(g&&(l={width:h+"px"},!k)){l.textOverflow="clip";for(n=c.length;!f&&n--;){if(o=c[n],h=d[o].label){if(h.styles.textOverflow==="ellipsis"?h.css({textOverflow:"clip"}):d[o].labelLength>g&&h.css({width:g+"px"}),h.getBBox().height>this.len/c.length-(j.h-j.f)){h.specCss={textOverflow:"ellipsis"};}}}}}if(i.rotation&&(l={width:(m>a.chartHeight*0.5?a.chartHeight*0.33:a.chartHeight)+"px"},!k)){l.textOverflow="ellipsis";}if(this.labelAlign=e.align||this.autoLabelAlign(this.labelRotation)){i.align=this.labelAlign;}q(c,function(a){var b=(a=d[a])&&a.label;if(b){b.attr(i),l&&b.css(E(l,b.specCss)),delete b.specCss,a.rotation=i.rotation;}});this.tickRotCorr=b.rotCorr(j.b,this.labelRotation||0,this.side!==0);},hasData:function(){return this.hasVisibleSeries||s(this.min)&&s(this.max)&&!!this.tickPositions;},getOffset:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.tickPositions,f=a.ticks,g=a.horiz,h=a.side,i=b.inverted?[1,0,3,2][h]:h,j,k,l=0,m,n=0,o=d.title,A=d.labels,r=0,K=a.opposite,w=b.axisOffset,b=b.clipOffset,v=[-1,1,1,-1][h],x,u=a.axisParent,aa=this.tickSize("tick");j=a.hasData();a.showAxis=k=j||p(d.showEmpty,!0);a.staggerLines=a.horiz&&A.staggerLines;if(!a.axisGroup){a.gridGroup=c.g("grid").attr({zIndex:d.gridZIndex||1}).add(u),a.axisGroup=c.g("axis").attr({zIndex:d.zIndex||2}).add(u),a.labelGroup=c.g("axis-labels").attr({zIndex:A.zIndex||7}).addClass("highcharts-"+a.coll.toLowerCase()+"-labels").add(u);}if(j||a.isLinked){if(q(e,function(b){f[b]?f[b].addLabel():f[b]=new Ya(a,b);}),a.renderUnsquish(),A.reserveSpace!==!1&&(h===0||h===2||{1:"left",3:"right"}[h]===a.labelAlign||a.labelAlign==="center")&&q(e,function(a){r=t(f[a].getLabelSize(),r);}),a.staggerLines){r*=a.staggerLines,a.labelOffset=r*(a.opposite?-1:1);}}else{for(x in f){f[x].destroy(),delete f[x];}}if(o&&o.text&&o.enabled!==!1){if(!a.axisTitle){(x=o.textAlign)||(x=(g?{low:"left",middle:"center",high:"right"}:{low:K?"right":"left",middle:"center",high:K?"left":"right"})[o.align]),a.axisTitle=c.text(o.text,0,0,o.useHTML).attr({zIndex:7,rotation:o.rotation||0,align:x}).addClass("highcharts-"+this.coll.toLowerCase()+"-title").css(o.style).add(a.axisGroup),a.axisTitle.isNew=!0;}if(k){l=a.axisTitle.getBBox()[g?"height":"width"],m=o.offset,n=s(m)?0:p(o.margin,g?5:10);}a.axisTitle[k?"show":"hide"](!0);}a.offset=v*p(d.offset,w[h]);a.tickRotCorr=a.tickRotCorr||{x:0,y:0};c=h===0?-a.labelMetrics().h:h===2?a.tickRotCorr.y:0;n=Math.abs(r)+n;r&&(n-=c,n+=v*(g?p(A.y,a.tickRotCorr.y+v*8):A.x));a.axisTitleMargin=p(m,n);w[h]=t(w[h],a.axisTitleMargin+l+v*a.offset,n,j&&e.length&&aa?aa[0]:0);d=d.offset?0:V(d.lineWidth/2)*2;b[i]=t(b[i],d);},getLinePath:function(a){var b=this.chart,c=this.opposite,d=this.offset,e=this.horiz,f=this.left+(c?this.width:0)+d,d=b.chartHeight-this.bottom-(c?this.height:0)+d;c&&(a*=-1);return b.renderer.crispLine([X,e?this.left:f,e?d:this.top,S,e?b.chartWidth-this.right:f,e?d:b.chartHeight-this.bottom],a);},getTitlePosition:function(){var a=this.horiz,b=this.left,c=this.top,d=this.len,e=this.options.title,f=a?b:c,g=this.opposite,h=this.offset,i=e.x||0,j=e.y||0,k=this.chart.renderer.fontMetrics(e.style.fontSize).f,d={low:f+(a?0:d),middle:f+d/2,high:f+(a?d:0)}[e.align],b=(a?c+this.height:b)+(a?1:-1)*(g?-1:1)*this.axisTitleMargin+(this.side===2?k:0);return{x:a?d+i:b+(g?this.width:0)+h+i,y:a?b+j-(g?this.height:0)+h:d+j};},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.isLog,f=a.lin2log,g=a.isLinked,h=a.tickPositions,i=a.axisTitle,j=a.ticks,k=a.minorTicks,l=a.alternateBands,m=d.stackLabels,n=d.alternateGridColor,o=a.tickmarkOffset,A=d.lineWidth,r,p=b.hasRendered&&I(a.oldMin),w=a.showAxis,v=Wa(c.globalAnimation),s,t;a.labelEdge.length=0;a.overlap=!1;q([j,k,l],function(a){for(var b in a){a[b].isActive=!1;}});if(a.hasData()||g){a.minorTickInterval&&!a.categories&&q(a.getMinorTickPositions(),function(b){k[b]||(k[b]=new Ya(a,b,"minor"));p&&k[b].isNew&&k[b].render(null,!0);k[b].render(null,!1,1);});if(h.length&&(q(h,function(b,c){if(!g||b>=a.min&&b<=a.max){j[b]||(j[b]=new Ya(a,b)),p&&j[b].isNew&&j[b].render(c,!0,0.1),j[b].render(c);}}),o&&(a.min===0||a.single))){j[-1]||(j[-1]=new Ya(a,-1,null,!0)),j[-1].render(-1);}n&&q(h,function(c,d){t=h[d+1]!==z?h[d+1]+o:a.max-o;if(d%2===0&&c<a.max&&t<=a.max+(b.polar?-o:o)){l[c]||(l[c]=new u.PlotLineOrBand(a)),s=c+o,l[c].options={from:e?f(s):s,to:e?f(t):t,color:n},l[c].render(),l[c].isActive=!0;}});if(!a._addedPlotLB){q((d.plotLines||[]).concat(d.plotBands||[]),function(b){a.addPlotBandOrLine(b);}),a._addedPlotLB=!0;}}q([j,k,l],function(a){var c,d,e=[],f=v.duration;for(c in a){if(!a[c].isActive){a[c].render(c,!1,0),a[c].isActive=!1,e.push(c);}}Sa(function(){for(d=e.length;d--;){a[e[d]]&&!a[e[d]].isActive&&(a[e[d]].destroy(),delete a[e[d]]);}},a===l||!b.hasRendered||!f?0:f);});if(A){r=a.getLinePath(A),a.axisLine?a.axisLine.animate({d:r}):a.axisLine=c.path(r).attr({stroke:d.lineColor,"stroke-width":A,zIndex:7}).add(a.axisGroup),a.axisLine[w?"show":"hide"](!0);}if(i&&w){i[i.isNew?"attr":"animate"](a.getTitlePosition()),i.isNew=!1;}m&&m.enabled&&a.renderStackTotals();a.isDirty=!1;},redraw:function(){this.visible&&(this.render(),q(this.plotLinesAndBands,function(a){a.render();}));q(this.series,function(a){a.isDirty=!0;});},destroy:function(a){var b=this,c=b.stacks,d,e=b.plotLinesAndBands;a||Y(b);for(d in c){Ua(c[d]),c[d]=null;}q([b.ticks,b.minorTicks,b.alternateBands],function(a){Ua(a);});for(a=e.length;a--;){e[a].destroy();}q("stackTotalGroup,axisLine,axisTitle,axisGroup,gridGroup,labelGroup,cross".split(","),function(a){b[a]&&(b[a]=b[a].destroy());});this._addedPlotLB=this.chart._labelPanes=this.ordinalSlope=void 0;},drawCrosshair:function(a,b){var c,d=this.crosshair,e,f;a||(a=this.cross&&this.cross.e);if(!this.crosshair||(s(b)||!p(d.snap,!0))===!1){this.hideCrosshair();}else{if(p(d.snap,!0)?s(b)&&(c=this.isXAxis?b.plotX:this.len-b.plotY):c=this.horiz?a.chartX-this.pos:this.len-a.chartY+this.pos,c=this.isRadial?this.getPlotLinePath(this.isXAxis?b.x:p(b.stackY,b.y))||null:this.getPlotLinePath(null,null,null,null,c)||null,c===null){this.hideCrosshair();}else{e=this.categories&&!this.isRadial;f=p(d.width,e?this.transA:1);if(this.cross){this.cross.attr({d:c,visibility:"visible","stroke-width":f});}else{e={"pointer-events":"none","stroke-width":f,stroke:d.color||(e?"rgba(155,200,255,0.2)":"#C0C0C0"),zIndex:p(d.zIndex,2)};if(d.dashStyle){e.dashstyle=d.dashStyle;}this.cross=this.chart.renderer.path(c).attr(e).add();}this.cross.e=a;}}},hideCrosshair:function(){this.cross&&this.cross.hide();}};x(ia.prototype,{getPlotBandPath:function(a,b){var c=this.getPlotLinePath(b,null,null,!0),d=this.getPlotLinePath(a,null,null,!0);d&&c?(d.flat=d.toString()===c.toString(),d.push(c[4],c[5],c[1],c[2])):d=null;return d;},addPlotBand:function(a){return this.addPlotBandOrLine(a,"plotBands");},addPlotLine:function(a){return this.addPlotBandOrLine(a,"plotLines");},addPlotBandOrLine:function(a,b){var c=(new u.PlotLineOrBand(this,a)).render(),d=this.userOptions;c&&(b&&(d[b]=d[b]||[],d[b].push(a)),this.plotLinesAndBands.push(c));return c;},removePlotBandOrLine:function(a){for(var b=this.plotLinesAndBands,c=this.options,d=this.userOptions,e=b.length;e--;){b[e].id===a&&b[e].destroy();}q([c.plotLines||[],d.plotLines||[],c.plotBands||[],d.plotBands||[]],function(b){for(e=b.length;e--;){b[e].id===a&&ra(b,b[e]);}});}});ia.prototype.getTimeTicks=function(a,b,c,d){var e=[],f={},g=T.global.useUTC,h,i=new ma(b-ab(b)),j=a.unitRange,k=a.count;if(s(b)){i[Ib](j>=G.second?0:k*V(i.getMilliseconds()/k));if(j>=G.second){i[Jb](j>=G.minute?0:k*V(i.getSeconds()/k));}if(j>=G.minute){i[Kb](j>=G.hour?0:k*V(i[xb]()/k));}if(j>=G.hour){i[Lb](j>=G.day?0:k*V(i[yb]()/k));}if(j>=G.day){i[nb](j>=G.month?1:k*V(i[Xa]()/k));}j>=G.month&&(i[Ab](j>=G.year?0:k*V(i[db]()/k)),h=i[eb]());j>=G.year&&(h-=h%k,i[Bb](h));if(j===G.week){i[nb](i[Xa]()-i[zb]()+p(d,1));}b=1;if(ub||bb){i=i.getTime(),i=new ma(i+ab(i));}h=i[eb]();for(var d=i.getTime(),l=i[db](),m=i[Xa](),n=!g||!!bb,o=(G.day+(g?ab(i):i.getTimezoneOffset()*60000))%G.day;d<c;){e.push(d),j===G.year?d=mb(h+b*k,0):j===G.month?d=mb(h,l+b*k):n&&(j===G.day||j===G.week)?d=mb(h,l,m+b*k*(j===G.day?1:7)):d+=j*k,b++;}e.push(d);q(Da(e,function(a){return j<=G.hour&&a%G.day===o;}),function(a){f[a]="day";});}e.info=x(a,{higherRanks:f,totalRange:j*k});return e;};ia.prototype.normalizeTimeTickInterval=function(a,b){var c=b||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],d=c[c.length-1],e=G[d[0]],f=d[1],g;for(g=0;g<c.length;g++){if(d=c[g],e=G[d[0]],f=d[1],c[g+1]&&a<=(e*f[f.length-1]+G[c[g+1][0]])/2){break;}}e===G.year&&a<5*e&&(f=[1,2,5]);c=wb(a/e,f,d[0]==="year"?t(vb(a/e),1):1);return{unitRange:e,count:c,unitName:d[0]};};ia.prototype.getLogTickPositions=function(a,b,c,d){var e=this.options,f=this.len,g=this.lin2log,h=this.log2lin,i=[];if(!d){this._minorAutoInterval=null;}if(a>=0.5){a=C(a),i=this.getLinearTickPositions(a,b,c);}else{if(a>=0.08){for(var f=V(b),j,k,l,m,n,e=a>0.3?[1,2,4]:a>0.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];f<c+1&&!n;f++){k=e.length;for(j=0;j<k&&!n;j++){l=h(g(f)*e[j]),l>b&&(!d||m<=c)&&m!==z&&i.push(m),m>c&&(n=!0),m=l;}}}else{if(b=g(b),c=g(c),a=e[d?"minorTickInterval":"tickInterval"],a=p(a==="auto"?null:a,this._minorAutoInterval,(c-b)*(e.tickPixelInterval/(d?5:1))/((d?f/this.tickPositions.length:f)||1)),a=wb(a,null,vb(a)),i=Ea(this.getLinearTickPositions(a,b,c),h),!d){this._minorAutoInterval=a/5;}}}if(!d){this.tickInterval=a;}return i;};ia.prototype.log2lin=function(a){return Z.log(a)/Z.LN10;};ia.prototype.lin2log=function(a){return Z.pow(10,a);};var Rb=u.Tooltip=function(){this.init.apply(this,arguments);};Rb.prototype={init:function(a,b){var c=b.borderWidth,d=b.style,e=B(d.padding);this.chart=a;this.options=b;this.crosshairs=[];this.now={x:0,y:0};this.isHidden=!0;this.label=a.renderer.label("",0,0,b.shape||"callout",null,null,b.useHTML,null,"tooltip").attr({padding:e,fill:b.backgroundColor,"stroke-width":c,r:b.borderRadius,zIndex:8,display:"none"}).css(d).css({padding:0}).add();la||this.label.shadow(b.shadow);this.shared=b.shared;},destroy:function(){if(this.label){this.label=this.label.destroy();}clearTimeout(this.hideTimer);clearTimeout(this.tooltipTimeout);},move:function(a,b,c,d){var e=this,f=e.now,g=e.options.animation!==!1&&!e.isHidden&&(Q(a-f.x)>1||Q(b-f.y)>1),h=e.followPointer||e.len>1;x(f,{x:g?(2*f.x+a)/3:a,y:g?(f.y+b)/2:b,anchorX:h?z:g?(2*f.anchorX+c)/3:c,anchorY:h?z:g?(f.anchorY+d)/2:d});e.label.attr(f);if(g){clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){e&&e.move(a,b,c,d);},32);}},hide:function(a){var b=this;clearTimeout(this.hideTimer);a=p(a,this.options.hideDelay,500);if(!this.isHidden){this.hideTimer=Sa(function(){b.label[a?"fadeOut":"hide"]();b.isHidden=!0;},a);}},getAnchor:function(a,b){var c,d=this.chart,e=d.inverted,f=d.plotTop,g=d.plotLeft,h=0,i=0,j,k,a=ua(a);c=a[0].tooltipPos;this.followPointer&&b&&(b.chartX===z&&(b=d.pointer.normalize(b)),c=[b.chartX-d.plotLeft,b.chartY-f]);c||(q(a,function(a){j=a.series.yAxis;k=a.series.xAxis;h+=a.plotX+(!e&&k?k.left-g:0);i+=(a.plotLow?(a.plotLow+a.plotHigh)/2:a.plotY)+(!e&&j?j.top-f:0);}),h/=a.length,i/=a.length,c=[e?d.plotWidth-i:h,this.shared&&!e&&a.length>1&&b?b.chartY-f:e?d.plotHeight-h:i]);return Ea(c,C);},getPosition:function(a,b,c){var d=this.chart,e=this.distance,f={},g=c.h||0,h,i=["y",d.chartHeight,b,c.plotY+d.plotTop,d.plotTop,d.plotTop+d.plotHeight],j=["x",d.chartWidth,a,c.plotX+d.plotLeft,d.plotLeft,d.plotLeft+d.plotWidth],k=!this.followPointer&&p(c.ttBelow,!d.inverted===!!c.negative),l=function(a,b,c,d,h,i){var j=c<d-e,m=d+e+c<b,l=d-e-c;d+=e;if(k&&m){f[a]=d;}else{if(!k&&j){f[a]=l;}else{if(j){f[a]=F(i-c,l-g<0?l:l-g);}else{if(m){f[a]=t(h,d+g+c>b?d:d+g);}else{return !1;}}}}},m=function(a,b,c,d){var g;d<e||d>b-e?g=!1:f[a]=d<c/2?1:d>b-c/2?b-c-2:d-c/2;return g;},n=function(a){var b=i;i=j;j=b;h=a;},o=function(){l.apply(0,i)!==!1?m.apply(0,j)===!1&&!h&&(n(!0),o()):h?f.x=f.y=0:(n(!0),o());};(d.inverted||this.len>1)&&n();o();return f;},defaultFormatter:function(a){var b=this.points||ua(this),c;c=[a.tooltipFooterHeaderFormatter(b[0])];c=c.concat(a.bodyFormatter(b));c.push(a.tooltipFooterHeaderFormatter(b[0],!0));return c.join("");},refresh:function(a,b){var c=this.chart,d=this.label,e=this.options,f,g,h,i={},j,k=[];j=e.formatter||this.defaultFormatter;var i=c.hoverPoints,l,m=this.shared;clearTimeout(this.hideTimer);this.followPointer=ua(a)[0].series.tooltipOptions.followPointer;h=this.getAnchor(a,b);f=h[0];g=h[1];m&&(!a.series||!a.series.noSharedTooltip)?(c.hoverPoints=a,i&&q(i,function(a){a.setState();}),q(a,function(a){a.setState("hover");k.push(a.getLabelConfig());}),i={x:a[0].category,y:a[0].y},i.points=k,this.len=k.length,a=a[0]):i=a.getLabelConfig();j=j.call(i,this);i=a.series;this.distance=p(i.tooltipOptions.distance,16);j===!1?this.hide():(this.isHidden&&(Ka(d),d.attr({opacity:1,display:"block"}).show()),d.attr({text:j}),l=e.borderColor||a.color||i.color||"#606060",d.attr({stroke:l}),this.updatePosition({plotX:f,plotY:g,negative:a.negative,ttBelow:a.ttBelow,h:h[2]||0}),this.isHidden=!1);H(c,"tooltipRefresh",{text:j,x:f+c.plotLeft,y:g+c.plotTop,borderColor:l});},updatePosition:function(a){var b=this.chart,c=this.label,c=(this.options.positioner||this.getPosition).call(this,c.width,c.height,a);this.move(C(c.x),C(c.y||0),a.plotX+b.plotLeft,a.plotY+b.plotTop);},getXDateFormat:function(a,b,c){var d,b=b.dateTimeLabelFormats,e=c&&c.closestPointRange,f,g={millisecond:15,second:12,minute:9,hour:6,day:3},h,i="millisecond";if(e){h=Ta("%m-%d %H:%M:%S.%L",a.x);for(f in G){if(e===G.week&&+Ta("%w",a.x)===c.options.startOfWeek&&h.substr(6)==="00:00:00.000"){f="week";break;}if(G[f]>e){f=i;break;}if(g[f]&&h.substr(g[f])!=="01-01 00:00:00.000".substr(g[f])){break;}f!=="week"&&(i=f);}f&&(d=b[f]);}else{d=b.day;}return d||b.year;},tooltipFooterHeaderFormatter:function(a,b){var c=b?"footer":"header",d=a.series,e=d.tooltipOptions,f=e.xDateFormat,g=d.xAxis,h=g&&g.options.type==="datetime"&&I(a.key),c=e[c+"Format"];h&&!f&&(f=this.getXDateFormat(a,e,g));h&&f&&(c=c.replace("{point.key}","{point.key:"+f+"}"));return Na(c,{point:a,series:d});},bodyFormatter:function(a){return Ea(a,function(a){var c=a.series.tooltipOptions;return(c.pointFormatter||a.point.tooltipFormatter).call(a.point,c.pointFormat);});}};var ja;gb=y&&y.documentElement.ontouchstart!==z;var $a=u.Pointer=function(a,b){this.init(a,b);};$a.prototype={init:function(a,b){var c=b.chart,d=c.events,e=la?"":c.zoomType,c=a.inverted,f;this.options=b;this.chart=a;this.zoomX=f=/x/.test(e);this.zoomY=e=/y/.test(e);this.zoomHor=f&&!c||e&&c;this.zoomVert=e&&!c||f&&c;this.hasZoom=f||e;this.runChartClick=d&&!!d.click;this.pinchDown=[];this.lastValidTouch={};if(u.Tooltip&&b.tooltip.enabled){a.tooltip=new Rb(a,b.tooltip),this.followTouchMove=p(b.tooltip.followTouchMove,!0);}this.setDOMEvents();},normalize:function(a,b){var c,d,a=a||D.event;if(!a.target){a.target=a.srcElement;}d=a.touches?a.touches.length?a.touches.item(0):a.changedTouches[0]:a;if(!b){this.chartPosition=b=Db(this.chart.container);}d.pageX===z?(c=t(a.x,a.clientX-b.left),d=a.y):(c=d.pageX-b.left,d=d.pageY-b.top);return x(a,{chartX:C(c),chartY:C(d)});},getCoordinates:function(a){var b={xAxis:[],yAxis:[]};q(this.chart.axes,function(c){b[c.isXAxis?"xAxis":"yAxis"].push({axis:c,value:c.toValue(a[c.horiz?"chartX":"chartY"])});});return b;},runPointActions:function(a){var b=this.chart,c=b.series,d=b.tooltip,e=d?d.shared:!1,f=!0,g=b.hoverPoint,h=b.hoverSeries,i,j,k,l=[],m;if(!e&&!h){for(i=0;i<c.length;i++){if(c[i].directTouch||!c[i].options.stickyTracking){c=[];}}}h&&(e?h.noSharedTooltip:h.directTouch)&&g?l=[g]:(!e&&h&&!h.options.stickyTracking&&(c=[h]),q(c,function(b){j=b.noSharedTooltip&&e;k=!e&&b.directTouch;b.visible&&!j&&!k&&p(b.options.enableMouseTracking,!0)&&(m=b.searchPoint(a,!j&&b.kdDimensions===1))&&m.series&&l.push(m);}),l.sort(function(a,b){var c=a.distX-b.distX,d=a.dist-b.dist,e=a.series.group.zIndex>b.series.group.zIndex?-1:1;return c!==0?c:d!==0?d:e;}));if(e){for(i=l.length;i--;){(l[i].clientX!==l[0].clientX||l[i].series.noSharedTooltip)&&l.splice(i,1);}}if(l[0]&&(l[0]!==this.hoverPoint||d&&d.isHidden)){if(e&&!l[0].series.noSharedTooltip){for(i=0;i>=0;i--){l[i].onMouseOver(a,l[i]!==(h&&h.directTouch&&g||l[0]));}if(h&&h.directTouch&&g&&g!==l[0]){g.onMouseOver(a,!1);}l.length&&d&&d.refresh(l.sort(function(a,b){return a.series.index-b.series.index;}),a);}else{if(d&&d.refresh(l[0],a),!h||!h.directTouch){l[0].onMouseOver(a);}}this.prevKDPoint=l[0];f=!1;}f&&(c=h&&h.tooltipOptions.followPointer,d&&c&&!d.isHidden&&(c=d.getAnchor([{}],a),d.updatePosition({plotX:c[0],plotY:c[1]})));if(!this._onDocumentMouseMove){this._onDocumentMouseMove=function(a){if(U[ja]){U[ja].pointer.onDocumentMouseMove(a);}},N(y,"mousemove",this._onDocumentMouseMove);}q(e?l:[p(g,l[0])],function(c){q(b.axes,function(b){(!c||c.series&&c.series[b.coll]===b)&&b.drawCrosshair(a,c);});});},reset:function(a,b){var c=this.chart,d=c.hoverSeries,e=c.hoverPoint,f=c.hoverPoints,g=c.tooltip,h=g&&g.shared?f:e;a&&h&&q(ua(h),function(b){b.series.isCartesian&&b.plotX===void 0&&(a=!1);});if(a){g&&h&&(g.refresh(h),e&&(e.setState(e.state,!0),q(c.axes,function(a){a.crosshair&&a.drawCrosshair(null,e);})));}else{if(e){e.onMouseOut();}f&&q(f,function(a){a.setState();});if(d){d.onMouseOut();}g&&g.hide(b);if(this._onDocumentMouseMove){Y(y,"mousemove",this._onDocumentMouseMove),this._onDocumentMouseMove=null;}q(c.axes,function(a){a.hideCrosshair();});this.hoverX=this.prevKDPoint=c.hoverPoints=c.hoverPoint=null;}},scaleGroups:function(a,b){var c=this.chart,d;q(c.series,function(e){d=a||e.getPlotBox();e.xAxis&&e.xAxis.zoomEnabled&&(e.group.attr(d),e.markerGroup&&(e.markerGroup.attr(d),e.markerGroup.clip(b?c.clipRect:null)),e.dataLabelsGroup&&e.dataLabelsGroup.attr(d));});c.clipRect.attr(b||c.clipBox);},dragStart:function(a){var b=this.chart;b.mouseIsDown=a.type;b.cancelClick=!1;b.mouseDownX=this.mouseDownX=a.chartX;b.mouseDownY=this.mouseDownY=a.chartY;},drag:function(a){var b=this.chart,c=b.options.chart,d=a.chartX,e=a.chartY,f=this.zoomHor,g=this.zoomVert,h=b.plotLeft,i=b.plotTop,j=b.plotWidth,k=b.plotHeight,l,m=this.selectionMarker,n=this.mouseDownX,o=this.mouseDownY,p=c.panKey&&a[c.panKey+"Key"];if(!m||!m.touch){if(d<h?d=h:d>h+j&&(d=h+j),e<i?e=i:e>i+k&&(e=i+k),this.hasDragged=Math.sqrt(Math.pow(n-d,2)+Math.pow(o-e,2)),this.hasDragged>10){l=b.isInsidePlot(n-h,o-i);if(b.hasCartesianSeries&&(this.zoomX||this.zoomY)&&l&&!p&&!m){this.selectionMarker=m=b.renderer.rect(h,i,f?1:j,g?1:k,0).attr({fill:c.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add();}m&&f&&(d-=n,m.attr({width:Q(d),x:(d>0?0:d)+n}));m&&g&&(d=e-o,m.attr({height:Q(d),y:(d>0?0:d)+o}));l&&!m&&c.panning&&b.pan(a,c.panning);}}},drop:function(a){var b=this,c=this.chart,d=this.hasPinched;if(this.selectionMarker){var e={originalEvent:a,xAxis:[],yAxis:[]},f=this.selectionMarker,g=f.attr?f.attr("x"):f.x,h=f.attr?f.attr("y"):f.y,i=f.attr?f.attr("width"):f.width,j=f.attr?f.attr("height"):f.height,k;if(this.hasDragged||d){q(c.axes,function(c){if(c.zoomEnabled&&s(c.min)&&(d||b[{xAxis:"zoomX",yAxis:"zoomY"}[c.coll]])){var f=c.horiz,n=a.type==="touchend"?c.minPixelPadding:0,o=c.toValue((f?g:h)+n),f=c.toValue((f?g+i:h+j)-n);e[c.coll].push({axis:c,min:F(o,f),max:t(o,f)});k=!0;}}),k&&H(c,"selection",e,function(a){c.zoom(x(a,d?{animation:!1}:null));});}this.selectionMarker=this.selectionMarker.destroy();d&&this.scaleGroups();}if(c){M(c.container,{cursor:c._cursor}),c.cancelClick=this.hasDragged>10,c.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[];}},onContainerMouseDown:function(a){a=this.normalize(a);a.preventDefault&&a.preventDefault();this.dragStart(a);},onDocumentMouseUp:function(a){U[ja]&&U[ja].pointer.drop(a);},onDocumentMouseMove:function(a){var b=this.chart,c=this.chartPosition,a=this.normalize(a,c);c&&!this.inClass(a.target,"highcharts-tracker")&&!b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop)&&this.reset();},onContainerMouseLeave:function(a){var b=U[ja];if(b&&(a.relatedTarget||a.toElement)){b.pointer.reset(),b.pointer.chartPosition=null;}},onContainerMouseMove:function(a){var b=this.chart;if(!s(ja)||!U[ja]||!U[ja].mouseIsDown){ja=b.index;}a=this.normalize(a);a.returnValue=!1;b.mouseIsDown==="mousedown"&&this.drag(a);(this.inClass(a.target,"highcharts-tracker")||b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop))&&!b.openMenu&&this.runPointActions(a);},inClass:function(a,b){for(var c;a;){if(c=O(a,"class")){if(c.indexOf(b)!==-1){return !0;}if(c.indexOf("highcharts-container")!==-1){return !1;}}a=a.parentNode;}},onTrackerMouseOut:function(a){var b=this.chart.hoverSeries,a=a.relatedTarget||a.toElement;if(b&&a&&!b.options.stickyTracking&&!this.inClass(a,"highcharts-tooltip")&&!this.inClass(a,"highcharts-series-"+b.index)){b.onMouseOut();}},onContainerClick:function(a){var b=this.chart,c=b.hoverPoint,d=b.plotLeft,e=b.plotTop,a=this.normalize(a);b.cancelClick||(c&&this.inClass(a.target,"highcharts-tracker")?(H(c.series,"click",x(a,{point:c})),b.hoverPoint&&c.firePointEvent("click",a)):(x(a,this.getCoordinates(a)),b.isInsidePlot(a.chartX-d,a.chartY-e)&&H(b,"click",a)));},setDOMEvents:function(){var a=this,b=a.chart.container;b.onmousedown=function(b){a.onContainerMouseDown(b);};b.onmousemove=function(b){a.onContainerMouseMove(b);};b.onclick=function(b){a.onContainerClick(b);};N(b,"mouseleave",a.onContainerMouseLeave);hb===1&&N(y,"mouseup",a.onDocumentMouseUp);if(gb){b.ontouchstart=function(b){a.onContainerTouchStart(b);},b.ontouchmove=function(b){a.onContainerTouchMove(b);},hb===1&&N(y,"touchend",a.onDocumentTouchEnd);}},destroy:function(){var a;Y(this.chart.container,"mouseleave",this.onContainerMouseLeave);hb||(Y(y,"mouseup",this.onDocumentMouseUp),Y(y,"touchend",this.onDocumentTouchEnd));clearInterval(this.tooltipTimeout);for(a in this){this[a]=null;}}};x(u.Pointer.prototype,{pinchTranslate:function(a,b,c,d,e,f){(this.zoomHor||this.pinchHor)&&this.pinchTranslateDirection(!0,a,b,c,d,e,f);(this.zoomVert||this.pinchVert)&&this.pinchTranslateDirection(!1,a,b,c,d,e,f);},pinchTranslateDirection:function(a,b,c,d,e,f,g,h){var i=this.chart,j=a?"x":"y",k=a?"X":"Y",l="chart"+k,m=a?"width":"height",n=i["plot"+(a?"Left":"Top")],o,p,r=h||1,q=i.inverted,w=i.bounds[a?"h":"v"],v=b.length===1,t=b[0][l],s=c[0][l],x=!v&&b[1][l],u=!v&&c[1][l],z,c=function(){!v&&Q(t-x)>20&&(r=h||Q(s-u)/Q(t-x));p=(n-s)/r+t;o=i["plot"+(a?"Width":"Height")]/r;};c();b=p;b<w.min?(b=w.min,z=!0):b+o>w.max&&(b=w.max-o,z=!0);z?(s-=0.8*(s-g[j][0]),v||(u-=0.8*(u-g[j][1])),c()):g[j]=[s,u];q||(f[j]=p-n,f[m]=o);f=q?1/r:r;e[m]=o;e[j]=b;d[q?a?"scaleY":"scaleX":"scale"+k]=r;d["translate"+k]=f*n+(s-f*t);},pinch:function(a){var b=this,c=b.chart,d=b.pinchDown,e=a.touches,f=e.length,g=b.lastValidTouch,h=b.hasZoom,i=b.selectionMarker,j={},k=f===1&&(b.inClass(a.target,"highcharts-tracker")&&c.runTrackerClick||b.runChartClick),l={};if(f>1){b.initiated=!0;}h&&b.initiated&&!k&&a.preventDefault();Ea(e,function(a){return b.normalize(a);});if(a.type==="touchstart"){q(e,function(a,b){d[b]={chartX:a.chartX,chartY:a.chartY};}),g.x=[d[0].chartX,d[1]&&d[1].chartX],g.y=[d[0].chartY,d[1]&&d[1].chartY],q(c.axes,function(a){if(a.zoomEnabled){var b=c.bounds[a.horiz?"h":"v"],d=a.minPixelPadding,e=a.toPixels(p(a.options.min,a.dataMin)),f=a.toPixels(p(a.options.max,a.dataMax)),g=F(e,f),e=t(e,f);b.min=F(a.pos,g-d);b.max=t(a.pos+a.len,e+d);}}),b.res=!0;}else{if(d.length){if(!i){b.selectionMarker=i=x({destroy:Ca,touch:!0},c.plotBox);}b.pinchTranslate(d,e,j,i,l,g);b.hasPinched=h;b.scaleGroups(j,l);if(!h&&b.followTouchMove&&f===1){this.runPointActions(b.normalize(a));}else{if(b.res){b.res=!1,this.reset(!1,0);}}}}},touch:function(a,b){var c=this.chart,d;ja=c.index;if(a.touches.length===1){if(a=this.normalize(a),c.isInsidePlot(a.chartX-c.plotLeft,a.chartY-c.plotTop)&&!c.openMenu){b&&this.runPointActions(a);if(a.type==="touchmove"){c=this.pinchDown,d=c[0]?Math.sqrt(Math.pow(c[0].chartX-a.chartX,2)+Math.pow(c[0].chartY-a.chartY,2))>=4:!1;}p(d,!0)&&this.pinch(a);}else{b&&this.reset();}}else{a.touches.length===2&&this.pinch(a);}},onContainerTouchStart:function(a){this.touch(a,!0);},onContainerTouchMove:function(a){this.touch(a);},onDocumentTouchEnd:function(a){U[ja]&&U[ja].pointer.drop(a);}});if(D.PointerEvent||D.MSPointerEvent){var wa={},Fb=!!D.PointerEvent,Ub=function(){var a,b=[];b.item=function(a){return this[a];};for(a in wa){wa.hasOwnProperty(a)&&b.push({pageX:wa[a].pageX,pageY:wa[a].pageY,target:wa[a].target});}return b;},Gb=function(a,b,c,d){if((a.pointerType==="touch"||a.pointerType===a.MSPOINTER_TYPE_TOUCH)&&U[ja]){d(a),d=U[ja].pointer,d[b]({type:c,target:a.currentTarget,preventDefault:Ca,touches:Ub()});}};x($a.prototype,{onContainerPointerDown:function(a){Gb(a,"onContainerTouchStart","touchstart",function(a){wa[a.pointerId]={pageX:a.pageX,pageY:a.pageY,target:a.currentTarget};});},onContainerPointerMove:function(a){Gb(a,"onContainerTouchMove","touchmove",function(a){wa[a.pointerId]={pageX:a.pageX,pageY:a.pageY};if(!wa[a.pointerId].target){wa[a.pointerId].target=a.currentTarget;}});},onDocumentPointerUp:function(a){Gb(a,"onDocumentTouchEnd","touchend",function(a){delete wa[a.pointerId];});},batchMSEvents:function(a){a(this.chart.container,Fb?"pointerdown":"MSPointerDown",this.onContainerPointerDown);a(this.chart.container,Fb?"pointermove":"MSPointerMove",this.onContainerPointerMove);a(y,Fb?"pointerup":"MSPointerUp",this.onDocumentPointerUp);}});ib($a.prototype,"init",function(a,b,c){a.call(this,b,c);this.hasZoom&&M(b.container,{"-ms-touch-action":"none","touch-action":"none"});});ib($a.prototype,"setDOMEvents",function(a){a.apply(this);(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(N);});ib($a.prototype,"destroy",function(a){this.batchMSEvents(Y);a.call(this);});}var sb=u.Legend=function(a,b){this.init(a,b);};sb.prototype={init:function(a,b){var c=this,d=b.itemStyle,e=b.itemMarginTop||0;this.options=b;if(b.enabled){c.itemStyle=d,c.itemHiddenStyle=E(d,b.itemHiddenStyle),c.itemMarginTop=e,c.padding=d=p(b.padding,8),c.initialItemX=d,c.initialItemY=d-5,c.maxItemWidth=0,c.chart=a,c.itemHeight=0,c.symbolWidth=p(b.symbolWidth,16),c.pages=[],c.render(),N(c.chart,"endResize",function(){c.positionCheckboxes();});}},colorizeItem:function(a,b){var c=this.options,d=a.legendItem,e=a.legendLine,f=a.legendSymbol,g=this.itemHiddenStyle.color,c=b?c.itemStyle.color:g,h=b?a.legendColor||a.color||"#CCC":g,g=a.options&&a.options.marker,i={fill:h},j;d&&d.css({fill:c,color:c});e&&e.attr({stroke:h});if(f){if(g&&f.isMarker){for(j in i.stroke=h,g=a.convertAttribs(g),g){d=g[j],d!==z&&(i[j]=d);}}f.attr(i);}},positionItem:function(a){var b=this.options,c=b.symbolPadding,b=!b.rtl,d=a._legendItemPos,e=d[0],d=d[1],f=a.checkbox;(a=a.legendGroup)&&a.element&&a.translate(b?e:this.legendWidth-e-2*c-4,d);if(f){f.x=e,f.y=d;}},destroyItem:function(a){var b=a.checkbox;q(["legendItem","legendLine","legendSymbol","legendGroup"],function(b){a[b]&&(a[b]=a[b].destroy());});b&&Va(a.checkbox);},destroy:function(){var a=this.group,b=this.box;if(b){this.box=b.destroy();}if(a){this.group=a.destroy();}},positionCheckboxes:function(a){var b=this.group.alignAttr,c,d=this.clipHeight||this.legendHeight,e=this.titleHeight;if(b){c=b.translateY,q(this.allItems,function(f){var g=f.checkbox,h;g&&(h=c+e+g.y+(a||0)+3,M(g,{left:b.translateX+f.checkboxOffset+g.x-20+"px",top:h+"px",display:h>c-6&&h<c+d-6?"":"none"}));});}},renderTitle:function(){var a=this.padding,b=this.options.title,c=0;if(b.text){if(!this.title){this.title=this.chart.renderer.label(b.text,a-3,a-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(b.style).add(this.group);}a=this.title.getBBox();c=a.height;this.offsetWidth=a.width;this.contentGroup.attr({translateY:c});}this.titleHeight=c;},setText:function(a){var b=this.options;a.legendItem.attr({text:b.labelFormat?Na(b.labelFormat,a):b.labelFormatter.call(a)});},renderItem:function(a){var b=this.chart,c=b.renderer,d=this.options,e=d.layout==="horizontal",f=this.symbolWidth,g=d.symbolPadding,h=this.itemStyle,i=this.itemHiddenStyle,j=this.padding,k=e?p(d.itemDistance,20):0,l=!d.rtl,m=d.width,n=d.itemMarginBottom||0,o=this.itemMarginTop,A=this.initialItemX,r=a.legendItem,q=a.series&&a.series.drawLegendSymbol?a.series:a,w=q.options,w=this.createCheckboxForItem&&w&&w.showCheckbox,v=d.useHTML;if(!r){a.legendGroup=c.g("legend-item").attr({zIndex:1}).add(this.scrollGroup);a.legendItem=r=c.text("",l?f+g:-g,this.baseline||0,v).css(E(a.visible?h:i)).attr({align:l?"left":"right",zIndex:2}).add(a.legendGroup);if(!this.baseline){this.fontMetrics=c.fontMetrics(h.fontSize,r),this.baseline=this.fontMetrics.f+3+o,r.attr("y",this.baseline);}q.drawLegendSymbol(this,a);this.setItemEvents&&this.setItemEvents(a,r,v,h,i);w&&this.createCheckboxForItem(a);}this.colorizeItem(a,a.visible);this.setText(a);c=r.getBBox();f=a.checkboxOffset=d.itemWidth||a.legendItemWidth||f+g+c.width+k+(w?20:0);this.itemHeight=g=C(a.legendItemHeight||c.height);if(e&&this.itemX-A+f>(m||b.chartWidth-2*j-A-d.x)){this.itemX=A,this.itemY+=o+this.lastLineHeight+n,this.lastLineHeight=0;}this.maxItemWidth=t(this.maxItemWidth,f);this.lastItemY=o+this.itemY+n;this.lastLineHeight=t(g,this.lastLineHeight);a._legendItemPos=[this.itemX,this.itemY];e?this.itemX+=f:(this.itemY+=o+g+n,this.lastLineHeight=g);this.offsetWidth=m||t((e?this.itemX-A-k:f)+j,this.offsetWidth);},getAllItems:function(){var a=[];q(this.chart.series,function(b){var c=b.options;if(p(c.showInLegend,!s(c.linkedTo)?z:!1,!0)){a=a.concat(b.legendItems||(c.legendType==="point"?b.data:b));}});return a;},adjustMargins:function(a,b){var c=this.chart,d=this.options,e=d.align.charAt(0)+d.verticalAlign.charAt(0)+d.layout.charAt(0);d.floating||q([/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(f,g){f.test(e)&&!s(a[g])&&(c[qb[g]]=t(c[qb[g]],c.legend[(g+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][g]*d[g%2?"x":"y"]+p(d.margin,12)+b[g]));});},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.group,e,f,g,h,i=a.box,j=a.options,k=a.padding,l=j.borderWidth,m=j.backgroundColor;a.itemX=a.initialItemX;a.itemY=a.initialItemY;a.offsetWidth=0;a.lastItemY=0;if(!d){a.group=d=c.g("legend").attr({zIndex:7}).add(),a.contentGroup=c.g().attr({zIndex:1}).add(d),a.scrollGroup=c.g().add(a.contentGroup);}a.renderTitle();e=a.getAllItems();kb(e,function(a,b){return(a.options&&a.options.legendIndex||0)-(b.options&&b.options.legendIndex||0);});j.reversed&&e.reverse();a.allItems=e;a.display=f=!!e.length;a.lastLineHeight=0;q(e,function(b){a.renderItem(b);});g=(j.width||a.offsetWidth)+k;h=a.lastItemY+a.lastLineHeight+a.titleHeight;h=a.handleOverflow(h);h+=k;if(l||m){if(i){if(g>0&&h>0){i[i.isNew?"attr":"animate"](i.crisp({width:g,height:h})),i.isNew=!1;}}else{a.box=i=c.rect(0,0,g,h,j.borderRadius,l||0).attr({stroke:j.borderColor,"stroke-width":l||0,fill:m||"none"}).add(d).shadow(j.shadow),i.isNew=!0;}i[f?"show":"hide"]();}a.legendWidth=g;a.legendHeight=h;q(e,function(b){a.positionItem(b);});f&&d.align(x({width:g,height:h},j),!0,"spacingBox");b.isResizing||this.positionCheckboxes();},handleOverflow:function(a){var b=this,c=this.chart,d=c.renderer,e=this.options,f=e.y,f=c.spacingBox.height+(e.verticalAlign==="top"?-f:f)-this.padding,g=e.maxHeight,h,i=this.clipRect,j=e.navigation,k=p(j.animation,!0),l=j.arrowSize||12,m=this.nav,n=this.pages,o=this.padding,A,r=this.allItems,s=function(a){i.attr({height:a});if(b.contentGroup.div){b.contentGroup.div.style.clip="rect("+o+"px,9999px,"+(o+a)+"px,0)";}};e.layout==="horizontal"&&(f/=2);g&&(f=F(f,g));n.length=0;if(a>f&&j.enabled!==!1){this.clipHeight=h=t(f-20-this.titleHeight-o,0);this.currentPage=p(this.currentPage,1);this.fullHeight=a;q(r,function(a,b){var c=a._legendItemPos[1],d=C(a.legendItem.getBBox().height),e=n.length;if(!e||c-n[e-1]>h&&(A||c)!==n[e-1]){n.push(A||c),e++;}b===r.length-1&&c+d-n[e-1]>h&&n.push(c);c!==A&&(A=c);});if(!i){i=b.clipRect=d.clipRect(0,o,9999,0),b.contentGroup.clip(i);}s(h);if(!m){this.nav=m=d.g().attr({zIndex:1}).add(this.group),this.up=d.symbol("triangle",0,0,l,l).on("click",function(){b.scroll(-1,k);}).add(m),this.pager=d.text("",15,10).css(j.style).add(m),this.down=d.symbol("triangle-down",0,0,l,l).on("click",function(){b.scroll(1,k);}).add(m);}b.scroll(0);a=f;}else{if(m){s(c.chartHeight),m.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0;}}return a;},scroll:function(a,b){var c=this.pages,d=c.length,e=this.currentPage+a,f=this.clipHeight,g=this.options.navigation,h=g.activeColor,g=g.inactiveColor,i=this.pager,j=this.padding;e>d&&(e=d);if(e>0){b!==z&&cb(b,this.chart),this.nav.attr({translateX:j,translateY:f+this.padding+7+this.titleHeight,visibility:"visible"}),this.up.attr({fill:e===1?g:h}).css({cursor:e===1?"default":"pointer"}),i.attr({text:e+"/"+d}),this.down.attr({x:18+this.pager.getBBox().width,fill:e===d?g:h}).css({cursor:e===d?"default":"pointer"}),c=-c[e-1]+this.initialItemY,this.scrollGroup.animate({translateY:c}),this.currentPage=e,this.positionCheckboxes(c);}}};P=u.LegendSymbolMixin={drawRectangle:function(a,b){var c=a.options.symbolHeight||a.fontMetrics.f;b.legendSymbol=this.chart.renderer.rect(0,a.baseline-c+1,a.symbolWidth,c,a.options.symbolRadius||0).attr({zIndex:3}).add(b.legendGroup);},drawLineMarker:function(a){var b=this.options,c=b.marker,d=a.symbolWidth,e=this.chart.renderer,f=this.legendGroup,a=a.baseline-C(a.fontMetrics.b*0.3),g;if(b.lineWidth){g={"stroke-width":b.lineWidth};if(b.dashStyle){g.dashstyle=b.dashStyle;}this.legendLine=e.path([X,0,a,S,d,a]).attr(g).add(f);}if(c&&c.enabled!==!1){b=c.radius,this.legendSymbol=c=e.symbol(this.symbol,d/2-b,a-b,2*b,2*b,c).add(f),c.isMarker=!0;}}};(/Trident\/7\.0/.test(Ba)||Qa)&&ib(sb.prototype,"positionItem",function(a,b){var c=this,d=function(){b._legendItemPos&&a.call(c,b);};d();setTimeout(d);});var jb=u.Chart=function(){this.getArgs.apply(this,arguments);};u.chart=function(a,b,c){return new jb(a,b,c);};jb.prototype={callbacks:[],getArgs:function(){var a=[].slice.call(arguments);if(ya(a[0])||a[0].nodeName){this.renderTo=a.shift();}this.init(a[0],a[1]);},init:function(a,b){var c,d=a.series;a.series=null;c=E(T,a);c.series=a.series=d;this.userOptions=a;d=c.chart;this.margin=this.splashArray("margin",d);this.spacing=this.splashArray("spacing",d);var e=d.events;this.bounds={h:{},v:{}};this.callback=b;this.isResizing=0;this.options=c;this.axes=[];this.series=[];this.hasCartesianSeries=d.showAxes;var f=this,g;f.index=U.length;U.push(f);hb++;d.reflow!==!1&&N(f,"load",function(){f.initReflow();});if(e){for(g in e){N(f,g,e[g]);}}f.xAxis=[];f.yAxis=[];f.animation=la?!1:p(d.animation,!0);f.pointCount=f.colorCounter=f.symbolCounter=0;f.firstRender();},initSeries:function(a){var b=this.options.chart;(b=L[a.type||b.type||b.defaultSeriesType])||ea(17,!0);b=new b;b.init(this,a);return b;},isInsidePlot:function(a,b,c){var d=c?b:a,a=c?a:b;return d>=0&&d<=this.plotWidth&&a>=0&&a<=this.plotHeight;},redraw:function(a){var b=this.axes,c=this.series,d=this.pointer,e=this.legend,f=this.isDirtyLegend,g,h,i=this.hasCartesianSeries,j=this.isDirtyBox,k=c.length,l=k,m=this.renderer,n=m.isHidden(),o=[];cb(a,this);n&&this.cloneRenderTo();for(this.layOutTitles();l--;){if(a=c[l],a.options.stacking&&(g=!0,a.isDirty)){h=!0;break;}}if(h){for(l=k;l--;){if(a=c[l],a.options.stacking){a.isDirty=!0;}}}q(c,function(a){a.isDirty&&a.options.legendType==="point"&&(a.updateTotals&&a.updateTotals(),f=!0);a.isDirtyData&&H(a,"updatedData");});if(f&&e.options.enabled){e.render(),this.isDirtyLegend=!1;}g&&this.getStacks();if(i&&!this.isResizing){this.maxTicks=null,q(b,function(a){a.updateNames();a.setScale();});}this.getMargins();i&&(q(b,function(a){a.isDirty&&(j=!0);}),q(b,function(a){var b=a.min+","+a.max;if(a.extKey!==b){a.extKey=b,o.push(function(){H(a,"afterSetExtremes",x(a.eventArgs,a.getExtremes()));delete a.eventArgs;});}(j||g)&&a.redraw();}));j&&this.drawChartBox();q(c,function(a){a.isDirty&&a.visible&&(!a.isCartesian||a.xAxis)&&a.redraw();});d&&d.reset(!0);m.draw();H(this,"redraw");n&&this.cloneRenderTo(!0);q(o,function(a){a.call();});},get:function(a){var b=this.axes,c=this.series,d,e;for(d=0;d<b.length;d++){if(b[d].options.id===a){return b[d];}}for(d=0;d<c.length;d++){if(c[d].options.id===a){return c[d];}}for(d=0;d<c.length;d++){e=c[d].points||[];for(b=0;b<e.length;b++){if(e[b].id===a){return e[b];}}}return null;},getAxes:function(){var a=this,b=this.options,c=b.xAxis=ua(b.xAxis||{}),b=b.yAxis=ua(b.yAxis||{});q(c,function(a,b){a.index=b;a.isX=!0;});q(b,function(a,b){a.index=b;});c=c.concat(b);q(c,function(b){new ia(a,b);});},getSelectedPoints:function(){var a=[];q(this.series,function(b){a=a.concat(Da(b.points||[],function(a){return a.selected;}));});return a;},getSelectedSeries:function(){return Da(this.series,function(a){return a.selected;});},setTitle:function(a,b,c){var g;var d=this,e=d.options,f;f=e.title=E(e.title,a);g=e.subtitle=E(e.subtitle,b),e=g;q([["title",a,f],["subtitle",b,e]],function(a){var b=a[0],c=d[b],e=a[1],a=a[2];c&&e&&(d[b]=c=c.destroy());a&&a.text&&!c&&(d[b]=d.renderer.text(a.text,0,0,a.useHTML).attr({align:a.align,"class":"highcharts-"+b,zIndex:a.zIndex||4}).css(a.style).add());});d.layOutTitles(c);},layOutTitles:function(a){var b=0,c=this.title,d=this.subtitle,e=this.options,f=e.title,e=e.subtitle,g=this.renderer,h=this.spacingBox;if(c&&(c.css({width:(f.width||h.width+f.widthAdjust)+"px"}).align(x({y:g.fontMetrics(f.style.fontSize,c).b-3},f),!1,h),!f.floating&&!f.verticalAlign)){b=c.getBBox().height;}d&&(d.css({width:(e.width||h.width+e.widthAdjust)+"px"}).align(x({y:b+(f.margin-13)+g.fontMetrics(e.style.fontSize,c).b},e),!1,h),!e.floating&&!e.verticalAlign&&(b=va(b+d.getBBox().height)));c=this.titleOffset!==b;this.titleOffset=b;if(!this.isDirtyBox&&c){this.isDirtyBox=c,this.hasRendered&&p(a,!0)&&this.isDirtyBox&&this.redraw();}},getChartSize:function(){var a=this.options.chart,b=a.width,a=a.height,c=this.renderToClone||this.renderTo;if(!s(b)){this.containerWidth=oa(c,"width");}if(!s(a)){this.containerHeight=oa(c,"height");}this.chartWidth=t(0,b||this.containerWidth||600);this.chartHeight=t(0,p(a,this.containerHeight>19?this.containerHeight:400));},cloneRenderTo:function(a){var b=this.renderToClone,c=this.container;if(a){if(b){for(;b.childNodes.length;){this.renderTo.appendChild(b.firstChild);}Va(b);delete this.renderToClone;}}else{c&&c.parentNode===this.renderTo&&this.renderTo.removeChild(c),this.renderToClone=b=this.renderTo.cloneNode(0),M(b,{position:"absolute",top:"-9999px",display:"block"}),b.style.setProperty&&b.style.setProperty("display","block","important"),y.body.appendChild(b),c&&b.appendChild(c);}},getContainer:function(){var a,b=this.options,c=b.chart,d,e;a=this.renderTo;var f="highcharts-"+Cb++;if(!a){this.renderTo=a=c.renderTo;}if(ya(a)){this.renderTo=a=y.getElementById(a);}a||ea(13,!0);d=B(O(a,"data-highcharts-chart"));I(d)&&U[d]&&U[d].hasRendered&&U[d].destroy();O(a,"data-highcharts-chart",this.index);a.innerHTML="";!c.skipClone&&!a.offsetWidth&&this.cloneRenderTo();this.getChartSize();d=this.chartWidth;e=this.chartHeight;this.container=a=ca(Pa,{className:"highcharts-container"+(c.className?" "+c.className:""),id:f},x({position:"relative",overflow:"hidden",width:d+"px",height:e+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},c.style),this.renderToClone||a);this._cursor=a.style.cursor;this.renderer=new (u[c.renderer]||fb)(a,d,e,c.style,c.forExport,b.exporting&&b.exporting.allowHTML);la&&this.renderer.create(this,a,d,e);this.renderer.chartIndex=this.index;},getMargins:function(a){var b=this.spacing,c=this.margin,d=this.titleOffset;this.resetMargins();if(d&&!s(c[0])){this.plotTop=t(this.plotTop,d+this.options.title.margin+b[0]);}this.legend.display&&this.legend.adjustMargins(c,b);this.extraBottomMargin&&(this.marginBottom+=this.extraBottomMargin);this.extraTopMargin&&(this.plotTop+=this.extraTopMargin);a||this.getAxisMargins();},getAxisMargins:function(){var a=this,b=a.axisOffset=[0,0,0,0],c=a.margin;a.hasCartesianSeries&&q(a.axes,function(a){a.visible&&a.getOffset();});q(qb,function(d,e){s(c[e])||(a[d]+=b[e]);});a.setChartSize();},reflow:function(a){var b=this,c=b.options.chart,d=b.renderTo,e=s(c.width),f=c.width||oa(d,"width"),c=c.height||oa(d,"height"),d=a?a.target:D;if(!e&&!b.isPrinting&&f&&c&&(d===D||d===y)){if(f!==b.containerWidth||c!==b.containerHeight){clearTimeout(b.reflowTimeout),b.reflowTimeout=Sa(function(){b.container&&b.setSize(void 0,void 0,!1);},a?100:0);}b.containerWidth=f;b.containerHeight=c;}},initReflow:function(){var a=this,b=function(b){a.reflow(b);};N(D,"resize",b);N(a,"destroy",function(){Y(D,"resize",b);});},setSize:function(a,b,c){var d=this,e=d.renderer;d.isResizing+=1;cb(c,d);d.oldChartHeight=d.chartHeight;d.oldChartWidth=d.chartWidth;if(a!==void 0){d.options.chart.width=a;}if(b!==void 0){d.options.chart.height=b;}d.getChartSize();a=e.globalAnimation;(a?Za:M)(d.container,{width:d.chartWidth+"px",height:d.chartHeight+"px"},a);d.setChartSize(!0);e.setSize(d.chartWidth,d.chartHeight,c);d.maxTicks=null;q(d.axes,function(a){a.isDirty=!0;a.setScale();});q(d.series,function(a){a.isDirty=!0;});d.isDirtyLegend=!0;d.isDirtyBox=!0;d.layOutTitles();d.getMargins();d.redraw(c);d.oldChartHeight=null;H(d,"resize");Sa(function(){d&&H(d,"endResize",null,function(){d.isResizing-=1;});},Wa(a).duration);},setChartSize:function(a){var b=this.inverted,c=this.renderer,d=this.chartWidth,e=this.chartHeight,f=this.options.chart,g=this.spacing,h=this.clipOffset,i,j,k,l;this.plotLeft=i=C(this.plotLeft);this.plotTop=j=C(this.plotTop);this.plotWidth=k=t(0,C(d-i-this.marginRight));this.plotHeight=l=t(0,C(e-j-this.marginBottom));this.plotSizeX=b?l:k;this.plotSizeY=b?k:l;this.plotBorderWidth=f.plotBorderWidth||0;this.spacingBox=c.spacingBox={x:g[3],y:g[0],width:d-g[3]-g[1],height:e-g[0]-g[2]};this.plotBox=c.plotBox={x:i,y:j,width:k,height:l};d=2*V(this.plotBorderWidth/2);b=va(t(d,h[3])/2);c=va(t(d,h[0])/2);this.clipBox={x:b,y:c,width:V(this.plotSizeX-t(d,h[1])/2-b),height:t(0,V(this.plotSizeY-t(d,h[2])/2-c))};a||q(this.axes,function(a){a.setAxisSize();a.setAxisTranslation();});},resetMargins:function(){var a=this;q(qb,function(b,c){a[b]=p(a.margin[c],a.spacing[c]);});a.axisOffset=[0,0,0,0];a.clipOffset=[0,0,0,0];},drawChartBox:function(){var a=this.options.chart,b=this.renderer,c=this.chartWidth,d=this.chartHeight,e=this.chartBackground,f=this.plotBackground,g=this.plotBorder,h=this.plotBGImage,i=a.borderWidth||0,j=a.backgroundColor,k=a.plotBackgroundColor,l=a.plotBackgroundImage,m=a.plotBorderWidth||0,n,o=this.plotLeft,p=this.plotTop,r=this.plotWidth,q=this.plotHeight,w=this.plotBox,v=this.clipRect,s=this.clipBox;n=i+(a.shadow?8:0);if(i||j){if(e){e.animate(e.crisp({width:c-n,height:d-n}));}else{e={fill:j||"none"};if(i){e.stroke=a.borderColor,e["stroke-width"]=i;}this.chartBackground=b.rect(n/2,n/2,c-n,d-n,a.borderRadius,i).attr(e).addClass("highcharts-background").add().shadow(a.shadow);}}if(k){f?f.animate(w):this.plotBackground=b.rect(o,p,r,q,0).attr({fill:k}).add().shadow(a.plotShadow);}if(l){h?h.animate(w):this.plotBGImage=b.image(l,o,p,r,q).add();}v?v.animate({width:s.width,height:s.height}):this.clipRect=b.clipRect(s);if(m){g?(g.strokeWidth=-m,g.animate(g.crisp({x:o,y:p,width:r,height:q}))):this.plotBorder=b.rect(o,p,r,q,0,-m).attr({stroke:a.plotBorderColor,"stroke-width":m,fill:"none",zIndex:1}).add();}this.isDirtyBox=!1;},propFromSeries:function(){var a=this,b=a.options.chart,c,d=a.options.series,e,f;q(["inverted","angular","polar"],function(g){c=L[b.type||b.defaultSeriesType];f=a[g]||b[g]||c&&c.prototype[g];for(e=d&&d.length;!f&&e--;){(c=L[d[e].type])&&c.prototype[g]&&(f=!0);}a[g]=f;});},linkSeries:function(){var a=this,b=a.series;q(b,function(a){a.linkedSeries.length=0;});q(b,function(b){var d=b.options.linkedTo;if(ya(d)&&(d=d===":previous"?a.series[b.index-1]:a.get(d))&&d.linkedParent!==b){d.linkedSeries.push(b),b.linkedParent=d,b.visible=p(b.options.visible,d.options.visible,b.visible);}});},renderSeries:function(){q(this.series,function(a){a.translate();a.render();});},renderLabels:function(){var a=this,b=a.options.labels;b.items&&q(b.items,function(c){var d=x(b.style,c.style),e=B(d.left)+a.plotLeft,f=B(d.top)+a.plotTop+12;delete d.left;delete d.top;a.renderer.text(c.html,e,f).attr({zIndex:2}).css(d).add();});},render:function(){var a=this.axes,b=this.renderer,c=this.options,d,e,f,g;this.setTitle();this.legend=new sb(this,c.legend);this.getStacks&&this.getStacks();this.getMargins(!0);this.setChartSize();d=this.plotWidth;e=this.plotHeight-=21;q(a,function(a){a.setScale();});this.getAxisMargins();f=d/this.plotWidth>1.1;g=e/this.plotHeight>1.05;if(f||g){this.maxTicks=null,q(a,function(a){(a.horiz&&f||!a.horiz&&g)&&a.setTickInterval(!0);}),this.getMargins();}this.drawChartBox();this.hasCartesianSeries&&q(a,function(a){a.visible&&a.render();});if(!this.seriesGroup){this.seriesGroup=b.g("series-group").attr({zIndex:3}).add();}this.renderSeries();this.renderLabels();this.showCredits(c.credits);this.hasRendered=!0;},showCredits:function(a){if(a.enabled&&!this.credits){this.credits=this.renderer.text(a.text,0,0).on("click",function(){if(a.href){D.location.href=a.href;}}).attr({align:a.position.align,zIndex:8}).css(a.style).add().align(a.position);}},destroy:function(){var a=this,b=a.axes,c=a.series,d=a.container,e,f=d&&d.parentNode;H(a,"destroy");U[a.index]=z;hb--;a.renderTo.removeAttribute("data-highcharts-chart");Y(a);for(e=b.length;e--;){b[e]=b[e].destroy();}for(e=c.length;e--;){c[e]=c[e].destroy();}q("title,subtitle,chartBackground,plotBackground,plotBGImage,plotBorder,seriesGroup,clipRect,credits,pointer,scroller,rangeSelector,legend,resetZoomButton,tooltip,renderer".split(","),function(b){var c=a[b];c&&c.destroy&&(a[b]=c.destroy());});if(d){d.innerHTML="",Y(d),f&&Va(d);}for(e in a){delete a[e];}},isReadyToRender:function(){var a=this;return !fa&&D==D.top&&y.readyState!=="complete"||la&&!D.canvg?(la?Qb.push(function(){a.firstRender();},a.options.global.canvasToolsURL):y.attachEvent("onreadystatechange",function(){y.detachEvent("onreadystatechange",a.firstRender);y.readyState==="complete"&&a.firstRender();}),!1):!0;},firstRender:function(){var a=this,b=a.options;if(a.isReadyToRender()){a.getContainer();H(a,"init");a.resetMargins();a.setChartSize();a.propFromSeries();a.getAxes();q(b.series||[],function(b){a.initSeries(b);});a.linkSeries();H(a,"beforeRender");if(u.Pointer){a.pointer=new $a(a,b);}a.render();a.renderer.draw();if(!a.renderer.imgCount&&a.onload){a.onload();}a.cloneRenderTo(!0);}},onload:function(){var a=this;q([this.callback].concat(this.callbacks),function(b){b&&a.index!==void 0&&b.apply(a,[a]);});H(a,"load");this.onload=null;},splashArray:function(a,b){var c=b[a],c=ba(c)?c:[c,c,c,c];return[p(b[a+"Top"],c[0]),p(b[a+"Right"],c[1]),p(b[a+"Bottom"],c[2]),p(b[a+"Left"],c[3])];}};var Eb=u.CenteredSeriesMixin={getCenter:function(){var a=this.options,b=this.chart,c=2*(a.slicedOffset||0),d=b.plotWidth-2*c,b=b.plotHeight-2*c,e=a.center,e=[p(e[0],"50%"),p(e[1],"50%"),a.size||"100%",a.innerSize||0],f=F(d,b),g,h;for(g=0;g<4;++g){h=e[g],a=g<2||g===2&&/%$/.test(h),e[g]=(/%$/.test(h)?[d,b,f,e[2]][g]*parseFloat(h)/100:parseFloat(h))+(a?c:0);}e[3]>e[2]&&(e[3]=e[2]);return e;}},Ma=function(){};Ma.prototype={init:function(a,b,c){this.series=a;this.color=a.color;this.applyOptions(b,c);this.pointAttr={};if(a.options.colorByPoint&&(b=a.options.colors||a.chart.options.colors,this.color=this.color||b[a.colorCounter++],a.colorCounter===b.length)){a.colorCounter=0;}a.chart.pointCount++;return this;},applyOptions:function(a,b){var c=this.series,d=c.options.pointValKey||c.pointValKey,a=Ma.prototype.optionsToObject.call(this,a);x(this,a);this.options=this.options?x(this.options,a):a;a.group&&delete this.group;if(d){this.y=this[d];}this.isNull=p(this.isValid&&!this.isValid(),this.x===null||!I(this.y,!0));if("name" in this&&b===void 0&&c.xAxis&&c.xAxis.hasNames){this.x=c.xAxis.nameToX(this);}if(this.x===void 0&&c){this.x=b===void 0?c.autoIncrement(this):b;}return this;},optionsToObject:function(a){var b={},c=this.series,d=c.options.keys,e=d||c.pointArrayMap||["y"],f=e.length,g=0,h=0;if(I(a)||a===null){b[e[0]]=a;}else{if(za(a)){if(!d&&a.length>f){c=typeof a[0];if(c==="string"){b.name=a[0];}else{if(c==="number"){b.x=a[0];}}g++;}for(;h<f;){if(!d||a[g]!==void 0){b[e[h]]=a[g];}g++;h++;}}else{if(typeof a==="object"){b=a;if(a.dataLabels){c._hasPointLabels=!0;}if(a.marker){c._hasPointMarkers=!0;}}}}return b;},destroy:function(){var a=this.series.chart,b=a.hoverPoints,c;a.pointCount--;if(b&&(this.setState(),ra(b,this),!b.length)){a.hoverPoints=null;}if(this===a.hoverPoint){this.onMouseOut();}if(this.graphic||this.dataLabel){Y(this),this.destroyElements();}this.legendItem&&a.legend.destroyItem(this);for(c in this){this[c]=null;}},destroyElements:function(){for(var a=["graphic","dataLabel","dataLabelUpper","connector","shadowGroup"],b,c=6;c--;){b=a[c],this[b]&&(this[b]=this[b].destroy());}},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal};},tooltipFormatter:function(a){var b=this.series,c=b.tooltipOptions,d=p(c.valueDecimals,""),e=c.valuePrefix||"",f=c.valueSuffix||"";q(b.pointArrayMap||["y"],function(b){b="{point."+b;if(e||f){a=a.replace(b+"}",e+b+"}"+f);}a=a.replace(b+"}",b+":,."+d+"f}");});return Na(a,{point:this,series:this.series});},firePointEvent:function(a,b,c){var d=this,e=this.series.options;(e.point.events[a]||d.options&&d.options.events&&d.options.events[a])&&this.importEvents();a==="click"&&e.allowPointSelect&&(c=function(a){d.select&&d.select(null,a.ctrlKey||a.metaKey||a.shiftKey);});H(this,a,b,c);},visible:!0};var R=u.Series=function(){};R.prototype={isCartesian:!0,type:"line",pointClass:Ma,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},directTouch:!1,axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],init:function(a,b){var c=this,d,e,f=a.series,g=function(a,b){return p(a.options.index,a._i)-p(b.options.index,b._i);};c.chart=a;c.options=b=c.setOptions(b);c.linkedSeries=[];c.bindAxes();x(c,{name:b.name,state:"",pointAttr:{},visible:b.visible!==!1,selected:b.selected===!0});if(la){b.animation=!1;}e=b.events;for(d in e){N(c,d,e[d]);}if(e&&e.click||b.point&&b.point.events&&b.point.events.click||b.allowPointSelect){a.runTrackerClick=!0;}c.getColor();c.getSymbol();q(c.parallelArrays,function(a){c[a+"Data"]=[];});c.setData(b.data,!1);if(c.isCartesian){a.hasCartesianSeries=!0;}f.push(c);c._i=f.length-1;kb(f,g);this.yAxis&&kb(this.yAxis.series,g);q(f,function(a,b){a.index=b;a.name=a.name||"Series "+(b+1);});},bindAxes:function(){var a=this,b=a.options,c=a.chart,d;q(a.axisTypes||[],function(e){q(c[e],function(c){d=c.options;if(b[e]===d.index||b[e]!==z&&b[e]===d.id||b[e]===z&&d.index===0){c.series.push(a),a[e]=c,c.isDirty=!0;}});!a[e]&&a.optionalAxis!==e&&ea(18,!0);});},updateParallelArrays:function(a,b){var c=a.series,d=arguments,e=I(b)?function(d){var e=d==="y"&&c.toYData?c.toYData(a):a[d];c[d+"Data"][b]=e;}:function(a){Array.prototype[b].apply(c[a+"Data"],Array.prototype.slice.call(d,2));};q(c.parallelArrays,e);},autoIncrement:function(){var a=this.options,b=this.xIncrement,c,d=a.pointIntervalUnit,b=p(b,a.pointStart,0);this.pointInterval=c=p(this.pointInterval,a.pointInterval,1);d&&(a=new ma(b),d==="day"?a=+a[nb](a[Xa]()+c):d==="month"?a=+a[Ab](a[db]()+c):d==="year"&&(a=+a[Bb](a[eb]()+c)),c=a-b);this.xIncrement=b+c;return b;},setOptions:function(a){var b=this.chart,c=b.options.plotOptions,b=b.userOptions||{},d=b.plotOptions||{},e=c[this.type];this.userOptions=a;c=E(e,c.series,a);this.tooltipOptions=E(T.tooltip,T.plotOptions[this.type].tooltip,b.tooltip,d.series&&d.series.tooltip,d[this.type]&&d[this.type].tooltip,a.tooltip);e.marker===null&&delete c.marker;this.zoneAxis=c.zoneAxis;a=this.zones=(c.zones||[]).slice();if((c.negativeColor||c.negativeFillColor)&&!c.zones){a.push({value:c[this.zoneAxis+"Threshold"]||c.threshold||0,color:c.negativeColor,fillColor:c.negativeFillColor});}a.length&&s(a[a.length-1].value)&&a.push({color:this.color,fillColor:this.fillColor});return c;},getCyclic:function(a,b,c){var d=this.userOptions,e="_"+a+"Index",f=a+"Counter";b||(s(d[e])?b=d[e]:(d[e]=b=this.chart[f]%c.length,this.chart[f]+=1),b=c[b]);this[a]=b;},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||ga[this.type].color,this.chart.options.colors);},getSymbol:function(){var a=this.options.marker;this.getCyclic("symbol",a.symbol,this.chart.options.symbols);if(/^url/.test(this.symbol)){a.radius=0;}},drawLegendSymbol:P.drawLineMarker,setData:function(a,b,c,d){var e=this,f=e.points,g=f&&f.length||0,h,i=e.options,j=e.chart,k=null,l=e.xAxis,m=i.turboThreshold,n=this.xData,o=this.yData,A=(h=e.pointArrayMap)&&h.length,a=a||[];h=a.length;b=p(b,!0);if(d!==!1&&h&&g===h&&!e.cropped&&!e.hasGroupedData&&e.visible){q(a,function(a,b){f[b].update&&a!==i.data[b]&&f[b].update(a,!1,null,!1);});}else{e.xIncrement=null;e.colorCounter=0;q(this.parallelArrays,function(a){e[a+"Data"].length=0;});if(m&&h>m){for(c=0;k===null&&c<h;){k=a[c],c++;}if(I(k)){for(c=0;c<h;c++){n[c]=this.autoIncrement(),o[c]=a[c];}}else{if(za(k)){if(A){for(c=0;c<h;c++){k=a[c],n[c]=k[0],o[c]=k.slice(1,A+1);}}else{for(c=0;c<h;c++){k=a[c],n[c]=k[0],o[c]=k[1];}}}else{ea(12);}}}else{for(c=0;c<h;c++){a[c]!==z&&(k={series:e},e.pointClass.prototype.applyOptions.apply(k,[a[c]]),e.updateParallelArrays(k,c));}}ya(o[0])&&ea(14,!0);e.data=[];e.options.data=e.userOptions.data=a;for(c=g;c--;){f[c]&&f[c].destroy&&f[c].destroy();}if(l){l.minRange=l.userMinRange;}e.isDirty=e.isDirtyData=j.isDirtyBox=!0;c=!1;}i.legendType==="point"&&(this.processData(),this.generatePoints());b&&j.redraw(c);},processData:function(a){var b=this.xData,c=this.yData,d=b.length,e;e=0;var f,g,h=this.xAxis,i,j=this.options;i=j.cropThreshold;var k=this.getExtremesFromAll||j.getExtremesFromAll,l=this.isCartesian,j=h&&h.val2lin,m=h&&h.isLog,n,o;if(l&&!this.isDirty&&!h.isDirty&&!this.yAxis.isDirty&&!a){return !1;}if(h){a=h.getExtremes(),n=a.min,o=a.max;}if(l&&this.sorted&&!k&&(!i||d>i||this.forceCrop)){if(b[d-1]<n||b[0]>o){b=[],c=[];}else{if(b[0]<n||b[d-1]>o){e=this.cropData(this.xData,this.yData,n,o),b=e.xData,c=e.yData,e=e.start,f=!0;}}}for(i=b.length||1;--i;){d=m?j(b[i])-j(b[i-1]):b[i]-b[i-1],d>0&&(g===z||d<g)?g=d:d<0&&this.requireSorting&&ea(15);}this.cropped=f;this.cropStart=e;this.processedXData=b;this.processedYData=c;this.closestPointRange=g;},cropData:function(a,b,c,d){var e=a.length,f=0,g=e,h=p(this.cropShoulder,1),i;for(i=0;i<e;i++){if(a[i]>=c){f=t(0,i-h);break;}}for(c=i;c<e;c++){if(a[c]>d){g=c+h;break;}}return{xData:a.slice(f,g),yData:b.slice(f,g),start:f,end:g};},generatePoints:function(){var a=this.options.data,b=this.data,c,d=this.processedXData,e=this.processedYData,f=this.pointClass,g=d.length,h=this.cropStart||0,i,j=this.hasGroupedData,k,l=[],m;if(!b&&!j){b=[],b.length=a.length,b=this.data=b;}for(m=0;m<g;m++){i=h+m,j?(l[m]=(new f).init(this,[d[m]].concat(ua(e[m]))),l[m].dataGroup=this.groupMap[m]):(b[i]?k=b[i]:a[i]!==z&&(b[i]=k=(new f).init(this,a[i],d[m])),l[m]=k),l[m].index=i;}if(b&&(g!==(c=b.length)||j)){for(m=0;m<c;m++){if(m===h&&!j&&(m+=g),b[m]){b[m].destroyElements(),b[m].plotX=z;}}}this.data=b;this.points=l;},getExtremes:function(a){var b=this.yAxis,c=this.processedXData,d,e=[],f=0;d=this.xAxis.getExtremes();var g=d.min,h=d.max,i,j,k,l,a=a||this.stackedYData||this.processedYData||[];d=a.length;for(l=0;l<d;l++){if(j=c[l],k=a[l],i=(I(k,!0)||za(k))&&(!b.isLog||k.length||k>0),j=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(c[l+1]||j)>=g&&(c[l-1]||j)<=h,i&&j){if(i=k.length){for(;i--;){k[i]!==null&&(e[f++]=k[i]);}}else{e[f++]=k;}}}this.dataMin=Oa(e);this.dataMax=Ha(e);},translate:function(){this.processedXData||this.processData();this.generatePoints();for(var a=this.options,b=a.stacking,c=this.xAxis,d=c.categories,e=this.yAxis,f=this.points,g=f.length,h=!!this.modifyValue,i=a.pointPlacement,j=i==="between"||I(i),k=a.threshold,l=a.startFromThreshold?k:0,m,n,o,q,r=Number.MAX_VALUE,a=0;a<g;a++){var K=f[a],w=K.x,v=K.y;n=K.low;var x=b&&e.stacks[(this.negStacks&&v<(l?0:k)?"-":"")+this.stackKey],u;if(e.isLog&&v!==null&&v<=0){K.isNull=!0;}K.plotX=m=$(F(t(-100000,c.translate(w,0,0,0,1,i,this.type==="flags")),100000));if(b&&this.visible&&!K.isNull&&x&&x[w]){q=this.getStackIndicator(q,w,this.index),u=x[w],v=u.points[q.key],n=v[0],v=v[1],n===l&&q.key===x[w].base&&(n=p(k,e.min)),e.isLog&&n<=0&&(n=null),K.total=K.stackTotal=u.total,K.percentage=u.total&&K.y/u.total*100,K.stackY=v,u.setOffset(this.pointXOffset||0,this.barW||0);}K.yBottom=s(n)?e.translate(n,0,1,0,1):null;h&&(v=this.modifyValue(v,K));K.plotY=n=typeof v==="number"&&v!==Infinity?F(t(-100000,e.translate(v,0,1,0,1)),100000):z;K.isInside=n!==z&&n>=0&&n<=e.len&&m>=0&&m<=c.len;K.clientX=j?$(c.translate(w,0,0,0,1,i)):m;K.negative=K.y<(k||0);K.category=d&&d[K.x]!==z?d[K.x]:K.x;K.isNull||(o!==void 0&&(r=F(r,Q(m-o))),o=m);}this.closestPointRangePx=r;},getValidPoints:function(a,b){var c=this.chart;return Da(a||this.points||[],function(a){return b&&!c.isInsidePlot(a.plotX,a.plotY,c.inverted)?!1:!a.isNull;});},setClip:function(a){var b=this.chart,c=this.options,d=b.renderer,e=b.inverted,f=this.clipBox,g=f||b.clipBox,h=this.sharedClipKey||["_sharedClip",a&&a.duration,a&&a.easing,g.height,c.xAxis,c.yAxis].join(","),i=b[h],j=b[h+"m"];if(!i){if(a){g.width=0,b[h+"m"]=j=d.clipRect(-99,e?-b.plotLeft:-b.plotTop,99,e?b.chartWidth:b.chartHeight);}b[h]=i=d.clipRect(g);i.count={length:0};}a&&!i.count[this.index]&&(i.count[this.index]=!0,i.count.length+=1);if(c.clip!==!1){this.group.clip(a||f?i:b.clipRect),this.markerGroup.clip(j),this.sharedClipKey=h;}a||(i.count[this.index]&&(delete i.count[this.index],i.count.length-=1),i.count.length===0&&h&&b[h]&&(f||(b[h]=b[h].destroy()),b[h+"m"]&&(b[h+"m"]=b[h+"m"].destroy())));},animate:function(a){var b=this.chart,c=Wa(this.options.animation),d;a?this.setClip(c):(d=this.sharedClipKey,(a=b[d])&&a.animate({width:b.plotSizeX},c),b[d+"m"]&&b[d+"m"].animate({width:b.plotSizeX+99},c),this.animate=null);},afterAnimate:function(){this.setClip();H(this,"afterAnimate");},drawPoints:function(){var a,b=this.points,c=this.chart,d,e,f,g,h,i,j,k,l=this.options.marker,m=this.pointAttr[""],n,o,q,r=this.markerGroup,s=p(l.enabled,this.xAxis.isRadial,this.closestPointRangePx>2*l.radius);if(l.enabled!==!1||this._hasPointMarkers){for(f=b.length;f--;){if(g=b[f],d=V(g.plotX),e=g.plotY,k=g.graphic,n=g.marker||{},o=!!g.marker,a=s&&n.enabled===z||n.enabled,q=g.isInside,a&&I(e)&&g.y!==null){if(a=g.pointAttr[g.selected?"select":""]||m,h=a.r,i=p(n.symbol,this.symbol),j=i.indexOf("url")===0,k){k[q?"show":"hide"](!0).attr(a).animate(x({x:d-h,y:e-h},k.symbolName?{width:2*h,height:2*h}:{}));}else{if(q&&(h>0||j)){g.graphic=c.renderer.symbol(i,d-h,e-h,2*h,2*h,o?n:l).attr(a).add(r);}}}else{if(k){g.graphic=k.destroy();}}}}},convertAttribs:function(a,b,c,d){var e=this.pointAttrToOptions,f,g,h={},a=a||{},b=b||{},c=c||{},d=d||{};for(f in e){g=e[f],h[f]=p(a[g],b[f],c[f],d[f]);}return h;},getAttribs:function(){var a=this,b=a.options,c=ga[a.type].marker?b.marker:b,d=c.states,e=d.hover,f,g=a.color,h=a.options.negativeColor,i={stroke:g,fill:g},j=a.points||[],k,l=[],m,n=a.pointAttrToOptions;f=a.hasPointSpecificOptions;var o=c.lineColor,A=c.fillColor;k=b.turboThreshold;var r=a.zones,t=a.zoneAxis||"y",w,v;b.marker?(e.radius=+e.radius||+c.radius+ +e.radiusPlus,e.lineWidth=e.lineWidth||c.lineWidth+e.lineWidthPlus):(e.color=e.color||na(e.color||g).brighten(e.brightness).get(),e.negativeColor=e.negativeColor||na(e.negativeColor||h).brighten(e.brightness).get());l[""]=a.convertAttribs(c,i);q(["hover","select"],function(b){l[b]=a.convertAttribs(d[b],l[""]);});a.pointAttr=l;g=j.length;if(!k||g<k||f){for(;g--;){k=j[g];if((c=k.options&&k.options.marker||k.options)&&c.enabled===!1){c.radius=0;}i=null;if(r.length){f=0;for(i=r[f];k[t]>=i.value;){i=r[++f];}k.color=k.fillColor=i=p(i.color,a.color);}f=b.colorByPoint||k.color;if(k.options){for(v in n){s(c[n[v]])&&(f=!0);}}if(f){c=c||{};m=[];d=c.states||{};f=d.hover=d.hover||{};if(!b.marker||k.negative&&!f.fillColor&&!e.fillColor){f[a.pointAttrToOptions.fill]=f.color||!k.options.color&&e[k.negative&&h?"negativeColor":"color"]||na(k.color).brighten(f.brightness||e.brightness).get();}w={color:k.color};if(!A){w.fillColor=k.color;}if(!o){w.lineColor=k.color;}c.hasOwnProperty("color")&&!c.color&&delete c.color;if(i&&!e.fillColor){f.fillColor=i;}m[""]=a.convertAttribs(x(w,c),l[""]);m.hover=a.convertAttribs(d.hover,l.hover,m[""]);m.select=a.convertAttribs(d.select,l.select,m[""]);}else{m=l;}k.pointAttr=m;}}},destroy:function(){var a=this,b=a.chart,c=/AppleWebKit\/533/.test(Ba),d,e=a.data||[],f,g,h;H(a,"destroy");Y(a);q(a.axisTypes||[],function(b){if(h=a[b]){ra(h.series,a),h.isDirty=h.forceRedraw=!0;}});a.legendItem&&a.chart.legend.destroyItem(a);for(d=e.length;d--;){(f=e[d])&&f.destroy&&f.destroy();}a.points=null;clearTimeout(a.animationTimeout);for(g in a){a[g] instanceof J&&!a[g].survive&&(d=c&&g==="group"?"hide":"destroy",a[g][d]());}if(b.hoverSeries===a){b.hoverSeries=null;}ra(b.series,a);for(g in a){delete a[g];}},getGraphPath:function(a,b,c){var d=this,e=d.options,f=e.step,g,h=[],i=[],j,a=a||d.points;(g=a.reversed)&&a.reverse();(f={right:1,center:2}[f]||f&&3)&&g&&(f=4-f);e.connectNulls&&!b&&!c&&(a=this.getValidPoints(a));q(a,function(g,l){var m=g.plotX,n=g.plotY,o=a[l-1];if((g.leftCliff||o&&o.rightCliff)&&!c){j=!0;}g.isNull&&!s(b)&&l>0?j=!e.connectNulls:g.isNull&&!b?j=!0:(l===0||j?o=[X,g.plotX,g.plotY]:d.getPointSpline?o=d.getPointSpline(a,g,l):f?(o=f===1?[S,o.plotX,n]:f===2?[S,(o.plotX+m)/2,o.plotY,S,(o.plotX+m)/2,n]:[S,m,o.plotY],o.push(S,m,n)):o=[S,m,n],i.push(g.x),f&&i.push(g.x),h.push.apply(h,o),j=!1);});h.xMap=i;return d.graphPath=h;},drawGraph:function(){var a=this,b=this.options,c=[["graph",b.lineColor||this.color,b.dashStyle]],d=b.lineWidth,e=b.linecap!=="square",f=(this.gappedPath||this.getGraphPath).call(this);q(this.zones,function(d,e){c.push(["zoneGraph"+e,d.color||a.color,d.dashStyle||b.dashStyle]);});q(c,function(c,h){var i=c[0],j=a[i];if(j){j.endX=f.xMap,j.animate({d:f});}else{if(d&&f.length){j={stroke:c[1],"stroke-width":d,fill:"none",zIndex:1},c[2]?j.dashstyle=c[2]:e&&(j["stroke-linecap"]=j["stroke-linejoin"]="round"),j=a[i]=a.chart.renderer.path(f).attr(j).add(a.group).shadow(h<2&&b.shadow);}}if(j){j.startX=f.xMap,j.isArea=f.isArea;}});},applyZones:function(){var a=this,b=this.chart,c=b.renderer,d=this.zones,e,f,g=this.clips||[],h,i=this.graph,j=this.area,k=t(b.chartWidth,b.chartHeight),l=this[(this.zoneAxis||"y")+"Axis"],m,n,o=b.inverted,A,r,s,w,v=!1;if(d.length&&(i||j)&&l&&l.min!==z){n=l.reversed,A=l.horiz,i&&i.hide(),j&&j.hide(),m=l.getExtremes(),q(d,function(d,q){e=n?A?b.plotWidth:0:A?0:l.toPixels(m.min);e=F(t(p(f,e),0),k);f=F(t(C(l.toPixels(p(d.value,m.max),!0)),0),k);v&&(e=f=l.toPixels(m.max));r=Math.abs(e-f);s=F(e,f);w=t(e,f);if(l.isXAxis){if(h={x:o?w:s,y:0,width:r,height:k},!A){h.x=b.plotHeight-h.x;}}else{if(h={x:0,y:o?w:s,width:k,height:r},A){h.y=b.plotWidth-h.y;}}o&&c.isVML&&(h=l.isXAxis?{x:0,y:n?s:w,height:h.width,width:b.chartWidth}:{x:h.y-b.plotLeft-b.spacingBox.x,y:0,width:h.height,height:b.chartHeight});g[q]?g[q].animate(h):(g[q]=c.clipRect(h),i&&a["zoneGraph"+q].clip(g[q]),j&&a["zoneArea"+q].clip(g[q]));v=d.value>m.max;}),this.clips=g;}},invertGroups:function(){function a(){var a={width:b.yAxis.len,height:b.xAxis.len};q(["group","markerGroup"],function(c){b[c]&&b[c].attr(a).invert();});}var b=this,c=b.chart;if(b.xAxis){N(c,"resize",a),N(b,"destroy",function(){Y(c,"resize",a);}),a(),b.invertGroups=a;}},plotGroup:function(a,b,c,d,e){var f=this[a],g=!f;g&&(this[a]=f=this.chart.renderer.g(b).attr({zIndex:d||0.1}).add(e),f.addClass("highcharts-series-"+this.index));f.attr({visibility:c})[g?"attr":"animate"](this.getPlotBox());return f;},getPlotBox:function(){var a=this.chart,b=this.xAxis,c=this.yAxis;if(a.inverted){b=c,c=this.xAxis;}return{translateX:b?b.left:a.plotLeft,translateY:c?c.top:a.plotTop,scaleX:1,scaleY:1};},render:function(){var a=this,b=a.chart,c,d=a.options,e=!!a.animate&&b.renderer.isSVG&&Wa(d.animation).duration,f=a.visible?"inherit":"hidden",g=d.zIndex,h=a.hasRendered,i=b.seriesGroup;c=a.plotGroup("group","series",f,g,i);a.markerGroup=a.plotGroup("markerGroup","markers",f,g,i);e&&a.animate(!0);a.getAttribs();c.inverted=a.isCartesian?b.inverted:!1;a.drawGraph&&(a.drawGraph(),a.applyZones());q(a.points,function(a){a.redraw&&a.redraw();});a.drawDataLabels&&a.drawDataLabels();a.visible&&a.drawPoints();a.drawTracker&&a.options.enableMouseTracking!==!1&&a.drawTracker();b.inverted&&a.invertGroups();d.clip!==!1&&!a.sharedClipKey&&!h&&c.clip(b.clipRect);e&&a.animate();if(!h){a.animationTimeout=Sa(function(){a.afterAnimate();},e);}a.isDirty=a.isDirtyData=!1;a.hasRendered=!0;},redraw:function(){var a=this.chart,b=this.isDirty||this.isDirtyData,c=this.group,d=this.xAxis,e=this.yAxis;c&&(a.inverted&&c.attr({width:a.plotWidth,height:a.plotHeight}),c.animate({translateX:p(d&&d.left,a.plotLeft),translateY:p(e&&e.top,a.plotTop)}));this.translate();this.render();b&&delete this.kdTree;},kdDimensions:1,kdAxisArray:["clientX","plotY"],searchPoint:function(a,b){var c=this.xAxis,d=this.yAxis,e=this.chart.inverted;return this.searchKDTree({clientX:e?c.len-a.chartY+c.pos:a.chartX-c.pos,plotY:e?d.len-a.chartX+d.pos:a.chartY-d.pos},b);},buildKDTree:function(){function a(c,e,f){var g,h;if(h=c&&c.length){return g=b.kdAxisArray[e%f],c.sort(function(a,b){return a[g]-b[g];}),h=Math.floor(h/2),{point:c[h],left:a(c.slice(0,h),e+1,f),right:a(c.slice(h+1),e+1,f)};}}var b=this,c=b.kdDimensions;delete b.kdTree;Sa(function(){b.kdTree=a(b.getValidPoints(null,!b.directTouch),c,c);},b.options.kdNow?0:1);},searchKDTree:function(a,b){function c(a,b,j,k){var l=b.point,m=d.kdAxisArray[j%k],n,o,p=l;o=s(a[e])&&s(l[e])?Math.pow(a[e]-l[e],2):null;n=s(a[f])&&s(l[f])?Math.pow(a[f]-l[f],2):null;n=(o||0)+(n||0);l.dist=s(n)?Math.sqrt(n):Number.MAX_VALUE;l.distX=s(o)?Math.sqrt(o):Number.MAX_VALUE;m=a[m]-l[m];n=m<0?"left":"right";o=m<0?"right":"left";b[n]&&(n=c(a,b[n],j+1,k),p=n[g]<p[g]?n:l);b[o]&&Math.sqrt(m*m)<p[g]&&(a=c(a,b[o],j+1,k),p=a[g]<p[g]?a:p);return p;}var d=this,e=this.kdAxisArray[0],f=this.kdAxisArray[1],g=b?"distX":"dist";this.kdTree||this.buildKDTree();if(this.kdTree){return c(a,this.kdTree,this.kdDimensions,this.kdDimensions);}}};Mb.prototype={destroy:function(){Ua(this,this.axis);},render:function(a){var b=this.options,c=b.format,c=c?Na(c,this):b.formatter.call(this);this.label?this.label.attr({text:c,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(c,null,null,b.useHTML).css(b.style).attr({align:this.textAlign,rotation:b.rotation,visibility:"hidden"}).add(a);},setOffset:function(a,b){var c=this.axis,d=c.chart,e=d.inverted,f=c.reversed,f=this.isNegative&&!f||!this.isNegative&&f,g=c.translate(c.usePercentage?100:this.total,0,0,0,1),c=c.translate(0),c=Q(g-c),h=d.xAxis[0].translate(this.x)+a,i=d.plotHeight,f={x:e?f?g:g-c:h,y:e?i-h-b:f?i-g-c:i-g,width:e?c:b,height:e?b:c};if(e=this.label){e.align(this.alignOptions,null,f),f=e.alignAttr,e[this.options.crop===!1||d.isInsidePlot(f.x,f.y)?"show":"hide"](!0);}}};jb.prototype.getStacks=function(){var a=this;q(a.yAxis,function(a){if(a.stacks&&a.hasVisibleSeries){a.oldStacks=a.stacks;}});q(a.series,function(b){if(b.options.stacking&&(b.visible===!0||a.options.chart.ignoreHiddenSeries===!1)){b.stackKey=b.type+p(b.options.stack,"");}});};ia.prototype.buildStacks=function(){var a=this.series,b,c=p(this.options.reversedStacks,!0),d=a.length,e;if(!this.isXAxis){this.usePercentage=!1;for(e=d;e--;){a[c?e:d-e-1].setStackedPoints();}for(e=d;e--;){b=a[c?e:d-e-1],b.setStackCliffs&&b.setStackCliffs();}if(this.usePercentage){for(e=0;e<d;e++){a[e].setPercentStacks();}}}};ia.prototype.renderStackTotals=function(){var a=this.chart,b=a.renderer,c=this.stacks,d,e,f=this.stackTotalGroup;if(!f){this.stackTotalGroup=f=b.g("stack-labels").attr({visibility:"visible",zIndex:6}).add();}f.translate(a.plotLeft,a.plotTop);for(d in c){for(e in a=c[d],a){a[e].render(f);}}};ia.prototype.resetStacks=function(){var a=this.stacks,b,c;if(!this.isXAxis){for(b in a){for(c in a[b]){a[b][c].touched<this.stacksTouched?(a[b][c].destroy(),delete a[b][c]):(a[b][c].total=null,a[b][c].cum=0);}}}};ia.prototype.cleanStacks=function(){var a,b,c;if(!this.isXAxis){if(this.oldStacks){a=this.stacks=this.oldStacks;}for(b in a){for(c in a[b]){a[b][c].cum=a[b][c].total;}}}};R.prototype.setStackedPoints=function(){if(this.options.stacking&&!(this.visible!==!0&&this.chart.options.chart.ignoreHiddenSeries!==!1)){var a=this.processedXData,b=this.processedYData,c=[],d=b.length,e=this.options,f=e.threshold,g=e.startFromThreshold?f:0,h=e.stack,e=e.stacking,i=this.stackKey,j="-"+i,k=this.negStacks,l=this.yAxis,m=l.stacks,n=l.oldStacks,o,q,r,x,w,v,u;l.stacksTouched+=1;for(w=0;w<d;w++){v=a[w];u=b[w];o=this.getStackIndicator(o,v,this.index);x=o.key;r=(q=k&&u<(g?0:f))?j:i;m[r]||(m[r]={});if(!m[r][v]){n[r]&&n[r][v]?(m[r][v]=n[r][v],m[r][v].total=null):m[r][v]=new Mb(l,l.options.stackLabels,q,v,h);}r=m[r][v];if(u!==null){r.points[x]=r.points[this.index]=[p(r.cum,g)];if(!s(r.cum)){r.base=x;}r.touched=l.stacksTouched;o.index>0&&this.singleStacks===!1&&(r.points[x][0]=r.points[this.index+","+v+",0"][0]);}e==="percent"?(q=q?i:j,k&&m[q]&&m[q][v]?(q=m[q][v],r.total=q.total=t(q.total,r.total)+Q(u)||0):r.total=$(r.total+(Q(u)||0))):r.total=$(r.total+(u||0));r.cum=p(r.cum,g)+(u||0);if(u!==null){r.points[x].push(r.cum),c[w]=r.cum;}}if(e==="percent"){l.usePercentage=!0;}this.stackedYData=c;l.oldStacks={};}};R.prototype.setPercentStacks=function(){var a=this,b=a.stackKey,c=a.yAxis.stacks,d=a.processedXData,e;q([b,"-"+b],function(b){var f;for(var g=d.length,h,i;g--;){if(h=d[g],e=a.getStackIndicator(e,h,a.index),f=(i=c[b]&&c[b][h])&&i.points[e.key],h=f){i=i.total?100/i.total:0,h[0]=$(h[0]*i),h[1]=$(h[1]*i),a.stackedYData[g]=h[1];}}});};R.prototype.getStackIndicator=function(a,b,c){!s(a)||a.x!==b?a={x:b,index:0}:a.index++;a.key=[c,b,a.index].join(",");return a;};x(jb.prototype,{addSeries:function(a,b,c){var d,e=this;a&&(b=p(b,!0),H(e,"addSeries",{options:a},function(){d=e.initSeries(a);e.isDirtyLegend=!0;e.linkSeries();b&&e.redraw(c);}));return d;},addAxis:function(a,b,c,d){var e=b?"xAxis":"yAxis",f=this.options,a=E(a,{index:this[e].length,isX:b});new ia(this,a);f[e]=ua(f[e]||{});f[e].push(a);p(c,!0)&&this.redraw(d);},showLoading:function(a){var b=this,c=b.options,d=b.loadingDiv,e=c.loading,f=function(){d&&M(d,{left:b.plotLeft+"px",top:b.plotTop+"px",width:b.plotWidth+"px",height:b.plotHeight+"px"});};if(!d){b.loadingDiv=d=ca(Pa,{className:"highcharts-loading"},x(e.style,{zIndex:10,display:"none"}),b.container),b.loadingSpan=ca("span",null,e.labelStyle,d),N(b,"redraw",f);}b.loadingSpan.innerHTML=a||c.lang.loading;if(!b.loadingShown){M(d,{opacity:0,display:""}),Za(d,{opacity:e.style.opacity},{duration:e.showDuration||0}),b.loadingShown=!0;}f();},hideLoading:function(){var a=this.options,b=this.loadingDiv;b&&Za(b,{opacity:0},{duration:a.loading.hideDuration||100,complete:function(){M(b,{display:"none"});}});this.loadingShown=!1;}});x(Ma.prototype,{update:function(a,b,c,d){function e(){f.applyOptions(a);if(f.y===null&&h){f.graphic=h.destroy();}if(ba(a,!0)){f.redraw=function(){if(h&&h.element&&a&&a.marker&&a.marker.symbol){f.graphic=h.destroy();}if(a&&a.dataLabels&&f.dataLabel){f.dataLabel=f.dataLabel.destroy();}f.redraw=null;};}i=f.index;g.updateParallelArrays(f,i);k.data[i]=ba(k.data[i],!0)?f.options:a;g.isDirty=g.isDirtyData=!0;if(!g.fixedBox&&g.hasCartesianSeries){j.isDirtyBox=!0;}if(k.legendType==="point"){j.isDirtyLegend=!0;}b&&j.redraw(c);}var f=this,g=f.series,h=f.graphic,i,j=g.chart,k=g.options,b=p(b,!0);d===!1?e():f.firePointEvent("update",{options:a},e);},remove:function(a,b){this.series.removePoint(pa(this,this.series.data),a,b);}});x(R.prototype,{addPoint:function(a,b,c,d){var e=this.options,f=this.data,g=this.chart,h=this.xAxis&&this.xAxis.names,i=e.data,j,k,l=this.xData,m,n,b=p(b,!0);j={series:this};this.pointClass.prototype.applyOptions.apply(j,[a]);n=j.x;m=l.length;if(this.requireSorting&&n<l[m-1]){for(k=!0;m&&l[m-1]>n;){m--;}}this.updateParallelArrays(j,"splice",m,0,0);this.updateParallelArrays(j,m);if(h&&j.name){h[n]=j.name;}i.splice(m,0,a);k&&(this.data.splice(m,0,null),this.processData());e.legendType==="point"&&this.generatePoints();c&&(f[0]&&f[0].remove?f[0].remove(!1):(f.shift(),this.updateParallelArrays(j,"shift"),i.shift()));this.isDirtyData=this.isDirty=!0;b&&(this.getAttribs(),g.redraw(d));},removePoint:function(a,b,c){var d=this,e=d.data,f=e[a],g=d.points,h=d.chart,i=function(){g&&g.length===e.length&&g.splice(a,1);e.splice(a,1);d.options.data.splice(a,1);d.updateParallelArrays(f||{series:d},"splice",a,1);f&&f.destroy();d.isDirty=!0;d.isDirtyData=!0;b&&h.redraw();};cb(c,h);b=p(b,!0);f?f.firePointEvent("remove",null,i):i();},remove:function(a,b,c){function d(){e.destroy();f.isDirtyLegend=f.isDirtyBox=!0;f.linkSeries();p(a,!0)&&f.redraw(b);}var e=this,f=e.chart;c!==!1?H(e,"remove",null,d):d();},update:function(a,b){var c=this,d=this.chart,e=this.userOptions,f=this.type,g=L[f].prototype,h=["group","markerGroup","dataLabelsGroup"],i;if(a.type&&a.type!==f||a.zIndex!==void 0){h.length=0;}q(h,function(a){h[a]=c[a];delete c[a];});a=E(e,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},a);this.remove(!1,null,!1);for(i in g){this[i]=z;}x(this,L[a.type||f].prototype);q(h,function(a){c[a]=h[a];});this.init(d,a);d.linkSeries();p(b,!0)&&d.redraw(!1);}});x(ia.prototype,{update:function(a,b){var c=this.chart,a=c.options[this.coll][this.options.index]=E(this.userOptions,a);this.destroy(!0);this.init(c,x(a,{events:z}));c.isDirtyBox=!0;p(b,!0)&&c.redraw();},remove:function(a){for(var b=this.chart,c=this.coll,d=this.series,e=d.length;e--;){d[e]&&d[e].remove(!1);}ra(b.axes,this);ra(b[c],this);b.options[c].splice(this.options.index,1);q(b[c],function(a,b){a.options.index=b;});this.destroy();b.isDirtyBox=!0;p(a,!0)&&b.redraw();},setTitle:function(a,b){this.update({title:a},b);},setCategories:function(a,b){this.update({categories:a},b);}});var xa=sa(R);L.line=xa;ga.area=E(ha,{softThreshold:!1,threshold:0});var qa=sa(R,{type:"area",singleStacks:!1,getStackPoints:function(){var a=[],b=[],c=this.xAxis,d=this.yAxis,e=d.stacks[this.stackKey],f={},g=this.points,h=this.index,i=d.series,j=i.length,k,l=p(d.options.reversedStacks,!0)?1:-1,m,n;if(this.options.stacking){for(m=0;m<g.length;m++){f[g[m].x]=g[m];}for(n in e){e[n].total!==null&&b.push(n);}b.sort(function(a,b){return a-b;});k=Ea(i,function(){return this.visible;});q(b,function(g,i){var n=0,p,s;if(f[g]&&!f[g].isNull){a.push(f[g]),q([-1,1],function(a){var c=a===1?"rightNull":"leftNull",d=0,n=e[b[i+a]];if(n){for(m=h;m>=0&&m<j;){p=n.points[m],p||(m===h?f[g][c]=!0:k[m]&&(s=e[g].points[m])&&(d-=s[1]-s[0])),m+=l;}}f[g][a===1?"rightCliff":"leftCliff"]=d;});}else{for(m=h;m>=0&&m<j;){if(p=e[g].points[m]){n=p[1];break;}m+=l;}n=d.toPixels(n,!0);a.push({isNull:!0,plotX:c.toPixels(g,!0),plotY:n,yBottom:n});}});}return a;},getGraphPath:function(a){var b=R.prototype.getGraphPath,c=this.options,d=c.stacking,e=this.yAxis,f,g,h=[],i=[],j=this.index,k,l=e.stacks[this.stackKey],m=c.threshold,n=e.getThreshold(c.threshold),o,c=c.connectNulls||d==="percent",q=function(b,c,f){var g=a[b],b=d&&l[g.x].points[j],o=g[f+"Null"]||0,f=g[f+"Cliff"]||0,p,q,g=!0;f||o?(p=(o?b[0]:b[1])+f,q=b[0]+f,g=!!o):!d&&a[c]&&a[c].isNull&&(p=q=m);p!==void 0&&(i.push({plotX:k,plotY:p===null?n:e.getThreshold(p),isNull:g}),h.push({plotX:k,plotY:q===null?n:e.getThreshold(q),doCurve:!1}));},a=a||this.points;d&&(a=this.getStackPoints());for(f=0;f<a.length;f++){if(g=a[f].isNull,k=p(a[f].rectPlotX,a[f].plotX),o=p(a[f].yBottom,n),!g||c){c||q(f,f-1,"left");if(!g||d||!c){i.push(a[f]),h.push({x:f,plotX:k,plotY:o});}c||q(f,f+1,"right");}}f=b.call(this,i,!0,!0);h.reversed=!0;g=b.call(this,h,!0,!0);g.length&&(g[0]=S);g=f.concat(g);b=b.call(this,i,!1,c);g.xMap=f.xMap;this.areaPath=g;return b;},drawGraph:function(){this.areaPath=[];R.prototype.drawGraph.apply(this);var a=this,b=this.areaPath,c=this.options,d=[["area",this.color,c.fillColor]];q(this.zones,function(b,f){d.push(["zoneArea"+f,b.color||a.color,b.fillColor||c.fillColor]);});q(d,function(d){var f=d[0],g=a[f];g?(g.endX=b.xMap,g.animate({d:b})):(g={fill:d[2]||d[1],zIndex:0},d[2]||(g["fill-opacity"]=p(c.fillOpacity,0.75)),g=a[f]=a.chart.renderer.path(b).attr(g).add(a.group),g.isArea=!0);g.startX=b.xMap;g.shiftUnit=c.step?2:1;});},drawLegendSymbol:P.drawRectangle});L.area=qa;ga.spline=E(ha);xa=sa(R,{type:"spline",getPointSpline:function(a,b,c){var d=b.plotX,e=b.plotY,f=a[c-1],c=a[c+1],g,h,i,j;if(f&&!f.isNull&&f.doCurve!==!1&&c&&!c.isNull&&c.doCurve!==!1){a=f.plotY;i=c.plotX;var c=c.plotY,k=0;g=(1.5*d+f.plotX)/2.5;h=(1.5*e+a)/2.5;i=(1.5*d+i)/2.5;j=(1.5*e+c)/2.5;i!==g&&(k=(j-h)*(i-d)/(i-g)+e-j);h+=k;j+=k;h>a&&h>e?(h=t(a,e),j=2*e-h):h<a&&h<e&&(h=F(a,e),j=2*e-h);j>c&&j>e?(j=t(c,e),h=2*e-j):j<c&&j<e&&(j=F(c,e),h=2*e-j);b.rightContX=i;b.rightContY=j;}b=["C",p(f.rightContX,f.plotX),p(f.rightContY,f.plotY),p(g,d),p(h,e),d,e];f.rightContX=f.rightContY=null;return b;}});L.spline=xa;ga.areaspline=E(ga.area);qa=qa.prototype;xa=sa(xa,{type:"areaspline",getStackPoints:qa.getStackPoints,getGraphPath:qa.getGraphPath,setStackCliffs:qa.setStackCliffs,drawGraph:qa.drawGraph,drawLegendSymbol:P.drawRectangle});L.areaspline=xa;ga.column=E(ha,{borderColor:"#FFFFFF",borderRadius:0,groupPadding:0.2,marker:null,pointPadding:0.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:0.1,shadow:!1,halo:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0});xa=sa(R,{type:"column",pointAttrToOptions:{stroke:"borderColor",fill:"color",r:"borderRadius"},cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){R.prototype.init.apply(this,arguments);var a=this,b=a.chart;b.hasRendered&&q(b.series,function(b){if(b.type===a.type){b.isDirty=!0;}});},getColumnMetrics:function(){var a=this,b=a.options,c=a.xAxis,d=a.yAxis,e=c.reversed,f,g={},h=0;b.grouping===!1?h=1:q(a.chart.series,function(b){var c=b.options,e=b.yAxis,i;if(b.type===a.type&&b.visible&&d.len===e.len&&d.pos===e.pos){c.stacking?(f=b.stackKey,g[f]===z&&(g[f]=h++),i=g[f]):c.grouping!==!1&&(i=h++),b.columnIndex=i;}});var i=F(Q(c.transA)*(c.ordinalSlope||b.pointRange||c.closestPointRange||c.tickInterval||1),c.len),j=i*b.groupPadding,k=(i-2*j)/h,b=F(b.maxPointWidth||c.len,p(b.pointWidth,k*(1-2*b.pointPadding)));a.columnMetrics={width:b,offset:(k-b)/2+(j+((a.columnIndex||0)+(e?1:0))*k-i/2)*(e?-1:1)};return a.columnMetrics;},crispCol:function(a,b,c,d){var e=this.chart,f=this.borderWidth,g=-(f%2?0.5:0),f=f%2?0.5:1;e.inverted&&e.renderer.isVML&&(f+=1);c=Math.round(a+c)+g;a=Math.round(a)+g;c-=a;d=Math.round(b+d)+f;g=Q(b)<=0.5&&d>0.5;b=Math.round(b)+f;d-=b;g&&d&&(b-=1,d+=1);return{x:a,y:b,width:c,height:d};},translate:function(){var a=this,b=a.chart,c=a.options,d=a.borderWidth=p(c.borderWidth,a.closestPointRange*a.xAxis.transA<2?0:1),e=a.yAxis,f=a.translatedThreshold=e.getThreshold(c.threshold),g=p(c.minPointLength,5),h=a.getColumnMetrics(),i=h.width,j=a.barW=t(i,1+2*d),k=a.pointXOffset=h.offset;b.inverted&&(f-=0.5);c.pointPadding&&(j=va(j));R.prototype.translate.apply(a);q(a.points,function(c){var d=F(p(c.yBottom,f),90000),h=999+Q(d),h=F(t(-h,c.plotY),e.len+h),o=c.plotX+k,q=j,r=F(h,d),s,w=t(h,d)-r;Q(w)<g&&g&&(w=g,s=!e.reversed&&!c.negative||e.reversed&&c.negative,r=Q(r-f)>g?d-g:f-(s?g:0));c.barX=o;c.pointWidth=i;c.tooltipPos=b.inverted?[e.len+e.pos-b.plotLeft-h,a.xAxis.len-o-q/2,w]:[o+q/2,h+e.pos-b.plotTop,w];c.shapeType="rect";c.shapeArgs=a.crispCol.apply(a,c.isNull?[c.plotX,e.len/2,0,0]:[o,r,q,w]);});},getSymbol:Ca,drawLegendSymbol:P.drawRectangle,drawGraph:Ca,drawPoints:function(){var a=this,b=this.chart,c=a.options,d=b.renderer,e=c.animationLimit||250,f,g;q(a.points,function(h){var i=h.graphic,j;if(I(h.plotY)&&h.y!==null){f=h.shapeArgs,j=s(a.borderWidth)?{"stroke-width":a.borderWidth}:{},g=h.pointAttr[h.selected?"select":""]||a.pointAttr[""],i?(Ka(i),i.attr(j).attr(g)[b.pointCount<e?"animate":"attr"](E(f))):h.graphic=d[h.shapeType](f).attr(j).attr(g).add(h.group||a.group).shadow(c.shadow,null,c.stacking&&!c.borderRadius);}else{if(i){h.graphic=i.destroy();}}});},animate:function(a){var b=this,c=this.yAxis,d=b.options,e=this.chart.inverted,f={};if(fa){a?(f.scaleY=0.001,a=F(c.pos+c.len,t(c.pos,c.toPixels(d.threshold))),e?f.translateX=a-c.len:f.translateY=a,b.group.attr(f)):(f[e?"translateX":"translateY"]=c.pos,b.group.animate(f,x(Wa(b.options.animation),{step:function(a,c){b.group.attr({scaleY:t(0.001,c.pos)});}})),b.animate=null);}},remove:function(){var a=this,b=a.chart;b.hasRendered&&q(b.series,function(b){if(b.type===a.type){b.isDirty=!0;}});R.prototype.remove.apply(a,arguments);}});L.column=xa;ga.bar=E(ga.column);qa=sa(xa,{type:"bar",inverted:!0});L.bar=qa;ga.scatter=E(ha,{lineWidth:0,marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">\u25cf</span> <span style="font-size: 10px;"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}});qa=sa(R,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,kdDimensions:2,drawGraph:function(){this.options.lineWidth&&R.prototype.drawGraph.call(this);}});L.scatter=qa;ga.pie=E(ha,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.y===null?void 0:this.point.name;},x:0},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:0.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});ha={type:"pie",isCartesian:!1,pointClass:sa(Ma,{init:function(){Ma.prototype.init.apply(this,arguments);var a=this,b;a.name=p(a.name,"Slice");b=function(b){a.slice(b.type==="select");};N(a,"select",b);N(a,"unselect",b);return a;},setVisible:function(a,b){var c=this,d=c.series,e=d.chart,f=d.options.ignoreHiddenPoint,b=p(b,f);if(a!==c.visible){c.visible=c.options.visible=a=a===z?!c.visible:a;d.options.data[pa(c,d.data)]=c.options;q(["graphic","dataLabel","connector","shadowGroup"],function(b){if(c[b]){c[b][a?"show":"hide"](!0);}});c.legendItem&&e.legend.colorizeItem(c,a);!a&&c.state==="hover"&&c.setState("");if(f){d.isDirty=!0;}b&&e.redraw();}},slice:function(a,b,c){var d=this.series;cb(c,d.chart);p(b,!0);this.sliced=this.options.sliced=a=s(a)?a:!this.sliced;d.options.data[pa(this,d.data)]=this.options;a=a?this.slicedTranslation:{translateX:0,translateY:0};this.graphic.animate(a);this.shadowGroup&&this.shadowGroup.animate(a);},haloPath:function(a){var b=this.shapeArgs,c=this.series.chart;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(c.plotLeft+b.x,c.plotTop+b.y,b.r+a,b.r+a,{innerR:this.shapeArgs.r,start:b.start,end:b.end});}}),requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},animate:function(a){var b=this,c=b.points,d=b.startAngleRad;if(!a){q(c,function(a){var c=a.graphic,g=a.shapeArgs;c&&(c.attr({r:a.startR||b.center[3]/2,start:d,end:d}),c.animate({r:g.r,start:g.start,end:g.end},b.options.animation));}),b.animate=null;}},updateTotals:function(){var a,b=0,c=this.points,d=c.length,e,f=this.options.ignoreHiddenPoint;for(a=0;a<d;a++){e=c[a];if(e.y<0){e.y=null;}b+=f&&!e.visible?0:e.y;}this.total=b;for(a=0;a<d;a++){e=c[a],e.percentage=b>0&&(e.visible||!f)?e.y/b*100:0,e.total=b;}},generatePoints:function(){R.prototype.generatePoints.call(this);this.updateTotals();},translate:function(a){this.generatePoints();var b=0,c=this.options,d=c.slicedOffset,e=d+c.borderWidth,f,g,h,i=c.startAngle||0,j=this.startAngleRad=ta/180*(i-90),i=(this.endAngleRad=ta/180*(p(c.endAngle,i+360)-90))-j,k=this.points,l=c.dataLabels.distance,c=c.ignoreHiddenPoint,m,n=k.length,o;if(!a){this.center=a=this.getCenter();}this.getX=function(b,c){h=Z.asin(F((b-a[1])/(a[2]/2+l),1));return a[0]+(c?-1:1)*W(h)*(a[2]/2+l);};for(m=0;m<n;m++){o=k[m];f=j+b*i;if(!c||o.visible){b+=o.percentage/100;}g=j+b*i;o.shapeType="arc";o.shapeArgs={x:a[0],y:a[1],r:a[2]/2,innerR:a[3]/2,start:C(f*1000)/1000,end:C(g*1000)/1000};h=(g+f)/2;h>1.5*ta?h-=2*ta:h<-ta/2&&(h+=2*ta);o.slicedTranslation={translateX:C(W(h)*d),translateY:C(da(h)*d)};f=W(h)*a[2]/2;g=da(h)*a[2]/2;o.tooltipPos=[a[0]+f*0.7,a[1]+g*0.7];o.half=h<-ta/2||h>ta/2?1:0;o.angle=h;e=F(e,l/2);o.labelPos=[a[0]+f+W(h)*l,a[1]+g+da(h)*l,a[0]+f+W(h)*e,a[1]+g+da(h)*e,a[0]+f,a[1]+g,l<0?"center":o.half?"right":"left",h];}},drawGraph:null,drawPoints:function(){var a=this,b=a.chart.renderer,c,d,e=a.options.shadow,f,g,h,i;if(e&&!a.shadowGroup){a.shadowGroup=b.g("shadow").add(a.group);}q(a.points,function(j){if(j.y!==null){d=j.graphic;h=j.shapeArgs;f=j.shadowGroup;g=j.pointAttr[j.selected?"select":""];if(!g.stroke){g.stroke=g.fill;}if(e&&!f){f=j.shadowGroup=b.g("shadow").add(a.shadowGroup);}c=j.sliced?j.slicedTranslation:{translateX:0,translateY:0};f&&f.attr(c);if(d){d.setRadialReference(a.center).attr(g).animate(x(h,c));}else{i={"stroke-linejoin":"round"};if(!j.visible){i.visibility="hidden";}j.graphic=d=b[j.shapeType](h).setRadialReference(a.center).attr(g).attr(i).attr(c).add(a.group).shadow(e,f);}}});},searchPoint:Ca,sortByAngle:function(a,b){a.sort(function(a,d){return a.angle!==void 0&&(d.angle-a.angle)*b;});},drawLegendSymbol:P.drawRectangle,getCenter:Eb.getCenter,getSymbol:Ca};ha=sa(R,ha);L.pie=ha;R.prototype.drawDataLabels=function(){var a=this,b=a.options,c=b.cursor,d=b.dataLabels,e=a.points,f,g,h=a.hasRendered||0,i,j,k=p(d.defer,!0),l=a.chart.renderer;if(d.enabled||a._hasPointLabels){a.dlProcessOptions&&a.dlProcessOptions(d),j=a.plotGroup("dataLabelsGroup","data-labels",k&&!h?"hidden":"visible",d.zIndex||6),k&&(j.attr({opacity:+h}),h||N(a,"afterAnimate",function(){a.visible&&j.show(!0);j[b.animation?"animate":"attr"]({opacity:1},{duration:200});})),g=d,q(e,function(e){var h,k=e.dataLabel,q,r,t=e.connector,w=!0,v,u={};f=e.dlOptions||e.options&&e.options.dataLabels;h=p(f&&f.enabled,g.enabled)&&e.y!==null;if(k&&!h){e.dataLabel=k.destroy();}else{if(h){d=E(g,f);v=d.style;h=d.rotation;q=e.getLabelConfig();i=d.format?Na(d.format,q):d.formatter.call(q,d);v.color=p(d.color,v.color,a.color,"black");if(k){if(s(i)){k.attr({text:i}),w=!1;}else{if(e.dataLabel=k=k.destroy(),t){e.connector=t.destroy();}}}else{if(s(i)){k={fill:d.backgroundColor,stroke:d.borderColor,"stroke-width":d.borderWidth,r:d.borderRadius||0,rotation:h,padding:d.padding,zIndex:1};if(v.color==="contrast"){u.color=d.inside||d.distance<0||b.stacking?l.getContrast(e.color||a.color):"#000000";}if(c){u.cursor=c;}for(r in k){k[r]===z&&delete k[r];}k=e.dataLabel=l[h?"text":"label"](i,0,-9999,d.shape,null,null,d.useHTML).attr(k).css(x(v,u)).add(j).shadow(d.shadow);}}k&&a.alignDataLabel(e,k,d,null,w);}}});}};R.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart,g=f.inverted,h=p(a.plotX,-9999),i=p(a.plotY,-9999),j=b.getBBox(),k=f.renderer.fontMetrics(c.style.fontSize).b,l=c.rotation,m=c.align,n=this.visible&&(a.series.forceDL||f.isInsidePlot(h,C(i),g)||d&&f.isInsidePlot(h,g?d.x+1:d.y+d.height-1,g)),o=p(c.overflow,"justify")==="justify";if(n){d=x({x:g?f.plotWidth-i:h,y:C(g?f.plotHeight-h:i),width:0,height:0},d),x(c,{width:j.width,height:j.height}),l?(o=!1,g=f.renderer.rotCorr(k,l),g={x:d.x+c.x+d.width/2+g.x,y:d.y+c.y+{top:0,middle:0.5,bottom:1}[c.verticalAlign]*d.height},b[e?"attr":"animate"](g).attr({align:m}),h=(l+720)%360,h=h>180&&h<360,m==="left"?g.y-=h?j.height:0:m==="center"?(g.x-=j.width/2,g.y-=j.height/2):m==="right"&&(g.x-=j.width,g.y-=h?0:j.height)):(b.align(c,null,d),g=b.alignAttr),o?this.justifyDataLabel(b,c,g,j,d,e):p(c.crop,!0)&&(n=f.isInsidePlot(g.x,g.y)&&f.isInsidePlot(g.x+j.width,g.y+j.height)),c.shape&&!l&&b.attr({anchorX:a.plotX,anchorY:a.plotY});}if(!n){Ka(b),b.attr({y:-9999}),b.placed=!1;}};R.prototype.justifyDataLabel=function(a,b,c,d,e,f){var g=this.chart,h=b.align,i=b.verticalAlign,j,k,l=a.box?0:a.padding||0;j=c.x+l;if(j<0){h==="right"?b.align="left":b.x=-j,k=!0;}j=c.x+d.width-l;if(j>g.plotWidth){h==="left"?b.align="right":b.x=g.plotWidth-j,k=!0;}j=c.y+l;if(j<0){i==="bottom"?b.verticalAlign="top":b.y=-j,k=!0;}j=c.y+d.height-l;if(j>g.plotHeight){i==="top"?b.verticalAlign="bottom":b.y=g.plotHeight-j,k=!0;}if(k){a.placed=!f,a.align(b,null,e);}};if(L.pie){L.pie.prototype.drawDataLabels=function(){var a=this,b=a.data,c,d=a.chart,e=a.options.dataLabels,f=p(e.connectorPadding,10),g=p(e.connectorWidth,1),h=d.plotWidth,i=d.plotHeight,j,k,l=p(e.softConnector,!0),m=e.distance,n=a.center,o=n[2]/2,s=n[1],r=m>0,u,w,v,x=[[],[]],z,y,D,E,B,G=[0,0,0,0],M=function(a,b){return b.y-a.y;};if(a.visible&&(e.enabled||a._hasPointLabels)){R.prototype.drawDataLabels.apply(a);q(b,function(a){if(a.dataLabel&&a.visible){x[a.half].push(a),a.dataLabel._pos=null;}});for(E=2;E--;){var H=[],N=[],I=x[E],L=I.length,J;if(L){a.sortByAngle(I,E-0.5);for(B=b=0;!b&&I[B];){b=I[B]&&I[B].dataLabel&&(I[B].dataLabel.getBBox().height||21),B++;}if(m>0){w=F(s+o+m,d.plotHeight);for(B=t(0,s-o-m);B<=w;B+=b){H.push(B);}w=H.length;if(L>w){c=[].concat(I);c.sort(M);for(B=L;B--;){c[B].rank=B;}for(B=L;B--;){I[B].rank>=w&&I.splice(B,1);}L=I.length;}for(B=0;B<L;B++){c=I[B];v=c.labelPos;c=9999;var P,O;for(O=0;O<w;O++){P=Q(H[O]-v[1]),P<c&&(c=P,J=O);}if(J<B&&H[B]!==null){J=B;}else{for(w<L-B+J&&H[B]!==null&&(J=w-L+B);H[J]===null;){J++;}}N.push({i:J,y:H[J]});H[J]=null;}N.sort(M);}for(B=0;B<L;B++){c=I[B];v=c.labelPos;u=c.dataLabel;D=c.visible===!1?"hidden":"inherit";c=v[1];if(m>0){if(w=N.pop(),J=w.i,y=w.y,c>y&&H[J+1]!==null||c<y&&H[J-1]!==null){y=F(t(0,c),d.plotHeight);}}else{y=c;}z=e.justify?n[0]+(E?-1:1)*(o+m):a.getX(y===s-o-m||y===s+o+m?c:y,E);u._attr={visibility:D,align:v[6]};u._pos={x:z+e.x+({left:f,right:-f}[v[6]]||0),y:y+e.y-10};u.connX=z;u.connY=y;if(this.options.size===null){w=u.width,z-w<f?G[3]=t(C(w-z+f),G[3]):z+w>h-f&&(G[1]=t(C(z+w-h+f),G[1])),y-b/2<0?G[0]=t(C(-y+b/2),G[0]):y+b/2>i&&(G[2]=t(C(y+b/2-i),G[2]));}}}}if(Ha(G)===0||this.verifyDataLabelOverflow(G)){this.placeDataLabels(),r&&g&&q(this.points,function(b){j=b.connector;v=b.labelPos;if((u=b.dataLabel)&&u._pos&&b.visible){D=u._attr.visibility,z=u.connX,y=u.connY,k=l?[X,z+(v[6]==="left"?5:-5),y,"C",z,y,2*v[2]-v[4],2*v[3]-v[5],v[2],v[3],S,v[4],v[5]]:[X,z+(v[6]==="left"?5:-5),y,S,v[2],v[3],S,v[4],v[5]],j?(j.animate({d:k}),j.attr("visibility",D)):b.connector=j=a.chart.renderer.path(k).attr({"stroke-width":g,stroke:e.connectorColor||b.color||"#606060",visibility:D}).add(a.dataLabelsGroup);}else{if(j){b.connector=j.destroy();}}});}}},L.pie.prototype.placeDataLabels=function(){q(this.points,function(a){var b=a.dataLabel;if(b&&a.visible){(a=b._pos)?(b.attr(b._attr),b[b.moved?"animate":"attr"](a),b.moved=!0):b&&b.attr({y:-9999});}});},L.pie.prototype.alignDataLabel=Ca,L.pie.prototype.verifyDataLabelOverflow=function(a){var b=this.center,c=this.options,d=c.center,e=c.minSize||80,f=e,g;d[0]!==null?f=t(b[2]-t(a[1],a[3]),e):(f=t(b[2]-a[1]-a[3],e),b[0]+=(a[3]-a[1])/2);d[1]!==null?f=t(F(f,b[2]-t(a[0],a[2])),e):(f=t(F(f,b[2]-a[0]-a[2]),e),b[1]+=(a[0]-a[2])/2);f<b[2]?(b[2]=f,b[3]=Math.min(/%$/.test(c.innerSize||0)?f*parseFloat(c.innerSize||0)/100:parseFloat(c.innerSize||0),f),this.translate(b),this.drawDataLabels&&this.drawDataLabels()):g=!0;return g;};}if(L.column){L.column.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart.inverted,g=a.series,h=a.dlBox||a.shapeArgs,i=p(a.below,a.plotY>p(this.translatedThreshold,g.yAxis.len)),j=p(c.inside,!!this.options.stacking);if(h){d=E(h);if(d.y<0){d.height+=d.y,d.y=0;}h=d.y+d.height-g.yAxis.len;h>0&&(d.height-=h);f&&(d={x:g.yAxis.len-d.y-d.height,y:g.xAxis.len-d.x-d.width,width:d.height,height:d.width});if(!j){f?(d.x+=i?0:d.width,d.width=0):(d.y+=i?d.height:0,d.height=0);}}c.align=p(c.align,!f||j?"center":i?"right":"left");c.verticalAlign=p(c.verticalAlign,f||j?"middle":i?"top":"bottom");R.prototype.alignDataLabel.call(this,a,b,c,d,e);};}(function(a){var b=a.Chart,c=a.each,d=a.pick,e=a.addEvent;b.prototype.callbacks.push(function(a){function b(){var e=[];c(a.series,function(a){var b=a.options.dataLabels,f=a.dataLabelCollections||["dataLabel"];(b.enabled||a._hasPointLabels)&&!b.allowOverlap&&a.visible&&c(f,function(b){c(a.points,function(a){if(a[b]){a[b].labelrank=d(a.labelrank,a.shapeArgs&&a.shapeArgs.height),e.push(a[b]);}});});});a.hideOverlappingLabels(e);}b();e(a,"redraw",b);});b.prototype.hideOverlappingLabels=function(a){var b=a.length,d,e,j,k,l,m,n,o,p;for(e=0;e<b;e++){if(d=a[e]){d.oldOpacity=d.opacity,d.newOpacity=1;}}a.sort(function(a,b){return(b.labelrank||0)-(a.labelrank||0);});for(e=0;e<b;e++){j=a[e];for(d=e+1;d<b;++d){if(k=a[d],j&&k&&j.placed&&k.placed&&j.newOpacity!==0&&k.newOpacity!==0&&(l=j.alignAttr,m=k.alignAttr,n=j.parentGroup,o=k.parentGroup,p=2*(j.box?0:j.padding),l=!(m.x+o.translateX>l.x+n.translateX+(j.width-p)||m.x+o.translateX+(k.width-p)<l.x+n.translateX||m.y+o.translateY>l.y+n.translateY+(j.height-p)||m.y+o.translateY+(k.height-p)<l.y+n.translateY))){(j.labelrank<k.labelrank?j:k).newOpacity=0;}}}c(a,function(a){var b,c;if(a){c=a.newOpacity;if(a.oldOpacity!==c&&a.placed){c?a.show(!0):b=function(){a.hide();},a.alignAttr.opacity=c,a[a.isOld?"animate":"attr"](a.alignAttr,null,b);}a.isOld=!0;}});};})(u);ha=u.TrackerMixin={drawTrackerPoint:function(){var a=this,b=a.chart,c=b.pointer,d=a.options.cursor,e=d&&{cursor:d},f=function(a){for(var c=a.target,d;c&&!d;){d=c.point,c=c.parentNode;}if(d!==z&&d!==b.hoverPoint){d.onMouseOver(a);}};q(a.points,function(a){if(a.graphic){a.graphic.element.point=a;}if(a.dataLabel){a.dataLabel.element.point=a;}});if(!a._hasTracking){q(a.trackerGroups,function(b){if(a[b]&&(a[b].addClass("highcharts-tracker").on("mouseover",f).on("mouseout",function(a){c.onTrackerMouseOut(a);}).css(e),gb)){a[b].on("touchstart",f);}}),a._hasTracking=!0;}},drawTrackerGraph:function(){var a=this,b=a.options,c=b.trackByArea,d=[].concat(c?a.areaPath:a.graphPath),e=d.length,f=a.chart,g=f.pointer,h=f.renderer,i=f.options.tooltip.snap,j=a.tracker,k=b.cursor,l=k&&{cursor:k},m=function(){if(f.hoverSeries!==a){a.onMouseOver();}},n="rgba(192,192,192,"+(fa?0.0001:0.002)+")";if(e&&!c){for(k=e+1;k--;){d[k]===X&&d.splice(k+1,0,d[k+1]-i,d[k+2],S),(k&&d[k]===X||k===e)&&d.splice(k,0,S,d[k-2]+i,d[k-1]);}}j?j.attr({d:d}):(a.tracker=h.path(d).attr({"stroke-linejoin":"round",visibility:a.visible?"visible":"hidden",stroke:n,fill:c?n:"none","stroke-width":b.lineWidth+(c?0:2*i),zIndex:2}).add(a.group),q([a.tracker,a.markerGroup],function(a){a.addClass("highcharts-tracker").on("mouseover",m).on("mouseout",function(a){g.onTrackerMouseOut(a);}).css(l);if(gb){a.on("touchstart",m);}}));}};if(L.column){xa.prototype.drawTracker=ha.drawTrackerPoint;}if(L.pie){L.pie.prototype.drawTracker=ha.drawTrackerPoint;}if(L.scatter){qa.prototype.drawTracker=ha.drawTrackerPoint;}x(sb.prototype,{setItemEvents:function(a,b,c,d,e){var f=this;(c?b:a.legendGroup).on("mouseover",function(){a.setState("hover");b.css(f.options.itemHoverStyle);}).on("mouseout",function(){b.css(a.visible?d:e);a.setState();}).on("click",function(b){var c=function(){a.setVisible&&a.setVisible();},b={browserEvent:b};a.firePointEvent?a.firePointEvent("legendItemClick",b,c):H(a,"legendItemClick",b,c);});},createCheckboxForItem:function(a){a.checkbox=ca("input",{type:"checkbox",checked:a.selected,defaultChecked:a.selected},this.options.itemCheckboxStyle,this.chart.container);N(a.checkbox,"click",function(b){H(a.series||a,"checkboxClick",{checked:b.target.checked,item:a},function(){a.select();});});}});T.legend.itemStyle.cursor="pointer";x(jb.prototype,{showResetZoom:function(){var a=this,b=T.lang,c=a.options.chart.resetZoomButton,d=c.theme,e=d.states,f=c.relativeTo==="chart"?null:"plotBox";this.resetZoomButton=a.renderer.button(b.resetZoom,null,null,function(){a.zoomOut();},d,e&&e.hover).attr({align:c.position.align,title:b.resetZoomTitle}).add().align(c.position,!1,f);},zoomOut:function(){var a=this;H(a,"selection",{resetSelection:!0},function(){a.zoom();});},zoom:function(a){var b,c=this.pointer,d=!1,e;!a||a.resetSelection?q(this.axes,function(a){b=a.zoom();}):q(a.xAxis.concat(a.yAxis),function(a){var e=a.axis,h=e.isXAxis;if(c[h?"zoomX":"zoomY"]||c[h?"pinchX":"pinchY"]){b=e.zoom(a.min,a.max),e.displayBtn&&(d=!0);}});e=this.resetZoomButton;if(d&&!e){this.showResetZoom();}else{if(!d&&ba(e)){this.resetZoomButton=e.destroy();}}b&&this.redraw(p(this.options.chart.animation,a&&a.animation,this.pointCount<100));},pan:function(a,b){var c=this,d=c.hoverPoints,e;d&&q(d,function(a){a.setState();});q(b==="xy"?[1,0]:[1],function(b){var b=c[b?"xAxis":"yAxis"][0],d=b.horiz,h=a[d?"chartX":"chartY"],d=d?"mouseDownX":"mouseDownY",i=c[d],j=(b.pointRange||0)/2,k=b.getExtremes(),l=b.toValue(i-h,!0)+j,j=b.toValue(i+b.len-h,!0)-j,i=i>h;if(b.series.length&&(i||l>F(k.dataMin,k.min))&&(!i||j<t(k.dataMax,k.max))){b.setExtremes(l,j,!1,!1,{trigger:"pan"}),e=!0;}c[d]=h;});e&&c.redraw(!1);M(c.container,{cursor:"move"});}});x(Ma.prototype,{select:function(a,b){var c=this,d=c.series,e=d.chart,a=p(a,!c.selected);c.firePointEvent(a?"select":"unselect",{accumulate:b},function(){c.selected=c.options.selected=a;d.options.data[pa(c,d.data)]=c.options;c.setState(a&&"select");b||q(e.getSelectedPoints(),function(a){if(a.selected&&a!==c){a.selected=a.options.selected=!1,d.options.data[pa(a,d.data)]=a.options,a.setState(""),a.firePointEvent("unselect");}});});},onMouseOver:function(a,b){var c=this.series,d=c.chart,e=d.tooltip,f=d.hoverPoint;if(d.hoverSeries!==c){c.onMouseOver();}if(f&&f!==this){f.onMouseOut();}if(this.series&&(this.firePointEvent("mouseOver"),e&&(!e.shared||c.noSharedTooltip)&&e.refresh(this,a),this.setState("hover"),!b)){d.hoverPoint=this;}},onMouseOut:function(){var a=this.series.chart,b=a.hoverPoints;this.firePointEvent("mouseOut");if(!b||pa(this,b)===-1){this.setState(),a.hoverPoint=null;}},importEvents:function(){if(!this.hasImportedEvents){var a=E(this.series.options.point,this.options).events,b;this.events=a;for(b in a){N(this,b,a[b]);}this.hasImportedEvents=!0;}},setState:function(a,b){var c=V(this.plotX),d=this.plotY,e=this.series,f=e.options.states,g=ga[e.type].marker&&e.options.marker,h=g&&!g.enabled,i=g&&g.states[a],j=i&&i.enabled===!1,k=e.stateMarkerGraphic,l=this.marker||{},m=e.chart,n=e.halo,o,a=a||"";o=this.pointAttr[a]||e.pointAttr[a];if(!(a===this.state&&!b||this.selected&&a!=="select"||f[a]&&f[a].enabled===!1||a&&(j||h&&i.enabled===!1)||a&&l.states&&l.states[a]&&l.states[a].enabled===!1)){if(this.graphic){g=g&&this.graphic.symbolName&&o.r,this.graphic.attr(E(o,g?{x:c-g,y:d-g,width:2*g,height:2*g}:{})),k&&k.hide();}else{if(a&&i){if(g=i.radius,l=l.symbol||e.symbol,k&&k.currentSymbol!==l&&(k=k.destroy()),k){k[b?"animate":"attr"]({x:c-g,y:d-g});}else{if(l){e.stateMarkerGraphic=k=m.renderer.symbol(l,c-g,d-g,2*g,2*g).attr(o).add(e.markerGroup),k.currentSymbol=l;}}}if(k){k[a&&m.isInsidePlot(c,d,m.inverted)?"show":"hide"](),k.element.point=this;}}if((c=f[a]&&f[a].halo)&&c.size){if(!n){e.halo=n=m.renderer.path().add(m.seriesGroup);}n.attr(x({fill:this.color||e.color,"fill-opacity":c.opacity,zIndex:-1},c.attributes))[b?"animate":"attr"]({d:this.haloPath(c.size)});}else{n&&n.attr({d:[]});}this.state=a;}},haloPath:function(a){var b=this.series,c=b.chart,d=b.getPlotBox(),e=c.inverted,f=Math.floor(this.plotX);return c.renderer.symbols.circle(d.translateX+(e?b.yAxis.len-this.plotY:f)-a,d.translateY+(e?b.xAxis.len-f:this.plotY)-a,a*2,a*2);}});x(R.prototype,{onMouseOver:function(){var a=this.chart,b=a.hoverSeries;if(b&&b!==this){b.onMouseOut();}this.options.events.mouseOver&&H(this,"mouseOver");this.setState("hover");a.hoverSeries=this;},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;b.hoverSeries=null;if(d){d.onMouseOut();}this&&a.events.mouseOut&&H(this,"mouseOut");c&&!a.stickyTracking&&(!c.shared||this.noSharedTooltip)&&c.hide();this.setState();},setState:function(a){var b=this.options,c=this.graph,d=b.states,e=b.lineWidth,b=0,a=a||"";if(this.state!==a&&(this.state=a,!(d[a]&&d[a].enabled===!1)&&(a&&(e=d[a].lineWidth||e+(d[a].lineWidthPlus||0)),c&&!c.dashstyle))){a={"stroke-width":e};for(c.attr(a);this["zoneGraph"+b];){this["zoneGraph"+b].attr(a),b+=1;}}},setVisible:function(a,b){var c=this,d=c.chart,e=c.legendItem,f,g=d.options.chart.ignoreHiddenSeries,h=c.visible;f=(c.visible=a=c.options.visible=c.userOptions.visible=a===void 0?!h:a)?"show":"hide";q(["group","dataLabelsGroup","markerGroup","tracker"],function(a){if(c[a]){c[a][f]();}});if(d.hoverSeries===c||(d.hoverPoint&&d.hoverPoint.series)===c){c.onMouseOut();}e&&d.legend.colorizeItem(c,a);c.isDirty=!0;c.options.stacking&&q(d.series,function(a){if(a.options.stacking&&a.visible){a.isDirty=!0;}});q(c.linkedSeries,function(b){b.setVisible(a,!1);});if(g){d.isDirtyBox=!0;}b!==!1&&d.redraw();H(c,f);},show:function(){this.setVisible(!0);},hide:function(){this.setVisible(!1);},select:function(a){this.selected=a=a===z?!this.selected:a;if(this.checkbox){this.checkbox.checked=a;}H(this,a?"select":"unselect");},drawTracker:ha.drawTrackerGraph});x(u,{Color:na,Point:Ma,Tick:Ya,Renderer:fb,SVGElement:J,SVGRenderer:Fa,arrayMin:Oa,arrayMax:Ha,charts:U,correctFloat:$,dateFormat:Ta,error:ea,format:Na,pathAnim:void 0,getOptions:function(){return T;},hasBidiBug:Sb,isTouchDevice:Ob,setOptions:function(a){T=E(!0,T,a);Hb();return T;},addEvent:N,removeEvent:Y,createElement:ca,discardElement:Va,css:M,each:q,map:Ea,merge:E,splat:ua,stableSort:kb,extendClass:sa,pInt:B,svg:fa,canvas:la,vml:!fa&&!la,product:"Highcharts",version:"4.2.7"});return u;});(function(f){typeof module==="object"&&module.exports?module.exports=f:f(Highcharts);})(function(f){var s=f.win,j=s.document,B=f.Chart,u=f.addEvent,C=f.removeEvent,D=f.fireEvent,r=f.createElement,t=f.discardElement,w=f.css,l=f.merge,m=f.each,q=f.extend,F=f.splat,G=Math.max,H=f.isTouchDevice,I=f.Renderer.prototype.symbols,z=f.getOptions(),A;q(z.lang,{printChart:"Print chart",downloadPNG:"Download PNG image",downloadJPEG:"Download JPEG image",downloadPDF:"Download PDF document",downloadSVG:"Download SVG vector image",contextButtonTitle:"Chart context menu"});z.navigation={menuStyle:{border:"1px solid #A0A0A0",background:"#FFFFFF",padding:"5px 0"},menuItemStyle:{padding:"0 10px",background:"none",color:"#303030",fontSize:H?"14px":"11px"},menuItemHoverStyle:{background:"#4572A5",color:"#FFFFFF"},buttonOptions:{symbolFill:"#E0E0E0",symbolSize:14,symbolStroke:"#666",symbolStrokeWidth:3,symbolX:12.5,symbolY:10.5,align:"right",buttonSpacing:3,height:22,theme:{fill:"white",stroke:"none"},verticalAlign:"top",width:24}};z.exporting={type:"image/png",url:"https://export.highcharts.com/",printMaxWidth:780,scale:2,buttons:{contextButton:{menuClassName:"highcharts-contextmenu",symbol:"menu",_titleKey:"contextButtonTitle",menuItems:[{textKey:"printChart",onclick:function(){this.print();}},{separator:!0},{textKey:"downloadPNG",onclick:function(){this.exportChart();}},{textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"});}},{textKey:"downloadPDF",onclick:function(){this.exportChart({type:"application/pdf"});}},{textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"});}}]}}};f.post=function(a,b,e){var c,a=r("form",l({method:"post",action:a,enctype:"multipart/form-data"},e),{display:"none"},j.body);for(c in b){r("input",{type:"hidden",name:c,value:b[c]},null,a);}a.submit();t(a);};q(B.prototype,{sanitizeSVG:function(a){return a.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\(("|&quot;)(\S+)("|&quot;)\)/g,"url($2)").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ (NS[0-9]+\:)?href=/g," xlink:href=").replace(/\n/," ").replace(/<\/svg>.*?$/,"</svg>").replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g,"\u00a0").replace(/&shy;/g,"\u00ad").replace(/<IMG /g,"<image ").replace(/<(\/?)TITLE>/g,"<$1title>").replace(/height=([^" ]+)/g,'height="$1"').replace(/width=([^" ]+)/g,'width="$1"').replace(/hc-svg-href="([^"]+)">/g,'xlink:href="$1"/>').replace(/ id=([^" >]+)/g,' id="$1"').replace(/class=([^" >]+)/g,'class="$1"').replace(/ transform /g," ").replace(/:(path|rect)/g,"$1").replace(/style="([^"]+)"/g,function(a){return a.toLowerCase();});},getChartHTML:function(){return this.container.innerHTML;},getSVG:function(a){var b=this,e,c,g,k,h,d=l(b.options,a),n=d.exporting.allowHTML;if(!j.createElementNS){j.createElementNS=function(a,b){return j.createElement(b);};}c=r("div",null,{position:"absolute",top:"-9999em",width:b.chartWidth+"px",height:b.chartHeight+"px"},j.body);g=b.renderTo.style.width;h=b.renderTo.style.height;g=d.exporting.sourceWidth||d.chart.width||/px$/.test(g)&&parseInt(g,10)||600;h=d.exporting.sourceHeight||d.chart.height||/px$/.test(h)&&parseInt(h,10)||400;q(d.chart,{animation:!1,renderTo:c,forExport:!0,renderer:"SVGRenderer",width:g,height:h});d.exporting.enabled=!1;delete d.data;d.series=[];m(b.series,function(a){k=l(a.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:a.visible});k.isInternal||d.series.push(k);});a&&m(["xAxis","yAxis"],function(b){m(F(a[b]),function(a,c){d[b][c]=l(d[b][c],a);});});e=new f.Chart(d,b.callback);m(["xAxis","yAxis"],function(a){m(b[a],function(b,c){var d=e[a][c],f=b.getExtremes(),g=f.userMin,f=f.userMax;d&&(g!==void 0||f!==void 0)&&d.setExtremes(g,f,!0,!1);});});g=e.getChartHTML();d=null;e.destroy();t(c);if(n&&(c=g.match(/<\/svg>(.*?$)/))){c='<foreignObject x="0" y="0" width="200" height="200"><body xmlns="http://www.w3.org/1999/xhtml">'+c[1]+"</body></foreignObject>",g=g.replace("</svg>",c+"</svg>");}g=this.sanitizeSVG(g);return g=g.replace(/(url\(#highcharts-[0-9]+)&quot;/g,"$1").replace(/&quot;/g,"'");},getSVGForExport:function(a,b){var e=this.options.exporting;return this.getSVG(l({chart:{borderRadius:0}},e.chartOptions,b,{exporting:{sourceWidth:a&&a.sourceWidth||e.sourceWidth,sourceHeight:a&&a.sourceHeight||e.sourceHeight}}));},exportChart:function(a,b){var e=this.getSVGForExport(a,b),a=l(this.options.exporting,a);f.post(a.url,{filename:a.filename||"chart",type:a.type,width:a.width||0,scale:a.scale,svg:e},a.formAttributes);},print:function(){var a=this,b=a.container,e=[],c=b.parentNode,f=j.body,k=f.childNodes,h=a.options.exporting.printMaxWidth,d,n;if(!a.isPrinting){a.isPrinting=!0;a.pointer.reset(null,0);D(a,"beforePrint");if(n=h&&a.chartWidth>h){d=[a.options.chart.width,void 0,!1],a.setSize(h,void 0,!1);}m(k,function(a,b){if(a.nodeType===1){e[b]=a.style.display,a.style.display="none";}});f.appendChild(b);s.focus();s.print();setTimeout(function(){c.appendChild(b);m(k,function(a,b){if(a.nodeType===1){a.style.display=e[b];}});a.isPrinting=!1;n&&a.setSize.apply(a,d);D(a,"afterPrint");},1000);}},contextMenu:function(a,b,e,c,f,k,h){var d=this,n=d.options.navigation,l=n.menuItemStyle,o=d.chartWidth,p=d.chartHeight,E="cache-"+a,i=d[E],v=G(f,k),x,y,s,t=function(b){d.pointer.inClass(b.target,a)||y();};if(!i){d[E]=i=r("div",{className:a},{position:"absolute",zIndex:1000,padding:v+"px"},d.container),x=r("div",null,q({MozBoxShadow:"3px 3px 10px #888",WebkitBoxShadow:"3px 3px 10px #888",boxShadow:"3px 3px 10px #888"},n.menuStyle),i),y=function(){w(i,{display:"none"});h&&h.setState(0);d.openMenu=!1;},u(i,"mouseleave",function(){s=setTimeout(y,500);}),u(i,"mouseenter",function(){clearTimeout(s);}),u(j,"mouseup",t),u(d,"destroy",function(){C(j,"mouseup",t);}),m(b,function(a){if(a){var b=a.separator?r("hr",null,null,x):r("div",{onmouseover:function(){w(this,n.menuItemHoverStyle);},onmouseout:function(){w(this,l);},onclick:function(b){b&&b.stopPropagation();y();a.onclick&&a.onclick.apply(d,arguments);},innerHTML:a.text||d.options.lang[a.textKey]},q({cursor:"pointer"},l),x);d.exportDivElements.push(b);}}),d.exportDivElements.push(x,i),d.exportMenuWidth=i.offsetWidth,d.exportMenuHeight=i.offsetHeight;}b={display:"block"};e+d.exportMenuWidth>o?b.right=o-e-f-v+"px":b.left=e-v+"px";c+k+d.exportMenuHeight>p&&h.alignOptions.verticalAlign!=="top"?b.bottom=p-c-v+"px":b.top=c+k-v+"px";w(i,b);d.openMenu=!0;},addButton:function(a){var b=this,e=b.renderer,c=l(b.options.navigation.buttonOptions,a),g=c.onclick,k=c.menuItems,h,d,n={stroke:c.symbolStroke,fill:c.symbolFill},j=c.symbolSize||12;if(!b.btnCount){b.btnCount=0;}if(!b.exportDivElements){b.exportDivElements=[],b.exportSVGElements=[];}if(c.enabled!==!1){var o=c.theme,p=o.states,m=p&&p.hover,p=p&&p.select,i;delete o.states;g?i=function(a){a.stopPropagation();g.call(b,a);}:k&&(i=function(){b.contextMenu(d.menuClassName,k,d.translateX,d.translateY,d.width,d.height,d);d.setState(2);});c.text&&c.symbol?o.paddingLeft=f.pick(o.paddingLeft,25):c.text||q(o,{width:c.width,height:c.height,padding:0});d=e.button(c.text,0,0,i,o,m,p).attr({title:b.options.lang[c._titleKey],"stroke-linecap":"round",zIndex:3});d.menuClassName=a.menuClassName||"highcharts-menu-"+b.btnCount++;c.symbol&&(h=e.symbol(c.symbol,c.symbolX-j/2,c.symbolY-j/2,j,j).attr(q(n,{"stroke-width":c.symbolStrokeWidth||1,zIndex:1})).add(d));d.add().align(q(c,{width:d.width,x:f.pick(c.x,A)}),!0,"spacingBox");A+=(d.width+c.buttonSpacing)*(c.align==="right"?-1:1);b.exportSVGElements.push(d,h);}},destroyExport:function(a){var a=a.target,b,e;for(b=0;b<a.exportSVGElements.length;b++){if(e=a.exportSVGElements[b]){e.onclick=e.ontouchstart=null,a.exportSVGElements[b]=e.destroy();}}for(b=0;b<a.exportDivElements.length;b++){e=a.exportDivElements[b],C(e,"mouseleave"),a.exportDivElements[b]=e.onmouseout=e.onmouseover=e.ontouchstart=e.onclick=null,t(e);}}});I.menu=function(a,b,e,c){return["M",a,b+2.5,"L",a+e,b+2.5,"M",a,b+c/2+0.5,"L",a+e,b+c/2+0.5,"M",a,b+c-1.5,"L",a+e,b+c-1.5];};B.prototype.callbacks.push(function(a){var b,e=a.options.exporting,c=e.buttons;A=0;if(e.enabled!==!1){for(b in c){a.addButton(c[b]);}u(a,"destroy",a.destroyExport);}});});